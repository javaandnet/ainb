(function(){"use strict";var e={6396:function(e,t,n){var s={};n.r(s),n.d(s,{k:function(){return Ow}});var o=n(2379),a=n(2360);function r(e,t,n,s,o,r){const i=(0,a.g2)("vue-advanced-chat");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(i,{id:"chat",ref:"chat",height:"calc(100vh - 20px)","single-room":!0,"current-user-id":o.currentUserId,"show-files":!1,"show-add-room":!1,"show-emojis":!1,rooms:JSON.stringify(o.rooms),messages:JSON.stringify(o.messages),"loading-rooms":!1,"messages-loaded":!0,"show-reaction-emojis":!1,"auto-scroll":JSON.stringify(e.autoScroll),"message-actions":JSON.stringify([]),onSendMessage:t[0]||(t[0]=e=>r.sendMessage(e.detail[0])),onRecordVoice:t[1]||(t[1]=e=>r.record(e.detail[0])),onRecordStatus:t[2]||(t[2]=e=>r.recordStatus(e.detail[0]))},null,8,["current-user-id","rooms","messages","auto-scroll","message-actions"])])}n(381),n(7836),n(9109),n(4381),n(2432),n(9878),n(6801),n(6462),n(5194),n(7092),n(8925),n(1796),n(1467),n(2064),n(2114),n(8360),n(726),n(2765),n(3312);function i(e,t){const n=Object.create(null),s=e.split(",");for(let o=0;o<s.length;o++)n[s[o]]=!0;return t?e=>!!n[e.toLowerCase()]:e=>!!n[e]}const l=()=>{},c=Object.assign,u=Object.prototype.hasOwnProperty,d=(e,t)=>u.call(e,t),m=Array.isArray,p=e=>"[object Map]"===b(e),h=e=>"function"===typeof e,f=e=>"string"===typeof e,g=e=>"symbol"===typeof e,_=e=>null!==e&&"object"===typeof e,v=Object.prototype.toString,b=e=>v.call(e),y=e=>b(e).slice(8,-1),x=e=>f(e)&&"NaN"!==e&&"-"!==e[0]&&""+parseInt(e,10)===e,w=(e,t)=>!Object.is(e,t),k=(e,t,n)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:n})};let S;class M{constructor(e=!1){this.active=!0,this.effects=[],this.cleanups=[],!e&&S&&(this.parent=S,this.index=(S.scopes||(S.scopes=[])).push(this)-1)}run(e){if(this.active){const t=S;try{return S=this,e()}finally{S=t}}}on(){S=this}off(){S=this.parent}stop(e){if(this.active){let t,n;for(t=0,n=this.effects.length;t<n;t++)this.effects[t].stop();for(t=0,n=this.cleanups.length;t<n;t++)this.cleanups[t]();if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].stop(!0);if(this.parent&&!e){const e=this.parent.scopes.pop();e&&e!==this&&(this.parent.scopes[this.index]=e,e.index=this.index)}this.active=!1}}}function A(e,t=S){t&&t.active&&t.effects.push(e)}const R=e=>{const t=new Set(e);return t.w=0,t.n=0,t},E=e=>(e.w&O)>0,T=e=>(e.n&O)>0,B=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=O},I=e=>{const{deps:t}=e;if(t.length){let n=0;for(let s=0;s<t.length;s++){const o=t[s];E(o)&&!T(o)?o.delete(e):t[n++]=o,o.w&=~O,o.n&=~O}t.length=n}},C=new WeakMap;let j=0,O=1;const F=30;let L;const P=Symbol(""),D=Symbol("");class H{constructor(e,t=null,n){this.fn=e,this.scheduler=t,this.active=!0,this.deps=[],this.parent=void 0,A(this,n)}run(){if(!this.active)return this.fn();let e=L,t=$;while(e){if(e===this)return;e=e.parent}try{return this.parent=L,L=this,$=!0,O=1<<++j,j<=F?B(this):N(this),this.fn()}finally{j<=F&&I(this),O=1<<--j,L=this.parent,$=t,this.parent=void 0,this.deferStop&&this.stop()}}stop(){L===this?this.deferStop=!0:this.active&&(N(this),this.onStop&&this.onStop(),this.active=!1)}}function N(e){const{deps:t}=e;if(t.length){for(let n=0;n<t.length;n++)t[n].delete(e);t.length=0}}let $=!0;const z=[];function V(){z.push($),$=!1}function q(){const e=z.pop();$=void 0===e||e}function U(e,t,n){if($&&L){let t=C.get(e);t||C.set(e,t=new Map);let s=t.get(n);s||t.set(n,s=R()),X(s)}}function X(e,t){let n=!1;j<=F?T(e)||(e.n|=O,n=!E(e)):n=!e.has(L),n&&(e.add(L),L.deps.push(e))}function Y(e,t,n,s,o,a){const r=C.get(e);if(!r)return;let i=[];if("clear"===t)i=[...r.values()];else if("length"===n&&m(e))r.forEach(((e,t)=>{("length"===t||t>=s)&&i.push(e)}));else switch(void 0!==n&&i.push(r.get(n)),t){case"add":m(e)?x(n)&&i.push(r.get("length")):(i.push(r.get(P)),p(e)&&i.push(r.get(D)));break;case"delete":m(e)||(i.push(r.get(P)),p(e)&&i.push(r.get(D)));break;case"set":p(e)&&i.push(r.get(P));break}if(1===i.length)i[0]&&G(i[0]);else{const e=[];for(const t of i)t&&e.push(...t);G(R(e))}}function G(e,t){const n=m(e)?e:[...e];for(const s of n)s.computed&&K(s);for(const s of n)s.computed||K(s)}function K(e,t){(e!==L||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const Z=i("__proto__,__v_isRef,__isVue"),W=new Set(Object.getOwnPropertyNames(Symbol).filter((e=>"arguments"!==e&&"caller"!==e)).map((e=>Symbol[e])).filter(g)),Q=se(),J=se(!1,!0),ee=se(!0),te=ne();function ne(){const e={};return["includes","indexOf","lastIndexOf"].forEach((t=>{e[t]=function(...e){const n=Ge(this);for(let t=0,o=this.length;t<o;t++)U(n,"get",t+"");const s=n[t](...e);return-1===s||!1===s?n[t](...e.map(Ge)):s}})),["push","pop","shift","unshift","splice"].forEach((t=>{e[t]=function(...e){V();const n=Ge(this)[t].apply(this,e);return q(),n}})),e}function se(e=!1,t=!1){return function(n,s,o){if("__v_isReactive"===s)return!e;if("__v_isReadonly"===s)return e;if("__v_isShallow"===s)return t;if("__v_raw"===s&&o===(e?t?Pe:Le:t?Fe:Oe).get(n))return n;const a=m(n);if(!e&&a&&d(te,s))return Reflect.get(te,s,o);const r=Reflect.get(n,s,o);return(g(s)?W.has(s):Z(s))?r:(e||U(n,"get",s),t?r:et(r)?a&&x(s)?r:r.value:_(r)?e?ze(r):Ne(r):r)}}const oe=re(),ae=re(!0);function re(e=!1){return function(t,n,s,o){let a=t[n];if(Ue(a)&&et(a)&&!et(s))return!1;if(!e&&!Ue(s)&&(Xe(s)||(s=Ge(s),a=Ge(a)),!m(t)&&et(a)&&!et(s)))return a.value=s,!0;const r=m(t)&&x(n)?Number(n)<t.length:d(t,n),i=Reflect.set(t,n,s,o);return t===Ge(o)&&(r?w(s,a)&&Y(t,"set",n,s):Y(t,"add",n,s)),i}}function ie(e,t){const n=d(e,t);e[t];const s=Reflect.deleteProperty(e,t);return s&&n&&Y(e,"delete",t,void 0),s}function le(e,t){const n=Reflect.has(e,t);return g(t)&&W.has(t)||U(e,"has",t),n}function ce(e){return U(e,"iterate",m(e)?"length":P),Reflect.ownKeys(e)}const ue={get:Q,set:oe,deleteProperty:ie,has:le,ownKeys:ce},de={get:ee,set(e,t){return!0},deleteProperty(e,t){return!0}},me=c({},ue,{get:J,set:ae}),pe=e=>e,he=e=>Reflect.getPrototypeOf(e);function fe(e,t,n=!1,s=!1){e=e["__v_raw"];const o=Ge(e),a=Ge(t);n||(t!==a&&U(o,"get",t),U(o,"get",a));const{has:r}=he(o),i=s?pe:n?We:Ze;return r.call(o,t)?i(e.get(t)):r.call(o,a)?i(e.get(a)):void(e!==o&&e.get(t))}function ge(e,t=!1){const n=this["__v_raw"],s=Ge(n),o=Ge(e);return t||(e!==o&&U(s,"has",e),U(s,"has",o)),e===o?n.has(e):n.has(e)||n.has(o)}function _e(e,t=!1){return e=e["__v_raw"],!t&&U(Ge(e),"iterate",P),Reflect.get(e,"size",e)}function ve(e){e=Ge(e);const t=Ge(this),n=he(t),s=n.has.call(t,e);return s||(t.add(e),Y(t,"add",e,e)),this}function be(e,t){t=Ge(t);const n=Ge(this),{has:s,get:o}=he(n);let a=s.call(n,e);a||(e=Ge(e),a=s.call(n,e));const r=o.call(n,e);return n.set(e,t),a?w(t,r)&&Y(n,"set",e,t):Y(n,"add",e,t),this}function ye(e){const t=Ge(this),{has:n,get:s}=he(t);let o=n.call(t,e);o||(e=Ge(e),o=n.call(t,e)),s&&s.call(t,e);const a=t.delete(e);return o&&Y(t,"delete",e,void 0),a}function xe(){const e=Ge(this),t=0!==e.size,n=e.clear();return t&&Y(e,"clear",void 0,void 0),n}function we(e,t){return function(n,s){const o=this,a=o["__v_raw"],r=Ge(a),i=t?pe:e?We:Ze;return!e&&U(r,"iterate",P),a.forEach(((e,t)=>n.call(s,i(e),i(t),o)))}}function ke(e,t,n){return function(...s){const o=this["__v_raw"],a=Ge(o),r=p(a),i="entries"===e||e===Symbol.iterator&&r,l="keys"===e&&r,c=o[e](...s),u=n?pe:t?We:Ze;return!t&&U(a,"iterate",l?D:P),{next(){const{value:e,done:t}=c.next();return t?{value:e,done:t}:{value:i?[u(e[0]),u(e[1])]:u(e),done:t}},[Symbol.iterator](){return this}}}}function Se(e){return function(...t){return"delete"!==e&&this}}function Me(){const e={get(e){return fe(this,e)},get size(){return _e(this)},has:ge,add:ve,set:be,delete:ye,clear:xe,forEach:we(!1,!1)},t={get(e){return fe(this,e,!1,!0)},get size(){return _e(this)},has:ge,add:ve,set:be,delete:ye,clear:xe,forEach:we(!1,!0)},n={get(e){return fe(this,e,!0)},get size(){return _e(this,!0)},has(e){return ge.call(this,e,!0)},add:Se("add"),set:Se("set"),delete:Se("delete"),clear:Se("clear"),forEach:we(!0,!1)},s={get(e){return fe(this,e,!0,!0)},get size(){return _e(this,!0)},has(e){return ge.call(this,e,!0)},add:Se("add"),set:Se("set"),delete:Se("delete"),clear:Se("clear"),forEach:we(!0,!0)},o=["keys","values","entries",Symbol.iterator];return o.forEach((o=>{e[o]=ke(o,!1,!1),n[o]=ke(o,!0,!1),t[o]=ke(o,!1,!0),s[o]=ke(o,!0,!0)})),[e,n,t,s]}const[Ae,Re,Ee,Te]=Me();function Be(e,t){const n=t?e?Te:Ee:e?Re:Ae;return(t,s,o)=>"__v_isReactive"===s?!e:"__v_isReadonly"===s?e:"__v_raw"===s?t:Reflect.get(d(n,s)&&s in t?n:t,s,o)}const Ie={get:Be(!1,!1)},Ce={get:Be(!1,!0)},je={get:Be(!0,!1)},Oe=new WeakMap,Fe=new WeakMap,Le=new WeakMap,Pe=new WeakMap;function De(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function He(e){return e["__v_skip"]||!Object.isExtensible(e)?0:De(y(e))}function Ne(e){return Ue(e)?e:Ve(e,!1,ue,Ie,Oe)}function $e(e){return Ve(e,!1,me,Ce,Fe)}function ze(e){return Ve(e,!0,de,je,Le)}function Ve(e,t,n,s,o){if(!_(e))return e;if(e["__v_raw"]&&(!t||!e["__v_isReactive"]))return e;const a=o.get(e);if(a)return a;const r=He(e);if(0===r)return e;const i=new Proxy(e,2===r?s:n);return o.set(e,i),i}function qe(e){return Ue(e)?qe(e["__v_raw"]):!(!e||!e["__v_isReactive"])}function Ue(e){return!(!e||!e["__v_isReadonly"])}function Xe(e){return!(!e||!e["__v_isShallow"])}function Ye(e){return qe(e)||Ue(e)}function Ge(e){const t=e&&e["__v_raw"];return t?Ge(t):e}function Ke(e){return k(e,"__v_skip",!0),e}const Ze=e=>_(e)?Ne(e):e,We=e=>_(e)?ze(e):e;function Qe(e){$&&L&&(e=Ge(e),X(e.dep||(e.dep=R())))}function Je(e,t){e=Ge(e),e.dep&&G(e.dep)}function et(e){return!(!e||!0!==e.__v_isRef)}function tt(e){return nt(e,!1)}function nt(e,t){return et(e)?e:new st(e,t)}class st{constructor(e,t){this.__v_isShallow=t,this.dep=void 0,this.__v_isRef=!0,this._rawValue=t?e:Ge(e),this._value=t?e:Ze(e)}get value(){return Qe(this),this._value}set value(e){e=this.__v_isShallow?e:Ge(e),w(e,this._rawValue)&&(this._rawValue=e,this._value=this.__v_isShallow?e:Ze(e),Je(this))}}function ot(e){return et(e)?e.value:e}const at={get:(e,t,n)=>ot(Reflect.get(e,t,n)),set:(e,t,n,s)=>{const o=e[t];return et(o)&&!et(n)?(o.value=n,!0):Reflect.set(e,t,n,s)}};function rt(e){return qe(e)?e:new Proxy(e,at)}class it{constructor(e,t,n,s){this._setter=t,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new H(e,(()=>{this._dirty||(this._dirty=!0,Je(this))})),this.effect.computed=this,this.effect.active=this._cacheable=!s,this["__v_isReadonly"]=n}get value(){const e=Ge(this);return Qe(e),!e._dirty&&e._cacheable||(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function lt(e,t,n=!1){let s,o;const a=h(e);a?(s=e,o=l):(s=e.get,o=e.set);const r=new it(s,o,a||!o,n);return r}function ct(e,t){const n=Object.create(null),s=e.split(",");for(let o=0;o<s.length;o++)n[s[o]]=!0;return t?e=>!!n[e.toLowerCase()]:e=>!!n[e]}function ut(e){if(Tt(e)){const t={};for(let n=0;n<e.length;n++){const s=e[n],o=jt(s)?pt(s):ut(s);if(o)for(const e in o)t[e]=o[e]}return t}return jt(e)||Ot(e)?e:void 0}const dt=/;(?![^(]*\))/g,mt=/:(.+)/;function pt(e){const t={};return e.split(dt).forEach((e=>{if(e){const n=e.split(mt);n.length>1&&(t[n[0].trim()]=n[1].trim())}})),t}function ht(e){let t="";if(jt(e))t=e;else if(Tt(e))for(let n=0;n<e.length;n++){const s=ht(e[n]);s&&(t+=s+" ")}else if(Ot(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}function ft(e){if(!e)return null;let{class:t,style:n}=e;return t&&!jt(t)&&(e.class=ht(t)),n&&(e.style=ut(n)),e}const gt=e=>jt(e)?e:null==e?"":Tt(e)||Ot(e)&&(e.toString===Lt||!Ct(e.toString))?JSON.stringify(e,_t,2):String(e),_t=(e,t)=>t&&t.__v_isRef?_t(e,t.value):Bt(t)?{[`Map(${t.size})`]:[...t.entries()].reduce(((e,[t,n])=>(e[`${t} =>`]=n,e)),{})}:It(t)?{[`Set(${t.size})`]:[...t.values()]}:!Ot(t)||Tt(t)||Dt(t)?t:String(t),vt={},bt=[],yt=()=>{},xt=()=>!1,wt=/^on[^a-z]/,kt=e=>wt.test(e),St=e=>e.startsWith("onUpdate:"),Mt=Object.assign,At=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},Rt=Object.prototype.hasOwnProperty,Et=(e,t)=>Rt.call(e,t),Tt=Array.isArray,Bt=e=>"[object Map]"===Pt(e),It=e=>"[object Set]"===Pt(e),Ct=e=>"function"===typeof e,jt=e=>"string"===typeof e,Ot=e=>null!==e&&"object"===typeof e,Ft=e=>Ot(e)&&Ct(e.then)&&Ct(e.catch),Lt=Object.prototype.toString,Pt=e=>Lt.call(e),Dt=e=>"[object Object]"===Pt(e),Ht=ct(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Nt=e=>{const t=Object.create(null);return n=>{const s=t[n];return s||(t[n]=e(n))}},$t=/-(\w)/g,zt=Nt((e=>e.replace($t,((e,t)=>t?t.toUpperCase():"")))),Vt=/\B([A-Z])/g,qt=Nt((e=>e.replace(Vt,"-$1").toLowerCase())),Ut=Nt((e=>e.charAt(0).toUpperCase()+e.slice(1))),Xt=Nt((e=>e?`on${Ut(e)}`:"")),Yt=(e,t)=>!Object.is(e,t),Gt=(e,t)=>{for(let n=0;n<e.length;n++)e[n](t)},Kt=(e,t,n)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:n})},Zt=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let Wt;const Qt=()=>Wt||(Wt="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:{});function Jt(e,t,n,s){let o;try{o=s?e(...s):e()}catch(a){tn(a,t,n)}return o}function en(e,t,n,s){if(Ct(e)){const o=Jt(e,t,n,s);return o&&Ft(o)&&o.catch((e=>{tn(e,t,n)})),o}const o=[];for(let a=0;a<e.length;a++)o.push(en(e[a],t,n,s));return o}function tn(e,t,n,s=!0){const o=t?t.vnode:null;if(t){let s=t.parent;const o=t.proxy,a=n;while(s){const t=s.ec;if(t)for(let n=0;n<t.length;n++)if(!1===t[n](e,o,a))return;s=s.parent}const r=t.appContext.config.errorHandler;if(r)return void Jt(r,null,10,[e,o,a])}nn(e,n,o,s)}function nn(e,t,n,s=!0){console.error(e)}let sn=!1,on=!1;const an=[];let rn=0;const ln=[];let cn=null,un=0;const dn=[];let mn=null,pn=0;const hn=Promise.resolve();let fn=null,gn=null;function _n(e){const t=fn||hn;return e?t.then(this?e.bind(this):e):t}function vn(e){let t=rn+1,n=an.length;while(t<n){const s=t+n>>>1,o=Rn(an[s]);o<e?t=s+1:n=s}return t}function bn(e){an.length&&an.includes(e,sn&&e.allowRecurse?rn+1:rn)||e===gn||(null==e.id?an.push(e):an.splice(vn(e.id),0,e),yn())}function yn(){sn||on||(on=!0,fn=hn.then(En))}function xn(e){const t=an.indexOf(e);t>rn&&an.splice(t,1)}function wn(e,t,n,s){Tt(e)?n.push(...e):t&&t.includes(e,e.allowRecurse?s+1:s)||n.push(e),yn()}function kn(e){wn(e,cn,ln,un)}function Sn(e){wn(e,mn,dn,pn)}function Mn(e,t=null){if(ln.length){for(gn=t,cn=[...new Set(ln)],ln.length=0,un=0;un<cn.length;un++)cn[un]();cn=null,un=0,gn=null,Mn(e,t)}}function An(e){if(Mn(),dn.length){const e=[...new Set(dn)];if(dn.length=0,mn)return void mn.push(...e);for(mn=e,mn.sort(((e,t)=>Rn(e)-Rn(t))),pn=0;pn<mn.length;pn++)mn[pn]();mn=null,pn=0}}const Rn=e=>null==e.id?1/0:e.id;function En(e){on=!1,sn=!0,Mn(e),an.sort(((e,t)=>Rn(e)-Rn(t)));try{for(rn=0;rn<an.length;rn++){const e=an[rn];e&&!1!==e.active&&Jt(e,null,14)}}finally{rn=0,an.length=0,An(),sn=!1,fn=null,(an.length||ln.length||dn.length)&&En(e)}}function Tn(e,t,...n){if(e.isUnmounted)return;const s=e.vnode.props||vt;let o=n;const a=t.startsWith("update:"),r=a&&t.slice(7);if(r&&r in s){const e=`${"modelValue"===r?"model":r}Modifiers`,{number:t,trim:a}=s[e]||vt;a&&(o=n.map((e=>e.trim()))),t&&(o=n.map(Zt))}let i,l=s[i=Xt(t)]||s[i=Xt(zt(t))];!l&&a&&(l=s[i=Xt(qt(t))]),l&&en(l,e,6,o);const c=s[i+"Once"];if(c){if(e.emitted){if(e.emitted[i])return}else e.emitted={};e.emitted[i]=!0,en(c,e,6,o)}}function Bn(e,t,n=!1){const s=t.emitsCache,o=s.get(e);if(void 0!==o)return o;const a=e.emits;let r={},i=!1;if(!Ct(e)){const s=e=>{const n=Bn(e,t,!0);n&&(i=!0,Mt(r,n))};!n&&t.mixins.length&&t.mixins.forEach(s),e.extends&&s(e.extends),e.mixins&&e.mixins.forEach(s)}return a||i?(Tt(a)?a.forEach((e=>r[e]=null)):Mt(r,a),s.set(e,r),r):(s.set(e,null),null)}function In(e,t){return!(!e||!kt(t))&&(t=t.slice(2).replace(/Once$/,""),Et(e,t[0].toLowerCase()+t.slice(1))||Et(e,qt(t))||Et(e,t))}let Cn=null,jn=null;function On(e){const t=Cn;return Cn=e,jn=e&&e.type.__scopeId||null,t}function Fn(e,t=Cn,n){if(!t)return e;if(e._n)return e;const s=(...n)=>{s._d&&$o(-1);const o=On(t),a=e(...n);return On(o),s._d&&$o(1),a};return s._n=!0,s._c=!0,s._d=!0,s}function Ln(e){const{type:t,vnode:n,proxy:s,withProxy:o,props:a,propsOptions:[r],slots:i,attrs:l,emit:c,render:u,renderCache:d,data:m,setupState:p,ctx:h,inheritAttrs:f}=e;let g,_;const v=On(e);try{if(4&n.shapeFlag){const e=o||s;g=sa(u.call(e,e,d,a,p,m,h)),_=l}else{const e=t;0,g=sa(e.length>1?e(a,{attrs:l,slots:i,emit:c}):e(a,null)),_=t.props?l:Pn(l)}}catch(y){Lo.length=0,tn(y,e,1),g=Wo(Oo)}let b=g;if(_&&!1!==f){const e=Object.keys(_),{shapeFlag:t}=b;e.length&&7&t&&(r&&e.some(St)&&(_=Dn(_,r)),b=ea(b,_))}return n.dirs&&(b=ea(b),b.dirs=b.dirs?b.dirs.concat(n.dirs):n.dirs),n.transition&&(b.transition=n.transition),g=b,On(v),g}const Pn=e=>{let t;for(const n in e)("class"===n||"style"===n||kt(n))&&((t||(t={}))[n]=e[n]);return t},Dn=(e,t)=>{const n={};for(const s in e)St(s)&&s.slice(9)in t||(n[s]=e[s]);return n};function Hn(e,t,n){const{props:s,children:o,component:a}=e,{props:r,children:i,patchFlag:l}=t,c=a.emitsOptions;if(t.dirs||t.transition)return!0;if(!(n&&l>=0))return!(!o&&!i||i&&i.$stable)||s!==r&&(s?!r||Nn(s,r,c):!!r);if(1024&l)return!0;if(16&l)return s?Nn(s,r,c):!!r;if(8&l){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const n=e[t];if(r[n]!==s[n]&&!In(c,n))return!0}}return!1}function Nn(e,t,n){const s=Object.keys(t);if(s.length!==Object.keys(e).length)return!0;for(let o=0;o<s.length;o++){const a=s[o];if(t[a]!==e[a]&&!In(n,a))return!0}return!1}function $n({vnode:e,parent:t},n){while(t&&t.subTree===e)(e=t.vnode).el=n,t=t.parent}const zn=e=>e.__isSuspense;function Vn(e,t){t&&t.pendingBranch?Tt(e)?t.effects.push(...e):t.effects.push(e):Sn(e)}function qn(e,t){if(da){let n=da.provides;const s=da.parent&&da.parent.provides;s===n&&(n=da.provides=Object.create(s)),n[e]=t}else;}function Un(e,t,n=!1){const s=da||Cn;if(s){const o=null==s.parent?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides;if(o&&e in o)return o[e];if(arguments.length>1)return n&&Ct(t)?t.call(s.proxy):t}}const Xn={};function Yn(e,t,n){return Gn(e,t,n)}function Gn(e,t,{immediate:n,deep:s,flush:o,onTrack:a,onTrigger:r}=vt){const i=da;let l,c,u=!1,d=!1;if(et(e)?(l=()=>e.value,u=Xe(e)):qe(e)?(l=()=>e,s=!0):Tt(e)?(d=!0,u=e.some((e=>qe(e)||Xe(e))),l=()=>e.map((e=>et(e)?e.value:qe(e)?Wn(e):Ct(e)?Jt(e,i,2):void 0))):l=Ct(e)?t?()=>Jt(e,i,2):()=>{if(!i||!i.isUnmounted)return c&&c(),en(e,i,3,[m])}:yt,t&&s){const e=l;l=()=>Wn(e())}let m=e=>{c=g.onStop=()=>{Jt(e,i,4)}};if(_a)return m=yt,t?n&&en(t,i,3,[l(),d?[]:void 0,m]):l(),yt;let p=d?[]:Xn;const h=()=>{if(g.active)if(t){const e=g.run();(s||u||(d?e.some(((e,t)=>Yt(e,p[t]))):Yt(e,p)))&&(c&&c(),en(t,i,3,[e,p===Xn?void 0:p,m]),p=e)}else g.run()};let f;h.allowRecurse=!!t,f="sync"===o?h:"post"===o?()=>Mo(h,i&&i.suspense):()=>kn(h);const g=new H(l,f);return t?n?h():p=g.run():"post"===o?Mo(g.run.bind(g),i&&i.suspense):g.run(),()=>{g.stop(),i&&i.scope&&At(i.scope.effects,g)}}function Kn(e,t,n){const s=this.proxy,o=jt(e)?e.includes(".")?Zn(s,e):()=>s[e]:e.bind(s,s);let a;Ct(t)?a=t:(a=t.handler,n=t);const r=da;pa(this);const i=Gn(o,a.bind(s),n);return r?pa(r):ha(),i}function Zn(e,t){const n=t.split(".");return()=>{let t=e;for(let e=0;e<n.length&&t;e++)t=t[n[e]];return t}}function Wn(e,t){if(!Ot(e)||e["__v_skip"])return e;if(t=t||new Set,t.has(e))return e;if(t.add(e),et(e))Wn(e.value,t);else if(Tt(e))for(let n=0;n<e.length;n++)Wn(e[n],t);else if(It(e)||Bt(e))e.forEach((e=>{Wn(e,t)}));else if(Dt(e))for(const n in e)Wn(e[n],t);return e}function Qn(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return vs((()=>{e.isMounted=!0})),xs((()=>{e.isUnmounting=!0})),e}const Jn=[Function,Array],es={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Jn,onEnter:Jn,onAfterEnter:Jn,onEnterCancelled:Jn,onBeforeLeave:Jn,onLeave:Jn,onAfterLeave:Jn,onLeaveCancelled:Jn,onBeforeAppear:Jn,onAppear:Jn,onAfterAppear:Jn,onAppearCancelled:Jn},setup(e,{slots:t}){const n=ma(),s=Qn();let o;return()=>{const a=t.default&&is(t.default(),!0);if(!a||!a.length)return;let r=a[0];if(a.length>1)for(const e of a)if(e.type!==Oo){r=e;break}const i=Ge(e),{mode:l}=i;if(s.isLeaving)return os(r);const c=as(r);if(!c)return os(r);const u=ss(c,i,s,n);rs(c,u);const d=n.subTree,m=d&&as(d);let p=!1;const{getTransitionKey:h}=c.type;if(h){const e=h();void 0===o?o=e:e!==o&&(o=e,p=!0)}if(m&&m.type!==Oo&&(!Xo(c,m)||p)){const e=ss(m,i,s,n);if(rs(m,e),"out-in"===l)return s.isLeaving=!0,e.afterLeave=()=>{s.isLeaving=!1,n.update()},os(r);"in-out"===l&&c.type!==Oo&&(e.delayLeave=(e,t,n)=>{const o=ns(s,m);o[String(m.key)]=m,e._leaveCb=()=>{t(),e._leaveCb=void 0,delete u.delayedLeave},u.delayedLeave=n})}return r}}},ts=es;function ns(e,t){const{leavingVNodes:n}=e;let s=n.get(t.type);return s||(s=Object.create(null),n.set(t.type,s)),s}function ss(e,t,n,s){const{appear:o,mode:a,persisted:r=!1,onBeforeEnter:i,onEnter:l,onAfterEnter:c,onEnterCancelled:u,onBeforeLeave:d,onLeave:m,onAfterLeave:p,onLeaveCancelled:h,onBeforeAppear:f,onAppear:g,onAfterAppear:_,onAppearCancelled:v}=t,b=String(e.key),y=ns(n,e),x=(e,t)=>{e&&en(e,s,9,t)},w=(e,t)=>{const n=t[1];x(e,t),Tt(e)?e.every((e=>e.length<=1))&&n():e.length<=1&&n()},k={mode:a,persisted:r,beforeEnter(t){let s=i;if(!n.isMounted){if(!o)return;s=f||i}t._leaveCb&&t._leaveCb(!0);const a=y[b];a&&Xo(e,a)&&a.el._leaveCb&&a.el._leaveCb(),x(s,[t])},enter(e){let t=l,s=c,a=u;if(!n.isMounted){if(!o)return;t=g||l,s=_||c,a=v||u}let r=!1;const i=e._enterCb=t=>{r||(r=!0,x(t?a:s,[e]),k.delayedLeave&&k.delayedLeave(),e._enterCb=void 0)};t?w(t,[e,i]):i()},leave(t,s){const o=String(e.key);if(t._enterCb&&t._enterCb(!0),n.isUnmounting)return s();x(d,[t]);let a=!1;const r=t._leaveCb=n=>{a||(a=!0,s(),x(n?h:p,[t]),t._leaveCb=void 0,y[o]===e&&delete y[o])};y[o]=e,m?w(m,[t,r]):r()},clone(e){return ss(e,t,n,s)}};return k}function os(e){if(us(e))return e=ea(e),e.children=null,e}function as(e){return us(e)?e.children?e.children[0]:void 0:e}function rs(e,t){6&e.shapeFlag&&e.component?rs(e.component.subTree,t):128&e.shapeFlag?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function is(e,t=!1,n){let s=[],o=0;for(let a=0;a<e.length;a++){let r=e[a];const i=null==n?r.key:String(n)+String(null!=r.key?r.key:a);r.type===Co?(128&r.patchFlag&&o++,s=s.concat(is(r.children,t,i))):(t||r.type!==Oo)&&s.push(null!=i?ea(r,{key:i}):r)}if(o>1)for(let a=0;a<s.length;a++)s[a].patchFlag=-2;return s}function ls(e){return Ct(e)?{setup:e,name:e.name}:e}const cs=e=>!!e.type.__asyncLoader,us=e=>e.type.__isKeepAlive;function ds(e,t){ps(e,"a",t)}function ms(e,t){ps(e,"da",t)}function ps(e,t,n=da){const s=e.__wdc||(e.__wdc=()=>{let t=n;while(t){if(t.isDeactivated)return;t=t.parent}return e()});if(fs(t,s,n),n){let e=n.parent;while(e&&e.parent)us(e.parent.vnode)&&hs(s,t,n,e),e=e.parent}}function hs(e,t,n,s){const o=fs(t,e,s,!0);ws((()=>{At(s[t],o)}),n)}function fs(e,t,n=da,s=!1){if(n){const o=n[e]||(n[e]=[]),a=t.__weh||(t.__weh=(...s)=>{if(n.isUnmounted)return;V(),pa(n);const o=en(t,n,e,s);return ha(),q(),o});return s?o.unshift(a):o.push(a),a}}const gs=e=>(t,n=da)=>(!_a||"sp"===e)&&fs(e,t,n),_s=gs("bm"),vs=gs("m"),bs=gs("bu"),ys=gs("u"),xs=gs("bum"),ws=gs("um"),ks=gs("sp"),Ss=gs("rtg"),Ms=gs("rtc");function As(e,t=da){fs("ec",e,t)}function Rs(e,t){const n=Cn;if(null===n)return e;const s=Sa(n)||n.proxy,o=e.dirs||(e.dirs=[]);for(let a=0;a<t.length;a++){let[e,n,r,i=vt]=t[a];Ct(e)&&(e={mounted:e,updated:e}),e.deep&&Wn(n),o.push({dir:e,instance:s,value:n,oldValue:void 0,arg:r,modifiers:i})}return e}function Es(e,t,n,s){const o=e.dirs,a=t&&t.dirs;for(let r=0;r<o.length;r++){const i=o[r];a&&(i.oldValue=a[r].value);let l=i.dir[s];l&&(V(),en(l,n,8,[e.el,i,e,t]),q())}}const Ts="components",Bs="directives";function Is(e,t){return Fs(Ts,e,!0,t)||e}const Cs=Symbol();function js(e){return jt(e)?Fs(Ts,e,!1)||e:e||Cs}function Os(e){return Fs(Bs,e)}function Fs(e,t,n=!0,s=!1){const o=Cn||da;if(o){const n=o.type;if(e===Ts){const e=Ma(n,!1);if(e&&(e===t||e===zt(t)||e===Ut(zt(t))))return n}const a=Ls(o[e]||n[e],t)||Ls(o.appContext[e],t);return!a&&s?n:a}}function Ls(e,t){return e&&(e[t]||e[zt(t)]||e[Ut(zt(t))])}function Ps(e,t,n,s){let o;const a=n&&n[s];if(Tt(e)||jt(e)){o=new Array(e.length);for(let n=0,s=e.length;n<s;n++)o[n]=t(e[n],n,void 0,a&&a[n])}else if("number"===typeof e){o=new Array(e);for(let n=0;n<e;n++)o[n]=t(n+1,n,void 0,a&&a[n])}else if(Ot(e))if(e[Symbol.iterator])o=Array.from(e,((e,n)=>t(e,n,void 0,a&&a[n])));else{const n=Object.keys(e);o=new Array(n.length);for(let s=0,r=n.length;s<r;s++){const r=n[s];o[s]=t(e[r],r,s,a&&a[s])}}else o=[];return n&&(n[s]=o),o}function Ds(e,t){for(let n=0;n<t.length;n++){const s=t[n];if(Tt(s))for(let t=0;t<s.length;t++)e[s[t].name]=s[t].fn;else s&&(e[s.name]=s.fn)}return e}function Hs(e,t,n={},s,o){if(Cn.isCE||Cn.parent&&cs(Cn.parent)&&Cn.parent.isCE)return Wo("slot","default"===t?null:{name:t},s&&s());let a=e[t];a&&a._c&&(a._d=!1),Do();const r=a&&Ns(a(n)),i=qo(Co,{key:n.key||`_${t}`},r||(s?s():[]),r&&1===e._?64:-2);return!o&&i.scopeId&&(i.slotScopeIds=[i.scopeId+"-s"]),a&&a._c&&(a._d=!0),i}function Ns(e){return e.some((e=>!Uo(e)||e.type!==Oo&&!(e.type===Co&&!Ns(e.children))))?e:null}const $s=e=>e?fa(e)?Sa(e)||e.proxy:$s(e.parent):null,zs=Mt(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>$s(e.parent),$root:e=>$s(e.root),$emit:e=>e.emit,$options:e=>Ks(e),$forceUpdate:e=>e.f||(e.f=()=>bn(e.update)),$nextTick:e=>e.n||(e.n=_n.bind(e.proxy)),$watch:e=>Kn.bind(e)}),Vs={get({_:e},t){const{ctx:n,setupState:s,data:o,props:a,accessCache:r,type:i,appContext:l}=e;let c;if("$"!==t[0]){const i=r[t];if(void 0!==i)switch(i){case 1:return s[t];case 2:return o[t];case 4:return n[t];case 3:return a[t]}else{if(s!==vt&&Et(s,t))return r[t]=1,s[t];if(o!==vt&&Et(o,t))return r[t]=2,o[t];if((c=e.propsOptions[0])&&Et(c,t))return r[t]=3,a[t];if(n!==vt&&Et(n,t))return r[t]=4,n[t];qs&&(r[t]=0)}}const u=zs[t];let d,m;return u?("$attrs"===t&&U(e,"get",t),u(e)):(d=i.__cssModules)&&(d=d[t])?d:n!==vt&&Et(n,t)?(r[t]=4,n[t]):(m=l.config.globalProperties,Et(m,t)?m[t]:void 0)},set({_:e},t,n){const{data:s,setupState:o,ctx:a}=e;return o!==vt&&Et(o,t)?(o[t]=n,!0):s!==vt&&Et(s,t)?(s[t]=n,!0):!Et(e.props,t)&&(("$"!==t[0]||!(t.slice(1)in e))&&(a[t]=n,!0))},has({_:{data:e,setupState:t,accessCache:n,ctx:s,appContext:o,propsOptions:a}},r){let i;return!!n[r]||e!==vt&&Et(e,r)||t!==vt&&Et(t,r)||(i=a[0])&&Et(i,r)||Et(s,r)||Et(zs,r)||Et(o.config.globalProperties,r)},defineProperty(e,t,n){return null!=n.get?e._.accessCache[t]=0:Et(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};let qs=!0;function Us(e){const t=Ks(e),n=e.proxy,s=e.ctx;qs=!1,t.beforeCreate&&Ys(t.beforeCreate,e,"bc");const{data:o,computed:a,methods:r,watch:i,provide:l,inject:c,created:u,beforeMount:d,mounted:m,beforeUpdate:p,updated:h,activated:f,deactivated:g,beforeDestroy:_,beforeUnmount:v,destroyed:b,unmounted:y,render:x,renderTracked:w,renderTriggered:k,errorCaptured:S,serverPrefetch:M,expose:A,inheritAttrs:R,components:E,directives:T,filters:B}=t,I=null;if(c&&Xs(c,s,I,e.appContext.config.unwrapInjectedRef),r)for(const j in r){const e=r[j];Ct(e)&&(s[j]=e.bind(n))}if(o){const t=o.call(n,n);Ot(t)&&(e.data=Ne(t))}if(qs=!0,a)for(const j in a){const e=a[j],t=Ct(e)?e.bind(n,n):Ct(e.get)?e.get.bind(n,n):yt,o=!Ct(e)&&Ct(e.set)?e.set.bind(n):yt,r=Ra({get:t,set:o});Object.defineProperty(s,j,{enumerable:!0,configurable:!0,get:()=>r.value,set:e=>r.value=e})}if(i)for(const j in i)Gs(i[j],s,n,j);if(l){const e=Ct(l)?l.call(n):l;Reflect.ownKeys(e).forEach((t=>{qn(t,e[t])}))}function C(e,t){Tt(t)?t.forEach((t=>e(t.bind(n)))):t&&e(t.bind(n))}if(u&&Ys(u,e,"c"),C(_s,d),C(vs,m),C(bs,p),C(ys,h),C(ds,f),C(ms,g),C(As,S),C(Ms,w),C(Ss,k),C(xs,v),C(ws,y),C(ks,M),Tt(A))if(A.length){const t=e.exposed||(e.exposed={});A.forEach((e=>{Object.defineProperty(t,e,{get:()=>n[e],set:t=>n[e]=t})}))}else e.exposed||(e.exposed={});x&&e.render===yt&&(e.render=x),null!=R&&(e.inheritAttrs=R),E&&(e.components=E),T&&(e.directives=T)}function Xs(e,t,n=yt,s=!1){Tt(e)&&(e=eo(e));for(const o in e){const n=e[o];let a;a=Ot(n)?"default"in n?Un(n.from||o,n.default,!0):Un(n.from||o):Un(n),et(a)&&s?Object.defineProperty(t,o,{enumerable:!0,configurable:!0,get:()=>a.value,set:e=>a.value=e}):t[o]=a}}function Ys(e,t,n){en(Tt(e)?e.map((e=>e.bind(t.proxy))):e.bind(t.proxy),t,n)}function Gs(e,t,n,s){const o=s.includes(".")?Zn(n,s):()=>n[s];if(jt(e)){const n=t[e];Ct(n)&&Yn(o,n)}else if(Ct(e))Yn(o,e.bind(n));else if(Ot(e))if(Tt(e))e.forEach((e=>Gs(e,t,n,s)));else{const s=Ct(e.handler)?e.handler.bind(n):t[e.handler];Ct(s)&&Yn(o,s,e)}}function Ks(e){const t=e.type,{mixins:n,extends:s}=t,{mixins:o,optionsCache:a,config:{optionMergeStrategies:r}}=e.appContext,i=a.get(t);let l;return i?l=i:o.length||n||s?(l={},o.length&&o.forEach((e=>Zs(l,e,r,!0))),Zs(l,t,r)):l=t,a.set(t,l),l}function Zs(e,t,n,s=!1){const{mixins:o,extends:a}=t;a&&Zs(e,a,n,!0),o&&o.forEach((t=>Zs(e,t,n,!0)));for(const r in t)if(s&&"expose"===r);else{const s=Ws[r]||n&&n[r];e[r]=s?s(e[r],t[r]):t[r]}return e}const Ws={data:Qs,props:no,emits:no,methods:no,computed:no,beforeCreate:to,created:to,beforeMount:to,mounted:to,beforeUpdate:to,updated:to,beforeDestroy:to,beforeUnmount:to,destroyed:to,unmounted:to,activated:to,deactivated:to,errorCaptured:to,serverPrefetch:to,components:no,directives:no,watch:so,provide:Qs,inject:Js};function Qs(e,t){return t?e?function(){return Mt(Ct(e)?e.call(this,this):e,Ct(t)?t.call(this,this):t)}:t:e}function Js(e,t){return no(eo(e),eo(t))}function eo(e){if(Tt(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function to(e,t){return e?[...new Set([].concat(e,t))]:t}function no(e,t){return e?Mt(Mt(Object.create(null),e),t):t}function so(e,t){if(!e)return t;if(!t)return e;const n=Mt(Object.create(null),e);for(const s in t)n[s]=to(e[s],t[s]);return n}function oo(e,t,n,s=!1){const o={},a={};Kt(a,Yo,1),e.propsDefaults=Object.create(null),ro(e,t,o,a);for(const r in e.propsOptions[0])r in o||(o[r]=void 0);n?e.props=s?o:$e(o):e.type.props?e.props=o:e.props=a,e.attrs=a}function ao(e,t,n,s){const{props:o,attrs:a,vnode:{patchFlag:r}}=e,i=Ge(o),[l]=e.propsOptions;let c=!1;if(!(s||r>0)||16&r){let s;ro(e,t,o,a)&&(c=!0);for(const a in i)t&&(Et(t,a)||(s=qt(a))!==a&&Et(t,s))||(l?!n||void 0===n[a]&&void 0===n[s]||(o[a]=io(l,i,a,void 0,e,!0)):delete o[a]);if(a!==i)for(const e in a)t&&Et(t,e)||(delete a[e],c=!0)}else if(8&r){const n=e.vnode.dynamicProps;for(let s=0;s<n.length;s++){let r=n[s];if(In(e.emitsOptions,r))continue;const u=t[r];if(l)if(Et(a,r))u!==a[r]&&(a[r]=u,c=!0);else{const t=zt(r);o[t]=io(l,i,t,u,e,!1)}else u!==a[r]&&(a[r]=u,c=!0)}}c&&Y(e,"set","$attrs")}function ro(e,t,n,s){const[o,a]=e.propsOptions;let r,i=!1;if(t)for(let l in t){if(Ht(l))continue;const c=t[l];let u;o&&Et(o,u=zt(l))?a&&a.includes(u)?(r||(r={}))[u]=c:n[u]=c:In(e.emitsOptions,l)||l in s&&c===s[l]||(s[l]=c,i=!0)}if(a){const t=Ge(n),s=r||vt;for(let r=0;r<a.length;r++){const i=a[r];n[i]=io(o,t,i,s[i],e,!Et(s,i))}}return i}function io(e,t,n,s,o,a){const r=e[n];if(null!=r){const e=Et(r,"default");if(e&&void 0===s){const e=r.default;if(r.type!==Function&&Ct(e)){const{propsDefaults:a}=o;n in a?s=a[n]:(pa(o),s=a[n]=e.call(null,t),ha())}else s=e}r[0]&&(a&&!e?s=!1:!r[1]||""!==s&&s!==qt(n)||(s=!0))}return s}function lo(e,t,n=!1){const s=t.propsCache,o=s.get(e);if(o)return o;const a=e.props,r={},i=[];let l=!1;if(!Ct(e)){const s=e=>{l=!0;const[n,s]=lo(e,t,!0);Mt(r,n),s&&i.push(...s)};!n&&t.mixins.length&&t.mixins.forEach(s),e.extends&&s(e.extends),e.mixins&&e.mixins.forEach(s)}if(!a&&!l)return s.set(e,bt),bt;if(Tt(a))for(let u=0;u<a.length;u++){const e=zt(a[u]);co(e)&&(r[e]=vt)}else if(a)for(const u in a){const e=zt(u);if(co(e)){const t=a[u],n=r[e]=Tt(t)||Ct(t)?{type:t}:t;if(n){const t=po(Boolean,n.type),s=po(String,n.type);n[0]=t>-1,n[1]=s<0||t<s,(t>-1||Et(n,"default"))&&i.push(e)}}}const c=[r,i];return s.set(e,c),c}function co(e){return"$"!==e[0]}function uo(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:null===e?"null":""}function mo(e,t){return uo(e)===uo(t)}function po(e,t){return Tt(t)?t.findIndex((t=>mo(t,e))):Ct(t)&&mo(t,e)?0:-1}const ho=e=>"_"===e[0]||"$stable"===e,fo=e=>Tt(e)?e.map(sa):[sa(e)],go=(e,t,n)=>{if(t._n)return t;const s=Fn(((...e)=>fo(t(...e))),n);return s._c=!1,s},_o=(e,t,n)=>{const s=e._ctx;for(const o in e){if(ho(o))continue;const n=e[o];if(Ct(n))t[o]=go(o,n,s);else if(null!=n){const e=fo(n);t[o]=()=>e}}},vo=(e,t)=>{const n=fo(t);e.slots.default=()=>n},bo=(e,t)=>{if(32&e.vnode.shapeFlag){const n=t._;n?(e.slots=Ge(t),Kt(t,"_",n)):_o(t,e.slots={})}else e.slots={},t&&vo(e,t);Kt(e.slots,Yo,1)},yo=(e,t,n)=>{const{vnode:s,slots:o}=e;let a=!0,r=vt;if(32&s.shapeFlag){const e=t._;e?n&&1===e?a=!1:(Mt(o,t),n||1!==e||delete o._):(a=!t.$stable,_o(t,o)),r=t}else t&&(vo(e,t),r={default:1});if(a)for(const i in o)ho(i)||i in r||delete o[i]};function xo(){return{app:null,config:{isNativeTag:xt,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let wo=0;function ko(e,t){return function(n,s=null){Ct(n)||(n=Object.assign({},n)),null==s||Ot(s)||(s=null);const o=xo(),a=new Set;let r=!1;const i=o.app={_uid:wo++,_component:n,_props:s,_container:null,_context:o,_instance:null,version:Ta,get config(){return o.config},set config(e){},use(e,...t){return a.has(e)||(e&&Ct(e.install)?(a.add(e),e.install(i,...t)):Ct(e)&&(a.add(e),e(i,...t))),i},mixin(e){return o.mixins.includes(e)||o.mixins.push(e),i},component(e,t){return t?(o.components[e]=t,i):o.components[e]},directive(e,t){return t?(o.directives[e]=t,i):o.directives[e]},mount(a,l,c){if(!r){const u=Wo(n,s);return u.appContext=o,l&&t?t(u,a):e(u,a,c),r=!0,i._container=a,a.__vue_app__=i,Sa(u.component)||u.component.proxy}},unmount(){r&&(e(null,i._container),delete i._container.__vue_app__)},provide(e,t){return o.provides[e]=t,i}};return i}}function So(e,t,n,s,o=!1){if(Tt(e))return void e.forEach(((e,a)=>So(e,t&&(Tt(t)?t[a]:t),n,s,o)));if(cs(s)&&!o)return;const a=4&s.shapeFlag?Sa(s.component)||s.component.proxy:s.el,r=o?null:a,{i:i,r:l}=e,c=t&&t.r,u=i.refs===vt?i.refs={}:i.refs,d=i.setupState;if(null!=c&&c!==l&&(jt(c)?(u[c]=null,Et(d,c)&&(d[c]=null)):et(c)&&(c.value=null)),Ct(l))Jt(l,i,12,[r,u]);else{const t=jt(l),s=et(l);if(t||s){const i=()=>{if(e.f){const n=t?u[l]:l.value;o?Tt(n)&&At(n,a):Tt(n)?n.includes(a)||n.push(a):t?(u[l]=[a],Et(d,l)&&(d[l]=u[l])):(l.value=[a],e.k&&(u[e.k]=l.value))}else t?(u[l]=r,Et(d,l)&&(d[l]=r)):s&&(l.value=r,e.k&&(u[e.k]=r))};r?(i.id=-1,Mo(i,n)):i()}}}const Mo=Vn;function Ao(e){return Ro(e)}function Ro(e,t){const n=Qt();n.__VUE__=!0;const{insert:s,remove:o,patchProp:a,createElement:r,createText:i,createComment:l,setText:c,setElementText:u,parentNode:d,nextSibling:m,setScopeId:p=yt,cloneNode:h,insertStaticContent:f}=e,g=(e,t,n,s=null,o=null,a=null,r=!1,i=null,l=!!t.dynamicChildren)=>{if(e===t)return;e&&!Xo(e,t)&&(s=Y(e),N(e,o,a,!0),e=null),-2===t.patchFlag&&(l=!1,t.dynamicChildren=null);const{type:c,ref:u,shapeFlag:d}=t;switch(c){case jo:_(e,t,n,s);break;case Oo:v(e,t,n,s);break;case Fo:null==e&&b(t,n,s,r);break;case Co:T(e,t,n,s,o,a,r,i,l);break;default:1&d?w(e,t,n,s,o,a,r,i,l):6&d?B(e,t,n,s,o,a,r,i,l):(64&d||128&d)&&c.process(e,t,n,s,o,a,r,i,l,K)}null!=u&&o&&So(u,e&&e.ref,a,t||e,!t)},_=(e,t,n,o)=>{if(null==e)s(t.el=i(t.children),n,o);else{const n=t.el=e.el;t.children!==e.children&&c(n,t.children)}},v=(e,t,n,o)=>{null==e?s(t.el=l(t.children||""),n,o):t.el=e.el},b=(e,t,n,s)=>{[e.el,e.anchor]=f(e.children,t,n,s,e.el,e.anchor)},y=({el:e,anchor:t},n,o)=>{let a;while(e&&e!==t)a=m(e),s(e,n,o),e=a;s(t,n,o)},x=({el:e,anchor:t})=>{let n;while(e&&e!==t)n=m(e),o(e),e=n;o(t)},w=(e,t,n,s,o,a,r,i,l)=>{r=r||"svg"===t.type,null==e?k(t,n,s,o,a,r,i,l):A(e,t,o,a,r,i,l)},k=(e,t,n,o,i,l,c,d)=>{let m,p;const{type:f,props:g,shapeFlag:_,transition:v,patchFlag:b,dirs:y}=e;if(e.el&&void 0!==h&&-1===b)m=e.el=h(e.el);else{if(m=e.el=r(e.type,l,g&&g.is,g),8&_?u(m,e.children):16&_&&M(e.children,m,null,o,i,l&&"foreignObject"!==f,c,d),y&&Es(e,null,o,"created"),g){for(const t in g)"value"===t||Ht(t)||a(m,t,null,g[t],l,e.children,o,i,X);"value"in g&&a(m,"value",null,g.value),(p=g.onVnodeBeforeMount)&&ia(p,o,e)}S(m,e,e.scopeId,c,o)}y&&Es(e,null,o,"beforeMount");const x=(!i||i&&!i.pendingBranch)&&v&&!v.persisted;x&&v.beforeEnter(m),s(m,t,n),((p=g&&g.onVnodeMounted)||x||y)&&Mo((()=>{p&&ia(p,o,e),x&&v.enter(m),y&&Es(e,null,o,"mounted")}),i)},S=(e,t,n,s,o)=>{if(n&&p(e,n),s)for(let a=0;a<s.length;a++)p(e,s[a]);if(o){let n=o.subTree;if(t===n){const t=o.vnode;S(e,t,t.scopeId,t.slotScopeIds,o.parent)}}},M=(e,t,n,s,o,a,r,i,l=0)=>{for(let c=l;c<e.length;c++){const l=e[c]=i?oa(e[c]):sa(e[c]);g(null,l,t,n,s,o,a,r,i)}},A=(e,t,n,s,o,r,i)=>{const l=t.el=e.el;let{patchFlag:c,dynamicChildren:d,dirs:m}=t;c|=16&e.patchFlag;const p=e.props||vt,h=t.props||vt;let f;n&&Eo(n,!1),(f=h.onVnodeBeforeUpdate)&&ia(f,n,t,e),m&&Es(t,e,n,"beforeUpdate"),n&&Eo(n,!0);const g=o&&"foreignObject"!==t.type;if(d?R(e.dynamicChildren,d,l,n,s,g,r):i||F(e,t,l,null,n,s,g,r,!1),c>0){if(16&c)E(l,t,p,h,n,s,o);else if(2&c&&p.class!==h.class&&a(l,"class",null,h.class,o),4&c&&a(l,"style",p.style,h.style,o),8&c){const r=t.dynamicProps;for(let t=0;t<r.length;t++){const i=r[t],c=p[i],u=h[i];u===c&&"value"!==i||a(l,i,c,u,o,e.children,n,s,X)}}1&c&&e.children!==t.children&&u(l,t.children)}else i||null!=d||E(l,t,p,h,n,s,o);((f=h.onVnodeUpdated)||m)&&Mo((()=>{f&&ia(f,n,t,e),m&&Es(t,e,n,"updated")}),s)},R=(e,t,n,s,o,a,r)=>{for(let i=0;i<t.length;i++){const l=e[i],c=t[i],u=l.el&&(l.type===Co||!Xo(l,c)||70&l.shapeFlag)?d(l.el):n;g(l,c,u,null,s,o,a,r,!0)}},E=(e,t,n,s,o,r,i)=>{if(n!==s){for(const l in s){if(Ht(l))continue;const c=s[l],u=n[l];c!==u&&"value"!==l&&a(e,l,u,c,i,t.children,o,r,X)}if(n!==vt)for(const l in n)Ht(l)||l in s||a(e,l,n[l],null,i,t.children,o,r,X);"value"in s&&a(e,"value",n.value,s.value)}},T=(e,t,n,o,a,r,l,c,u)=>{const d=t.el=e?e.el:i(""),m=t.anchor=e?e.anchor:i("");let{patchFlag:p,dynamicChildren:h,slotScopeIds:f}=t;f&&(c=c?c.concat(f):f),null==e?(s(d,n,o),s(m,n,o),M(t.children,n,m,a,r,l,c,u)):p>0&&64&p&&h&&e.dynamicChildren?(R(e.dynamicChildren,h,n,a,r,l,c),(null!=t.key||a&&t===a.subTree)&&To(e,t,!0)):F(e,t,n,m,a,r,l,c,u)},B=(e,t,n,s,o,a,r,i,l)=>{t.slotScopeIds=i,null==e?512&t.shapeFlag?o.ctx.activate(t,n,s,r,l):I(t,n,s,o,a,r,l):C(e,t,l)},I=(e,t,n,s,o,a,r)=>{const i=e.component=ua(e,s,o);if(us(e)&&(i.ctx.renderer=K),va(i),i.asyncDep){if(o&&o.registerDep(i,j),!e.el){const e=i.subTree=Wo(Oo);v(null,e,t,n)}}else j(i,e,t,n,o,a,r)},C=(e,t,n)=>{const s=t.component=e.component;if(Hn(e,t,n)){if(s.asyncDep&&!s.asyncResolved)return void O(s,t,n);s.next=t,xn(s.update),s.update()}else t.el=e.el,s.vnode=t},j=(e,t,n,s,o,a,r)=>{const i=()=>{if(e.isMounted){let t,{next:n,bu:s,u:i,parent:l,vnode:c}=e,u=n;Eo(e,!1),n?(n.el=c.el,O(e,n,r)):n=c,s&&Gt(s),(t=n.props&&n.props.onVnodeBeforeUpdate)&&ia(t,l,n,c),Eo(e,!0);const m=Ln(e),p=e.subTree;e.subTree=m,g(p,m,d(p.el),Y(p),e,o,a),n.el=m.el,null===u&&$n(e,m.el),i&&Mo(i,o),(t=n.props&&n.props.onVnodeUpdated)&&Mo((()=>ia(t,l,n,c)),o)}else{let r;const{el:i,props:l}=t,{bm:c,m:u,parent:d}=e,m=cs(t);if(Eo(e,!1),c&&Gt(c),!m&&(r=l&&l.onVnodeBeforeMount)&&ia(r,d,t),Eo(e,!0),i&&W){const n=()=>{e.subTree=Ln(e),W(i,e.subTree,e,o,null)};m?t.type.__asyncLoader().then((()=>!e.isUnmounted&&n())):n()}else{const r=e.subTree=Ln(e);g(null,r,n,s,e,o,a),t.el=r.el}if(u&&Mo(u,o),!m&&(r=l&&l.onVnodeMounted)){const e=t;Mo((()=>ia(r,d,e)),o)}(256&t.shapeFlag||d&&cs(d.vnode)&&256&d.vnode.shapeFlag)&&e.a&&Mo(e.a,o),e.isMounted=!0,t=n=s=null}},l=e.effect=new H(i,(()=>bn(c)),e.scope),c=e.update=()=>l.run();c.id=e.uid,Eo(e,!0),c()},O=(e,t,n)=>{t.component=e;const s=e.vnode.props;e.vnode=t,e.next=null,ao(e,t.props,s,n),yo(e,t.children,n),V(),Mn(void 0,e.update),q()},F=(e,t,n,s,o,a,r,i,l=!1)=>{const c=e&&e.children,d=e?e.shapeFlag:0,m=t.children,{patchFlag:p,shapeFlag:h}=t;if(p>0){if(128&p)return void P(c,m,n,s,o,a,r,i,l);if(256&p)return void L(c,m,n,s,o,a,r,i,l)}8&h?(16&d&&X(c,o,a),m!==c&&u(n,m)):16&d?16&h?P(c,m,n,s,o,a,r,i,l):X(c,o,a,!0):(8&d&&u(n,""),16&h&&M(m,n,s,o,a,r,i,l))},L=(e,t,n,s,o,a,r,i,l)=>{e=e||bt,t=t||bt;const c=e.length,u=t.length,d=Math.min(c,u);let m;for(m=0;m<d;m++){const s=t[m]=l?oa(t[m]):sa(t[m]);g(e[m],s,n,null,o,a,r,i,l)}c>u?X(e,o,a,!0,!1,d):M(t,n,s,o,a,r,i,l,d)},P=(e,t,n,s,o,a,r,i,l)=>{let c=0;const u=t.length;let d=e.length-1,m=u-1;while(c<=d&&c<=m){const s=e[c],u=t[c]=l?oa(t[c]):sa(t[c]);if(!Xo(s,u))break;g(s,u,n,null,o,a,r,i,l),c++}while(c<=d&&c<=m){const s=e[d],c=t[m]=l?oa(t[m]):sa(t[m]);if(!Xo(s,c))break;g(s,c,n,null,o,a,r,i,l),d--,m--}if(c>d){if(c<=m){const e=m+1,d=e<u?t[e].el:s;while(c<=m)g(null,t[c]=l?oa(t[c]):sa(t[c]),n,d,o,a,r,i,l),c++}}else if(c>m)while(c<=d)N(e[c],o,a,!0),c++;else{const p=c,h=c,f=new Map;for(c=h;c<=m;c++){const e=t[c]=l?oa(t[c]):sa(t[c]);null!=e.key&&f.set(e.key,c)}let _,v=0;const b=m-h+1;let y=!1,x=0;const w=new Array(b);for(c=0;c<b;c++)w[c]=0;for(c=p;c<=d;c++){const s=e[c];if(v>=b){N(s,o,a,!0);continue}let u;if(null!=s.key)u=f.get(s.key);else for(_=h;_<=m;_++)if(0===w[_-h]&&Xo(s,t[_])){u=_;break}void 0===u?N(s,o,a,!0):(w[u-h]=c+1,u>=x?x=u:y=!0,g(s,t[u],n,null,o,a,r,i,l),v++)}const k=y?Bo(w):bt;for(_=k.length-1,c=b-1;c>=0;c--){const e=h+c,d=t[e],m=e+1<u?t[e+1].el:s;0===w[c]?g(null,d,n,m,o,a,r,i,l):y&&(_<0||c!==k[_]?D(d,n,m,2):_--)}}},D=(e,t,n,o,a=null)=>{const{el:r,type:i,transition:l,children:c,shapeFlag:u}=e;if(6&u)return void D(e.component.subTree,t,n,o);if(128&u)return void e.suspense.move(t,n,o);if(64&u)return void i.move(e,t,n,K);if(i===Co){s(r,t,n);for(let e=0;e<c.length;e++)D(c[e],t,n,o);return void s(e.anchor,t,n)}if(i===Fo)return void y(e,t,n);const d=2!==o&&1&u&&l;if(d)if(0===o)l.beforeEnter(r),s(r,t,n),Mo((()=>l.enter(r)),a);else{const{leave:e,delayLeave:o,afterLeave:a}=l,i=()=>s(r,t,n),c=()=>{e(r,(()=>{i(),a&&a()}))};o?o(r,i,c):c()}else s(r,t,n)},N=(e,t,n,s=!1,o=!1)=>{const{type:a,props:r,ref:i,children:l,dynamicChildren:c,shapeFlag:u,patchFlag:d,dirs:m}=e;if(null!=i&&So(i,null,n,e,!0),256&u)return void t.ctx.deactivate(e);const p=1&u&&m,h=!cs(e);let f;if(h&&(f=r&&r.onVnodeBeforeUnmount)&&ia(f,t,e),6&u)U(e.component,n,s);else{if(128&u)return void e.suspense.unmount(n,s);p&&Es(e,null,t,"beforeUnmount"),64&u?e.type.remove(e,t,n,o,K,s):c&&(a!==Co||d>0&&64&d)?X(c,t,n,!1,!0):(a===Co&&384&d||!o&&16&u)&&X(l,t,n),s&&$(e)}(h&&(f=r&&r.onVnodeUnmounted)||p)&&Mo((()=>{f&&ia(f,t,e),p&&Es(e,null,t,"unmounted")}),n)},$=e=>{const{type:t,el:n,anchor:s,transition:a}=e;if(t===Co)return void z(n,s);if(t===Fo)return void x(e);const r=()=>{o(n),a&&!a.persisted&&a.afterLeave&&a.afterLeave()};if(1&e.shapeFlag&&a&&!a.persisted){const{leave:t,delayLeave:s}=a,o=()=>t(n,r);s?s(e.el,r,o):o()}else r()},z=(e,t)=>{let n;while(e!==t)n=m(e),o(e),e=n;o(t)},U=(e,t,n)=>{const{bum:s,scope:o,update:a,subTree:r,um:i}=e;s&&Gt(s),o.stop(),a&&(a.active=!1,N(r,e,t,n)),i&&Mo(i,t),Mo((()=>{e.isUnmounted=!0}),t),t&&t.pendingBranch&&!t.isUnmounted&&e.asyncDep&&!e.asyncResolved&&e.suspenseId===t.pendingId&&(t.deps--,0===t.deps&&t.resolve())},X=(e,t,n,s=!1,o=!1,a=0)=>{for(let r=a;r<e.length;r++)N(e[r],t,n,s,o)},Y=e=>6&e.shapeFlag?Y(e.component.subTree):128&e.shapeFlag?e.suspense.next():m(e.anchor||e.el),G=(e,t,n)=>{null==e?t._vnode&&N(t._vnode,null,null,!0):g(t._vnode||null,e,t,null,null,null,n),An(),t._vnode=e},K={p:g,um:N,m:D,r:$,mt:I,mc:M,pc:F,pbc:R,n:Y,o:e};let Z,W;return t&&([Z,W]=t(K)),{render:G,hydrate:Z,createApp:ko(G,Z)}}function Eo({effect:e,update:t},n){e.allowRecurse=t.allowRecurse=n}function To(e,t,n=!1){const s=e.children,o=t.children;if(Tt(s)&&Tt(o))for(let a=0;a<s.length;a++){const e=s[a];let t=o[a];1&t.shapeFlag&&!t.dynamicChildren&&((t.patchFlag<=0||32===t.patchFlag)&&(t=o[a]=oa(o[a]),t.el=e.el),n||To(e,t))}}function Bo(e){const t=e.slice(),n=[0];let s,o,a,r,i;const l=e.length;for(s=0;s<l;s++){const l=e[s];if(0!==l){if(o=n[n.length-1],e[o]<l){t[s]=o,n.push(s);continue}a=0,r=n.length-1;while(a<r)i=a+r>>1,e[n[i]]<l?a=i+1:r=i;l<e[n[a]]&&(a>0&&(t[s]=n[a-1]),n[a]=s)}}a=n.length,r=n[a-1];while(a-- >0)n[a]=r,r=t[r];return n}const Io=e=>e.__isTeleport,Co=Symbol(void 0),jo=Symbol(void 0),Oo=Symbol(void 0),Fo=Symbol(void 0),Lo=[];let Po=null;function Do(e=!1){Lo.push(Po=e?null:[])}function Ho(){Lo.pop(),Po=Lo[Lo.length-1]||null}let No=1;function $o(e){No+=e}function zo(e){return e.dynamicChildren=No>0?Po||bt:null,Ho(),No>0&&Po&&Po.push(e),e}function Vo(e,t,n,s,o,a){return zo(Zo(e,t,n,s,o,a,!0))}function qo(e,t,n,s,o){return zo(Wo(e,t,n,s,o,!0))}function Uo(e){return!!e&&!0===e.__v_isVNode}function Xo(e,t){return e.type===t.type&&e.key===t.key}const Yo="__vInternal",Go=({key:e})=>null!=e?e:null,Ko=({ref:e,ref_key:t,ref_for:n})=>null!=e?jt(e)||et(e)||Ct(e)?{i:Cn,r:e,k:t,f:!!n}:e:null;function Zo(e,t=null,n=null,s=0,o=null,a=(e===Co?0:1),r=!1,i=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Go(t),ref:t&&Ko(t),scopeId:jn,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:s,dynamicProps:o,dynamicChildren:null,appContext:null};return i?(aa(l,n),128&a&&e.normalize(l)):n&&(l.shapeFlag|=jt(n)?8:16),No>0&&!r&&Po&&(l.patchFlag>0||6&a)&&32!==l.patchFlag&&Po.push(l),l}const Wo=Qo;function Qo(e,t=null,n=null,s=0,o=null,a=!1){if(e&&e!==Cs||(e=Oo),Uo(e)){const s=ea(e,t,!0);return n&&aa(s,n),No>0&&!a&&Po&&(6&s.shapeFlag?Po[Po.indexOf(e)]=s:Po.push(s)),s.patchFlag|=-2,s}if(Aa(e)&&(e=e.__vccOpts),t){t=Jo(t);let{class:e,style:n}=t;e&&!jt(e)&&(t.class=ht(e)),Ot(n)&&(Ye(n)&&!Tt(n)&&(n=Mt({},n)),t.style=ut(n))}const r=jt(e)?1:zn(e)?128:Io(e)?64:Ot(e)?4:Ct(e)?2:0;return Zo(e,t,n,s,o,r,a,!0)}function Jo(e){return e?Ye(e)||Yo in e?Mt({},e):e:null}function ea(e,t,n=!1){const{props:s,ref:o,patchFlag:a,children:r}=e,i=t?ra(s||{},t):s,l={__v_isVNode:!0,__v_skip:!0,type:e.type,props:i,key:i&&Go(i),ref:t&&t.ref?n&&o?Tt(o)?o.concat(Ko(t)):[o,Ko(t)]:Ko(t):o,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:r,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Co?-1===a?16:16|a:a,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&ea(e.ssContent),ssFallback:e.ssFallback&&ea(e.ssFallback),el:e.el,anchor:e.anchor};return l}function ta(e=" ",t=0){return Wo(jo,null,e,t)}function na(e="",t=!1){return t?(Do(),qo(Oo,null,e)):Wo(Oo,null,e)}function sa(e){return null==e||"boolean"===typeof e?Wo(Oo):Tt(e)?Wo(Co,null,e.slice()):"object"===typeof e?oa(e):Wo(jo,null,String(e))}function oa(e){return null===e.el||e.memo?e:ea(e)}function aa(e,t){let n=0;const{shapeFlag:s}=e;if(null==t)t=null;else if(Tt(t))n=16;else if("object"===typeof t){if(65&s){const n=t.default;return void(n&&(n._c&&(n._d=!1),aa(e,n()),n._c&&(n._d=!0)))}{n=32;const s=t._;s||Yo in t?3===s&&Cn&&(1===Cn.slots._?t._=1:(t._=2,e.patchFlag|=1024)):t._ctx=Cn}}else Ct(t)?(t={default:t,_ctx:Cn},n=32):(t=String(t),64&s?(n=16,t=[ta(t)]):n=8);e.children=t,e.shapeFlag|=n}function ra(...e){const t={};for(let n=0;n<e.length;n++){const s=e[n];for(const e in s)if("class"===e)t.class!==s.class&&(t.class=ht([t.class,s.class]));else if("style"===e)t.style=ut([t.style,s.style]);else if(kt(e)){const n=t[e],o=s[e];!o||n===o||Tt(n)&&n.includes(o)||(t[e]=n?[].concat(n,o):o)}else""!==e&&(t[e]=s[e])}return t}function ia(e,t,n,s=null){en(e,t,7,[n,s])}const la=xo();let ca=0;function ua(e,t,n){const s=e.type,o=(t?t.appContext:e.appContext)||la,a={uid:ca++,vnode:e,type:s,parent:t,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,scope:new M(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(o.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:lo(s,o),emitsOptions:Bn(s,o),emit:null,emitted:null,propsDefaults:vt,inheritAttrs:s.inheritAttrs,ctx:vt,data:vt,props:vt,attrs:vt,slots:vt,refs:vt,setupState:vt,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=t?t.root:a,a.emit=Tn.bind(null,a),e.ce&&e.ce(a),a}let da=null;const ma=()=>da||Cn,pa=e=>{da=e,e.scope.on()},ha=()=>{da&&da.scope.off(),da=null};function fa(e){return 4&e.vnode.shapeFlag}let ga,_a=!1;function va(e,t=!1){_a=t;const{props:n,children:s}=e.vnode,o=fa(e);oo(e,n,o,t),bo(e,s);const a=o?ba(e,t):void 0;return _a=!1,a}function ba(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=Ke(new Proxy(e.ctx,Vs));const{setup:s}=n;if(s){const n=e.setupContext=s.length>1?ka(e):null;pa(e),V();const o=Jt(s,e,0,[e.props,n]);if(q(),ha(),Ft(o)){if(o.then(ha,ha),t)return o.then((n=>{ya(e,n,t)})).catch((t=>{tn(t,e,0)}));e.asyncDep=o}else ya(e,o,t)}else xa(e,t)}function ya(e,t,n){Ct(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Ot(t)&&(e.setupState=rt(t)),xa(e,n)}function xa(e,t,n){const s=e.type;if(!e.render){if(!t&&ga&&!s.render){const t=s.template;if(t){const{isCustomElement:n,compilerOptions:o}=e.appContext.config,{delimiters:a,compilerOptions:r}=s,i=Mt(Mt({isCustomElement:n,delimiters:a},o),r);s.render=ga(t,i)}}e.render=s.render||yt}pa(e),V(),Us(e),q(),ha()}function wa(e){return new Proxy(e.attrs,{get(t,n){return U(e,"get","$attrs"),t[n]}})}function ka(e){const t=t=>{e.exposed=t||{}};let n;return{get attrs(){return n||(n=wa(e))},slots:e.slots,emit:e.emit,expose:t}}function Sa(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(rt(Ke(e.exposed)),{get(t,n){return n in t?t[n]:n in zs?zs[n](e):void 0}}))}function Ma(e,t=!0){return Ct(e)?e.displayName||e.name:e.name||t&&e.__name}function Aa(e){return Ct(e)&&"__vccOpts"in e}const Ra=(e,t)=>lt(e,t,_a);function Ea(e,t,n){const s=arguments.length;return 2===s?Ot(t)&&!Tt(t)?Uo(t)?Wo(e,null,[t]):Wo(e,t):Wo(e,null,t):(s>3?n=Array.prototype.slice.call(arguments,2):3===s&&Uo(n)&&(n=[n]),Wo(e,t,n))}const Ta="3.2.37";function Ba(e,t){const n=Object.create(null),s=e.split(",");for(let o=0;o<s.length;o++)n[s[o]]=!0;return t?e=>!!n[e.toLowerCase()]:e=>!!n[e]}const Ia="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Ca=Ba(Ia);function ja(e){return!!e||""===e}const Oa=/^on[^a-z]/,Fa=e=>Oa.test(e),La=e=>e.startsWith("onUpdate:"),Pa=Object.assign,Da=Array.isArray,Ha=e=>"function"===typeof e,Na=e=>"string"===typeof e,$a=e=>null!==e&&"object"===typeof e,za=e=>{const t=Object.create(null);return n=>{const s=t[n];return s||(t[n]=e(n))}},Va=/-(\w)/g,qa=za((e=>e.replace(Va,((e,t)=>t?t.toUpperCase():"")))),Ua=/\B([A-Z])/g,Xa=za((e=>e.replace(Ua,"-$1").toLowerCase())),Ya=za((e=>e.charAt(0).toUpperCase()+e.slice(1))),Ga=e=>{const t=parseFloat(e);return isNaN(t)?e:t},Ka="http://www.w3.org/2000/svg",Za="undefined"!==typeof document?document:null,Wa=Za&&Za.createElement("template"),Qa={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,s)=>{const o=t?Za.createElementNS(Ka,e):Za.createElement(e,n?{is:n}:void 0);return"select"===e&&s&&null!=s.multiple&&o.setAttribute("multiple",s.multiple),o},createText:e=>Za.createTextNode(e),createComment:e=>Za.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Za.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},cloneNode(e){const t=e.cloneNode(!0);return"_value"in e&&(t._value=e._value),t},insertStaticContent(e,t,n,s,o,a){const r=n?n.previousSibling:t.lastChild;if(o&&(o===a||o.nextSibling)){while(1)if(t.insertBefore(o.cloneNode(!0),n),o===a||!(o=o.nextSibling))break}else{Wa.innerHTML=s?`<svg>${e}</svg>`:e;const o=Wa.content;if(s){const e=o.firstChild;while(e.firstChild)o.appendChild(e.firstChild);o.removeChild(e)}t.insertBefore(o,n)}return[r?r.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}};function Ja(e,t,n){const s=e._vtc;s&&(t=(t?[t,...s]:[...s]).join(" ")),null==t?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}function er(e,t,n){const s=e.style,o=Na(n);if(n&&!o){for(const e in n)nr(s,e,n[e]);if(t&&!Na(t))for(const e in t)null==n[e]&&nr(s,e,"")}else{const a=s.display;o?t!==n&&(s.cssText=n):t&&e.removeAttribute("style"),"_vod"in e&&(s.display=a)}}const tr=/\s*!important$/;function nr(e,t,n){if(Da(n))n.forEach((n=>nr(e,t,n)));else if(null==n&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const s=ar(e,t);tr.test(n)?e.setProperty(Xa(s),n.replace(tr,""),"important"):e[s]=n}}const sr=["Webkit","Moz","ms"],or={};function ar(e,t){const n=or[t];if(n)return n;let s=zt(t);if("filter"!==s&&s in e)return or[t]=s;s=Ya(s);for(let o=0;o<sr.length;o++){const n=sr[o]+s;if(n in e)return or[t]=n}return t}const rr="http://www.w3.org/1999/xlink";function ir(e,t,n,s,o){if(s&&t.startsWith("xlink:"))null==n?e.removeAttributeNS(rr,t.slice(6,t.length)):e.setAttributeNS(rr,t,n);else{const s=Ca(t);null==n||s&&!ja(n)?e.removeAttribute(t):e.setAttribute(t,s?"":n)}}function lr(e,t,n,s,o,a,r){if("innerHTML"===t||"textContent"===t)return s&&r(s,o,a),void(e[t]=null==n?"":n);if("value"===t&&"PROGRESS"!==e.tagName&&!e.tagName.includes("-")){e._value=n;const s=null==n?"":n;return e.value===s&&"OPTION"!==e.tagName||(e.value=s),void(null==n&&e.removeAttribute(t))}let i=!1;if(""===n||null==n){const s=typeof e[t];"boolean"===s?n=ja(n):null==n&&"string"===s?(n="",i=!0):"number"===s&&(n=0,i=!0)}try{e[t]=n}catch(l){}i&&e.removeAttribute(t)}const[cr,ur]=(()=>{let e=Date.now,t=!1;if("undefined"!==typeof window){Date.now()>document.createEvent("Event").timeStamp&&(e=performance.now.bind(performance));const n=navigator.userAgent.match(/firefox\/(\d+)/i);t=!!(n&&Number(n[1])<=53)}return[e,t]})();let dr=0;const mr=Promise.resolve(),pr=()=>{dr=0},hr=()=>dr||(mr.then(pr),dr=cr());function fr(e,t,n,s){e.addEventListener(t,n,s)}function gr(e,t,n,s){e.removeEventListener(t,n,s)}function _r(e,t,n,s,o=null){const a=e._vei||(e._vei={}),r=a[t];if(s&&r)r.value=s;else{const[n,i]=br(t);if(s){const r=a[t]=yr(s,o);fr(e,n,r,i)}else r&&(gr(e,n,r,i),a[t]=void 0)}}const vr=/(?:Once|Passive|Capture)$/;function br(e){let t;if(vr.test(e)){let n;t={};while(n=e.match(vr))e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[Xa(e.slice(2)),t]}function yr(e,t){const n=e=>{const s=e.timeStamp||cr();(ur||s>=n.attached-1)&&en(xr(e,n.value),t,5,[e])};return n.value=e,n.attached=hr(),n}function xr(e,t){if(Da(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map((e=>t=>!t._stopped&&e&&e(t)))}return t}const wr=/^on[a-z]/,kr=(e,t,n,s,o=!1,a,r,i,l)=>{"class"===t?Ja(e,s,o):"style"===t?er(e,n,s):Fa(t)?La(t)||_r(e,t,n,s,r):("."===t[0]?(t=t.slice(1),1):"^"===t[0]?(t=t.slice(1),0):Sr(e,t,s,o))?lr(e,t,s,a,r,i,l):("true-value"===t?e._trueValue=s:"false-value"===t&&(e._falseValue=s),ir(e,t,s,o))};function Sr(e,t,n,s){return s?"innerHTML"===t||"textContent"===t||!!(t in e&&wr.test(t)&&Ha(n)):"spellcheck"!==t&&"draggable"!==t&&"translate"!==t&&("form"!==t&&(("list"!==t||"INPUT"!==e.tagName)&&(("type"!==t||"TEXTAREA"!==e.tagName)&&((!wr.test(t)||!Na(n))&&t in e))))}function Mr(e,t){const n=ls(e);class s extends Rr{constructor(e){super(n,e,t)}}return s.def=n,s}const Ar="undefined"!==typeof HTMLElement?HTMLElement:class{};class Rr extends Ar{constructor(e,t={},n){super(),this._def=e,this._props=t,this._instance=null,this._connected=!1,this._resolved=!1,this._numberProps=null,this.shadowRoot&&n?n(this._createVNode(),this.shadowRoot):this.attachShadow({mode:"open"})}connectedCallback(){this._connected=!0,this._instance||this._resolveDef()}disconnectedCallback(){this._connected=!1,_n((()=>{this._connected||(di(null,this.shadowRoot),this._instance=null)}))}_resolveDef(){if(this._resolved)return;this._resolved=!0;for(let n=0;n<this.attributes.length;n++)this._setAttr(this.attributes[n].name);new MutationObserver((e=>{for(const t of e)this._setAttr(t.attributeName)})).observe(this,{attributes:!0});const e=e=>{const{props:t,styles:n}=e,s=!Da(t),o=t?s?Object.keys(t):t:[];let a;if(s)for(const r in this._props){const e=t[r];(e===Number||e&&e.type===Number)&&(this._props[r]=Ga(this._props[r]),(a||(a=Object.create(null)))[r]=!0)}this._numberProps=a;for(const r of Object.keys(this))"_"!==r[0]&&this._setProp(r,this[r],!0,!1);for(const r of o.map(qa))Object.defineProperty(this,r,{get(){return this._getProp(r)},set(e){this._setProp(r,e)}});this._applyStyles(n),this._update()},t=this._def.__asyncLoader;t?t().then(e):e(this._def)}_setAttr(e){let t=this.getAttribute(e);this._numberProps&&this._numberProps[e]&&(t=Ga(t)),this._setProp(qa(e),t,!1)}_getProp(e){return this._props[e]}_setProp(e,t,n=!0,s=!0){t!==this._props[e]&&(this._props[e]=t,s&&this._instance&&this._update(),n&&(!0===t?this.setAttribute(Xa(e),""):"string"===typeof t||"number"===typeof t?this.setAttribute(Xa(e),t+""):t||this.removeAttribute(Xa(e))))}_update(){di(this._createVNode(),this.shadowRoot)}_createVNode(){const e=Wo(this._def,Pa({},this._props));return this._instance||(e.ce=e=>{this._instance=e,e.isCE=!0,e.emit=(e,...t)=>{this.dispatchEvent(new CustomEvent(e,{detail:t}))};let t=this;while(t=t&&(t.parentNode||t.host))if(t instanceof Rr){e.parent=t._instance;break}}),e}_applyStyles(e){e&&e.forEach((e=>{const t=document.createElement("style");t.textContent=e,this.shadowRoot.appendChild(t)}))}}const Er="transition",Tr="animation",Br=(e,{slots:t})=>Ea(ts,Fr(e),t);Br.displayName="Transition";const Ir={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Cr=Br.props=Pa({},ts.props,Ir),jr=(e,t=[])=>{Da(e)?e.forEach((e=>e(...t))):e&&e(...t)},Or=e=>!!e&&(Da(e)?e.some((e=>e.length>1)):e.length>1);function Fr(e){const t={};for(const E in e)E in Ir||(t[E]=e[E]);if(!1===e.css)return t;const{name:n="v",type:s,duration:o,enterFromClass:a=`${n}-enter-from`,enterActiveClass:r=`${n}-enter-active`,enterToClass:i=`${n}-enter-to`,appearFromClass:l=a,appearActiveClass:c=r,appearToClass:u=i,leaveFromClass:d=`${n}-leave-from`,leaveActiveClass:m=`${n}-leave-active`,leaveToClass:p=`${n}-leave-to`}=e,h=Lr(o),f=h&&h[0],g=h&&h[1],{onBeforeEnter:_,onEnter:v,onEnterCancelled:b,onLeave:y,onLeaveCancelled:x,onBeforeAppear:w=_,onAppear:k=v,onAppearCancelled:S=b}=t,M=(e,t,n)=>{Hr(e,t?u:i),Hr(e,t?c:r),n&&n()},A=(e,t)=>{e._isLeaving=!1,Hr(e,d),Hr(e,p),Hr(e,m),t&&t()},R=e=>(t,n)=>{const o=e?k:v,r=()=>M(t,e,n);jr(o,[t,r]),Nr((()=>{Hr(t,e?l:a),Dr(t,e?u:i),Or(o)||zr(t,s,f,r)}))};return Pa(t,{onBeforeEnter(e){jr(_,[e]),Dr(e,a),Dr(e,r)},onBeforeAppear(e){jr(w,[e]),Dr(e,l),Dr(e,c)},onEnter:R(!1),onAppear:R(!0),onLeave(e,t){e._isLeaving=!0;const n=()=>A(e,t);Dr(e,d),Xr(),Dr(e,m),Nr((()=>{e._isLeaving&&(Hr(e,d),Dr(e,p),Or(y)||zr(e,s,g,n))})),jr(y,[e,n])},onEnterCancelled(e){M(e,!1),jr(b,[e])},onAppearCancelled(e){M(e,!0),jr(S,[e])},onLeaveCancelled(e){A(e),jr(x,[e])}})}function Lr(e){if(null==e)return null;if($a(e))return[Pr(e.enter),Pr(e.leave)];{const t=Pr(e);return[t,t]}}function Pr(e){const t=Ga(e);return t}function Dr(e,t){t.split(/\s+/).forEach((t=>t&&e.classList.add(t))),(e._vtc||(e._vtc=new Set)).add(t)}function Hr(e,t){t.split(/\s+/).forEach((t=>t&&e.classList.remove(t)));const{_vtc:n}=e;n&&(n.delete(t),n.size||(e._vtc=void 0))}function Nr(e){requestAnimationFrame((()=>{requestAnimationFrame(e)}))}let $r=0;function zr(e,t,n,s){const o=e._endId=++$r,a=()=>{o===e._endId&&s()};if(n)return setTimeout(a,n);const{type:r,timeout:i,propCount:l}=Vr(e,t);if(!r)return s();const c=r+"end";let u=0;const d=()=>{e.removeEventListener(c,m),a()},m=t=>{t.target===e&&++u>=l&&d()};setTimeout((()=>{u<l&&d()}),i+1),e.addEventListener(c,m)}function Vr(e,t){const n=window.getComputedStyle(e),s=e=>(n[e]||"").split(", "),o=s(Er+"Delay"),a=s(Er+"Duration"),r=qr(o,a),i=s(Tr+"Delay"),l=s(Tr+"Duration"),c=qr(i,l);let u=null,d=0,m=0;t===Er?r>0&&(u=Er,d=r,m=a.length):t===Tr?c>0&&(u=Tr,d=c,m=l.length):(d=Math.max(r,c),u=d>0?r>c?Er:Tr:null,m=u?u===Er?a.length:l.length:0);const p=u===Er&&/\b(transform|all)(,|$)/.test(n[Er+"Property"]);return{type:u,timeout:d,propCount:m,hasTransform:p}}function qr(e,t){while(e.length<t.length)e=e.concat(e);return Math.max(...t.map(((t,n)=>Ur(t)+Ur(e[n]))))}function Ur(e){return 1e3*Number(e.slice(0,-1).replace(",","."))}function Xr(){return document.body.offsetHeight}const Yr=new WeakMap,Gr=new WeakMap,Kr={name:"TransitionGroup",props:Pa({},Cr,{tag:String,moveClass:String}),setup(e,{slots:t}){const n=ma(),s=Qn();let o,a;return ys((()=>{if(!o.length)return;const t=e.moveClass||`${e.name||"v"}-move`;if(!ei(o[0].el,n.vnode.el,t))return;o.forEach(Wr),o.forEach(Qr);const s=o.filter(Jr);Xr(),s.forEach((e=>{const n=e.el,s=n.style;Dr(n,t),s.transform=s.webkitTransform=s.transitionDuration="";const o=n._moveCb=e=>{e&&e.target!==n||e&&!/transform$/.test(e.propertyName)||(n.removeEventListener("transitionend",o),n._moveCb=null,Hr(n,t))};n.addEventListener("transitionend",o)}))})),()=>{const r=Ge(e),i=Fr(r);let l=r.tag||Co;o=a,a=t.default?is(t.default()):[];for(let e=0;e<a.length;e++){const t=a[e];null!=t.key&&rs(t,ss(t,i,s,n))}if(o)for(let e=0;e<o.length;e++){const t=o[e];rs(t,ss(t,i,s,n)),Yr.set(t,t.el.getBoundingClientRect())}return Wo(l,null,a)}}},Zr=Kr;function Wr(e){const t=e.el;t._moveCb&&t._moveCb(),t._enterCb&&t._enterCb()}function Qr(e){Gr.set(e,e.el.getBoundingClientRect())}function Jr(e){const t=Yr.get(e),n=Gr.get(e),s=t.left-n.left,o=t.top-n.top;if(s||o){const t=e.el.style;return t.transform=t.webkitTransform=`translate(${s}px,${o}px)`,t.transitionDuration="0s",e}}function ei(e,t,n){const s=e.cloneNode();e._vtc&&e._vtc.forEach((e=>{e.split(/\s+/).forEach((e=>e&&s.classList.remove(e)))})),n.split(/\s+/).forEach((e=>e&&s.classList.add(e))),s.style.display="none";const o=1===t.nodeType?t:t.parentNode;o.appendChild(s);const{hasTransform:a}=Vr(s);return o.removeChild(s),a}const ti=["ctrl","shift","alt","meta"],ni={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&0!==e.button,middle:e=>"button"in e&&1!==e.button,right:e=>"button"in e&&2!==e.button,exact:(e,t)=>ti.some((n=>e[`${n}Key`]&&!t.includes(n)))},si=(e,t)=>(n,...s)=>{for(let e=0;e<t.length;e++){const s=ni[t[e]];if(s&&s(n,t))return}return e(n,...s)},oi={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},ai=(e,t)=>n=>{if(!("key"in n))return;const s=Xa(n.key);return t.some((e=>e===s||oi[e]===s))?e(n):void 0},ri={beforeMount(e,{value:t},{transition:n}){e._vod="none"===e.style.display?"":e.style.display,n&&t?n.beforeEnter(e):ii(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:s}){!t!==!n&&(s?t?(s.beforeEnter(e),ii(e,!0),s.enter(e)):s.leave(e,(()=>{ii(e,!1)})):ii(e,t))},beforeUnmount(e,{value:t}){ii(e,t)}};function ii(e,t){e.style.display=t?e._vod:"none"}const li=Pa({patchProp:kr},Qa);let ci;function ui(){return ci||(ci=Ao(li))}const di=(...e)=>{ui().render(...e)};var mi=(e,t)=>{const n=e.__vccOpts||e;for(const[s,o]of t)n[s]=o;return n};const pi={name:"AppLoader",props:{show:{type:Boolean,default:!1},infinite:{type:Boolean,default:!1},type:{type:String,required:!0},messageId:{type:String,default:""}}},hi=Zo("div",{id:"vac-circle"},null,-1),fi=Zo("div",{id:"vac-circle"},null,-1),gi=Zo("div",{id:"vac-circle"},null,-1),_i=Zo("div",{id:"vac-circle"},null,-1),vi=Zo("div",{id:"vac-circle"},null,-1),bi=Zo("div",{id:"vac-circle"},null,-1);function yi(e,t,n,s,o,a){return Do(),qo(Br,{name:"vac-fade-spinner",appear:""},{default:Fn((()=>[n.show?(Do(),Vo("div",{key:0,class:ht(["vac-loader-wrapper",{"vac-container-center":!n.infinite,"vac-container-top":n.infinite}])},["rooms"===n.type?Hs(e.$slots,"spinner-icon-rooms",{key:0},(()=>[hi])):na("",!0),"infinite-rooms"===n.type?Hs(e.$slots,"spinner-icon-infinite-rooms",{key:1},(()=>[fi])):na("",!0),"message-file"===n.type?Hs(e.$slots,"spinner-icon-message-file_"+n.messageId,{key:2},(()=>[gi])):na("",!0),"room-file"===n.type?Hs(e.$slots,"spinner-icon-room-file",{key:3},(()=>[_i])):na("",!0),"messages"===n.type?Hs(e.$slots,"spinner-icon-messages",{key:4},(()=>[vi])):na("",!0),"infinite-messages"===n.type?Hs(e.$slots,"spinner-icon-infinite-messages",{key:5},(()=>[bi])):na("",!0)],2)):na("",!0)])),_:3})}var xi=mi(pi,[["render",yi]]);const wi={name:"SvgIcon",props:{name:{type:String,default:null},param:{type:String,default:null}},data(){return{svgItem:{search:{path:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"},add:{path:"M17,13H13V17H11V13H7V11H11V7H13V11H17M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"},toggle:{path:"M5,13L9,17L7.6,18.42L1.18,12L7.6,5.58L9,7L5,11H21V13H5M21,6V8H11V6H21M21,16V18H11V16H21Z"},menu:{path:"M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z"},close:{path:"M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,6.47 6.47,2 12,2M15.59,7L12,10.59L8.41,7L7,8.41L10.59,12L7,15.59L8.41,17L12,13.41L15.59,17L17,15.59L13.41,12L17,8.41L15.59,7Z"},file:{path:"M14,17H7V15H14M17,13H7V11H17M17,9H7V7H17M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3Z"},paperclip:{path:"M16.5,6V17.5A4,4 0 0,1 12.5,21.5A4,4 0 0,1 8.5,17.5V5A2.5,2.5 0 0,1 11,2.5A2.5,2.5 0 0,1 13.5,5V15.5A1,1 0 0,1 12.5,16.5A1,1 0 0,1 11.5,15.5V6H10V15.5A2.5,2.5 0 0,0 12.5,18A2.5,2.5 0 0,0 15,15.5V5A4,4 0 0,0 11,1A4,4 0 0,0 7,5V17.5A5.5,5.5 0 0,0 12.5,23A5.5,5.5 0 0,0 18,17.5V6H16.5Z"},"close-outline":{path:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"},send:{path:"M2,21L23,12L2,3V10L17,12L2,14V21Z"},emoji:{path:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"},document:{path:"M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z"},pencil:{path:"M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"},checkmark:{path:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"},"double-checkmark":{path:"M18 7l-1.41-1.41-6.34 6.34 1.41 1.41L18 7zm4.24-1.41L11.66 16.17 7.48 12l-1.41 1.41L11.66 19l12-12-1.42-1.41zM.41 13.41L6 19l1.41-1.41L1.83 12 .41 13.41z"},eye:{path:"M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"},dropdown:{path:"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"},deleted:{path:"M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12C4,13.85 4.63,15.55 5.68,16.91L16.91,5.68C15.55,4.63 13.85,4 12,4M12,20A8,8 0 0,0 20,12C20,10.15 19.37,8.45 18.32,7.09L7.09,18.32C8.45,19.37 10.15,20 12,20Z"},microphone:{size:"large",path:"M432.8,216.4v39.2c0,45.2-15.3,84.3-45.2,118.4c-29.8,33.2-67.3,52.8-111.6,57.9v40.9h78.4c5.1,0,10.2,1.7,13.6,6c4.3,4.3,6,8.5,6,13.6c0,5.1-1.7,10.2-6,13.6c-4.3,4.3-8.5,6-13.6,6H157.6c-5.1,0-10.2-1.7-13.6-6c-4.3-4.3-6-8.5-6-13.6c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6H236v-40.9c-44.3-5.1-81.8-23.9-111.6-57.9s-45.2-73.3-45.2-118.4v-39.2c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6s10.2,1.7,13.6,6c4.3,4.3,6,8.5,6,13.6v39.2c0,37.5,13.6,70.7,40,97.1s59.6,40,97.1,40s70.7-13.6,97.1-40c26.4-26.4,40-59.6,40-97.1v-39.2c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6c5.1,0,10.2,1.7,13.6,6C430.2,206.2,432.8,211.3,432.8,216.4z M353.5,98v157.6c0,27.3-9.4,50.3-29,69c-19.6,19.6-42.6,29-69,29s-50.3-9.4-69-29c-19.6-19.6-29-42.6-29-69V98c0-27.3,9.4-50.3,29-69c19.6-19.6,42.6-29,69-29s50.3,9.4,69,29C344.2,47.7,353.5,71.6,353.5,98z"},"audio-play":{size:"medium",path:"M43.331,21.237L7.233,0.397c-0.917-0.529-2.044-0.529-2.96,0c-0.916,0.528-1.48,1.505-1.48,2.563v41.684   c0,1.058,0.564,2.035,1.48,2.563c0.458,0.268,0.969,0.397,1.48,0.397c0.511,0,1.022-0.133,1.48-0.397l36.098-20.84   c0.918-0.529,1.479-1.506,1.479-2.564S44.247,21.767,43.331,21.237z"},"audio-pause":{size:"medium",path:"M17.991,40.976c0,3.662-2.969,6.631-6.631,6.631l0,0c-3.662,0-6.631-2.969-6.631-6.631V6.631C4.729,2.969,7.698,0,11.36,0l0,0c3.662,0,6.631,2.969,6.631,6.631V40.976z",path2:"M42.877,40.976c0,3.662-2.969,6.631-6.631,6.631l0,0c-3.662,0-6.631-2.969-6.631-6.631V6.631C29.616,2.969,32.585,0,36.246,0l0,0c3.662,0,6.631,2.969,6.631,6.631V40.976z"}}}},computed:{svgId(){const e=this.param?"-"+this.param:"";return`vac-icon-${this.name}${e}`},size(){const e=this.svgItem[this.name];return"large"===e.size?512:"medium"===e.size?48:24}}},ki=["viewBox"],Si=["id","d"],Mi=["id","d"];function Ai(e,t,n,s,o,a){return Do(),Vo("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",width:"24",height:"24",viewBox:`0 0 ${a.size} ${a.size}`},[Zo("path",{id:a.svgId,d:o.svgItem[n.name].path},null,8,Si),o.svgItem[n.name].path2?(Do(),Vo("path",{key:0,id:a.svgId,d:o.svgItem[n.name].path2},null,8,Mi)):na("",!0)],8,ki)}var Ri=mi(wi,[["render",Ai]]);const Ei={name:"RoomsSearch",components:{SvgIcon:Ri},props:{textMessages:{type:Object,required:!0},showSearch:{type:Boolean,required:!0},showAddRoom:{type:Boolean,required:!0},rooms:{type:Array,required:!0},loadingRooms:{type:Boolean,required:!0}},emits:["search-room","add-room"],computed:{showSearchBar(){return this.showSearch||this.showAddRoom}}},Ti={key:0,class:"vac-icon-search"},Bi=["placeholder"];function Ii(e,t,n,s,o,a){const r=Is("svg-icon");return Do(),Vo("div",{class:ht({"vac-box-search":a.showSearchBar,"vac-box-empty":!a.showSearchBar})},[n.showSearch?(Do(),Vo(Co,{key:0},[!n.loadingRooms&&n.rooms.length?(Do(),Vo("div",Ti,[Hs(e.$slots,"search-icon",{},(()=>[Wo(r,{name:"search"})]))])):na("",!0),!n.loadingRooms&&n.rooms.length?(Do(),Vo("input",{key:1,type:"search",placeholder:n.textMessages.SEARCH,autocomplete:"off",class:"vac-input",onInput:t[0]||(t[0]=t=>e.$emit("search-room",t))},null,40,Bi)):na("",!0)],64)):na("",!0),n.showAddRoom?(Do(),Vo("div",{key:1,class:"vac-svg-button vac-add-icon",onClick:t[1]||(t[1]=t=>e.$emit("add-room"))},[Hs(e.$slots,"add-icon",{},(()=>[Wo(r,{name:"add"})]))])):na("",!0)],2)}var Ci=mi(Ei,[["render",Ii]]);const ji=document.createElement("i");function Oi(e){const t="&"+e+";";ji.innerHTML=t;const n=ji.textContent;return(59!==n.charCodeAt(n.length-1)||"semi"===e)&&(n!==t&&n)}function Fi(e,t,n,s){const o=e.length;let a,r=0;if(t=t<0?-t>o?0:o+t:t>o?o:t,n=n>0?n:0,s.length<1e4)a=Array.from(s),a.unshift(t,n),e.splice(...a);else{n&&e.splice(t,n);while(r<s.length)a=s.slice(r,r+1e4),a.unshift(t,0),e.splice(...a),r+=1e4,t+=1e4}}function Li(e,t){return e.length>0?(Fi(e,e.length,0,t),e):t}const Pi={}.hasOwnProperty;function Di(e){const t={};let n=-1;while(++n<e.length)Hi(t,e[n]);return t}function Hi(e,t){let n;for(n in t){const s=Pi.call(e,n)?e[n]:void 0,o=s||(e[n]={}),a=t[n];let r;if(a)for(r in a){Pi.call(o,r)||(o[r]=[]);const e=a[r];Ni(o[r],Array.isArray(e)?e:e?[e]:[])}}}function Ni(e,t){let n=-1;const s=[];while(++n<t.length)("after"===t[n].add?e:s).push(t[n]);Fi(e,0,0,s)}function $i(e){const t={};let n=-1;while(++n<e.length)zi(t,e[n]);return t}function zi(e,t){let n;for(n in t){const s=Pi.call(e,n)?e[n]:void 0,o=s||(e[n]={}),a=t[n];let r;if(a)for(r in a)o[r]=a[r]}}function Vi(e,t){const n=Number.parseInt(e,t);return n<9||11===n||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||65535===(65535&n)||65534===(65535&n)||n>1114111?"�":String.fromCharCode(n)}const qi={'"':"quot","&":"amp","<":"lt",">":"gt"};function Ui(e){return e.replace(/["&<>]/g,t);function t(e){return"&"+qi[e]+";"}}function Xi(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Yi=/[!-\/:-@\[-`\{-~\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]/,Gi=rl(/[A-Za-z]/),Ki=rl(/[\dA-Za-z]/),Zi=rl(/[#-'*+\--9=?A-Z^-~]/);function Wi(e){return null!==e&&(e<32||127===e)}const Qi=rl(/\d/),Ji=rl(/[\dA-Fa-f]/),el=rl(/[!-/:-@[-`{-~]/);function tl(e){return null!==e&&e<-2}function nl(e){return null!==e&&(e<0||32===e)}function sl(e){return-2===e||-1===e||32===e}const ol=rl(Yi),al=rl(/\s/);function rl(e){return t;function t(t){return null!==t&&e.test(String.fromCharCode(t))}}function il(e,t){const n=Ui(ll(e||""));if(!t)return n;const s=n.indexOf(":"),o=n.indexOf("?"),a=n.indexOf("#"),r=n.indexOf("/");return s<0||r>-1&&s>r||o>-1&&s>o||a>-1&&s>a||t.test(n.slice(0,s))?n:""}function ll(e){const t=[];let n=-1,s=0,o=0;while(++n<e.length){const a=e.charCodeAt(n);let r="";if(37===a&&Ki(e.charCodeAt(n+1))&&Ki(e.charCodeAt(n+2)))o=2;else if(a<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(a))||(r=String.fromCharCode(a));else if(a>55295&&a<57344){const t=e.charCodeAt(n+1);a<56320&&t>56319&&t<57344?(r=String.fromCharCode(a,t),o=1):r="�"}else r=String.fromCharCode(a);r&&(t.push(e.slice(s,n),encodeURIComponent(r)),s=n+o+1,r=""),o&&(n+=o,o=0)}return t.join("")+e.slice(s)}const cl={}.hasOwnProperty,ul=/^(https?|ircs?|mailto|xmpp)$/i,dl=/^https?$/i;function ml(e){const t=e||{};let n=!0;const s={},o=[[]],a=[],r=[],i={enter:{blockQuote:B,codeFenced:O,codeFencedFenceInfo:g,codeFencedFenceMeta:g,codeIndented:P,codeText:_e,content:te,definition:K,definitionDestinationString:W,definitionLabelString:g,definitionTitleString:g,emphasis:fe,htmlFlow:me,htmlText:he,image:H,label:g,link:N,listItemMarker:A,listItemValue:M,listOrdered:k,listUnordered:S,paragraph:C,reference:g,resource:q,resourceDestinationString:U,resourceTitleString:g,setextHeading:se,strong:ge},exit:{atxHeading:ae,atxHeadingSequence:ne,autolinkEmail:Me,autolinkProtocol:Se,blockQuote:I,characterEscapeValue:le,characterReferenceMarkerHexadecimal:we,characterReferenceMarkerNumeric:we,characterReferenceValue:ke,codeFenced:D,codeFencedFence:L,codeFencedFenceInfo:F,codeFencedFenceMeta:_,codeFlowValue:ue,codeIndented:D,codeText:ve,codeTextData:le,data:le,definition:ee,definitionDestinationString:Q,definitionLabelString:Z,definitionTitleString:J,emphasis:be,hardBreakEscape:de,hardBreakTrailing:de,htmlFlow:pe,htmlFlowData:le,htmlText:pe,htmlTextData:le,image:G,label:z,labelText:$,lineEnding:ce,link:G,listOrdered:R,listUnordered:E,paragraph:j,reference:_,referenceString:V,resource:_,resourceDestinationString:X,resourceTitleString:Y,setextHeading:ie,setextHeadingLineSequence:re,setextHeadingText:oe,strong:ye,thematicBreak:xe}},l=$i([i].concat(t.htmlExtensions||[])),c={tightStack:r,definitions:s},u={lineEndingIfNeeded:x,options:t,encode:w,raw:b,tag:v,buffer:g,resume:_,setData:h,getData:f};let d=t.defaultLineEnding;return m;function m(e){let t=-1,n=0;const s=[];let a=[],r=[];while(++t<e.length)d||"lineEnding"!==e[t][1].type&&"lineEndingBlank"!==e[t][1].type||(d=e[t][2].sliceSerialize(e[t][1])),"listOrdered"!==e[t][1].type&&"listUnordered"!==e[t][1].type||("enter"===e[t][0]?s.push(t):p(e.slice(s.pop(),t))),"definition"===e[t][1].type&&("enter"===e[t][0]?(r=Li(r,e.slice(n,t)),n=t):(a=Li(a,e.slice(n,t+1)),n=t+1));a=Li(a,r),a=Li(a,e.slice(n)),t=-1;const i=a;l.enter.null&&l.enter.null.call(u);while(++t<e.length){const e=l[i[t][0]],n=i[t][1].type,s=e[n];cl.call(e,n)&&s&&s.call(Object.assign({sliceSerialize:i[t][2].sliceSerialize},u),i[t][1])}return l.exit.null&&l.exit.null.call(u),o[0].join("")}function p(e){const t=e.length;let n,s=0,o=0,a=!1;while(++s<t){const t=e[s];if(t[1]._container)n=void 0,"enter"===t[0]?o++:o--;else switch(t[1].type){case"listItemPrefix":"exit"===t[0]&&(n=!0);break;case"linePrefix":break;case"lineEndingBlank":"enter"!==t[0]||o||(n?n=void 0:a=!0);break;default:n=void 0}}e[0][1]._loose=a}function h(e,t){c[e]=t}function f(e){return c[e]}function g(){o.push([])}function _(){const e=o.pop();return e.join("")}function v(e){n&&(h("lastWasTag",!0),o[o.length-1].push(e))}function b(e){h("lastWasTag"),o[o.length-1].push(e)}function y(){b(d||"\n")}function x(){const e=o[o.length-1],t=e[e.length-1],n=t?t.charCodeAt(t.length-1):null;10!==n&&13!==n&&null!==n&&y()}function w(e){return f("ignoreEncode")?e:Ui(e)}function k(e){r.push(!e._loose),x(),v("<ol"),h("expectFirstItem",!0)}function S(e){r.push(!e._loose),x(),v("<ul"),h("expectFirstItem",!0)}function M(e){if(f("expectFirstItem")){const t=Number.parseInt(this.sliceSerialize(e),10);1!==t&&v(' start="'+w(String(t))+'"')}}function A(){f("expectFirstItem")?v(">"):T(),x(),v("<li>"),h("expectFirstItem"),h("lastWasTag")}function R(){T(),r.pop(),y(),v("</ol>")}function E(){T(),r.pop(),y(),v("</ul>")}function T(){f("lastWasTag")&&!f("slurpAllLineEndings")&&x(),v("</li>"),h("slurpAllLineEndings")}function B(){r.push(!1),x(),v("<blockquote>")}function I(){r.pop(),x(),v("</blockquote>"),h("slurpAllLineEndings")}function C(){r[r.length-1]||(x(),v("<p>")),h("slurpAllLineEndings")}function j(){r[r.length-1]?h("slurpAllLineEndings",!0):v("</p>")}function O(){x(),v("<pre><code"),h("fencesCount",0)}function F(){const e=_();v(' class="language-'+e+'"')}function L(){const e=f("fencesCount")||0;e||(v(">"),h("slurpOneLineEnding",!0)),h("fencesCount",e+1)}function P(){x(),v("<pre><code>")}function D(){const e=f("fencesCount");void 0!==e&&e<2&&c.tightStack.length>0&&!f("lastWasTag")&&y(),f("flowCodeSeenData")&&x(),v("</code></pre>"),void 0!==e&&e<2&&x(),h("flowCodeSeenData"),h("fencesCount"),h("slurpOneLineEnding")}function H(){a.push({image:!0}),n=void 0}function N(){a.push({})}function $(e){a[a.length-1].labelId=this.sliceSerialize(e)}function z(){a[a.length-1].label=_()}function V(e){a[a.length-1].referenceId=this.sliceSerialize(e)}function q(){g(),a[a.length-1].destination=""}function U(){g(),h("ignoreEncode",!0)}function X(){a[a.length-1].destination=_(),h("ignoreEncode")}function Y(){a[a.length-1].title=_()}function G(){let e=a.length-1;const o=a[e],r=o.referenceId||o.labelId,i=void 0===o.destination?s[Xi(r)]:o;n=!0;while(e--)if(a[e].image){n=void 0;break}o.image?(v('<img src="'+il(i.destination,t.allowDangerousProtocol?void 0:dl)+'" alt="'),b(o.label),v('"')):v('<a href="'+il(i.destination,t.allowDangerousProtocol?void 0:ul)+'"'),v(i.title?' title="'+i.title+'"':""),o.image?v(" />"):(v(">"),b(o.label),v("</a>")),a.pop()}function K(){g(),a.push({})}function Z(e){_(),a[a.length-1].labelId=this.sliceSerialize(e)}function W(){g(),h("ignoreEncode",!0)}function Q(){a[a.length-1].destination=_(),h("ignoreEncode")}function J(){a[a.length-1].title=_()}function ee(){const e=a[a.length-1],t=Xi(e.labelId);_(),cl.call(s,t)||(s[t]=a[a.length-1]),a.pop()}function te(){h("slurpAllLineEndings",!0)}function ne(e){f("headingRank")||(h("headingRank",this.sliceSerialize(e).length),x(),v("<h"+f("headingRank")+">"))}function se(){g(),h("slurpAllLineEndings")}function oe(){h("slurpAllLineEndings",!0)}function ae(){v("</h"+f("headingRank")+">"),h("headingRank")}function re(e){h("headingRank",61===this.sliceSerialize(e).charCodeAt(0)?1:2)}function ie(){const e=_();x(),v("<h"+f("headingRank")+">"),b(e),v("</h"+f("headingRank")+">"),h("slurpAllLineEndings"),h("headingRank")}function le(e){b(w(this.sliceSerialize(e)))}function ce(e){f("slurpAllLineEndings")||(f("slurpOneLineEnding")?h("slurpOneLineEnding"):f("inCodeText")?b(" "):b(w(this.sliceSerialize(e))))}function ue(e){b(w(this.sliceSerialize(e))),h("flowCodeSeenData",!0)}function de(){v("<br />")}function me(){x(),he()}function pe(){h("ignoreEncode")}function he(){t.allowDangerousHtml&&h("ignoreEncode",!0)}function fe(){v("<em>")}function ge(){v("<strong>")}function _e(){h("inCodeText",!0),v("<code>")}function ve(){h("inCodeText"),v("</code>")}function be(){v("</em>")}function ye(){v("</strong>")}function xe(){x(),v("<hr />")}function we(e){h("characterReferenceType",e.type)}function ke(e){let t=this.sliceSerialize(e);t=f("characterReferenceType")?Vi(t,"characterReferenceMarkerNumeric"===f("characterReferenceType")?10:16):Oi(t),b(w(t)),h("characterReferenceType")}function Se(e){const n=this.sliceSerialize(e);v('<a href="'+il(n,t.allowDangerousProtocol?void 0:ul)+'">'),b(w(n)),v("</a>")}function Me(e){const t=this.sliceSerialize(e);v('<a href="'+il("mailto:"+t)+'">'),b(w(t)),v("</a>")}}function pl(e,t,n,s){const o=s?s-1:Number.POSITIVE_INFINITY;let a=0;return r;function r(s){return sl(s)?(e.enter(n),i(s)):t(s)}function i(s){return sl(s)&&a++<o?(e.consume(s),i):(e.exit(n),t(s))}}const hl={tokenize:fl};function fl(e){const t=e.attempt(this.parser.constructs.contentInitial,s,o);let n;return t;function s(n){if(null!==n)return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),pl(e,t,"linePrefix");e.consume(n)}function o(t){return e.enter("paragraph"),a(t)}function a(t){const s=e.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=s),n=s,r(t)}function r(t){return null===t?(e.exit("chunkText"),e.exit("paragraph"),void e.consume(t)):tl(t)?(e.consume(t),e.exit("chunkText"),a):(e.consume(t),r)}}const gl={tokenize:vl},_l={tokenize:bl};function vl(e){const t=this,n=[];let s,o,a,r=0;return i;function i(s){if(r<n.length){const o=n[r];return t.containerState=o[1],e.attempt(o[0].continuation,l,c)(s)}return c(s)}function l(e){if(r++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,s&&v();const n=t.events.length;let o,a=n;while(a--)if("exit"===t.events[a][0]&&"chunkFlow"===t.events[a][1].type){o=t.events[a][1].end;break}_(r);let i=n;while(i<t.events.length)t.events[i][1].end=Object.assign({},o),i++;return Fi(t.events,a+1,0,t.events.slice(n)),t.events.length=i,c(e)}return i(e)}function c(o){if(r===n.length){if(!s)return m(o);if(s.currentConstruct&&s.currentConstruct.concrete)return h(o);t.interrupt=Boolean(s.currentConstruct&&!s._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(_l,u,d)(o)}function u(e){return s&&v(),_(r),m(e)}function d(e){return t.parser.lazy[t.now().line]=r!==n.length,a=t.now().offset,h(e)}function m(n){return t.containerState={},e.attempt(_l,p,h)(n)}function p(e){return r++,n.push([t.currentConstruct,t.containerState]),m(e)}function h(n){return null===n?(s&&v(),_(0),void e.consume(n)):(s=s||t.parser.flow(t.now()),e.enter("chunkFlow",{contentType:"flow",previous:o,_tokenizer:s}),f(n))}function f(n){return null===n?(g(e.exit("chunkFlow"),!0),_(0),void e.consume(n)):tl(n)?(e.consume(n),g(e.exit("chunkFlow")),r=0,t.interrupt=void 0,i):(e.consume(n),f)}function g(e,n){const i=t.sliceStream(e);if(n&&i.push(null),e.previous=o,o&&(o.next=e),o=e,s.defineSkip(e.start),s.write(i),t.parser.lazy[e.start.line]){let e=s.events.length;while(e--)if(s.events[e][1].start.offset<a&&(!s.events[e][1].end||s.events[e][1].end.offset>a))return;const n=t.events.length;let o,i,l=n;while(l--)if("exit"===t.events[l][0]&&"chunkFlow"===t.events[l][1].type){if(o){i=t.events[l][1].end;break}o=!0}_(r),e=n;while(e<t.events.length)t.events[e][1].end=Object.assign({},i),e++;Fi(t.events,l+1,0,t.events.slice(n)),t.events.length=e}}function _(s){let o=n.length;while(o-- >s){const s=n[o];t.containerState=s[1],s[0].exit.call(t,e)}n.length=s}function v(){s.write([null]),o=void 0,s=void 0,t.containerState._closeFlow=void 0}}function bl(e,t,n){return pl(e,e.attempt(this.parser.constructs.document,t,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function yl(e){return null===e||nl(e)||al(e)?1:ol(e)?2:void 0}function xl(e,t,n){const s=[];let o=-1;while(++o<e.length){const a=e[o].resolveAll;a&&!s.includes(a)&&(t=a(t,n),s.push(a))}return t}const wl={name:"attention",tokenize:Sl,resolveAll:kl};function kl(e,t){let n,s,o,a,r,i,l,c,u=-1;while(++u<e.length)if("enter"===e[u][0]&&"attentionSequence"===e[u][1].type&&e[u][1]._close){n=u;while(n--)if("exit"===e[n][0]&&"attentionSequence"===e[n][1].type&&e[n][1]._open&&t.sliceSerialize(e[n][1]).charCodeAt(0)===t.sliceSerialize(e[u][1]).charCodeAt(0)){if((e[n][1]._close||e[u][1]._open)&&(e[u][1].end.offset-e[u][1].start.offset)%3&&!((e[n][1].end.offset-e[n][1].start.offset+e[u][1].end.offset-e[u][1].start.offset)%3))continue;i=e[n][1].end.offset-e[n][1].start.offset>1&&e[u][1].end.offset-e[u][1].start.offset>1?2:1;const d=Object.assign({},e[n][1].end),m=Object.assign({},e[u][1].start);Ml(d,-i),Ml(m,i),a={type:i>1?"strongSequence":"emphasisSequence",start:d,end:Object.assign({},e[n][1].end)},r={type:i>1?"strongSequence":"emphasisSequence",start:Object.assign({},e[u][1].start),end:m},o={type:i>1?"strongText":"emphasisText",start:Object.assign({},e[n][1].end),end:Object.assign({},e[u][1].start)},s={type:i>1?"strong":"emphasis",start:Object.assign({},a.start),end:Object.assign({},r.end)},e[n][1].end=Object.assign({},a.start),e[u][1].start=Object.assign({},r.end),l=[],e[n][1].end.offset-e[n][1].start.offset&&(l=Li(l,[["enter",e[n][1],t],["exit",e[n][1],t]])),l=Li(l,[["enter",s,t],["enter",a,t],["exit",a,t],["enter",o,t]]),l=Li(l,xl(t.parser.constructs.insideSpan.null,e.slice(n+1,u),t)),l=Li(l,[["exit",o,t],["enter",r,t],["exit",r,t],["exit",s,t]]),e[u][1].end.offset-e[u][1].start.offset?(c=2,l=Li(l,[["enter",e[u][1],t],["exit",e[u][1],t]])):c=0,Fi(e,n-1,u-n+3,l),u=n+l.length-c-2;break}}u=-1;while(++u<e.length)"attentionSequence"===e[u][1].type&&(e[u][1].type="data");return e}function Sl(e,t){const n=this.parser.constructs.attentionMarkers.null,s=this.previous,o=yl(s);let a;return r;function r(t){return a=t,e.enter("attentionSequence"),i(t)}function i(r){if(r===a)return e.consume(r),i;const l=e.exit("attentionSequence"),c=yl(r),u=!c||2===c&&o||n.includes(r),d=!o||2===o&&c||n.includes(s);return l._open=Boolean(42===a?u:u&&(o||!d)),l._close=Boolean(42===a?d:d&&(c||!u)),t(r)}}function Ml(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const Al={name:"autolink",tokenize:Rl};function Rl(e,t,n){let s=0;return o;function o(t){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(t),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),a}function a(t){return Gi(t)?(e.consume(t),r):c(t)}function r(e){return 43===e||45===e||46===e||Ki(e)?(s=1,i(e)):c(e)}function i(t){return 58===t?(e.consume(t),s=0,l):(43===t||45===t||46===t||Ki(t))&&s++<32?(e.consume(t),i):(s=0,c(t))}function l(s){return 62===s?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(s),e.exit("autolinkMarker"),e.exit("autolink"),t):null===s||32===s||60===s||Wi(s)?n(s):(e.consume(s),l)}function c(t){return 64===t?(e.consume(t),u):Zi(t)?(e.consume(t),c):n(t)}function u(e){return Ki(e)?d(e):n(e)}function d(n){return 46===n?(e.consume(n),s=0,u):62===n?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(n),e.exit("autolinkMarker"),e.exit("autolink"),t):m(n)}function m(t){if((45===t||Ki(t))&&s++<63){const n=45===t?m:d;return e.consume(t),n}return n(t)}}const El={tokenize:Tl,partial:!0};function Tl(e,t,n){return s;function s(t){return sl(t)?pl(e,o,"linePrefix")(t):o(t)}function o(e){return null===e||tl(e)?t(e):n(e)}}const Bl={name:"blockQuote",tokenize:Il,continuation:{tokenize:Cl},exit:jl};function Il(e,t,n){const s=this;return o;function o(t){if(62===t){const n=s.containerState;return n.open||(e.enter("blockQuote",{_container:!0}),n.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(t),e.exit("blockQuoteMarker"),a}return n(t)}function a(n){return sl(n)?(e.enter("blockQuotePrefixWhitespace"),e.consume(n),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(n))}}function Cl(e,t,n){const s=this;return o;function o(t){return sl(t)?pl(e,a,"linePrefix",s.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(t):a(t)}function a(s){return e.attempt(Bl,t,n)(s)}}function jl(e){e.exit("blockQuote")}const Ol={name:"characterEscape",tokenize:Fl};function Fl(e,t,n){return s;function s(t){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(t),e.exit("escapeMarker"),o}function o(s){return el(s)?(e.enter("characterEscapeValue"),e.consume(s),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):n(s)}}const Ll={name:"characterReference",tokenize:Pl};function Pl(e,t,n){const s=this;let o,a,r=0;return i;function i(t){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(t),e.exit("characterReferenceMarker"),l}function l(t){return 35===t?(e.enter("characterReferenceMarkerNumeric"),e.consume(t),e.exit("characterReferenceMarkerNumeric"),c):(e.enter("characterReferenceValue"),o=31,a=Ki,u(t))}function c(t){return 88===t||120===t?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(t),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),o=6,a=Ji,u):(e.enter("characterReferenceValue"),o=7,a=Qi,u(t))}function u(i){if(59===i&&r){const o=e.exit("characterReferenceValue");return a!==Ki||Oi(s.sliceSerialize(o))?(e.enter("characterReferenceMarker"),e.consume(i),e.exit("characterReferenceMarker"),e.exit("characterReference"),t):n(i)}return a(i)&&r++<o?(e.consume(i),u):n(i)}}const Dl={tokenize:$l,partial:!0},Hl={name:"codeFenced",tokenize:Nl,concrete:!0};function Nl(e,t,n){const s=this,o={tokenize:x,partial:!0};let a,r=0,i=0;return l;function l(e){return c(e)}function c(t){const n=s.events[s.events.length-1];return r=n&&"linePrefix"===n[1].type?n[2].sliceSerialize(n[1],!0).length:0,a=t,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),u(t)}function u(t){return t===a?(i++,e.consume(t),u):i<3?n(t):(e.exit("codeFencedFenceSequence"),sl(t)?pl(e,d,"whitespace")(t):d(t))}function d(n){return null===n||tl(n)?(e.exit("codeFencedFence"),s.interrupt?t(n):e.check(Dl,f,y)(n)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),m(n))}function m(t){return null===t||tl(t)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),d(t)):sl(t)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),pl(e,p,"whitespace")(t)):96===t&&t===a?n(t):(e.consume(t),m)}function p(t){return null===t||tl(t)?d(t):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),h(t))}function h(t){return null===t||tl(t)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),d(t)):96===t&&t===a?n(t):(e.consume(t),h)}function f(t){return e.attempt(o,y,g)(t)}function g(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),_}function _(t){return r>0&&sl(t)?pl(e,v,"linePrefix",r+1)(t):v(t)}function v(t){return null===t||tl(t)?e.check(Dl,f,y)(t):(e.enter("codeFlowValue"),b(t))}function b(t){return null===t||tl(t)?(e.exit("codeFlowValue"),v(t)):(e.consume(t),b)}function y(n){return e.exit("codeFenced"),t(n)}function x(e,t,n){let o=0;return r;function r(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),l}function l(t){return e.enter("codeFencedFence"),sl(t)?pl(e,c,"linePrefix",s.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(t):c(t)}function c(t){return t===a?(e.enter("codeFencedFenceSequence"),u(t)):n(t)}function u(t){return t===a?(o++,e.consume(t),u):o>=i?(e.exit("codeFencedFenceSequence"),sl(t)?pl(e,d,"whitespace")(t):d(t)):n(t)}function d(s){return null===s||tl(s)?(e.exit("codeFencedFence"),t(s)):n(s)}}}function $l(e,t,n){const s=this;return o;function o(t){return null===t?n(t):(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),a)}function a(e){return s.parser.lazy[s.now().line]?n(e):t(e)}}const zl={name:"codeIndented",tokenize:ql},Vl={tokenize:Ul,partial:!0};function ql(e,t,n){const s=this;return o;function o(t){return e.enter("codeIndented"),pl(e,a,"linePrefix",5)(t)}function a(e){const t=s.events[s.events.length-1];return t&&"linePrefix"===t[1].type&&t[2].sliceSerialize(t[1],!0).length>=4?r(e):n(e)}function r(t){return null===t?l(t):tl(t)?e.attempt(Vl,r,l)(t):(e.enter("codeFlowValue"),i(t))}function i(t){return null===t||tl(t)?(e.exit("codeFlowValue"),r(t)):(e.consume(t),i)}function l(n){return e.exit("codeIndented"),t(n)}}function Ul(e,t,n){const s=this;return o;function o(t){return s.parser.lazy[s.now().line]?n(t):tl(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),o):pl(e,a,"linePrefix",5)(t)}function a(e){const a=s.events[s.events.length-1];return a&&"linePrefix"===a[1].type&&a[2].sliceSerialize(a[1],!0).length>=4?t(e):tl(e)?o(e):n(e)}}const Xl={name:"codeText",tokenize:Kl,resolve:Yl,previous:Gl};function Yl(e){let t,n,s=e.length-4,o=3;if(("lineEnding"===e[o][1].type||"space"===e[o][1].type)&&("lineEnding"===e[s][1].type||"space"===e[s][1].type)){t=o;while(++t<s)if("codeTextData"===e[t][1].type){e[o][1].type="codeTextPadding",e[s][1].type="codeTextPadding",o+=2,s-=2;break}}t=o-1,s++;while(++t<=s)void 0===n?t!==s&&"lineEnding"!==e[t][1].type&&(n=t):t!==s&&"lineEnding"!==e[t][1].type||(e[n][1].type="codeTextData",t!==n+2&&(e[n][1].end=e[t-1][1].end,e.splice(n+2,t-n-2),s-=t-n-2,t=n+2),n=void 0);return e}function Gl(e){return 96!==e||"characterEscape"===this.events[this.events.length-1][1].type}function Kl(e,t,n){let s,o,a=0;return r;function r(t){return e.enter("codeText"),e.enter("codeTextSequence"),i(t)}function i(t){return 96===t?(e.consume(t),a++,i):(e.exit("codeTextSequence"),l(t))}function l(t){return null===t?n(t):32===t?(e.enter("space"),e.consume(t),e.exit("space"),l):96===t?(o=e.enter("codeTextSequence"),s=0,u(t)):tl(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),l):(e.enter("codeTextData"),c(t))}function c(t){return null===t||32===t||96===t||tl(t)?(e.exit("codeTextData"),l(t)):(e.consume(t),c)}function u(n){return 96===n?(e.consume(n),s++,u):s===a?(e.exit("codeTextSequence"),e.exit("codeText"),t(n)):(o.type="codeTextData",c(n))}}function Zl(e){const t={};let n,s,o,a,r,i,l,c=-1;while(++c<e.length){while(c in t)c=t[c];if(n=e[c],c&&"chunkFlow"===n[1].type&&"listItemPrefix"===e[c-1][1].type&&(i=n[1]._tokenizer.events,o=0,o<i.length&&"lineEndingBlank"===i[o][1].type&&(o+=2),o<i.length&&"content"===i[o][1].type))while(++o<i.length){if("content"===i[o][1].type)break;"chunkText"===i[o][1].type&&(i[o][1]._isInFirstContentOfListItem=!0,o++)}if("enter"===n[0])n[1].contentType&&(Object.assign(t,Wl(e,c)),c=t[c],l=!0);else if(n[1]._container){o=c,s=void 0;while(o--){if(a=e[o],"lineEnding"!==a[1].type&&"lineEndingBlank"!==a[1].type)break;"enter"===a[0]&&(s&&(e[s][1].type="lineEndingBlank"),a[1].type="lineEnding",s=o)}s&&(n[1].end=Object.assign({},e[s][1].start),r=e.slice(s,c),r.unshift(n),Fi(e,s,c-s+1,r))}}return!l}function Wl(e,t){const n=e[t][1],s=e[t][2];let o=t-1;const a=[],r=n._tokenizer||s.parser[n.contentType](n.start),i=r.events,l=[],c={};let u,d,m=-1,p=n,h=0,f=0;const g=[f];while(p){while(e[++o][1]!==p);a.push(o),p._tokenizer||(u=s.sliceStream(p),p.next||u.push(null),d&&r.defineSkip(p.start),p._isInFirstContentOfListItem&&(r._gfmTasklistFirstContentOfListItem=!0),r.write(u),p._isInFirstContentOfListItem&&(r._gfmTasklistFirstContentOfListItem=void 0)),d=p,p=p.next}p=n;while(++m<i.length)"exit"===i[m][0]&&"enter"===i[m-1][0]&&i[m][1].type===i[m-1][1].type&&i[m][1].start.line!==i[m][1].end.line&&(f=m+1,g.push(f),p._tokenizer=void 0,p.previous=void 0,p=p.next);r.events=[],p?(p._tokenizer=void 0,p.previous=void 0):g.pop(),m=g.length;while(m--){const t=i.slice(g[m],g[m+1]),n=a.pop();l.unshift([n,n+t.length-1]),Fi(e,n,2,t)}m=-1;while(++m<l.length)c[h+l[m][0]]=h+l[m][1],h+=l[m][1]-l[m][0]-1;return c}const Ql={tokenize:tc,resolve:ec},Jl={tokenize:nc,partial:!0};function ec(e){return Zl(e),e}function tc(e,t){let n;return s;function s(t){return e.enter("content"),n=e.enter("chunkContent",{contentType:"content"}),o(t)}function o(t){return null===t?a(t):tl(t)?e.check(Jl,r,a)(t):(e.consume(t),o)}function a(n){return e.exit("chunkContent"),e.exit("content"),t(n)}function r(t){return e.consume(t),e.exit("chunkContent"),n.next=e.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,o}}function nc(e,t,n){const s=this;return o;function o(t){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),pl(e,a,"linePrefix")}function a(o){if(null===o||tl(o))return n(o);const a=s.events[s.events.length-1];return!s.parser.constructs.disable.null.includes("codeIndented")&&a&&"linePrefix"===a[1].type&&a[2].sliceSerialize(a[1],!0).length>=4?t(o):e.interrupt(s.parser.constructs.flow,n,t)(o)}}function sc(e,t,n,s,o,a,r,i,l){const c=l||Number.POSITIVE_INFINITY;let u=0;return d;function d(t){return 60===t?(e.enter(s),e.enter(o),e.enter(a),e.consume(t),e.exit(a),m):null===t||32===t||41===t||Wi(t)?n(t):(e.enter(s),e.enter(r),e.enter(i),e.enter("chunkString",{contentType:"string"}),f(t))}function m(n){return 62===n?(e.enter(a),e.consume(n),e.exit(a),e.exit(o),e.exit(s),t):(e.enter(i),e.enter("chunkString",{contentType:"string"}),p(n))}function p(t){return 62===t?(e.exit("chunkString"),e.exit(i),m(t)):null===t||60===t||tl(t)?n(t):(e.consume(t),92===t?h:p)}function h(t){return 60===t||62===t||92===t?(e.consume(t),p):p(t)}function f(o){return u||null!==o&&41!==o&&!nl(o)?u<c&&40===o?(e.consume(o),u++,f):41===o?(e.consume(o),u--,f):null===o||32===o||40===o||Wi(o)?n(o):(e.consume(o),92===o?g:f):(e.exit("chunkString"),e.exit(i),e.exit(r),e.exit(s),t(o))}function g(t){return 40===t||41===t||92===t?(e.consume(t),f):f(t)}}function oc(e,t,n,s,o,a){const r=this;let i,l=0;return c;function c(t){return e.enter(s),e.enter(o),e.consume(t),e.exit(o),e.enter(a),u}function u(c){return l>999||null===c||91===c||93===c&&!i||94===c&&!l&&"_hiddenFootnoteSupport"in r.parser.constructs?n(c):93===c?(e.exit(a),e.enter(o),e.consume(c),e.exit(o),e.exit(s),t):tl(c)?(e.enter("lineEnding"),e.consume(c),e.exit("lineEnding"),u):(e.enter("chunkString",{contentType:"string"}),d(c))}function d(t){return null===t||91===t||93===t||tl(t)||l++>999?(e.exit("chunkString"),u(t)):(e.consume(t),i||(i=!sl(t)),92===t?m:d)}function m(t){return 91===t||92===t||93===t?(e.consume(t),l++,d):d(t)}}function ac(e,t,n,s,o,a){let r;return i;function i(t){return 34===t||39===t||40===t?(e.enter(s),e.enter(o),e.consume(t),e.exit(o),r=40===t?41:t,l):n(t)}function l(n){return n===r?(e.enter(o),e.consume(n),e.exit(o),e.exit(s),t):(e.enter(a),c(n))}function c(t){return t===r?(e.exit(a),l(r)):null===t?n(t):tl(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),pl(e,c,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),u(t))}function u(t){return t===r||null===t||tl(t)?(e.exit("chunkString"),c(t)):(e.consume(t),92===t?d:u)}function d(t){return t===r||92===t?(e.consume(t),u):u(t)}}function rc(e,t){let n;return s;function s(o){return tl(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),n=!0,s):sl(o)?pl(e,s,n?"linePrefix":"lineSuffix")(o):t(o)}}const ic={name:"definition",tokenize:cc},lc={tokenize:uc,partial:!0};function cc(e,t,n){const s=this;let o;return a;function a(t){return e.enter("definition"),r(t)}function r(t){return oc.call(s,e,i,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(t)}function i(t){return o=Xi(s.sliceSerialize(s.events[s.events.length-1][1]).slice(1,-1)),58===t?(e.enter("definitionMarker"),e.consume(t),e.exit("definitionMarker"),l):n(t)}function l(t){return nl(t)?rc(e,c)(t):c(t)}function c(t){return sc(e,u,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(t)}function u(t){return e.attempt(lc,d,d)(t)}function d(t){return sl(t)?pl(e,m,"whitespace")(t):m(t)}function m(a){return null===a||tl(a)?(e.exit("definition"),s.parser.defined.push(o),t(a)):n(a)}}function uc(e,t,n){return s;function s(t){return nl(t)?rc(e,o)(t):n(t)}function o(t){return ac(e,a,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(t)}function a(t){return sl(t)?pl(e,r,"whitespace")(t):r(t)}function r(e){return null===e||tl(e)?t(e):n(e)}}const dc={name:"hardBreakEscape",tokenize:mc};function mc(e,t,n){return s;function s(t){return e.enter("hardBreakEscape"),e.consume(t),o}function o(s){return tl(s)?(e.exit("hardBreakEscape"),t(s)):n(s)}}const pc={name:"headingAtx",tokenize:fc,resolve:hc};function hc(e,t){let n,s,o=e.length-2,a=3;return"whitespace"===e[a][1].type&&(a+=2),o-2>a&&"whitespace"===e[o][1].type&&(o-=2),"atxHeadingSequence"===e[o][1].type&&(a===o-1||o-4>a&&"whitespace"===e[o-2][1].type)&&(o-=a+1===o?2:4),o>a&&(n={type:"atxHeadingText",start:e[a][1].start,end:e[o][1].end},s={type:"chunkText",start:e[a][1].start,end:e[o][1].end,contentType:"text"},Fi(e,a,o-a+1,[["enter",n,t],["enter",s,t],["exit",s,t],["exit",n,t]])),e}function fc(e,t,n){let s=0;return o;function o(t){return e.enter("atxHeading"),a(t)}function a(t){return e.enter("atxHeadingSequence"),r(t)}function r(t){return 35===t&&s++<6?(e.consume(t),r):null===t||nl(t)?(e.exit("atxHeadingSequence"),i(t)):n(t)}function i(n){return 35===n?(e.enter("atxHeadingSequence"),l(n)):null===n||tl(n)?(e.exit("atxHeading"),t(n)):sl(n)?pl(e,i,"whitespace")(n):(e.enter("atxHeadingText"),c(n))}function l(t){return 35===t?(e.consume(t),l):(e.exit("atxHeadingSequence"),i(t))}function c(t){return null===t||35===t||nl(t)?(e.exit("atxHeadingText"),i(t)):(e.consume(t),c)}}const gc=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],_c=["pre","script","style","textarea"],vc={name:"htmlFlow",tokenize:wc,resolveTo:xc,concrete:!0},bc={tokenize:Sc,partial:!0},yc={tokenize:kc,partial:!0};function xc(e){let t=e.length;while(t--)if("enter"===e[t][0]&&"htmlFlow"===e[t][1].type)break;return t>1&&"linePrefix"===e[t-2][1].type&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e}function wc(e,t,n){const s=this;let o,a,r,i,l;return c;function c(e){return u(e)}function u(t){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(t),d}function d(i){return 33===i?(e.consume(i),m):47===i?(e.consume(i),a=!0,f):63===i?(e.consume(i),o=3,s.interrupt?t:L):Gi(i)?(e.consume(i),r=String.fromCharCode(i),g):n(i)}function m(a){return 45===a?(e.consume(a),o=2,p):91===a?(e.consume(a),o=5,i=0,h):Gi(a)?(e.consume(a),o=4,s.interrupt?t:L):n(a)}function p(o){return 45===o?(e.consume(o),s.interrupt?t:L):n(o)}function h(o){const a="CDATA[";return o===a.charCodeAt(i++)?(e.consume(o),i===a.length?s.interrupt?t:E:h):n(o)}function f(t){return Gi(t)?(e.consume(t),r=String.fromCharCode(t),g):n(t)}function g(i){if(null===i||47===i||62===i||nl(i)){const l=47===i,c=r.toLowerCase();return l||a||!_c.includes(c)?gc.includes(r.toLowerCase())?(o=6,l?(e.consume(i),_):s.interrupt?t(i):E(i)):(o=7,s.interrupt&&!s.parser.lazy[s.now().line]?n(i):a?v(i):b(i)):(o=1,s.interrupt?t(i):E(i))}return 45===i||Ki(i)?(e.consume(i),r+=String.fromCharCode(i),g):n(i)}function _(o){return 62===o?(e.consume(o),s.interrupt?t:E):n(o)}function v(t){return sl(t)?(e.consume(t),v):A(t)}function b(t){return 47===t?(e.consume(t),A):58===t||95===t||Gi(t)?(e.consume(t),y):sl(t)?(e.consume(t),b):A(t)}function y(t){return 45===t||46===t||58===t||95===t||Ki(t)?(e.consume(t),y):x(t)}function x(t){return 61===t?(e.consume(t),w):sl(t)?(e.consume(t),x):b(t)}function w(t){return null===t||60===t||61===t||62===t||96===t?n(t):34===t||39===t?(e.consume(t),l=t,k):sl(t)?(e.consume(t),w):S(t)}function k(t){return t===l?(e.consume(t),l=null,M):null===t||tl(t)?n(t):(e.consume(t),k)}function S(t){return null===t||34===t||39===t||47===t||60===t||61===t||62===t||96===t||nl(t)?x(t):(e.consume(t),S)}function M(e){return 47===e||62===e||sl(e)?b(e):n(e)}function A(t){return 62===t?(e.consume(t),R):n(t)}function R(t){return null===t||tl(t)?E(t):sl(t)?(e.consume(t),R):n(t)}function E(t){return 45===t&&2===o?(e.consume(t),C):60===t&&1===o?(e.consume(t),j):62===t&&4===o?(e.consume(t),P):63===t&&3===o?(e.consume(t),L):93===t&&5===o?(e.consume(t),F):!tl(t)||6!==o&&7!==o?null===t||tl(t)?(e.exit("htmlFlowData"),T(t)):(e.consume(t),E):(e.exit("htmlFlowData"),e.check(bc,D,T)(t))}function T(t){return e.check(yc,B,D)(t)}function B(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),I}function I(t){return null===t||tl(t)?T(t):(e.enter("htmlFlowData"),E(t))}function C(t){return 45===t?(e.consume(t),L):E(t)}function j(t){return 47===t?(e.consume(t),r="",O):E(t)}function O(t){if(62===t){const n=r.toLowerCase();return _c.includes(n)?(e.consume(t),P):E(t)}return Gi(t)&&r.length<8?(e.consume(t),r+=String.fromCharCode(t),O):E(t)}function F(t){return 93===t?(e.consume(t),L):E(t)}function L(t){return 62===t?(e.consume(t),P):45===t&&2===o?(e.consume(t),L):E(t)}function P(t){return null===t||tl(t)?(e.exit("htmlFlowData"),D(t)):(e.consume(t),P)}function D(n){return e.exit("htmlFlow"),t(n)}}function kc(e,t,n){const s=this;return o;function o(t){return tl(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),a):n(t)}function a(e){return s.parser.lazy[s.now().line]?n(e):t(e)}}function Sc(e,t,n){return s;function s(s){return e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),e.attempt(El,t,n)}}const Mc={name:"htmlText",tokenize:Ac};function Ac(e,t,n){const s=this;let o,a,r;return i;function i(t){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(t),l}function l(t){return 33===t?(e.consume(t),c):47===t?(e.consume(t),x):63===t?(e.consume(t),b):Gi(t)?(e.consume(t),S):n(t)}function c(t){return 45===t?(e.consume(t),u):91===t?(e.consume(t),a=0,h):Gi(t)?(e.consume(t),v):n(t)}function u(t){return 45===t?(e.consume(t),p):n(t)}function d(t){return null===t?n(t):45===t?(e.consume(t),m):tl(t)?(r=d,j(t)):(e.consume(t),d)}function m(t){return 45===t?(e.consume(t),p):d(t)}function p(e){return 62===e?C(e):45===e?m(e):d(e)}function h(t){const s="CDATA[";return t===s.charCodeAt(a++)?(e.consume(t),a===s.length?f:h):n(t)}function f(t){return null===t?n(t):93===t?(e.consume(t),g):tl(t)?(r=f,j(t)):(e.consume(t),f)}function g(t){return 93===t?(e.consume(t),_):f(t)}function _(t){return 62===t?C(t):93===t?(e.consume(t),_):f(t)}function v(t){return null===t||62===t?C(t):tl(t)?(r=v,j(t)):(e.consume(t),v)}function b(t){return null===t?n(t):63===t?(e.consume(t),y):tl(t)?(r=b,j(t)):(e.consume(t),b)}function y(e){return 62===e?C(e):b(e)}function x(t){return Gi(t)?(e.consume(t),w):n(t)}function w(t){return 45===t||Ki(t)?(e.consume(t),w):k(t)}function k(t){return tl(t)?(r=k,j(t)):sl(t)?(e.consume(t),k):C(t)}function S(t){return 45===t||Ki(t)?(e.consume(t),S):47===t||62===t||nl(t)?M(t):n(t)}function M(t){return 47===t?(e.consume(t),C):58===t||95===t||Gi(t)?(e.consume(t),A):tl(t)?(r=M,j(t)):sl(t)?(e.consume(t),M):C(t)}function A(t){return 45===t||46===t||58===t||95===t||Ki(t)?(e.consume(t),A):R(t)}function R(t){return 61===t?(e.consume(t),E):tl(t)?(r=R,j(t)):sl(t)?(e.consume(t),R):M(t)}function E(t){return null===t||60===t||61===t||62===t||96===t?n(t):34===t||39===t?(e.consume(t),o=t,T):tl(t)?(r=E,j(t)):sl(t)?(e.consume(t),E):(e.consume(t),B)}function T(t){return t===o?(e.consume(t),o=void 0,I):null===t?n(t):tl(t)?(r=T,j(t)):(e.consume(t),T)}function B(t){return null===t||34===t||39===t||60===t||61===t||96===t?n(t):47===t||62===t||nl(t)?M(t):(e.consume(t),B)}function I(e){return 47===e||62===e||nl(e)?M(e):n(e)}function C(s){return 62===s?(e.consume(s),e.exit("htmlTextData"),e.exit("htmlText"),t):n(s)}function j(t){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),O}function O(t){return sl(t)?pl(e,F,"linePrefix",s.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(t):F(t)}function F(t){return e.enter("htmlTextData"),r(t)}}const Rc={name:"labelEnd",tokenize:jc,resolveTo:Cc,resolveAll:Ic},Ec={tokenize:Oc},Tc={tokenize:Fc},Bc={tokenize:Lc};function Ic(e){let t=-1;while(++t<e.length){const n=e[t][1];"labelImage"!==n.type&&"labelLink"!==n.type&&"labelEnd"!==n.type||(e.splice(t+1,"labelImage"===n.type?4:2),n.type="data",t++)}return e}function Cc(e,t){let n,s,o,a,r=e.length,i=0;while(r--)if(n=e[r][1],s){if("link"===n.type||"labelLink"===n.type&&n._inactive)break;"enter"===e[r][0]&&"labelLink"===n.type&&(n._inactive=!0)}else if(o){if("enter"===e[r][0]&&("labelImage"===n.type||"labelLink"===n.type)&&!n._balanced&&(s=r,"labelLink"!==n.type)){i=2;break}}else"labelEnd"===n.type&&(o=r);const l={type:"labelLink"===e[s][1].type?"link":"image",start:Object.assign({},e[s][1].start),end:Object.assign({},e[e.length-1][1].end)},c={type:"label",start:Object.assign({},e[s][1].start),end:Object.assign({},e[o][1].end)},u={type:"labelText",start:Object.assign({},e[s+i+2][1].end),end:Object.assign({},e[o-2][1].start)};return a=[["enter",l,t],["enter",c,t]],a=Li(a,e.slice(s+1,s+i+3)),a=Li(a,[["enter",u,t]]),a=Li(a,xl(t.parser.constructs.insideSpan.null,e.slice(s+i+4,o-3),t)),a=Li(a,[["exit",u,t],e[o-2],e[o-1],["exit",c,t]]),a=Li(a,e.slice(o+1)),a=Li(a,[["exit",l,t]]),Fi(e,s,e.length,a),e}function jc(e,t,n){const s=this;let o,a,r=s.events.length;while(r--)if(("labelImage"===s.events[r][1].type||"labelLink"===s.events[r][1].type)&&!s.events[r][1]._balanced){o=s.events[r][1];break}return i;function i(t){return o?o._inactive?d(t):(a=s.parser.defined.includes(Xi(s.sliceSerialize({start:o.end,end:s.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelEnd"),l):n(t)}function l(t){return 40===t?e.attempt(Ec,u,a?u:d)(t):91===t?e.attempt(Tc,u,a?c:d)(t):a?u(t):d(t)}function c(t){return e.attempt(Bc,u,d)(t)}function u(e){return t(e)}function d(e){return o._balanced=!0,n(e)}}function Oc(e,t,n){return s;function s(t){return e.enter("resource"),e.enter("resourceMarker"),e.consume(t),e.exit("resourceMarker"),o}function o(t){return nl(t)?rc(e,a)(t):a(t)}function a(t){return 41===t?u(t):sc(e,r,i,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(t)}function r(t){return nl(t)?rc(e,l)(t):u(t)}function i(e){return n(e)}function l(t){return 34===t||39===t||40===t?ac(e,c,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(t):u(t)}function c(t){return nl(t)?rc(e,u)(t):u(t)}function u(s){return 41===s?(e.enter("resourceMarker"),e.consume(s),e.exit("resourceMarker"),e.exit("resource"),t):n(s)}}function Fc(e,t,n){const s=this;return o;function o(t){return oc.call(s,e,a,r,"reference","referenceMarker","referenceString")(t)}function a(e){return s.parser.defined.includes(Xi(s.sliceSerialize(s.events[s.events.length-1][1]).slice(1,-1)))?t(e):n(e)}function r(e){return n(e)}}function Lc(e,t,n){return s;function s(t){return e.enter("reference"),e.enter("referenceMarker"),e.consume(t),e.exit("referenceMarker"),o}function o(s){return 93===s?(e.enter("referenceMarker"),e.consume(s),e.exit("referenceMarker"),e.exit("reference"),t):n(s)}}const Pc={name:"labelStartImage",tokenize:Dc,resolveAll:Rc.resolveAll};function Dc(e,t,n){const s=this;return o;function o(t){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(t),e.exit("labelImageMarker"),a}function a(t){return 91===t?(e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelImage"),r):n(t)}function r(e){return 94===e&&"_hiddenFootnoteSupport"in s.parser.constructs?n(e):t(e)}}const Hc={name:"labelStartLink",tokenize:Nc,resolveAll:Rc.resolveAll};function Nc(e,t,n){const s=this;return o;function o(t){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelLink"),a}function a(e){return 94===e&&"_hiddenFootnoteSupport"in s.parser.constructs?n(e):t(e)}}const $c={name:"lineEnding",tokenize:zc};function zc(e,t){return n;function n(n){return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),pl(e,t,"linePrefix")}}const Vc={name:"thematicBreak",tokenize:qc};function qc(e,t,n){let s,o=0;return a;function a(t){return e.enter("thematicBreak"),r(t)}function r(e){return s=e,i(e)}function i(a){return a===s?(e.enter("thematicBreakSequence"),l(a)):o>=3&&(null===a||tl(a))?(e.exit("thematicBreak"),t(a)):n(a)}function l(t){return t===s?(e.consume(t),o++,l):(e.exit("thematicBreakSequence"),sl(t)?pl(e,i,"whitespace")(t):i(t))}}const Uc={name:"list",tokenize:Gc,continuation:{tokenize:Kc},exit:Wc},Xc={tokenize:Qc,partial:!0},Yc={tokenize:Zc,partial:!0};function Gc(e,t,n){const s=this,o=s.events[s.events.length-1];let a=o&&"linePrefix"===o[1].type?o[2].sliceSerialize(o[1],!0).length:0,r=0;return i;function i(t){const o=s.containerState.type||(42===t||43===t||45===t?"listUnordered":"listOrdered");if("listUnordered"===o?!s.containerState.marker||t===s.containerState.marker:Qi(t)){if(s.containerState.type||(s.containerState.type=o,e.enter(o,{_container:!0})),"listUnordered"===o)return e.enter("listItemPrefix"),42===t||45===t?e.check(Vc,n,c)(t):c(t);if(!s.interrupt||49===t)return e.enter("listItemPrefix"),e.enter("listItemValue"),l(t)}return n(t)}function l(t){return Qi(t)&&++r<10?(e.consume(t),l):(!s.interrupt||r<2)&&(s.containerState.marker?t===s.containerState.marker:41===t||46===t)?(e.exit("listItemValue"),c(t)):n(t)}function c(t){return e.enter("listItemMarker"),e.consume(t),e.exit("listItemMarker"),s.containerState.marker=s.containerState.marker||t,e.check(El,s.interrupt?n:u,e.attempt(Xc,m,d))}function u(e){return s.containerState.initialBlankLine=!0,a++,m(e)}function d(t){return sl(t)?(e.enter("listItemPrefixWhitespace"),e.consume(t),e.exit("listItemPrefixWhitespace"),m):n(t)}function m(n){return s.containerState.size=a+s.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(n)}}function Kc(e,t,n){const s=this;return s.containerState._closeFlow=void 0,e.check(El,o,a);function o(n){return s.containerState.furtherBlankLines=s.containerState.furtherBlankLines||s.containerState.initialBlankLine,pl(e,t,"listItemIndent",s.containerState.size+1)(n)}function a(n){return s.containerState.furtherBlankLines||!sl(n)?(s.containerState.furtherBlankLines=void 0,s.containerState.initialBlankLine=void 0,r(n)):(s.containerState.furtherBlankLines=void 0,s.containerState.initialBlankLine=void 0,e.attempt(Yc,t,r)(n))}function r(o){return s.containerState._closeFlow=!0,s.interrupt=void 0,pl(e,e.attempt(Uc,t,n),"linePrefix",s.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o)}}function Zc(e,t,n){const s=this;return pl(e,o,"listItemIndent",s.containerState.size+1);function o(e){const o=s.events[s.events.length-1];return o&&"listItemIndent"===o[1].type&&o[2].sliceSerialize(o[1],!0).length===s.containerState.size?t(e):n(e)}}function Wc(e){e.exit(this.containerState.type)}function Qc(e,t,n){const s=this;return pl(e,o,"listItemPrefixWhitespace",s.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function o(e){const o=s.events[s.events.length-1];return!sl(e)&&o&&"listItemPrefixWhitespace"===o[1].type?t(e):n(e)}}const Jc={name:"setextUnderline",tokenize:tu,resolveTo:eu};function eu(e,t){let n,s,o,a=e.length;while(a--)if("enter"===e[a][0]){if("content"===e[a][1].type){n=a;break}"paragraph"===e[a][1].type&&(s=a)}else"content"===e[a][1].type&&e.splice(a,1),o||"definition"!==e[a][1].type||(o=a);const r={type:"setextHeading",start:Object.assign({},e[s][1].start),end:Object.assign({},e[e.length-1][1].end)};return e[s][1].type="setextHeadingText",o?(e.splice(s,0,["enter",r,t]),e.splice(o+1,0,["exit",e[n][1],t]),e[n][1].end=Object.assign({},e[o][1].end)):e[n][1]=r,e.push(["exit",r,t]),e}function tu(e,t,n){const s=this;let o;return a;function a(t){let a,i=s.events.length;while(i--)if("lineEnding"!==s.events[i][1].type&&"linePrefix"!==s.events[i][1].type&&"content"!==s.events[i][1].type){a="paragraph"===s.events[i][1].type;break}return s.parser.lazy[s.now().line]||!s.interrupt&&!a?n(t):(e.enter("setextHeadingLine"),o=t,r(t))}function r(t){return e.enter("setextHeadingLineSequence"),i(t)}function i(t){return t===o?(e.consume(t),i):(e.exit("setextHeadingLineSequence"),sl(t)?pl(e,l,"lineSuffix")(t):l(t))}function l(s){return null===s||tl(s)?(e.exit("setextHeadingLine"),t(s)):n(s)}}const nu={tokenize:su};function su(e){const t=this,n=e.attempt(El,s,e.attempt(this.parser.constructs.flowInitial,o,pl(e,e.attempt(this.parser.constructs.flow,o,e.attempt(Ql,o)),"linePrefix")));return n;function s(s){if(null!==s)return e.enter("lineEndingBlank"),e.consume(s),e.exit("lineEndingBlank"),t.currentConstruct=void 0,n;e.consume(s)}function o(s){if(null!==s)return e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),t.currentConstruct=void 0,n;e.consume(s)}}const ou={resolveAll:lu()},au=iu("string"),ru=iu("text");function iu(e){return{tokenize:t,resolveAll:lu("text"===e?cu:void 0)};function t(t){const n=this,s=this.parser.constructs[e],o=t.attempt(s,a,r);return a;function a(e){return l(e)?o(e):r(e)}function r(e){if(null!==e)return t.enter("data"),t.consume(e),i;t.consume(e)}function i(e){return l(e)?(t.exit("data"),o(e)):(t.consume(e),i)}function l(e){if(null===e)return!0;const t=s[e];let o=-1;if(t)while(++o<t.length){const e=t[o];if(!e.previous||e.previous.call(n,n.previous))return!0}return!1}}}function lu(e){return t;function t(t,n){let s,o=-1;while(++o<=t.length)void 0===s?t[o]&&"data"===t[o][1].type&&(s=o,o++):t[o]&&"data"===t[o][1].type||(o!==s+2&&(t[s][1].end=t[o-1][1].end,t.splice(s+2,o-s-2),o=s+2),s=void 0);return e?e(t,n):t}}function cu(e,t){let n=0;while(++n<=e.length)if((n===e.length||"lineEnding"===e[n][1].type)&&"data"===e[n-1][1].type){const s=e[n-1][1],o=t.sliceStream(s);let a,r=o.length,i=-1,l=0;while(r--){const e=o[r];if("string"===typeof e){i=e.length;while(32===e.charCodeAt(i-1))l++,i--;if(i)break;i=-1}else if(-2===e)a=!0,l++;else if(-1!==e){r++;break}}if(l){const o={type:n===e.length||a||l<2?"lineSuffix":"hardBreakTrailing",start:{line:s.end.line,column:s.end.column-l,offset:s.end.offset-l,_index:s.start._index+r,_bufferIndex:r?i:s.start._bufferIndex+i},end:Object.assign({},s.end)};s.end=Object.assign({},o.start),s.start.offset===s.end.offset?Object.assign(s,o):(e.splice(n,0,["enter",o,t],["exit",o,t]),n+=2)}n++}return e}function uu(e,t,n){let s=Object.assign(n?Object.assign({},n):{line:1,column:1,offset:0},{_index:0,_bufferIndex:-1});const o={},a=[];let r=[],i=[];const l={consume:v,enter:b,exit:y,attempt:k(x),check:k(w),interrupt:k(w,{interrupt:!0})},c={previous:null,code:null,containerState:{},events:[],parser:e,sliceStream:p,sliceSerialize:m,now:h,defineSkip:f,write:d};let u=t.tokenize.call(c,l);return t.resolveAll&&a.push(t),c;function d(e){return r=Li(r,e),g(),null!==r[r.length-1]?[]:(S(t,0),c.events=xl(a,c.events,c),c.events)}function m(e,t){return mu(p(e),t)}function p(e){return du(r,e)}function h(){const{line:e,column:t,offset:n,_index:o,_bufferIndex:a}=s;return{line:e,column:t,offset:n,_index:o,_bufferIndex:a}}function f(e){o[e.line]=e.column,A()}function g(){let e;while(s._index<r.length){const t=r[s._index];if("string"===typeof t){e=s._index,s._bufferIndex<0&&(s._bufferIndex=0);while(s._index===e&&s._bufferIndex<t.length)_(t.charCodeAt(s._bufferIndex))}else _(t)}}function _(e){u=u(e)}function v(e){tl(e)?(s.line++,s.column=1,s.offset+=-3===e?2:1,A()):-1!==e&&(s.column++,s.offset++),s._bufferIndex<0?s._index++:(s._bufferIndex++,s._bufferIndex===r[s._index].length&&(s._bufferIndex=-1,s._index++)),c.previous=e}function b(e,t){const n=t||{};return n.type=e,n.start=h(),c.events.push(["enter",n,c]),i.push(n),n}function y(e){const t=i.pop();return t.end=h(),c.events.push(["exit",t,c]),t}function x(e,t){S(e,t.from)}function w(e,t){t.restore()}function k(e,t){return n;function n(n,s,o){let a,r,i,u;return Array.isArray(n)?m(n):"tokenize"in n?m([n]):d(n);function d(e){return t;function t(t){const n=null!==t&&e[t],s=null!==t&&e.null,o=[...Array.isArray(n)?n:n?[n]:[],...Array.isArray(s)?s:s?[s]:[]];return m(o)(t)}}function m(e){return a=e,r=0,0===e.length?o:p(e[r])}function p(e){return n;function n(n){return u=M(),i=e,e.partial||(c.currentConstruct=e),e.name&&c.parser.constructs.disable.null.includes(e.name)?f():e.tokenize.call(t?Object.assign(Object.create(c),t):c,l,h,f)(n)}}function h(t){return e(i,u),s}function f(e){return u.restore(),++r<a.length?p(a[r]):o}}}function S(e,t){e.resolveAll&&!a.includes(e)&&a.push(e),e.resolve&&Fi(c.events,t,c.events.length-t,e.resolve(c.events.slice(t),c)),e.resolveTo&&(c.events=e.resolveTo(c.events,c))}function M(){const e=h(),t=c.previous,n=c.currentConstruct,o=c.events.length,a=Array.from(i);return{restore:r,from:o};function r(){s=e,c.previous=t,c.currentConstruct=n,c.events.length=o,i=a,A()}}function A(){s.line in o&&s.column<2&&(s.column=o[s.line],s.offset+=o[s.line]-1)}}function du(e,t){const n=t.start._index,s=t.start._bufferIndex,o=t.end._index,a=t.end._bufferIndex;let r;if(n===o)r=[e[n].slice(s,a)];else{if(r=e.slice(n,o),s>-1){const e=r[0];"string"===typeof e?r[0]=e.slice(s):r.shift()}a>0&&r.push(e[o].slice(0,a))}return r}function mu(e,t){let n=-1;const s=[];let o;while(++n<e.length){const a=e[n];let r;if("string"===typeof a)r=a;else switch(a){case-5:r="\r";break;case-4:r="\n";break;case-3:r="\r\n";break;case-2:r=t?" ":"\t";break;case-1:if(!t&&o)continue;r=" ";break;default:r=String.fromCharCode(a)}o=-2===a,s.push(r)}return s.join("")}const pu={[42]:Uc,[43]:Uc,[45]:Uc,[48]:Uc,[49]:Uc,[50]:Uc,[51]:Uc,[52]:Uc,[53]:Uc,[54]:Uc,[55]:Uc,[56]:Uc,[57]:Uc,[62]:Bl},hu={[91]:ic},fu={[-2]:zl,[-1]:zl,[32]:zl},gu={[35]:pc,[42]:Vc,[45]:[Jc,Vc],[60]:vc,[61]:Jc,[95]:Vc,[96]:Hl,[126]:Hl},_u={[38]:Ll,[92]:Ol},vu={[-5]:$c,[-4]:$c,[-3]:$c,[33]:Pc,[38]:Ll,[42]:wl,[60]:[Al,Mc],[91]:Hc,[92]:[dc,Ol],[93]:Rc,[95]:wl,[96]:Xl},bu={null:[wl,ou]},yu={null:[42,95]},xu={null:[]};var wu=Object.freeze(Object.defineProperty({__proto__:null,document:pu,contentInitial:hu,flowInitial:fu,flow:gu,string:_u,text:vu,insideSpan:bu,attentionMarkers:yu,disable:xu},Symbol.toStringTag,{value:"Module"}));function ku(e){const t=e||{},n=Di([wu,...t.extensions||[]]),s={defined:[],lazy:{},constructs:n,content:o(hl),document:o(gl),flow:o(nu),string:o(au),text:o(ru)};return s;function o(e){return t;function t(t){return uu(s,e,t)}}}function Su(e){while(!Zl(e));return e}const Mu=/[\0\t\n\r]/g;function Au(){let e,t=1,n="",s=!0;return o;function o(o,a,r){const i=[];let l,c,u,d,m;o=n+o.toString(a),u=0,n="",s&&(65279===o.charCodeAt(0)&&u++,s=void 0);while(u<o.length){if(Mu.lastIndex=u,l=Mu.exec(o),d=l&&void 0!==l.index?l.index:o.length,m=o.charCodeAt(d),!l){n=o.slice(u);break}if(10===m&&u===d&&e)i.push(-3),e=void 0;else switch(e&&(i.push(-5),e=void 0),u<d&&(i.push(o.slice(u,d)),t+=d-u),m){case 0:i.push(65533),t++;break;case 9:c=4*Math.ceil(t/4),i.push(-2);while(t++<c)i.push(-1);break;case 10:i.push(-4),t=1;break;default:e=!0,t=1}u=d+1}return r&&(e&&i.push(-5),n&&i.push(n),i.push(null)),i}}function Ru(e,t,n){return"string"!==typeof t&&(n=t,t=void 0),ml(n)(Su(ku(n).document().write(Au()(e,t,!0))))}const Eu={tokenize:zu,partial:!0},Tu={tokenize:Vu,partial:!0},Bu={tokenize:qu,partial:!0},Iu={tokenize:Uu,partial:!0},Cu={tokenize:Xu,partial:!0},ju={tokenize:Nu,previous:Yu},Ou={tokenize:$u,previous:Gu},Fu={tokenize:Hu,previous:Ku},Lu={},Pu={text:Lu};let Du=48;while(Du<123)Lu[Du]=Fu,Du++,58===Du?Du=65:91===Du&&(Du=97);function Hu(e,t,n){const s=this;let o,a;return r;function r(t){return Zu(t)&&Ku.call(s,s.previous)&&!Wu(s.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),i(t)):n(t)}function i(t){return Zu(t)?(e.consume(t),i):64===t?(e.consume(t),l):n(t)}function l(t){return 46===t?e.check(Cu,u,c)(t):45===t||95===t||Ki(t)?(a=!0,e.consume(t),l):u(t)}function c(t){return e.consume(t),o=!0,l}function u(r){return a&&o&&Gi(s.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),t(r)):n(r)}}function Nu(e,t,n){const s=this;return o;function o(t){return 87!==t&&119!==t||!Yu.call(s,s.previous)||Wu(s.events)?n(t):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(Eu,e.attempt(Tu,e.attempt(Bu,a),n),n)(t))}function a(n){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),t(n)}}function $u(e,t,n){const s=this;let o="",a=!1;return r;function r(t){return 72!==t&&104!==t||!Gu.call(s,s.previous)||Wu(s.events)?n(t):(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),o+=String.fromCodePoint(t),e.consume(t),i)}function i(t){if(Gi(t)&&o.length<5)return o+=String.fromCodePoint(t),e.consume(t),i;if(58===t){const n=o.toLowerCase();if("http"===n||"https"===n)return e.consume(t),l}return n(t)}function l(t){return 47===t?(e.consume(t),a?c:(a=!0,l)):n(t)}function c(t){return null===t||Wi(t)||nl(t)||al(t)||ol(t)?n(t):e.attempt(Tu,e.attempt(Bu,u),n)(t)}function u(n){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),t(n)}}function zu(e,t,n){let s=0;return o;function o(t){return(87===t||119===t)&&s<3?(s++,e.consume(t),o):46===t&&3===s?(e.consume(t),a):n(t)}function a(e){return null===e?n(e):t(e)}}function Vu(e,t,n){let s,o,a;return r;function r(t){return 46===t||95===t?e.check(Iu,l,i)(t):null===t||nl(t)||al(t)||45!==t&&ol(t)?l(t):(a=!0,e.consume(t),r)}function i(t){return 95===t?s=!0:(o=s,s=void 0),e.consume(t),r}function l(e){return o||s||!a?n(e):t(e)}}function qu(e,t){let n=0,s=0;return o;function o(r){return 40===r?(n++,e.consume(r),o):41===r&&s<n?a(r):33===r||34===r||38===r||39===r||41===r||42===r||44===r||46===r||58===r||59===r||60===r||63===r||93===r||95===r||126===r?e.check(Iu,t,a)(r):null===r||nl(r)||al(r)?t(r):(e.consume(r),o)}function a(t){return 41===t&&s++,e.consume(t),o}}function Uu(e,t,n){return s;function s(r){return 33===r||34===r||39===r||41===r||42===r||44===r||46===r||58===r||59===r||63===r||95===r||126===r?(e.consume(r),s):38===r?(e.consume(r),a):93===r?(e.consume(r),o):60===r||null===r||nl(r)||al(r)?t(r):n(r)}function o(e){return null===e||40===e||91===e||nl(e)||al(e)?t(e):s(e)}function a(e){return Gi(e)?r(e):n(e)}function r(t){return 59===t?(e.consume(t),s):Gi(t)?(e.consume(t),r):n(t)}}function Xu(e,t,n){return s;function s(t){return e.consume(t),o}function o(e){return Ki(e)?n(e):t(e)}}function Yu(e){return null===e||40===e||42===e||95===e||91===e||93===e||126===e||nl(e)}function Gu(e){return!Gi(e)}function Ku(e){return!(47===e||Zu(e))}function Zu(e){return 43===e||45===e||46===e||95===e||Ki(e)}function Wu(e){let t=e.length,n=!1;while(t--){const s=e[t][1];if(("labelLink"===s.type||"labelImage"===s.type)&&!s._balanced){n=!0;break}if(s._gfmAutolinkLiteralWalkedInto){n=!1;break}}return e.length>0&&!n&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),n}Lu[43]=Fu,Lu[45]=Fu,Lu[46]=Fu,Lu[95]=Fu,Lu[72]=[Fu,Ou],Lu[104]=[Fu,Ou],Lu[87]=[Fu,ju],Lu[119]=[Fu,ju];const Qu={exit:{literalAutolinkEmail:ed,literalAutolinkHttp:td,literalAutolinkWww:Ju}};function Ju(e){nd.call(this,e,"http://")}function ed(e){nd.call(this,e,"mailto:")}function td(e){nd.call(this,e)}function nd(e,t){const n=this.sliceSerialize(e);this.tag('<a href="'+il((t||"")+n)+'">'),this.raw(this.encode(n)),this.tag("</a>")}const sd={tokenize:dd,partial:!0};function od(){return{document:{[91]:{tokenize:ld,continuation:{tokenize:cd},exit:ud}},text:{[91]:{tokenize:id},[93]:{add:"after",tokenize:ad,resolveTo:rd}}}}function ad(e,t,n){const s=this;let o=s.events.length;const a=s.parser.gfmFootnotes||(s.parser.gfmFootnotes=[]);let r;while(o--){const e=s.events[o][1];if("labelImage"===e.type){r=e;break}if("gfmFootnoteCall"===e.type||"labelLink"===e.type||"label"===e.type||"image"===e.type||"link"===e.type)break}return i;function i(o){if(!r||!r._balanced)return n(o);const i=Xi(s.sliceSerialize({start:r.end,end:s.now()}));return 94===i.codePointAt(0)&&a.includes(i.slice(1))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(o),e.exit("gfmFootnoteCallLabelMarker"),t(o)):n(o)}}function rd(e,t){let n=e.length;while(n--)if("labelImage"===e[n][1].type&&"enter"===e[n][0]){e[n][1];break}e[n+1][1].type="data",e[n+3][1].type="gfmFootnoteCallLabelMarker";const s={type:"gfmFootnoteCall",start:Object.assign({},e[n+3][1].start),end:Object.assign({},e[e.length-1][1].end)},o={type:"gfmFootnoteCallMarker",start:Object.assign({},e[n+3][1].end),end:Object.assign({},e[n+3][1].end)};o.end.column++,o.end.offset++,o.end._bufferIndex++;const a={type:"gfmFootnoteCallString",start:Object.assign({},o.end),end:Object.assign({},e[e.length-1][1].start)},r={type:"chunkString",contentType:"string",start:Object.assign({},a.start),end:Object.assign({},a.end)},i=[e[n+1],e[n+2],["enter",s,t],e[n+3],e[n+4],["enter",o,t],["exit",o,t],["enter",a,t],["enter",r,t],["exit",r,t],["exit",a,t],e[e.length-2],e[e.length-1],["exit",s,t]];return e.splice(n,e.length-n+1,...i),e}function id(e,t,n){const s=this,o=s.parser.gfmFootnotes||(s.parser.gfmFootnotes=[]);let a,r=0;return i;function i(t){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(t),e.exit("gfmFootnoteCallLabelMarker"),l}function l(t){return 94!==t?n(t):(e.enter("gfmFootnoteCallMarker"),e.consume(t),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",c)}function c(i){if(r>999||93===i&&!a||null===i||91===i||nl(i))return n(i);if(93===i){e.exit("chunkString");const a=e.exit("gfmFootnoteCallString");return o.includes(Xi(s.sliceSerialize(a)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(i),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),t):n(i)}return nl(i)||(a=!0),r++,e.consume(i),92===i?u:c}function u(t){return 91===t||92===t||93===t?(e.consume(t),r++,c):c(t)}}function ld(e,t,n){const s=this,o=s.parser.gfmFootnotes||(s.parser.gfmFootnotes=[]);let a,r,i=0;return l;function l(t){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(t),e.exit("gfmFootnoteDefinitionLabelMarker"),c}function c(t){return 94===t?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(t),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",u):n(t)}function u(t){if(i>999||93===t&&!r||null===t||91===t||nl(t))return n(t);if(93===t){e.exit("chunkString");const n=e.exit("gfmFootnoteDefinitionLabelString");return a=Xi(s.sliceSerialize(n)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(t),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),m}return nl(t)||(r=!0),i++,e.consume(t),92===t?d:u}function d(t){return 91===t||92===t||93===t?(e.consume(t),i++,u):u(t)}function m(t){return 58===t?(e.enter("definitionMarker"),e.consume(t),e.exit("definitionMarker"),o.includes(a)||o.push(a),pl(e,p,"gfmFootnoteDefinitionWhitespace")):n(t)}function p(e){return t(e)}}function cd(e,t,n){return e.check(El,t,e.attempt(sd,t,n))}function ud(e){e.exit("gfmFootnoteDefinition")}function dd(e,t,n){const s=this;return pl(e,o,"gfmFootnoteDefinitionIndent",5);function o(e){const o=s.events[s.events.length-1];return o&&"gfmFootnoteDefinitionIndent"===o[1].type&&4===o[2].sliceSerialize(o[1],!0).length?t(e):n(e)}}const md={}.hasOwnProperty,pd={};function hd(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}function fd(e){const t=e||pd,n=t.label||"Footnotes",s=t.labelTagName||"h2",o=null===t.labelAttributes||void 0===t.labelAttributes?'class="sr-only"':t.labelAttributes,a=t.backLabel||hd,r=null===t.clobberPrefix||void 0===t.clobberPrefix?"user-content-":t.clobberPrefix;return{enter:{gfmFootnoteDefinition(){const e=this.getData("tightStack");e.push(!1)},gfmFootnoteDefinitionLabelString(){this.buffer()},gfmFootnoteCallString(){this.buffer()}},exit:{gfmFootnoteDefinition(){let e=this.getData("gfmFootnoteDefinitions");const t=this.getData("gfmFootnoteDefinitionStack"),n=this.getData("tightStack"),s=t.pop(),o=this.resume();e||this.setData("gfmFootnoteDefinitions",e={}),md.call(e,s)||(e[s]=o),n.pop(),this.setData("slurpOneLineEnding",!0),this.setData("lastWasTag")},gfmFootnoteDefinitionLabelString(e){let t=this.getData("gfmFootnoteDefinitionStack");t||this.setData("gfmFootnoteDefinitionStack",t=[]),t.push(Xi(this.sliceSerialize(e))),this.resume(),this.buffer()},gfmFootnoteCallString(e){let t=this.getData("gfmFootnoteCallOrder"),n=this.getData("gfmFootnoteCallCounts");const s=Xi(this.sliceSerialize(e));let o;this.resume(),t||this.setData("gfmFootnoteCallOrder",t=[]),n||this.setData("gfmFootnoteCallCounts",n={});const a=t.indexOf(s),i=il(s.toLowerCase());-1===a?(t.push(s),n[s]=1,o=t.length):(n[s]++,o=a+1);const l=n[s];this.tag('<sup><a href="#'+r+"fn-"+i+'" id="'+r+"fnref-"+i+(l>1?"-"+l:"")+'" data-footnote-ref="" aria-describedby="footnote-label">'+String(o)+"</a></sup>")},null(){const e=this.getData("gfmFootnoteCallOrder")||[],t=this.getData("gfmFootnoteCallCounts")||{},i=this.getData("gfmFootnoteDefinitions")||{};let l=-1;e.length>0&&(this.lineEndingIfNeeded(),this.tag('<section data-footnotes="" class="footnotes"><'+s+' id="footnote-label"'+(o?" "+o:"")+">"),this.raw(this.encode(n)),this.tag("</"+s+">"),this.lineEndingIfNeeded(),this.tag("<ol>"));while(++l<e.length){const n=e[l],s=il(n.toLowerCase());let o=0;const c=[];while(++o<=t[n])c.push('<a href="#'+r+"fnref-"+s+(o>1?"-"+o:"")+'" data-footnote-backref="" aria-label="'+this.encode("string"===typeof a?a:a(l,o))+'" class="data-footnote-backref">↩'+(o>1?"<sup>"+o+"</sup>":"")+"</a>");const u=c.join(" ");let d=!1;this.lineEndingIfNeeded(),this.tag('<li id="'+r+"fn-"+s+'">'),this.lineEndingIfNeeded(),this.tag(i[n].replace(/<\/p>(?:\r?\n|\r)?$/,(e=>(d=!0," "+u+e)))),d||(this.lineEndingIfNeeded(),this.tag(u)),this.lineEndingIfNeeded(),this.tag("</li>")}e.length>0&&(this.lineEndingIfNeeded(),this.tag("</ol>"),this.lineEndingIfNeeded(),this.tag("</section>"))}}}}const gd={enter:{strikethrough(){this.tag("<del>")}},exit:{strikethrough(){this.tag("</del>")}}};function _d(e){const t=e||{};let n=t.singleTilde;const s={tokenize:a,resolveAll:o};return null!==n&&void 0!==n||(n=!0),{text:{[126]:s},insideSpan:{null:[s]},attentionMarkers:{null:[126]}};function o(e,t){let n=-1;while(++n<e.length)if("enter"===e[n][0]&&"strikethroughSequenceTemporary"===e[n][1].type&&e[n][1]._close){let s=n;while(s--)if("exit"===e[s][0]&&"strikethroughSequenceTemporary"===e[s][1].type&&e[s][1]._open&&e[n][1].end.offset-e[n][1].start.offset===e[s][1].end.offset-e[s][1].start.offset){e[n][1].type="strikethroughSequence",e[s][1].type="strikethroughSequence";const o={type:"strikethrough",start:Object.assign({},e[s][1].start),end:Object.assign({},e[n][1].end)},a={type:"strikethroughText",start:Object.assign({},e[s][1].end),end:Object.assign({},e[n][1].start)},r=[["enter",o,t],["enter",e[s][1],t],["exit",e[s][1],t],["enter",a,t]],i=t.parser.constructs.insideSpan.null;i&&Fi(r,r.length,0,xl(i,e.slice(s+1,n),t)),Fi(r,r.length,0,[["exit",a,t],["enter",e[n][1],t],["exit",e[n][1],t],["exit",o,t]]),Fi(e,s-1,n-s+3,r),n=s+r.length-2;break}}n=-1;while(++n<e.length)"strikethroughSequenceTemporary"===e[n][1].type&&(e[n][1].type="data");return e}function a(e,t,s){const o=this.previous,a=this.events;let r=0;return i;function i(t){return 126===o&&"characterEscape"!==a[a.length-1][1].type?s(t):(e.enter("strikethroughSequenceTemporary"),l(t))}function l(a){const i=yl(o);if(126===a)return r>1?s(a):(e.consume(a),r++,l);if(r<2&&!n)return s(a);const c=e.exit("strikethroughSequenceTemporary"),u=yl(a);return c._open=!u||2===u&&Boolean(i),c._close=!i||2===i&&Boolean(u),t(a)}}}const vd={none:"",left:' align="left"',right:' align="right"',center:' align="center"'},bd={enter:{table(e){const t=e._align;this.lineEndingIfNeeded(),this.tag("<table>"),this.setData("tableAlign",t)},tableBody(){this.tag("<tbody>")},tableData(){const e=this.getData("tableAlign"),t=this.getData("tableColumn"),n=vd[e[t]];void 0===n?this.buffer():(this.lineEndingIfNeeded(),this.tag("<td"+n+">"))},tableHead(){this.lineEndingIfNeeded(),this.tag("<thead>")},tableHeader(){const e=this.getData("tableAlign"),t=this.getData("tableColumn"),n=vd[e[t]];this.lineEndingIfNeeded(),this.tag("<th"+n+">")},tableRow(){this.setData("tableColumn",0),this.lineEndingIfNeeded(),this.tag("<tr>")}},exit:{codeTextData(e){let t=this.sliceSerialize(e);this.getData("tableAlign")&&(t=t.replace(/\\([\\|])/g,yd)),this.raw(this.encode(t))},table(){this.setData("tableAlign"),this.setData("slurpAllLineEndings"),this.lineEndingIfNeeded(),this.tag("</table>")},tableBody(){this.lineEndingIfNeeded(),this.tag("</tbody>")},tableData(){const e=this.getData("tableAlign"),t=this.getData("tableColumn");t in e?(this.tag("</td>"),this.setData("tableColumn",t+1)):this.resume()},tableHead(){this.lineEndingIfNeeded(),this.tag("</thead>")},tableHeader(){const e=this.getData("tableColumn");this.tag("</th>"),this.setData("tableColumn",e+1)},tableRow(){const e=this.getData("tableAlign");let t=this.getData("tableColumn");while(t<e.length)this.lineEndingIfNeeded(),this.tag("<td"+vd[e[t]]+"></td>"),t++;this.setData("tableColumn",t),this.lineEndingIfNeeded(),this.tag("</tr>")}}};function yd(e,t){return"|"===t?t:e}class xd{constructor(){this.map=[]}add(e,t,n){wd(this,e,t,n)}consume(e){if(this.map.sort(((e,t)=>e[0]-t[0])),0===this.map.length)return;let t=this.map.length;const n=[];while(t>0)t-=1,n.push(e.slice(this.map[t][0]+this.map[t][1])),n.push(this.map[t][2]),e.length=this.map[t][0];n.push([...e]),e.length=0;let s=n.pop();while(s)e.push(...s),s=n.pop();this.map.length=0}}function wd(e,t,n,s){let o=0;if(0!==n||0!==s.length){while(o<e.map.length){if(e.map[o][0]===t)return e.map[o][1]+=n,void e.map[o][2].push(...s);o+=1}e.map.push([t,n,s])}}function kd(e,t){let n=!1;const s=[];while(t<e.length){const o=e[t];if(n){if("enter"===o[0])"tableContent"===o[1].type&&s.push("tableDelimiterMarker"===e[t+1][1].type?"left":"none");else if("tableContent"===o[1].type){if("tableDelimiterMarker"===e[t-1][1].type){const e=s.length-1;s[e]="left"===s[e]?"center":"right"}}else if("tableDelimiterRow"===o[1].type)break}else"enter"===o[0]&&"tableDelimiterRow"===o[1].type&&(n=!0);t+=1}return s}const Sd={flow:{null:{tokenize:Md,resolveAll:Ad}}};function Md(e,t,n){const s=this;let o,a=0,r=0;return i;function i(e){let t=s.events.length-1;while(t>-1){const e=s.events[t][1].type;if("lineEnding"!==e&&"linePrefix"!==e)break;t--}const o=t>-1?s.events[t][1].type:null,a="tableHead"===o||"tableRow"===o?w:l;return a===w&&s.parser.lazy[s.now().line]?n(e):a(e)}function l(t){return e.enter("tableHead"),e.enter("tableRow"),c(t)}function c(e){return 124===e||(o=!0,r+=1),u(e)}function u(t){return null===t?n(t):tl(t)?r>1?(r=0,s.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),p):n(t):sl(t)?pl(e,u,"whitespace")(t):(r+=1,o&&(o=!1,a+=1),124===t?(e.enter("tableCellDivider"),e.consume(t),e.exit("tableCellDivider"),o=!0,u):(e.enter("data"),d(t)))}function d(t){return null===t||124===t||nl(t)?(e.exit("data"),u(t)):(e.consume(t),92===t?m:d)}function m(t){return 92===t||124===t?(e.consume(t),d):d(t)}function p(t){return s.interrupt=!1,s.parser.lazy[s.now().line]?n(t):(e.enter("tableDelimiterRow"),o=!1,sl(t)?pl(e,h,"linePrefix",s.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(t):h(t))}function h(t){return 45===t||58===t?g(t):124===t?(o=!0,e.enter("tableCellDivider"),e.consume(t),e.exit("tableCellDivider"),f):x(t)}function f(t){return sl(t)?pl(e,g,"whitespace")(t):g(t)}function g(t){return 58===t?(r+=1,o=!0,e.enter("tableDelimiterMarker"),e.consume(t),e.exit("tableDelimiterMarker"),_):45===t?(r+=1,_(t)):null===t||tl(t)?y(t):x(t)}function _(t){return 45===t?(e.enter("tableDelimiterFiller"),v(t)):x(t)}function v(t){return 45===t?(e.consume(t),v):58===t?(o=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(t),e.exit("tableDelimiterMarker"),b):(e.exit("tableDelimiterFiller"),b(t))}function b(t){return sl(t)?pl(e,y,"whitespace")(t):y(t)}function y(n){return 124===n?h(n):(null===n||tl(n))&&o&&a===r?(e.exit("tableDelimiterRow"),e.exit("tableHead"),t(n)):x(n)}function x(e){return n(e)}function w(t){return e.enter("tableRow"),k(t)}function k(n){return 124===n?(e.enter("tableCellDivider"),e.consume(n),e.exit("tableCellDivider"),k):null===n||tl(n)?(e.exit("tableRow"),t(n)):sl(n)?pl(e,k,"whitespace")(n):(e.enter("data"),S(n))}function S(t){return null===t||124===t||nl(t)?(e.exit("data"),k(t)):(e.consume(t),92===t?M:S)}function M(t){return 92===t||124===t?(e.consume(t),S):S(t)}}function Ad(e,t){let n,s,o,a=-1,r=!0,i=0,l=[0,0,0,0],c=[0,0,0,0],u=!1,d=0;const m=new xd;while(++a<e.length){const p=e[a],h=p[1];"enter"===p[0]?"tableHead"===h.type?(u=!1,0!==d&&(Ed(m,t,d,n,s),s=void 0,d=0),n={type:"table",start:Object.assign({},h.start),end:Object.assign({},h.end)},m.add(a,0,[["enter",n,t]])):"tableRow"===h.type||"tableDelimiterRow"===h.type?(r=!0,o=void 0,l=[0,0,0,0],c=[0,a+1,0,0],u&&(u=!1,s={type:"tableBody",start:Object.assign({},h.start),end:Object.assign({},h.end)},m.add(a,0,[["enter",s,t]])),i="tableDelimiterRow"===h.type?2:s?3:1):!i||"data"!==h.type&&"tableDelimiterMarker"!==h.type&&"tableDelimiterFiller"!==h.type?"tableCellDivider"===h.type&&(r?r=!1:(0!==l[1]&&(c[0]=c[1],o=Rd(m,t,l,i,void 0,o)),l=c,c=[l[1],a,0,0])):(r=!1,0===c[2]&&(0!==l[1]&&(c[0]=c[1],o=Rd(m,t,l,i,void 0,o),l=[0,0,0,0]),c[2]=a)):"tableHead"===h.type?(u=!0,d=a):"tableRow"===h.type||"tableDelimiterRow"===h.type?(d=a,0!==l[1]?(c[0]=c[1],o=Rd(m,t,l,i,a,o)):0!==c[1]&&(o=Rd(m,t,c,i,a,o)),i=0):!i||"data"!==h.type&&"tableDelimiterMarker"!==h.type&&"tableDelimiterFiller"!==h.type||(c[3]=a)}0!==d&&Ed(m,t,d,n,s),m.consume(t.events),a=-1;while(++a<t.events.length){const e=t.events[a];"enter"===e[0]&&"table"===e[1].type&&(e[1]._align=kd(t.events,a))}return e}function Rd(e,t,n,s,o,a){const r=1===s?"tableHeader":2===s?"tableDelimiter":"tableData",i="tableContent";0!==n[0]&&(a.end=Object.assign({},Td(t.events,n[0])),e.add(n[0],0,[["exit",a,t]]));const l=Td(t.events,n[1]);if(a={type:r,start:Object.assign({},l),end:Object.assign({},l)},e.add(n[1],0,[["enter",a,t]]),0!==n[2]){const o=Td(t.events,n[2]),a=Td(t.events,n[3]),r={type:i,start:Object.assign({},o),end:Object.assign({},a)};if(e.add(n[2],0,[["enter",r,t]]),2!==s){const s=t.events[n[2]],o=t.events[n[3]];if(s[1].end=Object.assign({},o[1].end),s[1].type="chunkText",s[1].contentType="text",n[3]>n[2]+1){const t=n[2]+1,s=n[3]-n[2]-1;e.add(t,s,[])}}e.add(n[3]+1,0,[["exit",r,t]])}return void 0!==o&&(a.end=Object.assign({},Td(t.events,o)),e.add(o,0,[["exit",a,t]]),a=void 0),a}function Ed(e,t,n,s,o){const a=[],r=Td(t.events,n);o&&(o.end=Object.assign({},r),a.push(["exit",o,t])),s.end=Object.assign({},r),a.push(["exit",s,t]),e.add(n+1,0,a)}function Td(e,t){const n=e[t],s="enter"===n[0]?"start":"end";return n[1][s]}const Bd=/<(\/?)(iframe|noembed|noframes|plaintext|script|style|title|textarea|xmp)(?=[\t\n\f\r />])/gi,Id=new RegExp("^"+Bd.source,"i"),Cd={exit:{htmlFlowData(e){jd.call(this,e,Bd)},htmlTextData(e){jd.call(this,e,Id)}}};function jd(e,t){let n=this.sliceSerialize(e);this.options.allowDangerousHtml&&(n=n.replace(t,"&lt;$1$2")),this.raw(this.encode(n))}const Od={enter:{taskListCheck(){this.tag('<input type="checkbox" disabled="" ')}},exit:{taskListCheck(){this.tag("/>")},taskListCheckValueChecked(){this.tag('checked="" ')}}},Fd={tokenize:Pd},Ld={text:{[91]:Fd}};function Pd(e,t,n){const s=this;return o;function o(t){return null===s.previous&&s._gfmTasklistFirstContentOfListItem?(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(t),e.exit("taskListCheckMarker"),a):n(t)}function a(t){return nl(t)?(e.enter("taskListCheckValueUnchecked"),e.consume(t),e.exit("taskListCheckValueUnchecked"),r):88===t||120===t?(e.enter("taskListCheckValueChecked"),e.consume(t),e.exit("taskListCheckValueChecked"),r):n(t)}function r(t){return 93===t?(e.enter("taskListCheckMarker"),e.consume(t),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),i):n(t)}function i(s){return tl(s)?t(s):sl(s)?e.check({tokenize:Dd},t,n)(s):n(s)}}function Dd(e,t,n){return pl(e,s,"whitespace");function s(e){return null===e?n(e):t(e)}}function Hd(e){return Di([Pu,od(),_d(e),Sd,Ld])}function Nd(e){return $i([Qu,fd(e),gd,bd,Cd,Od])}const $d={carriageReturn:-5,lineFeed:-4,carriageReturnLineFeed:-3,horizontalTab:-2,virtualSpace:-1,eof:null,nul:0,soh:1,stx:2,etx:3,eot:4,enq:5,ack:6,bel:7,bs:8,ht:9,lf:10,vt:11,ff:12,cr:13,so:14,si:15,dle:16,dc1:17,dc2:18,dc3:19,dc4:20,nak:21,syn:22,etb:23,can:24,em:25,sub:26,esc:27,fs:28,gs:29,rs:30,us:31,space:32,exclamationMark:33,quotationMark:34,numberSign:35,dollarSign:36,percentSign:37,ampersand:38,apostrophe:39,leftParenthesis:40,rightParenthesis:41,asterisk:42,plusSign:43,comma:44,dash:45,dot:46,slash:47,digit0:48,digit1:49,digit2:50,digit3:51,digit4:52,digit5:53,digit6:54,digit7:55,digit8:56,digit9:57,colon:58,semicolon:59,lessThan:60,equalsTo:61,greaterThan:62,questionMark:63,atSign:64,uppercaseA:65,uppercaseB:66,uppercaseC:67,uppercaseD:68,uppercaseE:69,uppercaseF:70,uppercaseG:71,uppercaseH:72,uppercaseI:73,uppercaseJ:74,uppercaseK:75,uppercaseL:76,uppercaseM:77,uppercaseN:78,uppercaseO:79,uppercaseP:80,uppercaseQ:81,uppercaseR:82,uppercaseS:83,uppercaseT:84,uppercaseU:85,uppercaseV:86,uppercaseW:87,uppercaseX:88,uppercaseY:89,uppercaseZ:90,leftSquareBracket:91,backslash:92,rightSquareBracket:93,caret:94,underscore:95,graveAccent:96,lowercaseA:97,lowercaseB:98,lowercaseC:99,lowercaseD:100,lowercaseE:101,lowercaseF:102,lowercaseG:103,lowercaseH:104,lowercaseI:105,lowercaseJ:106,lowercaseK:107,lowercaseL:108,lowercaseM:109,lowercaseN:110,lowercaseO:111,lowercaseP:112,lowercaseQ:113,lowercaseR:114,lowercaseS:115,lowercaseT:116,lowercaseU:117,lowercaseV:118,lowercaseW:119,lowercaseX:120,lowercaseY:121,lowercaseZ:122,leftCurlyBrace:123,verticalBar:124,rightCurlyBrace:125,tilde:126,del:127,degree:176,byteOrderMarker:65279,replacementCharacter:65533},zd=(e,t,n)=>{const s=a=>a===$d.carriageReturn||a===$d.lineFeed||a===$d.carriageReturnLineFeed||a===$d.eof?n(a):a===$d.backslash?(e.consume(a),o):a===$d.degree?(e.exit("underlineContent"),e.enter("underlineMarker"),e.consume(a),e.exit("underlineMarker"),e.exit("underline"),t):(e.consume(a),s),o=t=>t===$d.backslash||t===$d.degree?(e.consume(t),s):s(t),a=e=>e===$d.degree?n(e):s(e);return t=>(e.enter("underline"),e.enter("underlineMarker"),e.consume(t),e.exit("underlineMarker"),e.enter("underlineContent",{contentType:"string"}),a)},Vd={name:"underline",tokenize:zd},qd={text:{176:Vd}},Ud={enter:{underline(){this.tag("<u>")}},exit:{underline(){this.tag("</u>")}}},Xd=(e,t,n)=>{const s=a=>a===$d.carriageReturn||a===$d.lineFeed||a===$d.carriageReturnLineFeed||a===$d.eof?n(a):a===$d.backslash?(e.consume(a),o):a===$d.greaterThan?(e.exit("usertagContent"),e.enter("usertagMarker"),e.consume(a),e.exit("usertagMarker"),e.exit("usertag"),t):(e.consume(a),s),o=t=>t===$d.backslash||t===$d.greaterThan?(e.consume(t),s):s(t),a=t=>t===$d.atSign?(e.consume(t),e.exit("usertagMarker"),e.enter("usertagContent"),s):n(t);return t=>(e.enter("usertag"),e.enter("usertagMarker"),e.consume(t),a)},Yd={name:"usertag",tokenize:Xd},Gd={text:{60:Yd}},Kd=e=>({exit:{usertagContent(t){const n=this.sliceSerialize(t);this.tag(`<span class="vac-text-tag" data-user-id="${n}">`);const s=e.find((e=>e._id===n));this.raw(`@${this.encode(s?s.username:n)}`),this.tag("</span>")}}});var Zd=(e,{textFormatting:t})=>{if(t){let n=[];t.linkify||(n=["literalAutolink","literalAutolinkEmail"]);const s=Ru(e.replaceAll("<usertag>","<@").replaceAll("</usertag>",">"),{extensions:[{...Hd(),disable:{null:n}},qd,Gd],htmlExtensions:[Nd(),Ud,Kd(t.users)]});if(t.singleLine){const e=document.createElement("div");return e.innerHTML=s,[{types:[],value:e.innerText}]}return[{types:["markdown"],value:s}]}return[{types:[],value:e}]};const Wd=["png","jpg","jpeg","webp","svg","gif"],Qd=["mp4","video/ogg","webm","quicktime"],Jd=["mp3","audio/ogg","wav","mpeg"],em={name:"FormatMessage",components:{SvgIcon:Ri},props:{messageId:{type:String,default:""},roomId:{type:String,default:""},roomList:{type:Boolean,default:!1},content:{type:[String,Number],required:!0},deleted:{type:Boolean,default:!1},users:{type:Array,default:()=>[]},linkify:{type:Boolean,default:!0},singleLine:{type:Boolean,default:!1},reply:{type:Boolean,default:!1},textFormatting:{type:Object,required:!0},textMessages:{type:Object,default:()=>{}},linkOptions:{type:Object,required:!0}},emits:["open-user-tag"],computed:{parsedMessage(){if(this.deleted)return[{value:this.textMessages.MESSAGE_DELETED}];let e;e=this.textFormatting.disabled?{}:{textFormatting:{linkify:this.linkify,linkOptions:this.linkOptions,singleLine:this.singleLine,reply:this.reply,users:this.users,...this.textFormatting}};const t=Zd(this.content,e);return t.forEach((e=>{e.markdown=this.checkType(e,"markdown"),e.tag=this.checkType(e,"tag"),e.image=this.checkImageType(e)})),t}},methods:{checkType(e,t){return e.types&&-1!==e.types.indexOf(t)},checkImageType(e){let t=e.value.lastIndexOf(".");const n=e.value.lastIndexOf("/");n>t&&(t=-1);const s=e.value.substring(t+1,e.value.length),o=t>0&&Wd.some((e=>s.toLowerCase().includes(e)));return o&&this.setImageSize(e),o},setImageSize(e){const t=new Image;function n(s){const o=s.path[0].width/150;e.height=Math.round(s.path[0].height/o)+"px",t.removeEventListener("load",n)}t.src=e.value,t.addEventListener("load",n)},openTag(e){const t=e.target.getAttribute("data-user-id");if(!this.singleLine&&t){const e=this.users.find((e=>String(e._id)===t));this.$emit("open-user-tag",e)}}}},tm=["innerHTML"],nm={class:"vac-image-link-container"},sm={class:"vac-image-link-message"};function om(e,t,n,s,o,a){const r=Is("svg-icon");return Do(),Vo("div",{class:ht(["vac-format-message-wrapper",{"vac-text-ellipsis":n.singleLine}])},[(Do(!0),Vo(Co,null,Ps(a.parsedMessage,((s,o)=>(Do(),Vo(Co,{key:o},[s.markdown?(Do(),Vo("div",{key:0,class:"markdown",onClick:t[0]||(t[0]=(...e)=>a.openTag&&a.openTag(...e)),innerHTML:s.value},null,8,tm)):(Do(),Vo("div",{key:1,class:ht(["vac-format-container",{"vac-text-ellipsis":n.singleLine}])},[(Do(),qo(js(s.url?"a":"span"),{class:ht({"vac-text-ellipsis":n.singleLine,"vac-text-tag":!n.singleLine&&!n.reply&&s.tag}),href:s.href,target:s.href?n.linkOptions.target:null,rel:s.href?n.linkOptions.rel:null},{default:Fn((()=>[n.deleted?(Do(),Vo(Co,{key:0},[Hs(e.$slots,n.roomList?"deleted-icon-room_"+n.roomId:"deleted-icon_"+n.messageId,{},(()=>[Wo(r,{name:"deleted",class:ht(["vac-icon-deleted",{"vac-icon-deleted-room":n.roomList}])},null,8,["class"])])),ta(" "+gt(n.textMessages.MESSAGE_DELETED),1)],64)):s.url&&s.image?(Do(),Vo(Co,{key:1},[Zo("div",nm,[Zo("div",{class:"vac-image-link",style:ut({"background-image":`url('${s.value}')`,height:s.height})},null,4)]),Zo("div",sm,gt(s.value),1)],64)):(Do(),Vo(Co,{key:2},[ta(gt(s.value),1)],64))])),_:2},1032,["class","href","target","rel"]))],2))],64)))),128))],2)}var am=mi(em,[["render",om]]);const rm="__v-click-outside",im="undefined"!==typeof window,lm="undefined"!==typeof navigator,cm=im&&("ontouchstart"in window||lm&&navigator.msMaxTouchPoints>0),um=cm?["touchstart"]:["click"],dm=e=>{const t="function"===typeof e;if(!t&&"object"!==typeof e)throw new Error("v-click-outside: Binding value must be a function or an object");return{handler:t?e:e.handler,middleware:e.middleware||(e=>e),events:e.events||um,isActive:!(!1===e.isActive),detectIframe:!(!1===e.detectIframe),capture:Boolean(e.capture)}},mm=({event:e,handler:t,middleware:n})=>{n(e)&&t(e)},pm=({el:e,event:t,handler:n,middleware:s})=>{setTimeout((()=>{const{activeElement:o}=document;o&&"IFRAME"===o.tagName&&!e.contains(o)&&mm({event:t,handler:n,middleware:s})}),0)},hm=({el:e,event:t,handler:n,middleware:s})=>{const o=t.path||t.composedPath&&t.composedPath(),a=o?o.indexOf(e)<0:!e.contains(t.target);a&&mm({event:t,handler:n,middleware:s})},fm=(e,{value:t})=>{const{events:n,handler:s,middleware:o,isActive:a,detectIframe:r,capture:i}=dm(t);if(a){if(e[rm]=n.map((t=>({event:t,srcTarget:document.documentElement,handler:t=>hm({el:e,event:t,handler:s,middleware:o}),capture:i}))),r){const t={event:"blur",srcTarget:window,handler:t=>pm({el:e,event:t,handler:s,middleware:o}),capture:i};e[rm]=[...e[rm],t]}e[rm].forEach((({event:t,srcTarget:n,handler:s})=>setTimeout((()=>{e[rm]&&n.addEventListener(t,s,i)}),0)))}},gm=e=>{const t=e[rm]||[];t.forEach((({event:e,srcTarget:t,handler:n,capture:s})=>t.removeEventListener(e,n,s))),delete e[rm]},_m=(e,{value:t,oldValue:n})=>{JSON.stringify(t)!==JSON.stringify(n)&&(gm(e),fm(e,{value:t}))},vm={beforeMount:fm,updated:_m,unmounted:gm};var bm=im?vm:{},ym=(e,t,n)=>{if(e.typingUsers&&e.typingUsers.length){const s=e.users.filter((n=>{if(n._id!==t&&-1!==e.typingUsers.indexOf(n._id)&&(!n.status||"offline"!==n.status.state))return!0}));if(!s.length)return;return 2===e.users.length?n.IS_TYPING:s.map((e=>e.username)).join(", ")+" "+n.IS_TYPING}};function xm(e,t){if(t&&t.type)return e.some((e=>t.type.toLowerCase().includes(e)))}function wm(e){return xm(Wd,e)}function km(e){return xm(Qd,e)}function Sm(e){return xm(Wd,e)||xm(Qd,e)}function Mm(e){return xm(Jd,e)}const Am={name:"RoomsContent",components:{SvgIcon:Ri,FormatMessage:am},directives:{clickOutside:bm},props:{currentUserId:{type:[String,Number],required:!0},room:{type:Object,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},textMessages:{type:Object,required:!0},roomActions:{type:Array,required:!0}},emits:["room-action-handler"],data(){return{roomMenuOpened:null}},computed:{getLastMessage(){const e=this.typingUsers;if(e)return e;const t=this.room.lastMessage.content;if(this.room.users.length<=2)return t;const n=this.room.users.find((e=>e._id===this.room.lastMessage.senderId));return this.room.lastMessage.username?`${this.room.lastMessage.username} - ${t}`:n&&n._id!==this.currentUserId?`${n.username} - ${t}`:t},userStatus(){if(!this.room.users||2!==this.room.users.length)return;const e=this.room.users.find((e=>e._id!==this.currentUserId));return e&&e.status?e.status.state:null},typingUsers(){return ym(this.room,this.currentUserId,this.textMessages)},isMessageCheckmarkVisible(){return!this.typingUsers&&this.room.lastMessage&&!this.room.lastMessage.deleted&&this.room.lastMessage.senderId===this.currentUserId&&(this.room.lastMessage.saved||this.room.lastMessage.distributed||this.room.lastMessage.seen)},formattedDuration(){var e,t;const n=null==(t=null==(e=this.room.lastMessage)?void 0:e.files)?void 0:t[0];if(n){if(!n.duration)return`${n.name}.${n.extension}`;let e=Math.floor(n.duration);return(e-(e%=60))/60+(e>9?":":":0")+e}return""},isAudio(){return!!this.room.lastMessage.files&&Mm(this.room.lastMessage.files[0])}},methods:{roomActionHandler(e){this.closeRoomMenu(),this.$emit("room-action-handler",{action:e,roomId:this.room.roomId})},closeRoomMenu(){this.roomMenuOpened=null}}},Rm={class:"vac-room-container"},Em={class:"vac-name-container vac-text-ellipsis"},Tm={class:"vac-title-container"},Bm={class:"vac-room-name vac-text-ellipsis"},Im={key:1,class:"vac-text-date"},Cm={key:0},jm={key:1,class:"vac-text-ellipsis"},Om={key:3,class:"vac-text-ellipsis"},Fm={class:"vac-room-options-container"},Lm={key:0,class:"vac-badge-counter vac-room-badge"},Pm={key:0,class:"vac-menu-options"},Dm={class:"vac-menu-list"},Hm=["onClick"];function Nm(e,t,n,s,o,a){const r=Is("svg-icon"),i=Is("format-message"),l=Os("click-outside");return Do(),Vo("div",Rm,[Hs(e.$slots,"room-list-item_"+n.room.roomId,{},(()=>[Hs(e.$slots,"room-list-avatar_"+n.room.roomId,{},(()=>[n.room.avatar?(Do(),Vo("div",{key:0,class:"vac-avatar",style:ut({"background-image":`url('${n.room.avatar}')`})},null,4)):na("",!0)])),Zo("div",Em,[Zo("div",Tm,[a.userStatus?(Do(),Vo("div",{key:0,class:ht(["vac-state-circle",{"vac-state-online":"online"===a.userStatus}])},null,2)):na("",!0),Hs(e.$slots,"room-list-info_"+n.room.roomId,{},(()=>[Zo("div",Bm,gt(n.room.roomName),1)])),n.room.lastMessage?(Do(),Vo("div",Im,gt(n.room.lastMessage.timestamp),1)):na("",!0)]),Zo("div",{class:ht(["vac-text-last",{"vac-message-new":n.room.lastMessage&&n.room.lastMessage.new&&!a.typingUsers}])},[a.isMessageCheckmarkVisible?(Do(),Vo("span",Cm,[Hs(e.$slots,"checkmark-icon_"+n.room.roomId,{},(()=>[Wo(r,{name:n.room.lastMessage.distributed?"double-checkmark":"checkmark",param:n.room.lastMessage.seen?"seen":"",class:"vac-icon-check"},null,8,["name","param"])]))])):na("",!0),n.room.lastMessage&&!n.room.lastMessage.deleted&&a.isAudio?(Do(),Vo("div",jm,[Hs(e.$slots,"microphone-icon_"+n.room.roomId,{},(()=>[Wo(r,{name:"microphone",class:"vac-icon-microphone"})])),ta(" "+gt(a.formattedDuration),1)])):n.room.lastMessage?(Do(),qo(i,{key:2,"message-id":n.room.lastMessage._id,"room-id":n.room.roomId,"room-list":!0,content:a.getLastMessage,deleted:!!n.room.lastMessage.deleted&&!a.typingUsers,users:n.room.users,"text-messages":n.textMessages,linkify:!1,"text-formatting":n.textFormatting,"link-options":n.linkOptions,"single-line":!0},Ds({_:2},[Ps(e.$slots,((t,n)=>({name:n,fn:Fn((t=>[Hs(e.$slots,n,ft(Jo(t)))]))})))]),1032,["message-id","room-id","content","deleted","users","text-messages","text-formatting","link-options"])):na("",!0),!n.room.lastMessage&&a.typingUsers?(Do(),Vo("div",Om,gt(a.typingUsers),1)):na("",!0),Zo("div",Fm,[n.room.unreadCount?(Do(),Vo("div",Lm,gt(n.room.unreadCount),1)):na("",!0),Hs(e.$slots,"room-list-options_"+n.room.roomId,{},(()=>[n.roomActions.length?(Do(),Vo("div",{key:0,class:"vac-svg-button vac-list-room-options",onClick:t[0]||(t[0]=si((e=>o.roomMenuOpened=n.room.roomId),["stop"]))},[Hs(e.$slots,"room-list-options-icon_"+n.room.roomId,{},(()=>[Wo(r,{name:"dropdown",param:"room"})]))])):na("",!0),n.roomActions.length?(Do(),qo(Br,{key:1,name:"vac-slide-left"},{default:Fn((()=>[o.roomMenuOpened===n.room.roomId?Rs((Do(),Vo("div",Pm,[Zo("div",Dm,[(Do(!0),Vo(Co,null,Ps(n.roomActions,(e=>(Do(),Vo("div",{key:e.name},[Zo("div",{class:"vac-menu-item",onClick:si((t=>a.roomActionHandler(e)),["stop"])},gt(e.title),9,Hm)])))),128))])])),[[l,a.closeRoomMenu]]):na("",!0)])),_:1})):na("",!0)]))])],2)])]))])}var $m=mi(Am,[["render",Nm]]),zm=(e,t,n,s=!1)=>n&&""!==n?e.filter((e=>s?Vm(e[t]).startsWith(Vm(n)):Vm(e[t]).includes(Vm(n)))):e;function Vm(e){return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}const qm={name:"RoomsList",components:{Loader:xi,RoomsSearch:Ci,RoomContent:$m},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},showRoomsList:{type:Boolean,required:!0},showSearch:{type:Boolean,required:!0},showAddRoom:{type:Boolean,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},isMobile:{type:Boolean,required:!0},rooms:{type:Array,required:!0},loadingRooms:{type:Boolean,required:!0},roomsLoaded:{type:Boolean,required:!0},room:{type:Object,required:!0},customSearchRoomEnabled:{type:[Boolean,String],default:!1},roomActions:{type:Array,required:!0},scrollDistance:{type:Number,required:!0}},emits:["add-room","search-room","room-action-handler","loading-more-rooms","fetch-room","fetch-more-rooms"],data(){return{filteredRooms:this.rooms||[],observer:null,showLoader:!0,loadingMoreRooms:!1,selectedRoomId:""}},watch:{rooms:{deep:!0,handler(e,t){this.filteredRooms=e,(e.length!==t.length||this.roomsLoaded)&&(this.loadingMoreRooms=!1)}},loadingRooms(e){e||setTimeout((()=>this.initIntersectionObserver()))},loadingMoreRooms(e){this.$emit("loading-more-rooms",e)},roomsLoaded:{immediate:!0,handler(e){e&&(this.loadingMoreRooms=!1,this.loadingRooms||(this.showLoader=!1))}},room:{immediate:!0,handler(e){e&&!this.isMobile&&(this.selectedRoomId=e.roomId)}}},methods:{initIntersectionObserver(){this.observer&&(this.showLoader=!0,this.observer.disconnect());const e=this.$el.querySelector("#infinite-loader-rooms");if(e){const t={root:this.$el.querySelector("#rooms-list"),rootMargin:`${this.scrollDistance}px`,threshold:0};this.observer=new IntersectionObserver((e=>{e[0].isIntersecting&&this.loadMoreRooms()}),t),this.observer.observe(e)}},searchRoom(e){this.customSearchRoomEnabled?this.$emit("search-room",e.target.value):this.filteredRooms=zm(this.rooms,"roomName",e.target.value)},openRoom(e){(e.roomId!==this.room.roomId||this.isMobile)&&(this.isMobile||(this.selectedRoomId=e.roomId),this.$emit("fetch-room",{room:e}))},loadMoreRooms(){if(!this.loadingMoreRooms){if(this.roomsLoaded)return this.loadingMoreRooms=!1,void(this.showLoader=!1);this.$emit("fetch-more-rooms"),this.loadingMoreRooms=!0}}}},Um={key:0,class:"vac-rooms-empty"},Xm={key:1,id:"rooms-list",class:"vac-room-list"},Ym=["id","onClick"],Gm={key:0,id:"infinite-loader-rooms"};function Km(e,t,n,s,o,a){const r=Is("rooms-search"),i=Is("loader"),l=Is("room-content");return Rs((Do(),Vo("div",{class:ht(["vac-rooms-container",{"vac-rooms-container-full":n.isMobile,"vac-app-border-r":!n.isMobile}])},[Hs(e.$slots,"rooms-header"),Hs(e.$slots,"rooms-list-search",{},(()=>[Wo(r,{rooms:n.rooms,"loading-rooms":n.loadingRooms,"text-messages":n.textMessages,"show-search":n.showSearch,"show-add-room":n.showAddRoom,onSearchRoom:a.searchRoom,onAddRoom:t[0]||(t[0]=t=>e.$emit("add-room"))},Ds({_:2},[Ps(e.$slots,((t,n)=>({name:n,fn:Fn((t=>[Hs(e.$slots,n,ft(Jo(t)))]))})))]),1032,["rooms","loading-rooms","text-messages","show-search","show-add-room","onSearchRoom"])])),Wo(i,{show:n.loadingRooms,type:"rooms"},Ds({_:2},[Ps(e.$slots,((t,n)=>({name:n,fn:Fn((t=>[Hs(e.$slots,n,ft(Jo(t)))]))})))]),1032,["show"]),n.loadingRooms||n.rooms.length?na("",!0):(Do(),Vo("div",Um,[Hs(e.$slots,"rooms-empty",{},(()=>[ta(gt(n.textMessages.ROOMS_EMPTY),1)]))])),n.loadingRooms?na("",!0):(Do(),Vo("div",Xm,[(Do(!0),Vo(Co,null,Ps(o.filteredRooms,(s=>(Do(),Vo("div",{id:s.roomId,key:s.roomId,class:ht(["vac-room-item",{"vac-room-selected":o.selectedRoomId===s.roomId}]),onClick:e=>a.openRoom(s)},[Wo(l,{"current-user-id":n.currentUserId,room:s,"text-formatting":n.textFormatting,"link-options":n.linkOptions,"text-messages":n.textMessages,"room-actions":n.roomActions,onRoomActionHandler:t[1]||(t[1]=t=>e.$emit("room-action-handler",t))},Ds({_:2},[Ps(e.$slots,((t,n)=>({name:n,fn:Fn((t=>[Hs(e.$slots,n,ft(Jo(t)))]))})))]),1032,["current-user-id","room","text-formatting","link-options","text-messages","room-actions"])],10,Ym)))),128)),Wo(Br,{name:"vac-fade-message"},{default:Fn((()=>[n.rooms.length&&!n.loadingRooms?(Do(),Vo("div",Gm,[Wo(i,{show:o.showLoader,infinite:!0,type:"infinite-rooms"},Ds({_:2},[Ps(e.$slots,((t,n)=>({name:n,fn:Fn((t=>[Hs(e.$slots,n,ft(Jo(t)))]))})))]),1032,["show"])])):na("",!0)])),_:3})]))],2)),[[ri,n.showRoomsList]])}var Zm=mi(qm,[["render",Km]]);const Wm={name:"RoomHeader",components:{SvgIcon:Ri},directives:{clickOutside:bm},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},singleRoom:{type:Boolean,required:!0},showRoomsList:{type:Boolean,required:!0},isMobile:{type:Boolean,required:!0},roomInfoEnabled:{type:Boolean,required:!0},menuActions:{type:Array,required:!0},room:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0},messageSelectionActions:{type:Array,required:!0},selectedMessagesTotal:{type:Number,required:!0}},emits:["toggle-rooms-list","room-info","menu-action-handler","cancel-message-selection","message-selection-action-handler"],data(){return{menuOpened:!1,messageSelectionAnimationEnded:!0}},computed:{typingUsers(){return ym(this.room,this.currentUserId,this.textMessages)},userStatus(){if(!this.room.users||2!==this.room.users.length)return;const e=this.room.users.find((e=>e._id!==this.currentUserId));if(!(null==e?void 0:e.status))return;let t="";return"online"===e.status.state?t=this.textMessages.IS_ONLINE:e.status.lastChanged&&(t=this.textMessages.LAST_SEEN+e.status.lastChanged),t}},watch:{messageSelectionEnabled(e){e?this.messageSelectionAnimationEnded=!1:setTimeout((()=>{this.messageSelectionAnimationEnded=!0}),300)}},methods:{menuActionHandler(e){this.closeMenu(),this.$emit("menu-action-handler",e)},closeMenu(){this.menuOpened=!1},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",e)}}},Qm={class:"vac-room-header vac-app-border-b"},Jm={class:"vac-room-wrapper"},ep={key:0,class:"vac-room-selection"},tp=["id"],np=["onClick"],sp={class:"vac-selection-button-count"},op={class:"vac-text-ellipsis"},ap={class:"vac-room-name vac-text-ellipsis"},rp={key:0,class:"vac-room-info vac-text-ellipsis"},ip={key:1,class:"vac-room-info vac-text-ellipsis"},lp={key:0,class:"vac-menu-options"},cp={class:"vac-menu-list"},up=["onClick"];function dp(e,t,n,s,o,a){const r=Is("svg-icon"),i=Os("click-outside");return Do(),Vo("div",Qm,[Hs(e.$slots,"room-header",{},(()=>[Zo("div",Jm,[Wo(Br,{name:"vac-slide-up"},{default:Fn((()=>[n.messageSelectionEnabled?(Do(),Vo("div",ep,[(Do(!0),Vo(Co,null,Ps(n.messageSelectionActions,(e=>(Do(),Vo("div",{id:e.name,key:e.name},[Zo("div",{class:"vac-selection-button",onClick:t=>a.messageSelectionActionHandler(e)},[ta(gt(e.title)+" ",1),Zo("span",sp,gt(n.selectedMessagesTotal),1)],8,np)],8,tp)))),128)),Zo("div",{class:"vac-selection-cancel vac-item-clickable",onClick:t[0]||(t[0]=t=>e.$emit("cancel-message-selection"))},gt(n.textMessages.CANCEL_SELECT_MESSAGE),1)])):na("",!0)])),_:1}),!n.messageSelectionEnabled&&o.messageSelectionAnimationEnded?(Do(),Vo(Co,{key:0},[n.singleRoom?na("",!0):(Do(),Vo("div",{key:0,class:ht(["vac-svg-button vac-toggle-button",{"vac-rotate-icon-init":!n.isMobile,"vac-rotate-icon":!n.showRoomsList&&!n.isMobile}]),onClick:t[1]||(t[1]=t=>e.$emit("toggle-rooms-list"))},[Hs(e.$slots,"toggle-icon",{},(()=>[Wo(r,{name:"toggle"})]))],2)),Zo("div",{class:ht(["vac-info-wrapper",{"vac-item-clickable":n.roomInfoEnabled}]),onClick:t[2]||(t[2]=t=>e.$emit("room-info"))},[Hs(e.$slots,"room-header-avatar",{},(()=>[n.room.avatar?(Do(),Vo("div",{key:0,class:"vac-avatar",style:ut({"background-image":`url('${n.room.avatar}')`})},null,4)):na("",!0)])),Hs(e.$slots,"room-header-info",{},(()=>[Zo("div",op,[Zo("div",ap,gt(n.room.roomName),1),a.typingUsers?(Do(),Vo("div",rp,gt(a.typingUsers),1)):(Do(),Vo("div",ip,gt(a.userStatus),1))])]))],2),n.room.roomId?Hs(e.$slots,"room-options",{key:1},(()=>[n.menuActions.length?(Do(),Vo("div",{key:0,class:"vac-svg-button vac-room-options",onClick:t[3]||(t[3]=e=>o.menuOpened=!o.menuOpened)},[Hs(e.$slots,"menu-icon",{},(()=>[Wo(r,{name:"menu"})]))])):na("",!0),n.menuActions.length?(Do(),qo(Br,{key:1,name:"vac-slide-left"},{default:Fn((()=>[o.menuOpened?Rs((Do(),Vo("div",lp,[Zo("div",cp,[(Do(!0),Vo(Co,null,Ps(n.menuActions,(e=>(Do(),Vo("div",{key:e.name},[Zo("div",{class:"vac-menu-item",onClick:t=>a.menuActionHandler(e)},gt(e.title),9,up)])))),128))])])),[[i,a.closeMenu]]):na("",!0)])),_:1})):na("",!0)])):na("",!0)],64)):na("",!0)])]))])}var mp=mi(Wm,[["render",dp]]);function pp(e){if("string"!==typeof e||!e)throw new Error("expected a non-empty string, got: "+e)}function hp(e){if("number"!==typeof e)throw new Error("expected a number, got: "+e)}const fp=1,gp=1,_p="emoji",vp="keyvalue",bp="favorites",yp="tokens",xp="tokens",wp="unicode",kp="count",Sp="group",Mp="order",Ap="group-order",Rp="eTag",Ep="url",Tp="skinTone",Bp="readonly",Ip="readwrite",Cp="skinUnicodes",jp="skinUnicodes",Op="https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",Fp="en";function Lp(e,t){const n=new Set,s=[];for(const o of e){const e=t(o);n.has(e)||(n.add(e),s.push(o))}return s}function Pp(e){return Lp(e,(e=>e.unicode))}function Dp(e){function t(t,n,s){const o=n?e.createObjectStore(t,{keyPath:n}):e.createObjectStore(t);if(s)for(const[e,[a,r]]of Object.entries(s))o.createIndex(e,a,{multiEntry:r});return o}t(vp),t(_p,wp,{[xp]:[yp,!0],[Ap]:[[Sp,Mp]],[Cp]:[jp,!0]}),t(bp,void 0,{[kp]:[""]})}const Hp={},Np={},$p={};function zp(e,t,n){n.onerror=()=>t(n.error),n.onblocked=()=>t(new Error("IDB blocked")),n.onsuccess=()=>e(n.result)}async function Vp(e){const t=await new Promise(((t,n)=>{const s=indexedDB.open(e,fp);Hp[e]=s,s.onupgradeneeded=e=>{e.oldVersion<gp&&Dp(s.result)},zp(t,n,s)}));return t.onclose=()=>Xp(e),t}function qp(e){return Np[e]||(Np[e]=Vp(e)),Np[e]}function Up(e,t,n,s){return new Promise(((o,a)=>{const r=e.transaction(t,n,{durability:"relaxed"}),i="string"===typeof t?r.objectStore(t):t.map((e=>r.objectStore(e)));let l;s(i,r,(e=>{l=e})),r.oncomplete=()=>o(l),r.onerror=()=>a(r.error)}))}function Xp(e){const t=Hp[e],n=t&&t.result;if(n){n.close();const t=$p[e];if(t)for(const e of t)e()}delete Hp[e],delete Np[e],delete $p[e]}function Yp(e){return new Promise(((t,n)=>{Xp(e);const s=indexedDB.deleteDatabase(e);zp(t,n,s)}))}function Gp(e,t){let n=$p[e];n||(n=$p[e]=[]),n.push(t)}const Kp=new Set([":D","XD",":'D","O:)",":X",":P",";P","XP",":L",":Z",":j","8D","XO","8)",":B",":O",":S",":'o","Dx","X(","D:",":C",">0)",":3","</3","<3","\\M/",":E","8#"]);function Zp(e){return e.split(/[\s_]+/).map((e=>!e.match(/\w/)||Kp.has(e)?e.toLowerCase():e.replace(/[)(:,]/g,"").replace(/’/g,"'").toLowerCase())).filter(Boolean)}const Wp=2;function Qp(e){return e.filter(Boolean).map((e=>e.toLowerCase())).filter((e=>e.length>=Wp))}function Jp(e){const t=e.map((({annotation:e,emoticon:t,group:n,order:s,shortcodes:o,skins:a,tags:r,emoji:i,version:l})=>{const c=[...new Set(Qp([...(o||[]).map(Zp).flat(),...r.map(Zp).flat(),...Zp(e),t]))].sort(),u={annotation:e,group:n,order:s,tags:r,tokens:c,unicode:i,version:l};if(t&&(u.emoticon=t),o&&(u.shortcodes=o),a){u.skinTones=[],u.skinUnicodes=[],u.skinVersions=[];for(const{tone:e,emoji:t,version:n}of a)u.skinTones.push(e),u.skinUnicodes.push(t),u.skinVersions.push(n)}return u}));return t}function eh(e,t,n,s){e[t](n).onsuccess=e=>s&&s(e.target.result)}function th(e,t,n){eh(e,"get",t,n)}function nh(e,t,n){eh(e,"getAll",t,n)}function sh(e){e.commit&&e.commit()}function oh(e,t){let n=e[0];for(let s=1;s<e.length;s++){const o=e[s];t(n)>t(o)&&(n=o)}return n}function ah(e,t){const n=oh(e,(e=>e.length)),s=[];for(const o of n)e.some((e=>-1===e.findIndex((e=>t(e)===t(o)))))||s.push(o);return s}async function rh(e){return!await hh(e,vp,Ep)}async function ih(e,t,n){const[s,o]=await Promise.all([Rp,Ep].map((t=>hh(e,vp,t))));return s===n&&o===t}async function lh(e,t){const n=50;return Up(e,_p,Bp,((e,s,o)=>{let a;const r=()=>{e.getAll(a&&IDBKeyRange.lowerBound(a,!0),n).onsuccess=e=>{const s=e.target.result;for(const n of s)if(a=n.unicode,t(n))return o(n);if(s.length<n)return o();r()}};r()}))}async function ch(e,t,n,s){try{const o=Jp(t);await Up(e,[_p,vp],Ip,(([e,t],a)=>{let r,i,l=0;function c(){2===++l&&u()}function u(){if(r!==s||i!==n){e.clear();for(const t of o)e.put(t);t.put(s,Rp),t.put(n,Ep),sh(a)}}th(t,Rp,(e=>{r=e,c()})),th(t,Ep,(e=>{i=e,c()}))}))}finally{}}async function uh(e,t){return Up(e,_p,Bp,((e,n,s)=>{const o=IDBKeyRange.bound([t,0],[t+1,0],!1,!0);nh(e.index(Ap),o,s)}))}async function dh(e,t){const n=Qp(Zp(t));return n.length?Up(e,_p,Bp,((e,t,s)=>{const o=[],a=()=>{o.length===n.length&&r()},r=()=>{const e=ah(o,(e=>e.unicode));s(e.sort(((e,t)=>e.order<t.order?-1:1)))};for(let i=0;i<n.length;i++){const t=n[i],s=i===n.length-1?IDBKeyRange.bound(t,t+"￿",!1,!0):IDBKeyRange.only(t);nh(e.index(xp),s,(e=>{o.push(e),a()}))}})):[]}async function mh(e,t){const n=await dh(e,t);if(!n.length){const n=e=>(e.shortcodes||[]).includes(t.toLowerCase());return await lh(e,n)||null}return n.filter((e=>{const n=(e.shortcodes||[]).map((e=>e.toLowerCase()));return n.includes(t.toLowerCase())}))[0]||null}async function ph(e,t){return Up(e,_p,Bp,((e,n,s)=>th(e,t,(n=>{if(n)return s(n);th(e.index(Cp),t,(e=>s(e||null)))}))))}function hh(e,t,n){return Up(e,t,Bp,((e,t,s)=>th(e,n,s)))}function fh(e,t,n,s){return Up(e,t,Ip,((e,t)=>{e.put(s,n),sh(t)}))}function gh(e,t){return Up(e,bp,Ip,((e,n)=>th(e,t,(s=>{e.put((s||0)+1,t),sh(n)}))))}function _h(e,t,n){return 0===n?[]:Up(e,[bp,_p],Bp,(([e,s],o,a)=>{const r=[];e.index(kp).openCursor(void 0,"prev").onsuccess=e=>{const o=e.target.result;if(!o)return a(r);function i(e){if(r.push(e),r.length===n)return a(r);o.continue()}const l=o.primaryKey,c=t.byName(l);if(c)return i(c);th(s,l,(e=>{if(e)return i(e);o.continue()}))}}))}const vh="";function bh(e,t){const n=new Map;for(const o of e){const e=t(o);for(const t of e){let e=n;for(let n=0;n<t.length;n++){const s=t.charAt(n);let o=e.get(s);o||(o=new Map,e.set(s,o)),e=o}let s=e.get(vh);s||(s=[],e.set(vh,s)),s.push(o)}}const s=(e,t)=>{let s=n;for(let n=0;n<e.length;n++){const t=e.charAt(n),o=s.get(t);if(!o)return[];s=o}if(t){const e=s.get(vh);return e||[]}const o=[],a=[s];while(a.length){const e=a.shift(),t=[...e.entries()].sort(((e,t)=>e[0]<t[0]?-1:1));for(const[n,s]of t)n===vh?o.push(...s):a.push(s)}return o};return s}const yh=["name","url"];function xh(e){const t=e&&Array.isArray(e),n=t&&e.length&&(!e[0]||yh.some((t=>!(t in e[0]))));if(!t||n)throw new Error("Custom emojis are in the wrong format")}function wh(e){xh(e);const t=(e,t)=>e.name.toLowerCase()<t.name.toLowerCase()?-1:1,n=e.sort(t),s=e=>[...new Set((e.shortcodes||[]).map((e=>Zp(e))).flat())],o=bh(e,s),a=e=>o(e,!0),r=e=>o(e,!1),i=e=>{const n=Zp(e),s=n.map(((e,t)=>(t<n.length-1?a:r)(e)));return ah(s,(e=>e.name)).sort(t)},l=new Map,c=new Map;for(const m of e){c.set(m.name.toLowerCase(),m);for(const e of m.shortcodes||[])l.set(e.toLowerCase(),m)}const u=e=>l.get(e.toLowerCase()),d=e=>c.get(e.toLowerCase());return{all:n,search:i,byShortcode:u,byName:d}}function kh(e){if(!e)return e;if(delete e.tokens,e.skinTones){const t=e.skinTones.length;e.skins=Array(t);for(let n=0;n<t;n++)e.skins[n]={tone:e.skinTones[n],unicode:e.skinUnicodes[n],version:e.skinVersions[n]};delete e.skinTones,delete e.skinUnicodes,delete e.skinVersions}return e}function Sh(e){e||console.warn("emoji-picker-element is more efficient if the dataSource server exposes an ETag header.")}const Mh=["annotation","emoji","group","order","tags","version"];function Ah(e){if(!e||!Array.isArray(e)||!e[0]||"object"!==typeof e[0]||Mh.some((t=>!(t in e[0]))))throw new Error("Emoji data is in the wrong format")}function Rh(e,t){if(2!==Math.floor(e.status/100))throw new Error("Failed to fetch: "+t+":  "+e.status)}async function Eh(e){const t=await fetch(e,{method:"HEAD"});Rh(t,e);const n=t.headers.get("etag");return Sh(n),n}async function Th(e){const t=await fetch(e);Rh(t,e);const n=t.headers.get("etag");Sh(n);const s=await t.json();return Ah(s),[n,s]}function Bh(e){var t="",n=new Uint8Array(e),s=n.byteLength,o=-1;while(++o<s)t+=String.fromCharCode(n[o]);return t}function Ih(e){var t=e.length,n=new ArrayBuffer(t),s=new Uint8Array(n),o=-1;while(++o<t)s[o]=e.charCodeAt(o);return n}async function Ch(e){const t=JSON.stringify(e),n=Ih(t),s=await crypto.subtle.digest("SHA-1",n),o=Bh(s),a=btoa(o);return a}async function jh(e,t){let n,s=await Eh(t);if(!s){const e=await Th(t);s=e[0],n=e[1],s||(s=await Ch(n))}if(await ih(e,t,s));else{if(!n){const e=await Th(t);n=e[1]}await ch(e,n,t,s)}}async function Oh(e,t){let[n,s]=await Th(t);n||(n=await Ch(s)),await ch(e,s,t,n)}class Fh{constructor({dataSource:e=Op,locale:t=Fp,customEmoji:n=[]}={}){this.dataSource=e,this.locale=t,this._dbName=`emoji-picker-element-${this.locale}`,this._db=void 0,this._lazyUpdate=void 0,this._custom=wh(n),this._clear=this._clear.bind(this),this._ready=this._init()}async _init(){const e=this._db=await qp(this._dbName);Gp(this._dbName,this._clear);const t=this.dataSource,n=await rh(e);n?await Oh(e,t):this._lazyUpdate=jh(e,t)}async ready(){const e=async()=>(this._ready||(this._ready=this._init()),this._ready);await e(),this._db||await e()}async getEmojiByGroup(e){return hp(e),await this.ready(),Pp(await uh(this._db,e)).map(kh)}async getEmojiBySearchQuery(e){pp(e),await this.ready();const t=this._custom.search(e),n=Pp(await dh(this._db,e)).map(kh);return[...t,...n]}async getEmojiByShortcode(e){pp(e),await this.ready();const t=this._custom.byShortcode(e);return t||kh(await mh(this._db,e))}async getEmojiByUnicodeOrName(e){pp(e),await this.ready();const t=this._custom.byName(e);return t||kh(await ph(this._db,e))}async getPreferredSkinTone(){return await this.ready(),await hh(this._db,vp,Tp)||0}async setPreferredSkinTone(e){return hp(e),await this.ready(),fh(this._db,vp,Tp,e)}async incrementFavoriteEmojiCount(e){return pp(e),await this.ready(),gh(this._db,e)}async getTopFavoriteEmoji(e){return hp(e),await this.ready(),(await _h(this._db,this._custom,e)).map(kh)}set customEmoji(e){this._custom=wh(e)}get customEmoji(){return this._custom.all}async _shutdown(){await this.ready();try{await this._lazyUpdate}catch(e){}}_clear(){this._db=this._ready=this._lazyUpdate=void 0}async close(){await this._shutdown(),await Xp(this._dbName)}async delete(){await this._shutdown(),await Yp(this._dbName)}}function Lh(){}function Ph(e){return e()}function Dh(){return Object.create(null)}function Hh(e){e.forEach(Ph)}function Nh(e){return"function"===typeof e}function $h(e,t){return e!=e?t==t:e!==t||e&&"object"===typeof e||"function"===typeof e}let zh,Vh;function qh(e,t){return zh||(zh=document.createElement("a")),zh.href=t,e===zh.href}function Uh(e){return 0===Object.keys(e).length}function Xh(e){return e&&Nh(e.destroy)?e.destroy:Lh}function Yh(e,t){e.appendChild(t)}function Gh(e,t,n){e.insertBefore(t,n||null)}function Kh(e){e.parentNode.removeChild(e)}function Zh(e){return document.createElement(e)}function Wh(e){return document.createTextNode(e)}function Qh(e,t,n,s){return e.addEventListener(t,n,s),()=>e.removeEventListener(t,n,s)}function Jh(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function ef(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function tf(e,t){e.value=null==t?"":t}function nf(e,t,n,s){null===n?e.style.removeProperty(t):e.style.setProperty(t,n,s?"important":"")}function sf(e){Vh=e}const of=[],af=[],rf=[],lf=[],cf=Promise.resolve();let uf=!1;function df(){uf||(uf=!0,cf.then(gf))}function mf(){return df(),cf}function pf(e){rf.push(e)}const hf=new Set;let ff=0;function gf(){const e=Vh;do{while(ff<of.length){const e=of[ff];ff++,sf(e),_f(e.$$)}sf(null),of.length=0,ff=0;while(af.length)af.pop()();for(let e=0;e<rf.length;e+=1){const t=rf[e];hf.has(t)||(hf.add(t),t())}rf.length=0}while(of.length);while(lf.length)lf.pop()();uf=!1,hf.clear(),sf(e)}function _f(e){if(null!==e.fragment){e.update(),Hh(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(pf)}}const vf=new Set;function bf(e,t){e&&e.i&&(vf.delete(e),e.i(t))}const yf="undefined"!==typeof window?window:"undefined"!==typeof globalThis?globalThis:n.g;function xf(e,t){e.d(1),t.delete(e.key)}function wf(e,t,n,s,o,a,r,i,l,c,u,d){let m=e.length,p=a.length,h=m;const f={};while(h--)f[e[h].key]=h;const g=[],_=new Map,v=new Map;h=p;while(h--){const e=d(o,a,h),i=n(e);let l=r.get(i);l?s&&l.p(e,t):(l=c(i,e),l.c()),_.set(i,g[h]=l),i in f&&v.set(i,Math.abs(h-f[i]))}const b=new Set,y=new Set;function x(e){bf(e,1),e.m(i,u),r.set(e.key,e),u=e.first,p--}while(m&&p){const t=g[p-1],n=e[m-1],s=t.key,o=n.key;t===n?(u=t.first,m--,p--):_.has(o)?!r.has(s)||b.has(s)?x(t):y.has(o)?m--:v.get(s)>v.get(o)?(y.add(s),x(t)):(b.add(o),m--):(l(n,r),m--)}while(m--){const t=e[m];_.has(t.key)||l(t,r)}while(p)x(g[p-1]);return g}function kf(e,t,n,s){const{fragment:o,on_mount:a,on_destroy:r,after_update:i}=e.$$;o&&o.m(t,n),s||pf((()=>{const t=a.map(Ph).filter(Nh);r?r.push(...t):Hh(t),e.$$.on_mount=[]})),i.forEach(pf)}function Sf(e,t){const n=e.$$;null!==n.fragment&&(Hh(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Mf(e,t){-1===e.$$.dirty[0]&&(of.push(e),df(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Af(e,t,n,s,o,a,r,i=[-1]){const l=Vh;sf(e);const c=e.$$={fragment:null,ctx:null,props:a,update:Lh,not_equal:o,bound:Dh(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(l?l.$$.context:[]),callbacks:Dh(),dirty:i,skip_bound:!1,root:t.target||l.$$.root};r&&r(c.root);let u=!1;c.ctx=n?n(e,t.props||{},((t,n,...s)=>{const a=s.length?s[0]:n;return c.ctx&&o(c.ctx[t],c.ctx[t]=a)&&(!c.skip_bound&&c.bound[t]&&c.bound[t](a),u&&Mf(e,t)),n})):[],c.update(),u=!0,Hh(c.before_update),c.fragment=!!s&&s(c.ctx),t.target&&(c.fragment&&c.fragment.c(),kf(e,t.target,void 0,void 0),gf()),sf(l)}class Rf{$destroy(){Sf(this,1),this.$destroy=Lh}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){this.$$set&&!Uh(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Ef=[[-1,"✨","custom"],[0,"😀","smileys-emotion"],[1,"👋","people-body"],[3,"🐱","animals-nature"],[4,"🍎","food-drink"],[5,"🏠️","travel-places"],[6,"⚽","activities"],[7,"📝","objects"],[8,"⛔️","symbols"],[9,"🏁","flags"]].map((([e,t,n])=>({id:e,emoji:t,name:n}))),Tf=Ef.slice(1),Bf=Ef[0],If=2,Cf=6,jf="function"===typeof requestIdleCallback?requestIdleCallback:setTimeout;function Of(e){return e.unicode.includes("‍")}const Ff={"🫠":14,"🥲":13.1,"🥻":12.1,"🥰":11,"🤩":5,"👱‍♀️":4,"🤣":3,"👁️‍🗨️":2,"😀":1,"😐️":.7,"😃":.6},Lf=1e3,Pf="🖐️",Df=8,Hf=["😊","😒","♥️","👍️","😍","😂","😭","☺️","😔","😩","😏","💕","🙌","😘"],Nf='"Twemoji Mozilla","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji","EmojiOne Color","Android Emoji",sans-serif',$f=(e,t)=>e<t?-1:e>t?1:0,zf=(e,t)=>{const n=document.createElement("canvas");n.width=n.height=1;const s=n.getContext("2d");return s.textBaseline="top",s.font=`100px ${Nf}`,s.fillStyle=t,s.scale(.01,.01),s.fillText(e,0,0),s.getImageData(0,0,1,1).data},Vf=(e,t)=>{const n=[...e].join(","),s=[...t].join(",");return n===s&&!n.startsWith("0,0,0,")};function qf(e){const t=zf(e,"#000"),n=zf(e,"#fff");return t&&n&&Vf(t,n)}function Uf(){const e=Object.entries(Ff);try{for(const[t,n]of e)if(qf(t))return n}catch(t){}return e[0][1]}const Xf=new Promise((e=>jf((()=>e(Uf()))))),Yf=new Map,Gf="️",Kf="\ud83c",Zf="‍",Wf=127995,Qf=57339;function Jf(e,t){if(0===t)return e;const n=e.indexOf(Zf);return-1!==n?e.substring(0,n)+String.fromCodePoint(Wf+t-1)+e.substring(n):(e.endsWith(Gf)&&(e=e.substring(0,e.length-1)),e+Kf+String.fromCodePoint(Qf+t-1))}function eg(e){e.preventDefault(),e.stopPropagation()}function tg(e,t,n){return t+=e?-1:1,t<0?t=n.length-1:t>=n.length&&(t=0),t}function ng(e,t){const n=new Set,s=[];for(const o of e){const e=t(o);n.has(e)||(n.add(e),s.push(o))}return s}function sg(e,t){const n=e=>{const n={};for(const s of e)"number"===typeof s.tone&&s.version<=t&&(n[s.tone]=s.unicode);return n};return e.map((({unicode:e,skins:t,shortcodes:s,url:o,name:a,category:r})=>({unicode:e,name:a,shortcodes:s,url:o,category:r,id:e||a,skins:t&&n(t),title:(s||[]).join(", ")})))}const og=requestAnimationFrame;let ag,rg="function"===typeof ResizeObserver;function ig(e,t){let n;return rg?(n=new ResizeObserver((e=>t(e[0].contentRect.width))),n.observe(e)):og((()=>t(e.getBoundingClientRect().width))),{destroy(){n&&n.disconnect()}}}function lg(e){{const t=document.createRange();return t.selectNode(e.firstChild),t.getBoundingClientRect().width}}function cg(e,t,n){for(const s of e){const e=n(s),o=lg(e);"undefined"===typeof ag&&(ag=lg(t));const a=o/1.8<ag;Yf.set(s.unicode,a)}}function ug(e){return ng(e,(e=>e))}const{Map:dg}=yf;function mg(e,t,n){const s=e.slice();return s[63]=t[n],s[65]=n,s}function pg(e,t,n){const s=e.slice();return s[66]=t[n],s[65]=n,s}function hg(e,t,n){const s=e.slice();return s[63]=t[n],s[65]=n,s}function fg(e,t,n){const s=e.slice();return s[69]=t[n],s}function gg(e,t,n){const s=e.slice();return s[72]=t[n],s[65]=n,s}function _g(e,t){let n,s,o,a,r,i,l,c=t[72]+"";return{key:e,first:null,c(){n=Zh("div"),s=Wh(c),Jh(n,"id",o="skintone-"+t[65]),Jh(n,"class",a="emoji hide-focus "+(t[65]===t[20]?"active":"")),Jh(n,"aria-selected",r=t[65]===t[20]),Jh(n,"role","option"),Jh(n,"title",i=t[0].skinTones[t[65]]),Jh(n,"tabindex","-1"),Jh(n,"aria-label",l=t[0].skinTones[t[65]]),this.first=n},m(e,t){Gh(e,n,t),Yh(n,s)},p(e,u){t=e,512&u[0]&&c!==(c=t[72]+"")&&ef(s,c),512&u[0]&&o!==(o="skintone-"+t[65])&&Jh(n,"id",o),1049088&u[0]&&a!==(a="emoji hide-focus "+(t[65]===t[20]?"active":""))&&Jh(n,"class",a),1049088&u[0]&&r!==(r=t[65]===t[20])&&Jh(n,"aria-selected",r),513&u[0]&&i!==(i=t[0].skinTones[t[65]])&&Jh(n,"title",i),513&u[0]&&l!==(l=t[0].skinTones[t[65]])&&Jh(n,"aria-label",l)},d(e){e&&Kh(n)}}}function vg(e,t){let n,s,o,a,r,i,l,c,u,d=t[69].emoji+"";function m(){return t[49](t[69])}return{key:e,first:null,c(){n=Zh("button"),s=Zh("div"),o=Wh(d),Jh(s,"class","nav-emoji emoji"),Jh(n,"role","tab"),Jh(n,"class","nav-button"),Jh(n,"aria-controls",a="tab-"+t[69].id),Jh(n,"aria-label",r=t[0].categories[t[69].name]),Jh(n,"aria-selected",i=!t[4]&&t[13].id===t[69].id),Jh(n,"title",l=t[0].categories[t[69].name]),this.first=n},m(e,t){Gh(e,n,t),Yh(n,s),Yh(s,o),c||(u=Qh(n,"click",m),c=!0)},p(e,s){t=e,4096&s[0]&&d!==(d=t[69].emoji+"")&&ef(o,d),4096&s[0]&&a!==(a="tab-"+t[69].id)&&Jh(n,"aria-controls",a),4097&s[0]&&r!==(r=t[0].categories[t[69].name])&&Jh(n,"aria-label",r),12304&s[0]&&i!==(i=!t[4]&&t[13].id===t[69].id)&&Jh(n,"aria-selected",i),4097&s[0]&&l!==(l=t[0].categories[t[69].name])&&Jh(n,"title",l)},d(e){e&&Kh(n),c=!1,u()}}}function bg(e){let t,n;return{c(){t=Zh("img"),Jh(t,"class","custom-emoji"),qh(t.src,n=e[63].url)||Jh(t,"src",n),Jh(t,"alt",""),Jh(t,"loading","lazy")},m(e,n){Gh(e,t,n)},p(e,s){32768&s[0]&&!qh(t.src,n=e[63].url)&&Jh(t,"src",n)},d(e){e&&Kh(t)}}}function yg(e){let t,n=e[27](e[63],e[8])+"";return{c(){t=Wh(n)},m(e,n){Gh(e,t,n)},p(e,s){33024&s[0]&&n!==(n=e[27](e[63],e[8])+"")&&ef(t,n)},d(e){e&&Kh(t)}}}function xg(e,t){let n,s,o,a,r,i,l;function c(e,t){return e[63].unicode?yg:bg}let u=c(t),d=u(t);return{key:e,first:null,c(){n=Zh("button"),d.c(),Jh(n,"role",s=t[4]?"option":"menuitem"),Jh(n,"aria-selected",o=t[4]?t[65]==t[5]:""),Jh(n,"aria-label",a=t[28](t[63],t[8])),Jh(n,"title",r=t[63].title),Jh(n,"class",i="emoji "+(t[4]&&t[65]===t[5]?"active":"")),Jh(n,"id",l="emo-"+t[63].id),this.first=n},m(e,t){Gh(e,n,t),d.m(n,null)},p(e,m){t=e,u===(u=c(t))&&d?d.p(t,m):(d.d(1),d=u(t),d&&(d.c(),d.m(n,null))),16&m[0]&&s!==(s=t[4]?"option":"menuitem")&&Jh(n,"role",s),32816&m[0]&&o!==(o=t[4]?t[65]==t[5]:"")&&Jh(n,"aria-selected",o),33024&m[0]&&a!==(a=t[28](t[63],t[8]))&&Jh(n,"aria-label",a),32768&m[0]&&r!==(r=t[63].title)&&Jh(n,"title",r),32816&m[0]&&i!==(i="emoji "+(t[4]&&t[65]===t[5]?"active":""))&&Jh(n,"class",i),32768&m[0]&&l!==(l="emo-"+t[63].id)&&Jh(n,"id",l)},d(e){e&&Kh(n),d.d()}}}function wg(e,t){let n,s,o,a,r,i,l,c,u=(t[4]?t[0].searchResultsLabel:t[66].category?t[66].category:t[15].length>1?t[0].categories.custom:t[0].categories[t[13].name])+"",d=[],m=new dg,p=t[66].emojis;const h=e=>e[63].id;for(let f=0;f<p.length;f+=1){let e=hg(t,p,f),n=h(e);m.set(n,d[f]=xg(n,e))}return{key:e,first:null,c(){n=Zh("div"),s=Wh(u),r=Zh("div");for(let e=0;e<d.length;e+=1)d[e].c();Jh(n,"id",o="menu-label-"+t[65]),Jh(n,"class",a="category "+(1===t[15].length&&""===t[15][0].category?"gone":"")),Jh(n,"aria-hidden","true"),Jh(r,"class","emoji-menu"),Jh(r,"role",i=t[4]?"listbox":"menu"),Jh(r,"aria-labelledby",l="menu-label-"+t[65]),Jh(r,"id",c=t[4]?"search-results":""),this.first=n},m(e,t){Gh(e,n,t),Yh(n,s),Gh(e,r,t);for(let n=0;n<d.length;n+=1)d[n].m(r,null)},p(e,f){t=e,40977&f[0]&&u!==(u=(t[4]?t[0].searchResultsLabel:t[66].category?t[66].category:t[15].length>1?t[0].categories.custom:t[0].categories[t[13].name])+"")&&ef(s,u),32768&f[0]&&o!==(o="menu-label-"+t[65])&&Jh(n,"id",o),32768&f[0]&&a!==(a="category "+(1===t[15].length&&""===t[15][0].category?"gone":""))&&Jh(n,"class",a),402686256&f[0]&&(p=t[66].emojis,d=wf(d,f,h,1,t,p,m,r,xf,xg,null,hg)),16&f[0]&&i!==(i=t[4]?"listbox":"menu")&&Jh(r,"role",i),32768&f[0]&&l!==(l="menu-label-"+t[65])&&Jh(r,"aria-labelledby",l),16&f[0]&&c!==(c=t[4]?"search-results":"")&&Jh(r,"id",c)},d(e){e&&Kh(n),e&&Kh(r);for(let t=0;t<d.length;t+=1)d[t].d()}}}function kg(e){let t,n;return{c(){t=Zh("img"),Jh(t,"class","custom-emoji"),qh(t.src,n=e[63].url)||Jh(t,"src",n),Jh(t,"alt",""),Jh(t,"loading","lazy")},m(e,n){Gh(e,t,n)},p(e,s){1024&s[0]&&!qh(t.src,n=e[63].url)&&Jh(t,"src",n)},d(e){e&&Kh(t)}}}function Sg(e){let t,n=e[27](e[63],e[8])+"";return{c(){t=Wh(n)},m(e,n){Gh(e,t,n)},p(e,s){1280&s[0]&&n!==(n=e[27](e[63],e[8])+"")&&ef(t,n)},d(e){e&&Kh(t)}}}function Mg(e,t){let n,s,o,a;function r(e,t){return e[63].unicode?Sg:kg}let i=r(t),l=i(t);return{key:e,first:null,c(){n=Zh("button"),l.c(),Jh(n,"role","menuitem"),Jh(n,"aria-label",s=t[28](t[63],t[8])),Jh(n,"title",o=t[63].title),Jh(n,"class","emoji"),Jh(n,"id",a="fav-"+t[63].id),this.first=n},m(e,t){Gh(e,n,t),l.m(n,null)},p(e,c){t=e,i===(i=r(t))&&l?l.p(t,c):(l.d(1),l=i(t),l&&(l.c(),l.m(n,null))),1280&c[0]&&s!==(s=t[28](t[63],t[8]))&&Jh(n,"aria-label",s),1024&c[0]&&o!==(o=t[63].title)&&Jh(n,"title",o),1024&c[0]&&a!==(a="fav-"+t[63].id)&&Jh(n,"id",a)},d(e){e&&Kh(n),l.d()}}}function Ag(e){let t,n,s,o,a,r,i,l,c,u,d,m,p,h,f,g,_,v,b,y,x,w,k,S,M,A,R,E,T,B,I,C,j,O,F,L,P,D,H,N,$,z,V,q,U=e[0].searchLabel+"",X=e[0].searchDescription+"",Y=e[0].skinToneDescription+"",G=[],K=new dg,Z=[],W=new dg,Q=[],J=new dg,ee=[],te=new dg,ne=e[9];const se=e=>e[72];for(let ue=0;ue<ne.length;ue+=1){let t=gg(e,ne,ue),n=se(t);K.set(n,G[ue]=_g(n,t))}let oe=e[12];const ae=e=>e[69].id;for(let ue=0;ue<oe.length;ue+=1){let t=fg(e,oe,ue),n=ae(t);W.set(n,Z[ue]=vg(n,t))}let re=e[15];const ie=e=>e[66].category;for(let ue=0;ue<re.length;ue+=1){let t=pg(e,re,ue),n=ie(t);J.set(n,Q[ue]=wg(n,t))}let le=e[10];const ce=e=>e[63].id;for(let ue=0;ue<le.length;ue+=1){let t=mg(e,le,ue),n=ce(t);te.set(n,ee[ue]=Mg(n,t))}return{c(){t=Zh("section"),n=Zh("div"),s=Zh("div"),o=Zh("div"),a=Zh("input"),c=Zh("label"),u=Wh(U),d=Zh("span"),m=Wh(X),p=Zh("div"),h=Zh("button"),f=Wh(e[21]),v=Zh("span"),b=Wh(Y),y=Zh("div");for(let e=0;e<G.length;e+=1)G[e].c();M=Zh("div");for(let e=0;e<Z.length;e+=1)Z[e].c();R=Zh("div"),E=Zh("div"),T=Zh("div"),B=Wh(e[18]),C=Zh("div"),j=Zh("div");for(let e=0;e<Q.length;e+=1)Q[e].c();D=Zh("div");for(let e=0;e<ee.length;e+=1)ee[e].c();$=Zh("button"),$.textContent="😀",Jh(n,"class","pad-top"),Jh(a,"id","search"),Jh(a,"class","search"),Jh(a,"type","search"),Jh(a,"role","combobox"),Jh(a,"enterkeyhint","search"),Jh(a,"placeholder",r=e[0].searchLabel),Jh(a,"autocapitalize","none"),Jh(a,"autocomplete","off"),Jh(a,"spellcheck","true"),Jh(a,"aria-expanded",i=!(!e[4]||!e[1].length)),Jh(a,"aria-controls","search-results"),Jh(a,"aria-describedby","search-description"),Jh(a,"aria-autocomplete","list"),Jh(a,"aria-activedescendant",l=e[26]?`emo-${e[26]}`:""),Jh(c,"class","sr-only"),Jh(c,"for","search"),Jh(d,"id","search-description"),Jh(d,"class","sr-only"),Jh(o,"class","search-wrapper"),Jh(h,"id","skintone-button"),Jh(h,"class",g="emoji "+(e[6]?"hide-focus":"")),Jh(h,"aria-label",e[23]),Jh(h,"title",e[23]),Jh(h,"aria-describedby","skintone-description"),Jh(h,"aria-haspopup","listbox"),Jh(h,"aria-expanded",e[6]),Jh(h,"aria-controls","skintone-list"),Jh(p,"class",_="skintone-button-wrapper "+(e[19]?"expanded":"")),Jh(v,"id","skintone-description"),Jh(v,"class","sr-only"),Jh(y,"id","skintone-list"),Jh(y,"class",x="skintone-list "+(e[6]?"":"hidden no-animate")),nf(y,"transform","translateY("+(e[6]?0:"calc(-1 * var(--num-skintones) * var(--total-emoji-size))")+")"),Jh(y,"role","listbox"),Jh(y,"aria-label",w=e[0].skinTonesLabel),Jh(y,"aria-activedescendant",k="skintone-"+e[20]),Jh(y,"aria-hidden",S=!e[6]),Jh(s,"class","search-row"),Jh(M,"class","nav"),Jh(M,"role","tablist"),nf(M,"grid-template-columns","repeat("+e[12].length+", 1fr)"),Jh(M,"aria-label",A=e[0].categoriesLabel),Jh(E,"class","indicator"),nf(E,"transform","translateX("+(e[24]?-1:1)*e[11]*100+"%)"),Jh(R,"class","indicator-wrapper"),Jh(T,"class",I="message "+(e[18]?"":"gone")),Jh(T,"role","alert"),Jh(T,"aria-live","polite"),Jh(C,"class",O="tabpanel "+(!e[14]||e[18]?"gone":"")),Jh(C,"role",F=e[4]?"region":"tabpanel"),Jh(C,"aria-label",L=e[4]?e[0].searchResultsLabel:e[0].categories[e[13].name]),Jh(C,"id",P=e[4]?"":`tab-${e[13].id}`),Jh(C,"tabindex","0"),Jh(D,"class",H="favorites emoji-menu "+(e[18]?"gone":"")),Jh(D,"role","menu"),Jh(D,"aria-label",N=e[0].favoritesLabel),nf(D,"padding-inline-end",e[25]+"px"),Jh($,"aria-hidden","true"),Jh($,"tabindex","-1"),Jh($,"class","abs-pos hidden emoji"),Jh(t,"class","picker"),Jh(t,"aria-label",z=e[0].regionLabel),Jh(t,"style",e[22])},m(r,i){Gh(r,t,i),Yh(t,n),Yh(t,s),Yh(s,o),Yh(o,a),tf(a,e[2]),Yh(o,c),Yh(c,u),Yh(o,d),Yh(d,m),Yh(s,p),Yh(p,h),Yh(h,f),Yh(s,v),Yh(v,b),Yh(s,y);for(let e=0;e<G.length;e+=1)G[e].m(y,null);e[48](y),Yh(t,M);for(let e=0;e<Z.length;e+=1)Z[e].m(M,null);Yh(t,R),Yh(R,E),Yh(t,T),Yh(T,B),Yh(t,C),Yh(C,j);for(let e=0;e<Q.length;e+=1)Q[e].m(j,null);e[50](C),Yh(t,D);for(let e=0;e<ee.length;e+=1)ee[e].m(D,null);Yh(t,$),e[51]($),e[52](t),V||(q=[Qh(a,"input",e[47]),Qh(a,"keydown",e[30]),Qh(h,"click",e[35]),Qh(y,"focusout",e[38]),Qh(y,"click",e[34]),Qh(y,"keydown",e[36]),Qh(y,"keyup",e[37]),Qh(M,"keydown",e[32]),Xh(e[29].call(null,j)),Qh(C,"click",e[33]),Qh(D,"click",e[33])],V=!0)},p(e,n){1&n[0]&&r!==(r=e[0].searchLabel)&&Jh(a,"placeholder",r),18&n[0]&&i!==(i=!(!e[4]||!e[1].length))&&Jh(a,"aria-expanded",i),67108864&n[0]&&l!==(l=e[26]?`emo-${e[26]}`:"")&&Jh(a,"aria-activedescendant",l),4&n[0]&&tf(a,e[2]),1&n[0]&&U!==(U=e[0].searchLabel+"")&&ef(u,U),1&n[0]&&X!==(X=e[0].searchDescription+"")&&ef(m,X),2097152&n[0]&&ef(f,e[21]),64&n[0]&&g!==(g="emoji "+(e[6]?"hide-focus":""))&&Jh(h,"class",g),8388608&n[0]&&Jh(h,"aria-label",e[23]),8388608&n[0]&&Jh(h,"title",e[23]),64&n[0]&&Jh(h,"aria-expanded",e[6]),524288&n[0]&&_!==(_="skintone-button-wrapper "+(e[19]?"expanded":""))&&Jh(p,"class",_),1&n[0]&&Y!==(Y=e[0].skinToneDescription+"")&&ef(b,Y),1049089&n[0]&&(ne=e[9],G=wf(G,n,se,1,e,ne,K,y,xf,_g,null,gg)),64&n[0]&&x!==(x="skintone-list "+(e[6]?"":"hidden no-animate"))&&Jh(y,"class",x),64&n[0]&&nf(y,"transform","translateY("+(e[6]?0:"calc(-1 * var(--num-skintones) * var(--total-emoji-size))")+")"),1&n[0]&&w!==(w=e[0].skinTonesLabel)&&Jh(y,"aria-label",w),1048576&n[0]&&k!==(k="skintone-"+e[20])&&Jh(y,"aria-activedescendant",k),64&n[0]&&S!==(S=!e[6])&&Jh(y,"aria-hidden",S),12305&n[0]|1&n[1]&&(oe=e[12],Z=wf(Z,n,ae,1,e,oe,W,M,xf,vg,null,fg)),4096&n[0]&&nf(M,"grid-template-columns","repeat("+e[12].length+", 1fr)"),1&n[0]&&A!==(A=e[0].categoriesLabel)&&Jh(M,"aria-label",A),16779264&n[0]&&nf(E,"transform","translateX("+(e[24]?-1:1)*e[11]*100+"%)"),262144&n[0]&&ef(B,e[18]),262144&n[0]&&I!==(I="message "+(e[18]?"":"gone"))&&Jh(T,"class",I),402694449&n[0]&&(re=e[15],Q=wf(Q,n,ie,1,e,re,J,j,xf,wg,null,pg)),278528&n[0]&&O!==(O="tabpanel "+(!e[14]||e[18]?"gone":""))&&Jh(C,"class",O),16&n[0]&&F!==(F=e[4]?"region":"tabpanel")&&Jh(C,"role",F),8209&n[0]&&L!==(L=e[4]?e[0].searchResultsLabel:e[0].categories[e[13].name])&&Jh(C,"aria-label",L),8208&n[0]&&P!==(P=e[4]?"":`tab-${e[13].id}`)&&Jh(C,"id",P),402654464&n[0]&&(le=e[10],ee=wf(ee,n,ce,1,e,le,te,D,xf,Mg,null,mg)),262144&n[0]&&H!==(H="favorites emoji-menu "+(e[18]?"gone":""))&&Jh(D,"class",H),1&n[0]&&N!==(N=e[0].favoritesLabel)&&Jh(D,"aria-label",N),33554432&n[0]&&nf(D,"padding-inline-end",e[25]+"px"),1&n[0]&&z!==(z=e[0].regionLabel)&&Jh(t,"aria-label",z),4194304&n[0]&&Jh(t,"style",e[22])},i:Lh,o:Lh,d(n){n&&Kh(t);for(let e=0;e<G.length;e+=1)G[e].d();e[48](null);for(let e=0;e<Z.length;e+=1)Z[e].d();for(let e=0;e<Q.length;e+=1)Q[e].d();e[50](null);for(let e=0;e<ee.length;e+=1)ee[e].d();e[51](null),e[52](null),V=!1,Hh(q)}}}function Rg(e,t,n){let s,o,a,r,i,l,c,u,d,m,{skinToneEmoji:p}=t,{i18n:h}=t,{database:f}=t,{customEmoji:g}=t,{customCategorySorting:_}=t,v=!0,b=[],y=[],x="",w="",k=!1,S=-1,M=!1,A=!1,R=0,E=0,T="",B=[],I=[],C=Df,j=!1,O=0,F=0,L=Tf,P=!1;const D=e=>{s.getRootNode().getElementById(e).focus()},H=(e,t)=>{s.dispatchEvent(new CustomEvent(e,{detail:t,bubbles:!0,composed:!0}))},N=(e,t)=>t&&e.skins&&e.skins[t]||e.unicode,$=(e,t)=>ug([e.name||N(e,t),...e.shortcodes||[]]).join(", "),z=e=>/^skintone-/.test(e.id);function V(e){return ig(e,(t=>{{const o=getComputedStyle(s),a=parseInt(o.getPropertyValue("--num-columns"),10),r="rtl"===o.getPropertyValue("direction"),i=e.parentElement.getBoundingClientRect().width,l=i-t;n(46,C=a),n(25,O=l),n(24,j=r)}}))}function q(e){const t=s.getRootNode(),a=e=>t.getElementById(`emo-${e.id}`);cg(e,o,a),n(1,b)}function U(e){return!e.unicode||!Of(e)||Yf.get(e.unicode)}async function X(e){const t=await Xf;return e.filter((({version:e})=>!e||e<=t))}async function Y(e){return sg(e,await Xf)}async function G(e){if("undefined"===typeof e)return[];const t=-1===e?g:await f.getEmojiByGroup(e);return Y(await X(t))}async function K(e){return Y(await X(await f.getEmojiBySearchQuery(e)))}function Z(e){if(!k||!b.length)return;const t=t=>{eg(e),n(5,S=tg(t,S,b))};switch(e.key){case"ArrowDown":return t(!1);case"ArrowUp":return t(!0);case"Enter":if(-1!==S)return eg(e),J(b[S].id);b.length&&n(5,S=0)}}function W(e){n(2,x=""),n(44,w=""),n(5,S=-1),n(11,F=L.findIndex((t=>t.id===e.id)))}function Q(e){const{target:t,key:n}=e,s=t=>{t&&(eg(e),t.focus())};switch(n){case"ArrowLeft":return s(t.previousSibling);case"ArrowRight":return s(t.nextSibling);case"Home":return s(t.parentElement.firstChild);case"End":return s(t.parentElement.lastChild)}}async function J(e){const t=await f.getEmojiByUnicodeOrName(e),n=[...b,...I].find((t=>t.id===e)),s=n.unicode&&N(n,R);await f.incrementFavoriteEmojiCount(e),H("emoji-click",{emoji:t,skinTone:R,...s&&{unicode:s},...n.name&&{name:n.name}})}async function ee(e){const{target:t}=e;if(!t.classList.contains("emoji"))return;eg(e);const n=t.id.substring(4);J(n)}async function te(e){const{target:t}=e;if(!z(t))return;eg(e);const s=parseInt(t.id.slice(9),10);n(8,R=s),n(6,M=!1),D("skintone-button"),H("skin-tone-change",{skinTone:s}),f.setPreferredSkinTone(s)}async function ne(e){n(6,M=!M),n(20,E=R),M&&(eg(e),og((()=>D(`skintone-${E}`))))}function se(e){if(!M)return;const t=async t=>{eg(e),n(20,E=t),await mf(),D(`skintone-${E}`)};switch(e.key){case"ArrowUp":return t(tg(!0,E,B));case"ArrowDown":return t(tg(!1,E,B));case"Home":return t(0);case"End":return t(B.length-1);case"Enter":return te(e);case"Escape":return eg(e),n(6,M=!1),D("skintone-button")}}function oe(e){if(M)switch(e.key){case" ":return te(e)}}async function ae(e){const{relatedTarget:t}=e;t&&z(t)||n(6,M=!1)}function re(){x=this.value,n(2,x)}function ie(e){af[e?"unshift":"push"]((()=>{i=e,n(7,i)}))}Xf.then((e=>{e||n(18,r=h.emojiUnsupportedMessage)}));const le=e=>W(e);function ce(e){af[e?"unshift":"push"]((()=>{a=e,n(3,a)}))}function ue(e){af[e?"unshift":"push"]((()=>{o=e,n(17,o)}))}function de(e){af[e?"unshift":"push"]((()=>{s=e,n(16,s)}))}return e.$$set=e=>{"skinToneEmoji"in e&&n(40,p=e.skinToneEmoji),"i18n"in e&&n(0,h=e.i18n),"database"in e&&n(39,f=e.database),"customEmoji"in e&&n(41,g=e.customEmoji),"customCategorySorting"in e&&n(42,_=e.customCategorySorting)},e.$$.update=()=>{if(1280&e.$$.dirty[1]&&g&&f&&n(39,f.customEmoji=g,f),1&e.$$.dirty[0]|256&e.$$.dirty[1]){async function t(){let e=!1;const t=setTimeout((()=>{e=!0,n(18,r=h.loadingMessage)}),Lf);try{await f.ready(),n(14,P=!0)}catch(s){console.error(s),n(18,r=h.networkErrorMessage)}finally{clearTimeout(t),e&&(e=!1,n(18,r=""))}}f&&t()}if(6144&e.$$.dirty[0]|1024&e.$$.dirty[1]&&(g&&g.length?n(12,L=[Bf,...Tf]):L!==Tf&&(F&&n(11,F--,F),n(12,L=Tf))),4&e.$$.dirty[0]&&jf((()=>{n(44,w=(x||"").trim()),n(5,S=-1)})),6144&e.$$.dirty[0]&&n(13,d=L[F]),24576&e.$$.dirty[0]|8192&e.$$.dirty[1]){async function s(){if(P){if(w.length>=If){const e=w,t=await K(e);e===w&&(n(1,b=t),n(4,k=!0))}else if(d){const e=d.id,t=await G(e);e===d.id&&(n(1,b=t),n(4,k=!1))}}else n(1,b=[]),n(4,k=!1)}s()}if(4112&e.$$.dirty[0]&&n(22,c=`\n  --font-family: ${Nf};\n  --num-groups: ${L.length}; \n  --indicator-opacity: ${k?0:1}; \n  --num-skintones: ${Cf};`),16384&e.$$.dirty[0]|256&e.$$.dirty[1]){async function o(){P&&n(8,R=await f.getPreferredSkinTone())}o()}if(512&e.$$.dirty[1]&&n(9,B=Array(Cf).fill().map(((e,t)=>Jf(p,t)))),768&e.$$.dirty[0]&&n(21,l=B[R]),257&e.$$.dirty[0]&&n(23,T=h.skinToneLabel.replace("{skinTone}",h.skinTones[R])),16384&e.$$.dirty[0]|256&e.$$.dirty[1]){async function v(){n(45,u=(await Promise.all(Hf.map((e=>f.getEmojiByUnicodeOrName(e))))).filter(Boolean))}P&&v()}if(16384&e.$$.dirty[0]|49408&e.$$.dirty[1]){async function E(){const e=await f.getTopFavoriteEmoji(C),t=await Y(ng([...e,...u],(e=>e.unicode||e.name)).slice(0,C));n(10,I=t)}P&&u&&E()}if(10&e.$$.dirty[0]){const j=b.filter((e=>e.unicode)).filter((e=>Of(e)&&!Yf.has(e.unicode)));j.length?og((()=>q(j))):(n(1,b=b.filter(U)),og((()=>{(a||{}).scrollTop=0})))}if(e.$$.dirty[0],e.$$.dirty[1],18&e.$$.dirty[0]|2048&e.$$.dirty[1]){let O=function(){if(k)return[{category:"",emojis:b}];const e=new Map;for(const t of b){const n=t.category||"";let s=e.get(n);s||(s=[],e.set(n,s)),s.push(t)}return[...e.entries()].map((([e,t])=>({category:e,emojis:t}))).sort(((e,t)=>_(e.category,t.category)))};n(15,y=O())}34&e.$$.dirty[0]&&n(26,m=-1!==S&&b[S].id),192&e.$$.dirty[0]&&(M?i.addEventListener("transitionend",(()=>{n(19,A=!0)}),{once:!0}):n(19,A=!1))},[h,b,x,a,k,S,M,i,R,B,I,F,L,d,P,y,s,o,r,A,E,l,c,T,j,O,m,N,$,V,Z,W,Q,ee,te,ne,se,oe,ae,f,p,g,_,v,w,u,C,re,ie,le,ce,ue,de]}class Eg extends Rf{constructor(e){super(),Af(this,e,Rg,Ag,$h,{skinToneEmoji:40,i18n:0,database:39,customEmoji:41,customCategorySorting:42},null,[-1,-1,-1])}}const Tg="https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",Bg="en";var Ig={categoriesLabel:"Categories",emojiUnsupportedMessage:"Your browser does not support color emoji.",favoritesLabel:"Favorites",loadingMessage:"Loading…",networkErrorMessage:"Could not load emoji.",regionLabel:"Emoji picker",searchDescription:"When search results are available, press up or down to select and enter to choose.",searchLabel:"Search",searchResultsLabel:"Search results",skinToneDescription:"When expanded, press up or down to select and enter to choose.",skinToneLabel:"Choose a skin tone (currently {skinTone})",skinTonesLabel:"Skin tones",skinTones:["Default","Light","Medium-Light","Medium","Medium-Dark","Dark"],categories:{custom:"Custom","smileys-emotion":"Smileys and emoticons","people-body":"People and body","animals-nature":"Animals and nature","food-drink":"Food and drink","travel-places":"Travel and places",activities:"Activities",objects:"Objects",symbols:"Symbols",flags:"Flags"}};const Cg=["customEmoji","customCategorySorting","database","dataSource","i18n","locale","skinToneEmoji"];class jg extends HTMLElement{constructor(e){super(),this.attachShadow({mode:"open"});const t=document.createElement("style");t.textContent=":host{--emoji-size:1.375rem;--emoji-padding:0.5rem;--category-emoji-size:var(--emoji-size);--category-emoji-padding:var(--emoji-padding);--indicator-height:3px;--input-border-radius:0.5rem;--input-border-size:1px;--input-font-size:1rem;--input-line-height:1.5;--input-padding:0.25rem;--num-columns:8;--outline-size:2px;--border-size:1px;--skintone-border-radius:1rem;--category-font-size:1rem;display:flex;width:min-content;height:400px}:host,:host(.light){--background:#fff;--border-color:#e0e0e0;--indicator-color:#385ac1;--input-border-color:#999;--input-font-color:#111;--input-placeholder-color:#999;--outline-color:#999;--category-font-color:#111;--button-active-background:#e6e6e6;--button-hover-background:#d9d9d9}:host(.dark){--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}@media (prefers-color-scheme:dark){:host{--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}}:host([hidden]){display:none}button{margin:0;padding:0;border:0;background:0 0;box-shadow:none;-webkit-tap-highlight-color:transparent}button::-moz-focus-inner{border:0}input{padding:0;margin:0;line-height:1.15;font-family:inherit}input[type=search]{-webkit-appearance:none}:focus{outline:var(--outline-color) solid var(--outline-size);outline-offset:calc(-1*var(--outline-size))}:host([data-js-focus-visible]) :focus:not([data-focus-visible-added]){outline:0}:focus:not(:focus-visible){outline:0}.hide-focus{outline:0}*{box-sizing:border-box}.picker{contain:content;display:flex;flex-direction:column;background:var(--background);border:var(--border-size) solid var(--border-color);width:100%;height:100%;overflow:hidden;--total-emoji-size:calc(var(--emoji-size) + (2 * var(--emoji-padding)));--total-category-emoji-size:calc(var(--category-emoji-size) + (2 * var(--category-emoji-padding)))}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.hidden{opacity:0;pointer-events:none}.abs-pos{position:absolute;left:0;top:0}.gone{display:none!important}.skintone-button-wrapper,.skintone-list{background:var(--background);z-index:3}.skintone-button-wrapper.expanded{z-index:1}.skintone-list{position:absolute;inset-inline-end:0;top:0;z-index:2;overflow:visible;border-bottom:var(--border-size) solid var(--border-color);border-radius:0 0 var(--skintone-border-radius) var(--skintone-border-radius);will-change:transform;transition:transform .2s ease-in-out;transform-origin:center 0}@media (prefers-reduced-motion:reduce){.skintone-list{transition-duration:.001s}}@supports not (inset-inline-end:0){.skintone-list{right:0}}.skintone-list.no-animate{transition:none}.tabpanel{overflow-y:auto;-webkit-overflow-scrolling:touch;will-change:transform;min-height:0;flex:1;contain:content}.emoji-menu{display:grid;grid-template-columns:repeat(var(--num-columns),var(--total-emoji-size));justify-content:space-around;align-items:flex-start;width:100%}.category{padding:var(--emoji-padding);font-size:var(--category-font-size);color:var(--category-font-color)}.custom-emoji,.emoji,button.emoji{height:var(--total-emoji-size);width:var(--total-emoji-size)}.emoji,button.emoji{font-size:var(--emoji-size);display:flex;align-items:center;justify-content:center;border-radius:100%;line-height:1;overflow:hidden;font-family:var(--font-family);cursor:pointer}@media (hover:hover) and (pointer:fine){.emoji:hover,button.emoji:hover{background:var(--button-hover-background)}}.emoji.active,.emoji:active,button.emoji.active,button.emoji:active{background:var(--button-active-background)}.custom-emoji{padding:var(--emoji-padding);object-fit:contain;pointer-events:none;background-repeat:no-repeat;background-position:center center;background-size:var(--emoji-size) var(--emoji-size)}.nav,.nav-button{align-items:center}.nav{display:grid;justify-content:space-between;contain:content}.nav-button{display:flex;justify-content:center}.nav-emoji{font-size:var(--category-emoji-size);width:var(--total-category-emoji-size);height:var(--total-category-emoji-size)}.indicator-wrapper{display:flex;border-bottom:1px solid var(--border-color)}.indicator{width:calc(100%/var(--num-groups));height:var(--indicator-height);opacity:var(--indicator-opacity);background-color:var(--indicator-color);will-change:transform,opacity;transition:opacity .1s linear,transform .25s ease-in-out}@media (prefers-reduced-motion:reduce){.indicator{will-change:opacity;transition:opacity .1s linear}}.pad-top,input.search{background:var(--background);width:100%}.pad-top{height:var(--emoji-padding);z-index:3}.search-row{display:flex;align-items:center;position:relative;padding-inline-start:var(--emoji-padding);padding-bottom:var(--emoji-padding)}.search-wrapper{flex:1;min-width:0}input.search{padding:var(--input-padding);border-radius:var(--input-border-radius);border:var(--input-border-size) solid var(--input-border-color);color:var(--input-font-color);font-size:var(--input-font-size);line-height:var(--input-line-height)}input.search::placeholder{color:var(--input-placeholder-color)}.favorites{display:flex;flex-direction:row;border-top:var(--border-size) solid var(--border-color);contain:content}.message{padding:var(--emoji-padding)}",this.shadowRoot.appendChild(t),this._ctx={locale:Bg,dataSource:Tg,skinToneEmoji:Pf,customCategorySorting:$f,customEmoji:null,i18n:Ig,...e};for(const n of Cg)"database"!==n&&Object.prototype.hasOwnProperty.call(this,n)&&(this._ctx[n]=this[n],delete this[n]);this._dbFlush()}connectedCallback(){this._cmp=new Eg({target:this.shadowRoot,props:this._ctx})}disconnectedCallback(){this._cmp.$destroy(),this._cmp=void 0;const{database:e}=this._ctx;e&&e.close().catch((e=>console.error(e)))}static get observedAttributes(){return["locale","data-source","skin-tone-emoji"]}attributeChangedCallback(e,t,n){this._set(e.replace(/-([a-z])/g,((e,t)=>t.toUpperCase())),n)}_set(e,t){this._ctx[e]=t,this._cmp&&this._cmp.$set({[e]:t}),["locale","dataSource"].includes(e)&&this._dbFlush()}_dbCreate(){const{locale:e,dataSource:t,database:n}=this._ctx;n&&n.locale===e&&n.dataSource===t||this._set("database",new Fh({locale:e,dataSource:t}))}_dbFlush(){Promise.resolve().then((()=>this._dbCreate()))}}const Og={};for(const Gw of Cg)Og[Gw]={get(){return"database"===Gw&&this._dbCreate(),this._ctx[Gw]},set(e){if("database"===Gw)throw new Error("database is read-only");this._set(Gw,e)}};function Fg(e,t){while(e&&!e.querySelector(t)){e=e.parentNode;const n=e.querySelector(t);if(n)return n}return null}Object.defineProperties(jg.prototype,Og),customElements.get("emoji-picker")||customElements.define("emoji-picker",jg);const Lg={name:"EmojiPickerContainer",components:{SvgIcon:Ri},props:{emojiOpened:{type:Boolean,default:!1},emojiReaction:{type:Boolean,default:!1},positionTop:{type:Boolean,default:!1},positionRight:{type:Boolean,default:!1},messageId:{type:String,default:""},emojiDataSource:{type:String,default:void 0}},emits:["add-emoji","open-emoji"],data(){return{emojiPickerHeight:320,emojiPickerTop:0,emojiPickerRight:""}},watch:{emojiOpened(e){e&&setTimeout((()=>{this.addCustomStyling(),this.$refs.emojiPicker.shadowRoot.addEventListener("emoji-click",(({detail:e})=>{this.$emit("add-emoji",{unicode:e.unicode})}))}),0)}},methods:{addCustomStyling(){const e=".picker {\n\t\t\t\tborder: none;\n\t\t\t}",t=".nav {\n\t\t\t\toverflow-x: auto;\n\t\t\t}",n=".search-wrapper {\n\t\t\t\tpadding-right: 2px;\n\t\t\t\tpadding-left: 2px;\n\t\t\t}",s="input.search {\n\t\t\t\theight: 32px;\n\t\t\t\tfont-size: 14px;\n\t\t\t\tborder-radius: 10rem;\n\t\t\t\tborder: var(--chat-border-style);\n\t\t\t\tpadding: 5px 10px;\n\t\t\t\toutline: none;\n\t\t\t\tbackground: var(--chat-bg-color-input);\n\t\t\t\tcolor: var(--chat-color);\n\t\t\t}",o=document.createElement("style");o.textContent=e+t+n+s,this.$refs.emojiPicker.shadowRoot.appendChild(o)},openEmoji(e){this.$emit("open-emoji",!this.emojiOpened),this.setEmojiPickerPosition(e.clientY,e.view.innerWidth,e.view.innerHeight)},setEmojiPickerPosition(e,t,n){const s=t<500||n<700,o=Fg(this.$el,"#room-footer");if(o)if(s)this.emojiPickerRight=t/2-(this.positionTop?200:150)+"px",this.emojiPickerTop=100,this.emojiPickerHeight=n-200;else{const t=o.getBoundingClientRect().top,n=t-e>this.emojiPickerHeight-50;this.emojiPickerTop=n?e+10:e-this.emojiPickerHeight-10,this.emojiPickerRight=this.positionTop?"0px":this.positionRight?"60px":""}else s&&(this.emojiPickerRight="-50px")}}},Pg={class:"vac-emoji-wrapper"};function Dg(e,t,n,s,o,a){const r=Is("svg-icon"),i=Is("emoji-picker");return Do(),Vo("div",Pg,[Zo("div",{class:ht(["vac-svg-button",{"vac-emoji-reaction":n.emojiReaction}]),onClick:t[0]||(t[0]=(...e)=>a.openEmoji&&a.openEmoji(...e))},[Hs(e.$slots,n.messageId?"emoji-picker-reaction-icon_"+n.messageId:"emoji-picker-icon",{},(()=>[Wo(r,{name:"emoji",param:n.emojiReaction?"reaction":""},null,8,["param"])]))],2),n.emojiOpened?(Do(),qo(Br,{key:0,name:"vac-slide-up",appear:""},{default:Fn((()=>[Zo("div",{class:ht(["vac-emoji-picker",{"vac-picker-reaction":n.emojiReaction}]),style:ut({height:`${o.emojiPickerHeight}px`,top:n.positionTop?o.emojiPickerHeight:`${o.emojiPickerTop}px`,right:o.emojiPickerRight,display:o.emojiPickerTop||!n.emojiReaction?"initial":"none"})},[n.emojiOpened?(Do(),qo(i,{key:0,ref:"emojiPicker","data-source":n.emojiDataSource},null,8,["data-source"])):na("",!0)],6)])),_:1})):na("",!0)])}var Hg=mi(Lg,[["render",Dg]]);const Ng={name:"RoomFiles",components:{Loader:xi,SvgIcon:Ri},props:{file:{type:Object,required:!0},index:{type:Number,required:!0}},emits:["remove-file"],computed:{isImage(){return wm(this.file)},isVideo(){return km(this.file)}}},$g={class:"vac-room-file-container"},zg=["src"],Vg={class:"vac-text-ellipsis"},qg={key:0,class:"vac-text-ellipsis vac-text-extension"};function Ug(e,t,n,s,o,a){const r=Is("loader"),i=Is("svg-icon");return Do(),Vo("div",$g,[Wo(r,{show:n.file.loading,type:"room-file"},Ds({_:2},[Ps(e.$slots,((t,n)=>({name:n,fn:Fn((t=>[Hs(e.$slots,n,ft(Jo(t)))]))})))]),1032,["show"]),Zo("div",{class:"vac-svg-button vac-icon-remove",onClick:t[0]||(t[0]=t=>e.$emit("remove-file",n.index))},[Hs(e.$slots,"image-close-icon",{},(()=>[Wo(i,{name:"close",param:"image"})]))]),a.isImage?(Do(),Vo("div",{key:0,class:ht(["vac-message-image",{"vac-blur-loading":n.file.loading}]),style:ut({"background-image":`url('${n.file.localUrl||n.file.url}')`})},null,6)):a.isVideo?(Do(),Vo("video",{key:1,controls:"",class:ht({"vac-blur-loading":n.file.loading})},[Zo("source",{src:n.file.localUrl||n.file.url},null,8,zg)],2)):(Do(),Vo("div",{key:2,class:ht(["vac-file-container",{"vac-blur-loading":n.file.loading}])},[Zo("div",null,[Hs(e.$slots,"file-icon",{},(()=>[Wo(i,{name:"file"})]))]),Zo("div",Vg,gt(n.file.name),1),n.file.extension?(Do(),Vo("div",qg,gt(n.file.extension),1)):na("",!0)],2))])}var Xg=mi(Ng,[["render",Ug]]);const Yg={name:"RoomFiles",components:{SvgIcon:Ri,RoomFile:Xg},props:{files:{type:Array,required:!0}},emits:["remove-file","reset-message"],computed:{}},Gg={key:0,class:"vac-room-files-container"},Kg={class:"vac-files-box"},Zg={class:"vac-icon-close"};function Wg(e,t,n,s,o,a){const r=Is("room-file"),i=Is("svg-icon");return Do(),qo(Br,{name:"vac-slide-up"},{default:Fn((()=>[n.files.length?(Do(),Vo("div",Gg,[Zo("div",Kg,[(Do(!0),Vo(Co,null,Ps(n.files,((n,s)=>(Do(),Vo("div",{key:s},[Wo(r,{file:n,index:s,onRemoveFile:t[0]||(t[0]=t=>e.$emit("remove-file",t))},Ds({_:2},[Ps(e.$slots,((t,n)=>({name:n,fn:Fn((t=>[Hs(e.$slots,n,ft(Jo(t)))]))})))]),1032,["file","index"])])))),128))]),Zo("div",Zg,[Zo("div",{class:"vac-svg-button",onClick:t[1]||(t[1]=t=>e.$emit("reset-message"))},[Hs(e.$slots,"files-close-icon",{},(()=>[Wo(i,{name:"close-outline"})]))])])])):na("",!0)])),_:3})}var Qg=mi(Yg,[["render",Wg]]);const Jg={props:{percentage:{type:Number,default:0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["hover-audio-progress","change-linehead"],data(){return{isMouseDown:!1}},methods:{onMouseDown(e){if(this.messageSelectionEnabled)return;this.isMouseDown=!0;const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)},onMouseUp(e){if(this.messageSelectionEnabled)return;this.isMouseDown=!1,document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mousemove",this.onMouseMove);const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t)},onMouseMove(e){if(this.messageSelectionEnabled)return;const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t)},calculateLineHeadPosition(e,t){const n=t.getBoundingClientRect().width,s=t.getBoundingClientRect().left;let o=(e.clientX-s)/n;return o=o<0?0:o,o=o>1?1:o,o}}},e_={class:"vac-player-progress"},t_={class:"vac-line-container"};function n_(e,t,n,s,o,a){return Do(),Vo("div",{ref:"progress",class:"vac-player-bar",onMousedown:t[0]||(t[0]=(...e)=>a.onMouseDown&&a.onMouseDown(...e)),onMouseover:t[1]||(t[1]=t=>e.$emit("hover-audio-progress",!0)),onMouseout:t[2]||(t[2]=t=>e.$emit("hover-audio-progress",!1))},[Zo("div",e_,[Zo("div",t_,[Zo("div",{class:"vac-line-progress",style:ut({width:`${n.percentage}%`})},null,4),Zo("div",{class:ht(["vac-line-dot",{"vac-line-dot__active":o.isMouseDown}]),style:ut({left:`${n.percentage}%`})},null,6)])])],544)}var s_=mi(Jg,[["render",n_]]);const o_={name:"AudioPlayer",components:{SvgIcon:Ri,AudioControl:s_},props:{messageId:{type:[String,Number],default:null},src:{type:String,default:null},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["hover-audio-progress","update-progress-time"],data(){return{isPlaying:!1,duration:this.convertTimeMMSS(0),playedTime:this.convertTimeMMSS(0),progress:0}},computed:{playerUniqId(){return`audio-player${this.messageId}`},audioSource(){return this.src?this.src:(this.resetProgress(),null)}},mounted(){this.player=this.$el.querySelector("#"+this.playerUniqId),this.player.addEventListener("ended",(()=>{this.isPlaying=!1})),this.player.addEventListener("loadeddata",(()=>{this.resetProgress(),this.duration=this.convertTimeMMSS(this.player.duration),this.updateProgressTime()})),this.player.addEventListener("timeupdate",this.onTimeUpdate)},methods:{convertTimeMMSS(e){return new Date(1e3*e).toISOString().substr(14,5)},playback(){!this.messageSelectionEnabled&&this.audioSource&&(this.isPlaying?this.player.pause():setTimeout((()=>this.player.play())),this.isPlaying=!this.isPlaying)},resetProgress(){this.isPlaying&&this.player.pause(),this.duration=this.convertTimeMMSS(0),this.playedTime=this.convertTimeMMSS(0),this.progress=0,this.isPlaying=!1,this.updateProgressTime()},onTimeUpdate(){this.playedTime=this.convertTimeMMSS(this.player.currentTime),this.progress=this.player.currentTime/this.player.duration*100,this.updateProgressTime()},onUpdateProgress(e){e&&(this.player.currentTime=e*this.player.duration)},updateProgressTime(){this.$emit("update-progress-time",this.progress>1?this.playedTime:this.duration)}}},a_={class:"vac-audio-player"},r_=["id","src"];function i_(e,t,n,s,o,a){const r=Is("svg-icon"),i=Is("audio-control");return Do(),Vo("div",null,[Zo("div",a_,[Zo("div",{class:"vac-svg-button",onClick:t[0]||(t[0]=(...e)=>a.playback&&a.playback(...e))},[o.isPlaying?Hs(e.$slots,"audio-pause-icon_"+n.messageId,{key:0},(()=>[Wo(r,{name:"audio-pause"})])):Hs(e.$slots,"audio-play-icon_"+n.messageId,{key:1},(()=>[Wo(r,{name:"audio-play"})]))]),Wo(i,{percentage:o.progress,"message-selection-enabled":n.messageSelectionEnabled,onChangeLinehead:a.onUpdateProgress,onHoverAudioProgress:t[1]||(t[1]=t=>e.$emit("hover-audio-progress",t))},null,8,["percentage","message-selection-enabled","onChangeLinehead"]),Zo("audio",{id:a.playerUniqId,src:a.audioSource},null,8,r_)])])}var l_=mi(o_,[["render",i_]]);const c_={name:"RoomMessageReply",components:{SvgIcon:Ri,FormatMessage:am,AudioPlayer:l_},props:{room:{type:Object,required:!0},messageReply:{type:Object,default:null},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0}},emits:["reset-message"],computed:{firstFile(){var e,t;return(null==(t=null==(e=this.messageReply)?void 0:e.files)?void 0:t.length)?this.messageReply.files[0]:{}},isImage(){return wm(this.firstFile)},isVideo(){return km(this.firstFile)},isAudio(){return Mm(this.firstFile)},isOtherFile(){var e,t;return(null==(t=null==(e=this.messageReply)?void 0:e.files)?void 0:t.length)&&!this.isAudio&&!this.isVideo&&!this.isImage}}},u_={key:0,class:"vac-reply-container"},d_={class:"vac-reply-box"},m_={class:"vac-reply-info"},p_={class:"vac-reply-username"},h_={class:"vac-reply-content"},f_=["src"],g_={key:1,controls:"",class:"vac-image-reply"},__=["src"],v_={key:3,class:"vac-image-reply vac-file-container"},b_={class:"vac-text-ellipsis"},y_={key:0,class:"vac-text-ellipsis vac-text-extension"},x_={class:"vac-icon-reply"};function w_(e,t,n,s,o,a){const r=Is("format-message"),i=Is("audio-player"),l=Is("svg-icon");return Do(),qo(Br,{name:"vac-slide-up"},{default:Fn((()=>[n.messageReply?(Do(),Vo("div",u_,[Zo("div",d_,[Zo("div",m_,[Zo("div",p_,gt(n.messageReply.username),1),Zo("div",h_,[Wo(r,{"message-id":n.messageReply._id,content:n.messageReply.content,users:n.room.users,"text-formatting":n.textFormatting,"link-options":n.linkOptions,reply:!0},null,8,["message-id","content","users","text-formatting","link-options"])])]),a.isImage?(Do(),Vo("img",{key:0,src:a.firstFile.url,class:"vac-image-reply"},null,8,f_)):a.isVideo?(Do(),Vo("video",g_,[Zo("source",{src:a.firstFile.url},null,8,__)])):a.isAudio?(Do(),qo(i,{key:2,src:a.firstFile.url,"message-selection-enabled":!1,class:"vac-audio-reply"},Ds({_:2},[Ps(e.$slots,((t,n)=>({name:n,fn:Fn((t=>[Hs(e.$slots,n,ft(Jo(t)))]))})))]),1032,["src"])):a.isOtherFile?(Do(),Vo("div",v_,[Zo("div",null,[Hs(e.$slots,"file-icon",{},(()=>[Wo(l,{name:"file"})]))]),Zo("div",b_,gt(a.firstFile.name),1),a.firstFile.extension?(Do(),Vo("div",y_,gt(a.firstFile.extension),1)):na("",!0)])):na("",!0)]),Zo("div",x_,[Zo("div",{class:"vac-svg-button",onClick:t[0]||(t[0]=t=>e.$emit("reset-message"))},[Hs(e.$slots,"reply-close-icon",{},(()=>[Wo(l,{name:"close-outline"})]))])])])):na("",!0)])),_:3})}var k_=mi(c_,[["render",w_]]);const S_={name:"RoomUsersTag",props:{filteredUsersTag:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-user-tag","activate-item"],data(){return{activeItem:null}},watch:{filteredUsersTag(e,t){t.length&&e.length===t.length||(this.activeItem=0)},selectItem(e){e&&this.$emit("select-user-tag",this.filteredUsersTag[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredUsersTag.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},M_={key:0,class:"vac-tags-container"},A_=["onMouseover","onClick"],R_={class:"vac-tags-info"},E_={class:"vac-tags-username"};function T_(e,t,n,s,o,a){return Do(),qo(Br,{name:"vac-slide-up"},{default:Fn((()=>[n.filteredUsersTag.length?(Do(),Vo("div",M_,[(Do(!0),Vo(Co,null,Ps(n.filteredUsersTag,((t,n)=>(Do(),Vo("div",{key:t._id,class:ht(["vac-tags-box",{"vac-tags-box-active":n===o.activeItem}]),onMouseover:e=>o.activeItem=n,onClick:n=>e.$emit("select-user-tag",t)},[Zo("div",R_,[t.avatar?(Do(),Vo("div",{key:0,class:"vac-avatar vac-tags-avatar",style:ut({"background-image":`url('${t.avatar}')`})},null,4)):na("",!0),Zo("div",E_,gt(t.username),1)])],42,A_)))),128))])):na("",!0)])),_:1})}var B_=mi(S_,[["render",T_]]);const I_={name:"RoomEmojis",props:{filteredEmojis:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-emoji","activate-item"],data(){return{activeItem:null}},watch:{filteredEmojis(e,t){t.length&&e.length===t.length||(this.activeItem=0)},selectItem(e){e&&this.$emit("select-emoji",this.filteredEmojis[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredEmojis.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},C_={key:0,class:"vac-emojis-container"},j_=["onMouseover","onClick"];function O_(e,t,n,s,o,a){return Do(),qo(Br,{name:"vac-slide-up"},{default:Fn((()=>[n.filteredEmojis.length?(Do(),Vo("div",C_,[(Do(!0),Vo(Co,null,Ps(n.filteredEmojis,((t,n)=>(Do(),Vo("div",{key:t,class:ht(["vac-emoji-element",{"vac-emoji-element-active":n===o.activeItem}]),onMouseover:e=>o.activeItem=n,onClick:n=>e.$emit("select-emoji",t)},gt(t),43,j_)))),128))])):na("",!0)])),_:1})}var F_=mi(I_,[["render",O_]]);const L_={name:"RoomTemplatesText",props:{filteredTemplatesText:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-template-text","activate-item"],data(){return{activeItem:null}},watch:{filteredTemplatesText(e,t){t.length&&e.length===t.length||(this.activeItem=0)},selectItem(e){e&&this.$emit("select-template-text",this.filteredTemplatesText[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredTemplatesText.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},P_={key:0,class:"vac-template-container vac-app-box-shadow"},D_=["onMouseover","onClick"],H_={class:"vac-template-info"},N_={class:"vac-template-tag"},$_={class:"vac-template-text"};function z_(e,t,n,s,o,a){return Do(),qo(Br,{name:"vac-slide-up"},{default:Fn((()=>[n.filteredTemplatesText.length?(Do(),Vo("div",P_,[(Do(!0),Vo(Co,null,Ps(n.filteredTemplatesText,((t,n)=>(Do(),Vo("div",{key:n,class:ht(["vac-template-box",{"vac-template-active":n===o.activeItem}]),onMouseover:e=>o.activeItem=n,onClick:n=>e.$emit("select-template-text",t)},[Zo("div",H_,[Zo("div",N_," /"+gt(t.tag),1),Zo("div",$_,gt(t.text),1)])],42,D_)))),128))])):na("",!0)])),_:1})}var V_=mi(L_,[["render",z_]]);function q_(e){return new Int8Array(e)}function U_(e){return new Int16Array(e)}function X_(e){return new Int32Array(e)}function Y_(e){return new Float32Array(e)}function G_(e){return new Float64Array(e)}function K_(e){if(1==e.length)return Y_(e[0]);var t=e[0];e=e.slice(1);for(var n=[],s=0;s<t;s++)n.push(K_(e));return n}function Z_(e){if(1==e.length)return X_(e[0]);var t=e[0];e=e.slice(1);for(var n=[],s=0;s<t;s++)n.push(Z_(e));return n}function W_(e){if(1==e.length)return U_(e[0]);var t=e[0];e=e.slice(1);for(var n=[],s=0;s<t;s++)n.push(W_(e));return n}function Q_(e){if(1==e.length)return new Array(e[0]);var t=e[0];e=e.slice(1);for(var n=[],s=0;s<t;s++)n.push(Q_(e));return n}var J_={fill:function(e,t,n,s){if(2==arguments.length)for(var o=0;o<e.length;o++)e[o]=arguments[1];else for(o=t;o<n;o++)e[o]=s}},ev={arraycopy:function(e,t,n,s,o){var a=t+o;while(t<a)n[s++]=e[t++]},out:{}};ev.out.println=function(e){console.log(e)},ev.out.printf=function(){console.log.apply(console,arguments)};var tv={};function nv(e){this.ordinal=e}tv.SQRT2=1.4142135623730951,tv.FAST_LOG10=function(e){return Math.log10(e)},tv.FAST_LOG10_X=function(e,t){return Math.log10(e)*t},nv.short_block_allowed=new nv(0),nv.short_block_coupled=new nv(1),nv.short_block_dispensed=new nv(2),nv.short_block_forced=new nv(3);var sv={};function ov(e){this.ordinal=e}sv.MAX_VALUE=34028235e31,ov.vbr_off=new ov(0),ov.vbr_mt=new ov(1),ov.vbr_rh=new ov(2),ov.vbr_abr=new ov(3),ov.vbr_mtrh=new ov(4),ov.vbr_default=ov.vbr_mtrh;var av=function(e){},rv={System:ev,VbrMode:ov,Float:sv,ShortBlock:nv,Util:tv,Arrays:J_,new_array_n:Q_,new_byte:q_,new_double:G_,new_float:Y_,new_float_n:K_,new_int:X_,new_int_n:Z_,new_short:U_,new_short_n:W_,assert:av},iv=rv.System,lv=rv.Util,cv=rv.Arrays,uv=rv.new_float;function dv(){var e=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*lv.SQRT2*.5/2384e-9,.017876148*lv.SQRT2*.5/2384e-9,.003134727*lv.SQRT2*.5/2384e-9,.002457142*lv.SQRT2*.5/2384e-9,971317e-9*lv.SQRT2*.5/2384e-9,218868e-9*lv.SQRT2*.5/2384e-9,101566e-9*lv.SQRT2*.5/2384e-9,13828e-9*lv.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],t=12,n=36,s=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],o=s[Mv.SHORT_TYPE],a=s[Mv.SHORT_TYPE],r=s[Mv.SHORT_TYPE],i=s[Mv.SHORT_TYPE],l=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function c(t,n,s){for(var o,a,r,i=10,l=n+238-14-286,c=-15;c<0;c++){var u,d,m;u=e[i+-10],d=t[l+-224]*u,m=t[n+224]*u,u=e[i+-9],d+=t[l+-160]*u,m+=t[n+160]*u,u=e[i+-8],d+=t[l+-96]*u,m+=t[n+96]*u,u=e[i+-7],d+=t[l+-32]*u,m+=t[n+32]*u,u=e[i+-6],d+=t[l+32]*u,m+=t[n+-32]*u,u=e[i+-5],d+=t[l+96]*u,m+=t[n+-96]*u,u=e[i+-4],d+=t[l+160]*u,m+=t[n+-160]*u,u=e[i+-3],d+=t[l+224]*u,m+=t[n+-224]*u,u=e[i+-2],d+=t[n+-256]*u,m-=t[l+256]*u,u=e[i+-1],d+=t[n+-192]*u,m-=t[l+192]*u,u=e[i+0],d+=t[n+-128]*u,m-=t[l+128]*u,u=e[i+1],d+=t[n+-64]*u,m-=t[l+64]*u,u=e[i+2],d+=t[n+0]*u,m-=t[l+0]*u,u=e[i+3],d+=t[n+64]*u,m-=t[l+-64]*u,u=e[i+4],d+=t[n+128]*u,m-=t[l+-128]*u,u=e[i+5],d+=t[n+192]*u,m-=t[l+-192]*u,d*=e[i+6],u=m-d,s[30+2*c]=m+d,s[31+2*c]=e[i+7]*u,i+=18,n--,l++}m=t[n+-16]*e[i+-10],d=t[n+-32]*e[i+-2],m+=(t[n+-48]-t[n+16])*e[i+-9],d+=t[n+-96]*e[i+-1],m+=(t[n+-80]+t[n+48])*e[i+-8],d+=t[n+-160]*e[i+0],m+=(t[n+-112]-t[n+80])*e[i+-7],d+=t[n+-224]*e[i+1],m+=(t[n+-144]+t[n+112])*e[i+-6],d-=t[n+32]*e[i+2],m+=(t[n+-176]-t[n+144])*e[i+-5],d-=t[n+96]*e[i+3],m+=(t[n+-208]+t[n+176])*e[i+-4],d-=t[n+160]*e[i+4],m+=(t[n+-240]-t[n+208])*e[i+-3],d-=t[n+224],o=d-m,a=d+m,m=s[14],d=s[15]-m,s[31]=a+m,s[30]=o+d,s[15]=o-d,s[14]=a-m,r=s[28]-s[0],s[0]+=s[28],s[28]=r*e[i+-36+7],r=s[29]-s[1],s[1]+=s[29],s[29]=r*e[i+-36+7],r=s[26]-s[2],s[2]+=s[26],s[26]=r*e[i+-72+7],r=s[27]-s[3],s[3]+=s[27],s[27]=r*e[i+-72+7],r=s[24]-s[4],s[4]+=s[24],s[24]=r*e[i+-108+7],r=s[25]-s[5],s[5]+=s[25],s[25]=r*e[i+-108+7],r=s[22]-s[6],s[6]+=s[22],s[22]=r*lv.SQRT2,r=s[23]-s[7],s[7]+=s[23],s[23]=r*lv.SQRT2-s[7],s[7]-=s[6],s[22]-=s[7],s[23]-=s[22],r=s[6],s[6]=s[31]-r,s[31]=s[31]+r,r=s[7],s[7]=s[30]-r,s[30]=s[30]+r,r=s[22],s[22]=s[15]-r,s[15]=s[15]+r,r=s[23],s[23]=s[14]-r,s[14]=s[14]+r,r=s[20]-s[8],s[8]+=s[20],s[20]=r*e[i+-180+7],r=s[21]-s[9],s[9]+=s[21],s[21]=r*e[i+-180+7],r=s[18]-s[10],s[10]+=s[18],s[18]=r*e[i+-216+7],r=s[19]-s[11],s[11]+=s[19],s[19]=r*e[i+-216+7],r=s[16]-s[12],s[12]+=s[16],s[16]=r*e[i+-252+7],r=s[17]-s[13],s[13]+=s[17],s[17]=r*e[i+-252+7],r=-s[20]+s[24],s[20]+=s[24],s[24]=r*e[i+-216+7],r=-s[21]+s[25],s[21]+=s[25],s[25]=r*e[i+-216+7],r=s[4]-s[8],s[4]+=s[8],s[8]=r*e[i+-216+7],r=s[5]-s[9],s[5]+=s[9],s[9]=r*e[i+-216+7],r=s[0]-s[12],s[0]+=s[12],s[12]=r*e[i+-72+7],r=s[1]-s[13],s[1]+=s[13],s[13]=r*e[i+-72+7],r=s[16]-s[28],s[16]+=s[28],s[28]=r*e[i+-72+7],r=-s[17]+s[29],s[17]+=s[29],s[29]=r*e[i+-72+7],r=lv.SQRT2*(s[2]-s[10]),s[2]+=s[10],s[10]=r,r=lv.SQRT2*(s[3]-s[11]),s[3]+=s[11],s[11]=r,r=lv.SQRT2*(-s[18]+s[26]),s[18]+=s[26],s[26]=r-s[18],r=lv.SQRT2*(-s[19]+s[27]),s[19]+=s[27],s[27]=r-s[19],r=s[2],s[19]-=s[3],s[3]-=r,s[2]=s[31]-r,s[31]+=r,r=s[3],s[11]-=s[19],s[18]-=r,s[3]=s[30]-r,s[30]+=r,r=s[18],s[27]-=s[11],s[19]-=r,s[18]=s[15]-r,s[15]+=r,r=s[19],s[10]-=r,s[19]=s[14]-r,s[14]+=r,r=s[10],s[11]-=r,s[10]=s[23]-r,s[23]+=r,r=s[11],s[26]-=r,s[11]=s[22]-r,s[22]+=r,r=s[26],s[27]-=r,s[26]=s[7]-r,s[7]+=r,r=s[27],s[27]=s[6]-r,s[6]+=r,r=lv.SQRT2*(s[0]-s[4]),s[0]+=s[4],s[4]=r,r=lv.SQRT2*(s[1]-s[5]),s[1]+=s[5],s[5]=r,r=lv.SQRT2*(s[16]-s[20]),s[16]+=s[20],s[20]=r,r=lv.SQRT2*(s[17]-s[21]),s[17]+=s[21],s[21]=r,r=-lv.SQRT2*(s[8]-s[12]),s[8]+=s[12],s[12]=r-s[8],r=-lv.SQRT2*(s[9]-s[13]),s[9]+=s[13],s[13]=r-s[9],r=-lv.SQRT2*(s[25]-s[29]),s[25]+=s[29],s[29]=r-s[25],r=-lv.SQRT2*(s[24]+s[28]),s[24]-=s[28],s[28]=r-s[24],r=s[24]-s[16],s[24]=r,r=s[20]-r,s[20]=r,r=s[28]-r,s[28]=r,r=s[25]-s[17],s[25]=r,r=s[21]-r,s[21]=r,r=s[29]-r,s[29]=r,r=s[17]-s[1],s[17]=r,r=s[9]-r,s[9]=r,r=s[25]-r,s[25]=r,r=s[5]-r,s[5]=r,r=s[21]-r,s[21]=r,r=s[13]-r,s[13]=r,r=s[29]-r,s[29]=r,r=s[1]-s[0],s[1]=r,r=s[16]-r,s[16]=r,r=s[17]-r,s[17]=r,r=s[8]-r,s[8]=r,r=s[9]-r,s[9]=r,r=s[24]-r,s[24]=r,r=s[25]-r,s[25]=r,r=s[4]-r,s[4]=r,r=s[5]-r,s[5]=r,r=s[20]-r,s[20]=r,r=s[21]-r,s[21]=r,r=s[12]-r,s[12]=r,r=s[13]-r,s[13]=r,r=s[28]-r,s[28]=r,r=s[29]-r,s[29]=r,r=s[0],s[0]+=s[31],s[31]-=r,r=s[1],s[1]+=s[30],s[30]-=r,r=s[16],s[16]+=s[15],s[15]-=r,r=s[17],s[17]+=s[14],s[14]-=r,r=s[8],s[8]+=s[23],s[23]-=r,r=s[9],s[9]+=s[22],s[22]-=r,r=s[24],s[24]+=s[7],s[7]-=r,r=s[25],s[25]+=s[6],s[6]-=r,r=s[4],s[4]+=s[27],s[27]-=r,r=s[5],s[5]+=s[26],s[26]-=r,r=s[20],s[20]+=s[11],s[11]-=r,r=s[21],s[21]+=s[10],s[10]-=r,r=s[12],s[12]+=s[19],s[19]-=r,r=s[13],s[13]+=s[18],s[18]-=r,r=s[28],s[28]+=s[3],s[3]-=r,r=s[29],s[29]+=s[2],s[2]-=r}function u(e,t){for(var n=0;n<3;n++){var o,a,r,i,l,c;i=e[t+6]*s[Mv.SHORT_TYPE][0]-e[t+15],o=e[t+0]*s[Mv.SHORT_TYPE][2]-e[t+9],a=i+o,r=i-o,i=e[t+15]*s[Mv.SHORT_TYPE][0]+e[t+6],o=e[t+9]*s[Mv.SHORT_TYPE][2]+e[t+0],l=i+o,c=-i+o,o=2069978111953089e-26*(e[t+3]*s[Mv.SHORT_TYPE][1]-e[t+12]),i=2069978111953089e-26*(e[t+12]*s[Mv.SHORT_TYPE][1]+e[t+3]),e[t+0]=190752519173728e-25*a+o,e[t+15]=190752519173728e-25*-l+i,r=.8660254037844387*r*1907525191737281e-26,l=.5*l*1907525191737281e-26+i,e[t+3]=r-l,e[t+6]=r+l,a=.5*a*1907525191737281e-26-o,c=.8660254037844387*c*1907525191737281e-26,e[t+9]=a+c,e[t+12]=a-c,t++}}function d(e,t,n){var s,o,r,i,l,c,u,d,m,p,h,f,g,_,v,b,y,x;r=n[17]-n[9],l=n[15]-n[11],c=n[14]-n[12],u=n[0]+n[8],d=n[1]+n[7],m=n[2]+n[6],p=n[3]+n[5],e[t+17]=u+m-p-(d-n[4]),o=(u+m-p)*a[19]+(d-n[4]),s=(r-l-c)*a[18],e[t+5]=s+o,e[t+6]=s-o,i=(n[16]-n[10])*a[18],d=d*a[19]+n[4],s=r*a[12]+i+l*a[13]+c*a[14],o=-u*a[16]+d-m*a[17]+p*a[15],e[t+1]=s+o,e[t+2]=s-o,s=r*a[13]-i-l*a[14]+c*a[12],o=-u*a[17]+d-m*a[15]+p*a[16],e[t+9]=s+o,e[t+10]=s-o,s=r*a[14]-i+l*a[12]-c*a[13],o=u*a[15]-d+m*a[16]-p*a[17],e[t+13]=s+o,e[t+14]=s-o,h=n[8]-n[0],g=n[6]-n[2],_=n[5]-n[3],v=n[17]+n[9],b=n[16]+n[10],y=n[15]+n[11],x=n[14]+n[12],e[t+0]=v+y+x+(b+n[13]),s=(v+y+x)*a[19]-(b+n[13]),o=(h-g+_)*a[18],e[t+11]=s+o,e[t+12]=s-o,f=(n[7]-n[1])*a[18],b=n[13]-b*a[19],s=v*a[15]-b+y*a[16]+x*a[17],o=h*a[14]+f+g*a[12]+_*a[13],e[t+3]=s+o,e[t+4]=s-o,s=-v*a[17]+b-y*a[15]-x*a[16],o=h*a[13]+f-g*a[14]-_*a[12],e[t+7]=s+o,e[t+8]=s-o,s=-v*a[16]+b-y*a[17]-x*a[15],o=h*a[12]-f+g*a[13]-_*a[14],e[t+15]=s+o,e[t+16]=s-o}this.mdct_sub48=function(e,a,m){for(var p=a,h=286,f=0;f<e.channels_out;f++){for(var g=0;g<e.mode_gr;g++){for(var _,v=e.l3_side.tt[g][f],b=v.xr,y=0,x=e.sb_sample[f][1-g],w=0,k=0;k<9;k++)for(c(p,h,x[w]),c(p,h+32,x[w+1]),w+=2,h+=64,_=1;_<32;_+=2)x[w-1][_]*=-1;for(_=0;_<32;_++,y+=18){var S=v.block_type,M=e.sb_sample[f][g],A=e.sb_sample[f][1-g];if(0!=v.mixed_block_flag&&_<2&&(S=0),e.amp_filter[_]<1e-12)cv.fill(b,y+0,y+18,0);else{if(e.amp_filter[_]<1)for(k=0;k<18;k++)A[k][l[_]]*=e.amp_filter[_];if(S==Mv.SHORT_TYPE){for(k=-t/4;k<0;k++){var R=s[Mv.SHORT_TYPE][k+3];b[y+3*k+9]=M[9+k][l[_]]*R-M[8-k][l[_]],b[y+3*k+18]=M[14-k][l[_]]*R+M[15+k][l[_]],b[y+3*k+10]=M[15+k][l[_]]*R-M[14-k][l[_]],b[y+3*k+19]=A[2-k][l[_]]*R+A[3+k][l[_]],b[y+3*k+11]=A[3+k][l[_]]*R-A[2-k][l[_]],b[y+3*k+20]=A[8-k][l[_]]*R+A[9+k][l[_]]}u(b,y)}else{var E=uv(18);for(k=-n/4;k<0;k++){var T,B;T=s[S][k+27]*A[k+9][l[_]]+s[S][k+36]*A[8-k][l[_]],B=s[S][k+9]*M[k+9][l[_]]-s[S][k+18]*M[8-k][l[_]],E[k+9]=T-B*o[3+k+9],E[k+18]=T*o[3+k+9]+B}d(b,y,E)}}if(S!=Mv.SHORT_TYPE&&0!=_)for(k=7;k>=0;--k){var I,C;I=b[y+k]*r[20+k]+b[y+-1-k]*i[28+k],C=b[y+k]*i[28+k]-b[y+-1-k]*r[20+k],b[y+-1-k]=I,b[y+k]=C}}}if(p=m,h=286,1==e.mode_gr)for(var j=0;j<18;j++)iv.arraycopy(e.sb_sample[f][1][j],0,e.sb_sample[f][0][j],0,32)}}}var mv=rv.System,pv=rv.new_float,hv=rv.new_float_n;function fv(){this.l=pv(Mv.SBMAX_l),this.s=hv([Mv.SBMAX_s,3]);var e=this;this.assign=function(t){mv.arraycopy(t.l,0,e.l,0,Mv.SBMAX_l);for(var n=0;n<Mv.SBMAX_s;n++)for(var s=0;s<3;s++)e.s[n][s]=t.s[n][s]}}function gv(){this.thm=new fv,this.en=new fv}function _v(e){var t=e;this.ordinal=function(){return t}}_v.STEREO=new _v(0),_v.JOINT_STEREO=new _v(1),_v.DUAL_CHANNEL=new _v(2),_v.MONO=new _v(3),_v.NOT_SET=new _v(4);var vv=rv.System,bv=rv.VbrMode,yv=rv.new_array_n,xv=rv.new_float,wv=rv.new_float_n,kv=rv.new_int,Sv=rv.assert;function Mv(){var e=Mv.FFTOFFSET,t=Mv.MPG_MD_MS_LR,n=null;this.psy=null;var s=null,o=null,a=null;this.setModules=function(e,t,r,i){n=e,this.psy=t,s=t,o=i,a=r};var r=new dv;function i(e){var t,n;if(0!=e.ATH.useAdjust)if(n=e.loudness_sq[0][0],t=e.loudness_sq[1][0],2==e.channels_out?(n+=e.loudness_sq[0][1],t+=e.loudness_sq[1][1]):(n+=n,t+=t),2==e.mode_gr&&(n=Math.max(n,t)),n*=.5,n*=e.ATH.aaSensitivityP,n>.03125)e.ATH.adjust>=1?e.ATH.adjust=1:e.ATH.adjust<e.ATH.adjustLimit&&(e.ATH.adjust=e.ATH.adjustLimit),e.ATH.adjustLimit=1;else{var s=31.98*n+625e-6;e.ATH.adjust>=s?(e.ATH.adjust*=.075*s+.925,e.ATH.adjust<s&&(e.ATH.adjust=s)):e.ATH.adjustLimit>=s?e.ATH.adjust=s:e.ATH.adjust<e.ATH.adjustLimit&&(e.ATH.adjust=e.ATH.adjustLimit),e.ATH.adjustLimit=s}else e.ATH.adjust=1}function l(e){var t,n;for(Sv(e.bitrate_index>=0&&e.bitrate_index<16),Sv(e.mode_ext>=0&&e.mode_ext<4),e.bitrate_stereoMode_Hist[e.bitrate_index][4]++,e.bitrate_stereoMode_Hist[15][4]++,2==e.channels_out&&(e.bitrate_stereoMode_Hist[e.bitrate_index][e.mode_ext]++,e.bitrate_stereoMode_Hist[15][e.mode_ext]++),t=0;t<e.mode_gr;++t)for(n=0;n<e.channels_out;++n){var s=0|e.l3_side.tt[t][n].block_type;0!=e.l3_side.tt[t][n].mixed_block_flag&&(s=4),e.bitrate_blockType_Hist[e.bitrate_index][s]++,e.bitrate_blockType_Hist[e.bitrate_index][5]++,e.bitrate_blockType_Hist[15][s]++,e.bitrate_blockType_Hist[15][5]++}}function c(e,t){var n,s,o=e.internal_flags;if(0==o.lame_encode_frame_init){var a,i,l=xv(2014),c=xv(2014);for(o.lame_encode_frame_init=1,a=0,i=0;a<286+576*(1+o.mode_gr);++a)a<576*o.mode_gr?(l[a]=0,2==o.channels_out&&(c[a]=0)):(l[a]=t[0][i],2==o.channels_out&&(c[a]=t[1][i]),++i);for(s=0;s<o.mode_gr;s++)for(n=0;n<o.channels_out;n++)o.l3_side.tt[s][n].block_type=Mv.SHORT_TYPE;r.mdct_sub48(o,l,c),Sv(o.mf_size>=Mv.BLKSIZE+e.framesize-Mv.FFTOFFSET),Sv(o.mf_size>=512+e.framesize-32)}}this.lame_encode_mp3_frame=function(u,d,m,p,h,f){var g,_=yv([2,2]);_[0][0]=new gv,_[0][1]=new gv,_[1][0]=new gv,_[1][1]=new gv;var v,b=yv([2,2]);b[0][0]=new gv,b[0][1]=new gv,b[1][0]=new gv,b[1][1]=new gv;var y,x,w,k=[null,null],S=u.internal_flags,M=wv([2,4]),A=[.5,.5],R=[[0,0],[0,0]],E=[[0,0],[0,0]];if(k[0]=d,k[1]=m,0==S.lame_encode_frame_init&&c(u,k),S.padding=0,(S.slot_lag-=S.frac_SpF)<0&&(S.slot_lag+=u.out_samplerate,S.padding=1),0!=S.psymodel){var T,B=[null,null],I=0,C=kv(2);for(w=0;w<S.mode_gr;w++){for(x=0;x<S.channels_out;x++)B[x]=k[x],I=576+576*w-Mv.FFTOFFSET;if(T=u.VBR==bv.vbr_mtrh||u.VBR==bv.vbr_mt?s.L3psycho_anal_vbr(u,B,I,w,_,b,R[w],E[w],M[w],C):s.L3psycho_anal_ns(u,B,I,w,_,b,R[w],E[w],M[w],C),0!=T)return-4;for(u.mode==_v.JOINT_STEREO&&(A[w]=M[w][2]+M[w][3],A[w]>0&&(A[w]=M[w][3]/A[w])),x=0;x<S.channels_out;x++){var j=S.l3_side.tt[w][x];j.block_type=C[x],j.mixed_block_flag=0}}}else for(w=0;w<S.mode_gr;w++)for(x=0;x<S.channels_out;x++)S.l3_side.tt[w][x].block_type=Mv.NORM_TYPE,S.l3_side.tt[w][x].mixed_block_flag=0,E[w][x]=R[w][x]=700;if(i(S),r.mdct_sub48(S,k[0],k[1]),S.mode_ext=Mv.MPG_MD_LR_LR,u.force_ms)S.mode_ext=Mv.MPG_MD_MS_LR;else if(u.mode==_v.JOINT_STEREO){var O=0,F=0;for(w=0;w<S.mode_gr;w++)for(x=0;x<S.channels_out;x++)O+=E[w][x],F+=R[w][x];if(O<=1*F){var L=S.l3_side.tt[0],P=S.l3_side.tt[S.mode_gr-1];L[0].block_type==L[1].block_type&&P[0].block_type==P[1].block_type&&(S.mode_ext=Mv.MPG_MD_MS_LR)}}if(S.mode_ext==t?(v=b,y=E):(v=_,y=R),u.analysis&&null!=S.pinfo)for(w=0;w<S.mode_gr;w++)for(x=0;x<S.channels_out;x++)S.pinfo.ms_ratio[w]=S.ms_ratio[w],S.pinfo.ms_ener_ratio[w]=A[w],S.pinfo.blocktype[w][x]=S.l3_side.tt[w][x].block_type,S.pinfo.pe[w][x]=y[w][x],vv.arraycopy(S.l3_side.tt[w][x].xr,0,S.pinfo.xr[w][x],0,576),S.mode_ext==t&&(S.pinfo.ers[w][x]=S.pinfo.ers[w][x+2],vv.arraycopy(S.pinfo.energy[w][x+2],0,S.pinfo.energy[w][x],0,S.pinfo.energy[w][x].length));if(u.VBR==bv.vbr_off||u.VBR==bv.vbr_abr){var D,H;for(D=0;D<18;D++)S.nsPsy.pefirbuf[D]=S.nsPsy.pefirbuf[D+1];for(H=0,w=0;w<S.mode_gr;w++)for(x=0;x<S.channels_out;x++)H+=y[w][x];for(S.nsPsy.pefirbuf[18]=H,H=S.nsPsy.pefirbuf[9],D=0;D<9;D++)H+=(S.nsPsy.pefirbuf[D]+S.nsPsy.pefirbuf[18-D])*Mv.fircoef[D];for(H=3350*S.mode_gr*S.channels_out/H,w=0;w<S.mode_gr;w++)for(x=0;x<S.channels_out;x++)y[w][x]*=H}if(S.iteration_loop.iteration_loop(u,y,A,v),n.format_bitstream(u),g=n.copy_buffer(S,p,h,f,1),u.bWriteVbrTag&&o.addVbrFrame(u),u.analysis&&null!=S.pinfo){for(x=0;x<S.channels_out;x++){var N;for(N=0;N<e;N++)S.pinfo.pcmdata[x][N]=S.pinfo.pcmdata[x][N+u.framesize];for(N=e;N<1600;N++)S.pinfo.pcmdata[x][N]=k[x][N-e]}a.set_frame_pinfo(u,v)}return l(S),g}}Mv.ENCDELAY=576,Mv.POSTDELAY=1152,Mv.MDCTDELAY=48,Mv.FFTOFFSET=224+Mv.MDCTDELAY,Mv.DECDELAY=528,Mv.SBLIMIT=32,Mv.CBANDS=64,Mv.SBPSY_l=21,Mv.SBPSY_s=12,Mv.SBMAX_l=22,Mv.SBMAX_s=13,Mv.PSFB21=6,Mv.PSFB12=6,Mv.BLKSIZE=1024,Mv.HBLKSIZE=Mv.BLKSIZE/2+1,Mv.BLKSIZE_s=256,Mv.HBLKSIZE_s=Mv.BLKSIZE_s/2+1,Mv.NORM_TYPE=0,Mv.START_TYPE=1,Mv.SHORT_TYPE=2,Mv.STOP_TYPE=3,Mv.MPG_MD_LR_LR=0,Mv.MPG_MD_LR_I=1,Mv.MPG_MD_MS_LR=2,Mv.MPG_MD_MS_I=3,Mv.fircoef=[-.1039435,-.1892065,5*-.0432472,-.155915,3898045e-23,.0467745*5,.50455,.756825,.187098*5];var Av=rv.Util,Rv=rv.new_float;function Ev(){var e=Rv(Mv.BLKSIZE),t=Rv(Mv.BLKSIZE_s/2),n=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function s(e,t,s){var o,a,r,i=0;s<<=1;var l=t+s;o=4;do{var c,u,d,m,p,h,f;f=o>>1,m=o,p=o<<1,h=p+m,o=p<<1,a=t,r=a+f;do{w=e[a+0]-e[a+m],x=e[a+0]+e[a+m],A=e[a+p]-e[a+h],S=e[a+p]+e[a+h],e[a+p]=x-S,e[a+0]=x+S,e[a+h]=w-A,e[a+m]=w+A,w=e[r+0]-e[r+m],x=e[r+0]+e[r+m],A=Av.SQRT2*e[r+h],S=Av.SQRT2*e[r+p],e[r+p]=x-S,e[r+0]=x+S,e[r+h]=w-A,e[r+m]=w+A,r+=o,a+=o}while(a<l);for(u=n[i+0],c=n[i+1],d=1;d<f;d++){var g,_;g=1-2*c*c,_=2*c*u,a=t+d,r=t+m-d;do{var v,b,y,x,w,k,S,M,A,R;b=_*e[a+m]-g*e[r+m],v=g*e[a+m]+_*e[r+m],w=e[a+0]-v,x=e[a+0]+v,k=e[r+0]-b,y=e[r+0]+b,b=_*e[a+h]-g*e[r+h],v=g*e[a+h]+_*e[r+h],A=e[a+p]-v,S=e[a+p]+v,R=e[r+p]-b,M=e[r+p]+b,b=c*S-u*R,v=u*S+c*R,e[a+p]=x-v,e[a+0]=x+v,e[r+h]=k-b,e[r+m]=k+b,b=u*M-c*A,v=c*M+u*A,e[r+p]=y-v,e[r+0]=y+v,e[a+h]=w-b,e[a+m]=w+b,r+=o,a+=o}while(a<l);g=u,u=g*n[i+0]-c*n[i+1],c=g*n[i+1]+c*n[i+0]}i+=2}while(o<s)}var o=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(e,n,a,r,i){for(var l=0;l<3;l++){var c=Mv.BLKSIZE_s/2,u=65535&192*(l+1),d=Mv.BLKSIZE_s/8-1;do{var m,p,h,f,g,_=255&o[d<<2];m=t[_]*r[a][i+_+u],g=t[127-_]*r[a][i+_+u+128],p=m-g,m+=g,h=t[_+64]*r[a][i+_+u+64],g=t[63-_]*r[a][i+_+u+192],f=h-g,h+=g,c-=4,n[l][c+0]=m+h,n[l][c+2]=m-h,n[l][c+1]=p+f,n[l][c+3]=p-f,m=t[_+1]*r[a][i+_+u+1],g=t[126-_]*r[a][i+_+u+129],p=m-g,m+=g,h=t[_+65]*r[a][i+_+u+65],g=t[62-_]*r[a][i+_+u+193],f=h-g,h+=g,n[l][c+Mv.BLKSIZE_s/2+0]=m+h,n[l][c+Mv.BLKSIZE_s/2+2]=m-h,n[l][c+Mv.BLKSIZE_s/2+1]=p+f,n[l][c+Mv.BLKSIZE_s/2+3]=p-f}while(--d>=0);s(n[l],c,Mv.BLKSIZE_s/2)}},this.fft_long=function(t,n,a,r,i){var l=Mv.BLKSIZE/8-1,c=Mv.BLKSIZE/2;do{var u,d,m,p,h,f=255&o[l];u=e[f]*r[a][i+f],h=e[f+512]*r[a][i+f+512],d=u-h,u+=h,m=e[f+256]*r[a][i+f+256],h=e[f+768]*r[a][i+f+768],p=m-h,m+=h,c-=4,n[c+0]=u+m,n[c+2]=u-m,n[c+1]=d+p,n[c+3]=d-p,u=e[f+1]*r[a][i+f+1],h=e[f+513]*r[a][i+f+513],d=u-h,u+=h,m=e[f+257]*r[a][i+f+257],h=e[f+769]*r[a][i+f+769],p=m-h,m+=h,n[c+Mv.BLKSIZE/2+0]=u+m,n[c+Mv.BLKSIZE/2+2]=u-m,n[c+Mv.BLKSIZE/2+1]=d+p,n[c+Mv.BLKSIZE/2+3]=d-p}while(--l>=0);s(n,c,Mv.BLKSIZE/2)},this.init_fft=function(n){for(var s=0;s<Mv.BLKSIZE;s++)e[s]=.42-.5*Math.cos(2*Math.PI*(s+.5)/Mv.BLKSIZE)+.08*Math.cos(4*Math.PI*(s+.5)/Mv.BLKSIZE);for(s=0;s<Mv.BLKSIZE_s/2;s++)t[s]=.5*(1-Math.cos(2*Math.PI*(s+.5)/Mv.BLKSIZE_s))}}var Tv=rv.VbrMode,Bv=rv.Float,Iv=rv.ShortBlock,Cv=rv.Util,jv=rv.Arrays,Ov=rv.new_float,Fv=rv.new_float_n,Lv=rv.new_int,Pv=rv.assert;function Dv(){var e=new Ev,t=2.302585092994046,n=2,s=16,o=2,a=16,r=.34,i=1/217621504/(Mv.BLKSIZE/2),l=.01,c=.8,u=.6,d=.3,m=3.5,p=21,h=.2302585093;function f(e){return e}function g(e,t){for(var n=0,s=0;s<Mv.BLKSIZE/2;++s)n+=e[s]*t.ATH.eql_w[s];return n*=i,n}function _(t,n,s,o,a,r,i,l,c,u,d){var m=t.internal_flags;if(c<2)e.fft_long(m,o[a],c,u,d),e.fft_short(m,r[i],c,u,d);else if(2==c){for(var p=Mv.BLKSIZE-1;p>=0;--p){var h=o[a+0][p],_=o[a+1][p];o[a+0][p]=(h+_)*Cv.SQRT2*.5,o[a+1][p]=(h-_)*Cv.SQRT2*.5}for(var v=2;v>=0;--v)for(p=Mv.BLKSIZE_s-1;p>=0;--p){h=r[i+0][v][p],_=r[i+1][v][p];r[i+0][v][p]=(h+_)*Cv.SQRT2*.5,r[i+1][v][p]=(h-_)*Cv.SQRT2*.5}}n[0]=f(o[a+0][0]),n[0]*=n[0];for(p=Mv.BLKSIZE/2-1;p>=0;--p){var b=o[a+0][Mv.BLKSIZE/2-p],y=o[a+0][Mv.BLKSIZE/2+p];n[Mv.BLKSIZE/2-p]=f(.5*(b*b+y*y))}for(v=2;v>=0;--v){s[v][0]=r[i+0][v][0],s[v][0]*=s[v][0];for(p=Mv.BLKSIZE_s/2-1;p>=0;--p){b=r[i+0][v][Mv.BLKSIZE_s/2-p],y=r[i+0][v][Mv.BLKSIZE_s/2+p];s[v][Mv.BLKSIZE_s/2-p]=f(.5*(b*b+y*y))}}var x=0;for(p=11;p<Mv.HBLKSIZE;p++)x+=n[p];if(m.tot_ener[c]=x,t.analysis){for(p=0;p<Mv.HBLKSIZE;p++)m.pinfo.energy[l][c][p]=m.pinfo.energy_save[c][p],m.pinfo.energy_save[c][p]=n[p];m.pinfo.pe[l][c]=m.pe[c]}2==t.athaa_loudapprox&&c<2&&(m.loudness_sq[l][c]=m.loudness_sq_save[c],m.loudness_sq_save[c]=g(n,m))}var v,b,y,x=8,w=23,k=15,S=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749];function M(){v=Math.pow(10,(x+1)/16),b=Math.pow(10,(w+1)/16),y=Math.pow(10,k/10)}var A=[3.3246*3.3246,3.23837*3.23837,9.9500500969,9.0247369744,8.1854926609,7.0440875649,2.46209*2.46209,2.284*2.284,4.4892710641,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,2.4621061921,2.1508568964,1.37074*1.37074,1.31036*1.31036,1.5691069696,1.4555939904,1.16203*1.16203,1.2715945225,1.09428*1.09428,1.0659*1.0659,1.0779838276,1.0382591025,1],R=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1],E=[5.5396212496,2.29259*2.29259,4.9868695969,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,2.2499700001,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.2339655056,1.0779838276];function T(e,t,n,s,o,a){var r;if(t>e){if(!(t<e*b))return e+t;r=t/e}else{if(e>=t*b)return e+t;r=e/t}if(e+=t,s+3<=6){if(r>=v)return e;var i=0|Cv.FAST_LOG10_X(r,16);return e*R[i]}var l,c;i=0|Cv.FAST_LOG10_X(r,16);return t=0!=a?o.ATH.cb_s[n]*o.ATH.adjust:o.ATH.cb_l[n]*o.ATH.adjust,e<y*t?e>t?(l=1,i<=13&&(l=E[i]),c=Cv.FAST_LOG10_X(e/t,10/15),e*((A[i]-l)*c+l)):i>13?e:e*E[i]:e*A[i]}var B=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1];function I(e,t,n){var s;if(e<0&&(e=0),t<0&&(t=0),e<=0)return t;if(t<=0)return e;if(s=t>e?t/e:e/t,n>=-2&&n<=2){if(s>=v)return e+t;var o=0|Cv.FAST_LOG10_X(s,16);return(e+t)*B[o]}return s<b?e+t:(e<t&&(e=t),e)}function C(e,t){var n=e.internal_flags;if(n.channels_out>1){for(var s=0;s<Mv.SBMAX_l;s++){var o=n.thm[0].l[s],a=n.thm[1].l[s];n.thm[0].l[s]+=a*t,n.thm[1].l[s]+=o*t}for(s=0;s<Mv.SBMAX_s;s++)for(var r=0;r<3;r++){o=n.thm[0].s[s][r],a=n.thm[1].s[s][r];n.thm[0].s[s][r]+=a*t,n.thm[1].s[s][r]+=o*t}}}function j(e){for(var t=0;t<Mv.SBMAX_l;t++)if(!(e.thm[0].l[t]>1.58*e.thm[1].l[t]||e.thm[1].l[t]>1.58*e.thm[0].l[t])){var n=e.mld_l[t]*e.en[3].l[t],s=Math.max(e.thm[2].l[t],Math.min(e.thm[3].l[t],n));n=e.mld_l[t]*e.en[2].l[t];var o=Math.max(e.thm[3].l[t],Math.min(e.thm[2].l[t],n));e.thm[2].l[t]=s,e.thm[3].l[t]=o}for(t=0;t<Mv.SBMAX_s;t++)for(var a=0;a<3;a++)if(!(e.thm[0].s[t][a]>1.58*e.thm[1].s[t][a]||e.thm[1].s[t][a]>1.58*e.thm[0].s[t][a])){n=e.mld_s[t]*e.en[3].s[t][a],s=Math.max(e.thm[2].s[t][a],Math.min(e.thm[3].s[t][a],n));n=e.mld_s[t]*e.en[2].s[t][a];o=Math.max(e.thm[3].s[t][a],Math.min(e.thm[2].s[t][a],n));e.thm[2].s[t][a]=s,e.thm[3].s[t][a]=o}}function O(e,t,n){var s=t,o=Math.pow(10,n);t*=2,s*=2;for(var a=0;a<Mv.SBMAX_l;a++){if(d=e.ATH.cb_l[e.bm_l[a]]*o,l=Math.min(Math.max(e.thm[0].l[a],d),Math.max(e.thm[1].l[a],d)),c=Math.max(e.thm[2].l[a],d),u=Math.max(e.thm[3].l[a],d),l*t<c+u){var r=l*s/(c+u);c*=r,u*=r}e.thm[2].l[a]=Math.min(c,e.thm[2].l[a]),e.thm[3].l[a]=Math.min(u,e.thm[3].l[a])}o*=Mv.BLKSIZE_s/Mv.BLKSIZE;for(a=0;a<Mv.SBMAX_s;a++)for(var i=0;i<3;i++){var l,c,u,d;if(d=e.ATH.cb_s[e.bm_s[a]]*o,l=Math.min(Math.max(e.thm[0].s[a][i],d),Math.max(e.thm[1].s[a][i],d)),c=Math.max(e.thm[2].s[a][i],d),u=Math.max(e.thm[3].s[a][i],d),l*t<c+u){r=l*t/(c+u);c*=r,u*=r}e.thm[2].s[a][i]=Math.min(e.thm[2].s[a][i],c),e.thm[3].s[a][i]=Math.min(e.thm[3].s[a][i],u)}}function F(e,t,n,s,o){var a,r,i=0,l=0;for(a=r=0;a<Mv.SBMAX_s;++r,++a){var c=e.bo_s[a],u=e.npart_s,d=c<u?c:u;while(r<d)Pv(t[r]>=0),Pv(n[r]>=0),i+=t[r],l+=n[r],r++;if(e.en[s].s[a][o]=i,e.thm[s].s[a][o]=l,r>=u){++a;break}Pv(t[r]>=0),Pv(n[r]>=0);var m=e.PSY.bo_s_weight[a],p=1-m;i=m*t[r],l=m*n[r],e.en[s].s[a][o]+=i,e.thm[s].s[a][o]+=l,i=p*t[r],l=p*n[r]}for(;a<Mv.SBMAX_s;++a)e.en[s].s[a][o]=0,e.thm[s].s[a][o]=0}function L(e,t,n,s){var o,a,r=0,i=0;for(o=a=0;o<Mv.SBMAX_l;++a,++o){var l=e.bo_l[o],c=e.npart_l,u=l<c?l:c;while(a<u)Pv(t[a]>=0),Pv(n[a]>=0),r+=t[a],i+=n[a],a++;if(e.en[s].l[o]=r,e.thm[s].l[o]=i,a>=c){++o;break}Pv(t[a]>=0),Pv(n[a]>=0);var d=e.PSY.bo_l_weight[o],m=1-d;r=d*t[a],i=d*n[a],e.en[s].l[o]+=r,e.thm[s].l[o]+=i,r=m*t[a],i=m*n[a]}for(;o<Mv.SBMAX_l;++o)e.en[s].l[o]=0,e.thm[s].l[o]=0}function P(e,t,n,s,r,i){var l,c,u=e.internal_flags;for(c=l=0;c<u.npart_s;++c){for(var d=0,m=u.numlines_s[c],p=0;p<m;++p,++l){var h=t[i][l];d+=h}n[c]=d}for(Pv(c==u.npart_s),l=c=0;c<u.npart_s;c++){var f=u.s3ind_s[c][0],g=u.s3_ss[l++]*n[f];++f;while(f<=u.s3ind_s[c][1])g+=u.s3_ss[l]*n[f],++l,++f;var _=o*u.nb_s1[r][c];if(s[c]=Math.min(g,_),u.blocktype_old[1&r]==Mv.SHORT_TYPE){_=a*u.nb_s2[r][c];var v=s[c];s[c]=Math.min(_,v)}u.nb_s2[r][c]=u.nb_s1[r][c],u.nb_s1[r][c]=g,Pv(s[c]>=0)}for(;c<=Mv.CBANDS;++c)n[c]=0,s[c]=0}function D(e,t,n,s){var o=e.internal_flags;e.short_blocks!=Iv.short_block_coupled||0!=t[0]&&0!=t[1]||(t[0]=t[1]=0);for(var a=0;a<o.channels_out;a++)s[a]=Mv.NORM_TYPE,e.short_blocks==Iv.short_block_dispensed&&(t[a]=1),e.short_blocks==Iv.short_block_forced&&(t[a]=0),0!=t[a]?(Pv(o.blocktype_old[a]!=Mv.START_TYPE),o.blocktype_old[a]==Mv.SHORT_TYPE&&(s[a]=Mv.STOP_TYPE)):(s[a]=Mv.SHORT_TYPE,o.blocktype_old[a]==Mv.NORM_TYPE&&(o.blocktype_old[a]=Mv.START_TYPE),o.blocktype_old[a]==Mv.STOP_TYPE&&(o.blocktype_old[a]=Mv.SHORT_TYPE)),n[a]=o.blocktype_old[a],o.blocktype_old[a]=s[a]}function H(e,t,n){return n>=1?e:n<=0?t:t>0?Math.pow(e/t,n)*t:0}var N=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function $(e,n){for(var s=309.07,o=0;o<Mv.SBMAX_s-1;o++)for(var a=0;a<3;a++){var r=e.thm.s[o][a];if(r>0){var i=r*n,l=e.en.s[o][a];l>i&&(s+=l>1e10*i?N[o]*(10*t):N[o]*Cv.FAST_LOG10(l/i))}}return s}var z=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function V(e,n){for(var s=281.0575,o=0;o<Mv.SBMAX_l-1;o++){var a=e.thm.l[o];if(a>0){var r=a*n,i=e.en.l[o];i>r&&(s+=i>1e10*r?z[o]*(10*t):z[o]*Cv.FAST_LOG10(i/r))}}return s}function q(e,t,n,s,o){var a,r;for(a=r=0;a<e.npart_l;++a){var i,l=0,c=0;for(i=0;i<e.numlines_l[a];++i,++r){var u=t[r];l+=u,c<u&&(c=u)}n[a]=l,s[a]=c,o[a]=l*e.rnumlines_l[a],Pv(e.rnumlines_l[a]>=0),Pv(n[a]>=0),Pv(s[a]>=0),Pv(o[a]>=0)}}function U(e,t,n,s){var o=S.length-1,a=0,r=n[a]+n[a+1];if(r>0){var i=t[a];i<t[a+1]&&(i=t[a+1]),Pv(e.numlines_l[a]+e.numlines_l[a+1]-1>0),r=20*(2*i-r)/(r*(e.numlines_l[a]+e.numlines_l[a+1]-1));var l=0|r;l>o&&(l=o),s[a]=l}else s[a]=0;for(a=1;a<e.npart_l-1;a++)if(r=n[a-1]+n[a]+n[a+1],r>0){i=t[a-1];i<t[a]&&(i=t[a]),i<t[a+1]&&(i=t[a+1]),Pv(e.numlines_l[a-1]+e.numlines_l[a]+e.numlines_l[a+1]-1>0),r=20*(3*i-r)/(r*(e.numlines_l[a-1]+e.numlines_l[a]+e.numlines_l[a+1]-1));l=0|r;l>o&&(l=o),s[a]=l}else s[a]=0;if(Pv(a==e.npart_l-1),r=n[a-1]+n[a],r>0){i=t[a-1];i<t[a]&&(i=t[a]),Pv(e.numlines_l[a-1]+e.numlines_l[a]-1>0),r=20*(2*i-r)/(r*(e.numlines_l[a-1]+e.numlines_l[a]-1));l=0|r;l>o&&(l=o),s[a]=l}else s[a]=0;Pv(a==e.npart_l-1)}var X=[-1730326e-23,-.01703172,-1349528e-23,.0418072,-673278e-22,-.0876324,-30835e-21,.1863476,-1104424e-22,-.627638];function Y(t,n,s,o,a,r,i,l){var c=t.internal_flags;if(o<2)e.fft_long(c,i[l],o,n,s);else if(2==o)for(var u=Mv.BLKSIZE-1;u>=0;--u){var d=i[l+0][u],m=i[l+1][u];i[l+0][u]=(d+m)*Cv.SQRT2*.5,i[l+1][u]=(d-m)*Cv.SQRT2*.5}r[0]=f(i[l+0][0]),r[0]*=r[0];for(u=Mv.BLKSIZE/2-1;u>=0;--u){var p=i[l+0][Mv.BLKSIZE/2-u],h=i[l+0][Mv.BLKSIZE/2+u];r[Mv.BLKSIZE/2-u]=f(.5*(p*p+h*h))}var g=0;for(u=11;u<Mv.HBLKSIZE;u++)g+=r[u];if(c.tot_ener[o]=g,t.analysis){for(u=0;u<Mv.HBLKSIZE;u++)c.pinfo.energy[a][o][u]=c.pinfo.energy_save[o][u],c.pinfo.energy_save[o][u]=r[u];c.pinfo.pe[a][o]=c.pe[o]}}function G(t,n,s,o,a,r,i,l){var c=t.internal_flags;if(0==a&&o<2&&e.fft_short(c,i[l],o,n,s),2==o)for(var u=Mv.BLKSIZE_s-1;u>=0;--u){var d=i[l+0][a][u],m=i[l+1][a][u];i[l+0][a][u]=(d+m)*Cv.SQRT2*.5,i[l+1][a][u]=(d-m)*Cv.SQRT2*.5}r[a][0]=i[l+0][a][0],r[a][0]*=r[a][0];for(u=Mv.BLKSIZE_s/2-1;u>=0;--u){var p=i[l+0][a][Mv.BLKSIZE_s/2-u],h=i[l+0][a][Mv.BLKSIZE_s/2+u];r[a][Mv.BLKSIZE_s/2-u]=f(.5*(p*p+h*h))}}function K(e,t,n,s){var o=e.internal_flags;2==e.athaa_loudapprox&&n<2&&(o.loudness_sq[t][n]=o.loudness_sq_save[n],o.loudness_sq_save[n]=g(s,o))}this.L3psycho_anal_ns=function(e,t,o,a,r,i,l,m,h,f){var g,v,b,y,x,w,k,M,A,R,E=e.internal_flags,B=Fv([2,Mv.BLKSIZE]),I=Fv([2,3,Mv.BLKSIZE_s]),N=Ov(Mv.CBANDS+1),z=Ov(Mv.CBANDS+1),Y=Ov(Mv.CBANDS+2),G=Lv(2),K=Lv(2),Z=Fv([2,576]),W=Lv(Mv.CBANDS+2),Q=Lv(Mv.CBANDS+2);for(jv.fill(Q,0),g=E.channels_out,e.mode==_v.JOINT_STEREO&&(g=4),A=e.VBR==Tv.vbr_off?0==E.ResvMax?0:E.ResvSize/E.ResvMax*.5:e.VBR==Tv.vbr_rh||e.VBR==Tv.vbr_mtrh||e.VBR==Tv.vbr_mt?.6:1,v=0;v<E.channels_out;v++){var J=t[v],ee=o+576-350-p+192;for(y=0;y<576;y++){var te,ne;for(te=J[ee+y+10],ne=0,x=0;x<(p-1)/2-1;x+=2)te+=X[x]*(J[ee+y+x]+J[ee+y+p-x]),ne+=X[x+1]*(J[ee+y+x+1]+J[ee+y+p-x-1]);Z[v][y]=te+ne}r[a][v].en.assign(E.en[v]),r[a][v].thm.assign(E.thm[v]),g>2&&(i[a][v].en.assign(E.en[v+2]),i[a][v].thm.assign(E.thm[v+2]))}for(v=0;v<g;v++){var se,oe,ae,re=Ov(12),ie=[0,0,0,0],le=Ov(12),ce=1,ue=Ov(Mv.CBANDS),de=Ov(Mv.CBANDS),me=[0,0,0,0],pe=Ov(Mv.HBLKSIZE),he=Fv([3,Mv.HBLKSIZE_s]);for(Pv(E.npart_s<=Mv.CBANDS),Pv(E.npart_l<=Mv.CBANDS),y=0;y<3;y++)re[y]=E.nsPsy.last_en_subshort[v][y+6],Pv(E.nsPsy.last_en_subshort[v][y+4]>0),le[y]=re[y]/E.nsPsy.last_en_subshort[v][y+4],ie[0]+=re[y];if(2==v)for(y=0;y<576;y++){var fe,ge;fe=Z[0][y],ge=Z[1][y],Z[0][y]=fe+ge,Z[1][y]=fe-ge}var _e=Z[1&v],ve=0;for(y=0;y<9;y++){for(var be=ve+64,ye=1;ve<be;ve++)ye<Math.abs(_e[ve])&&(ye=Math.abs(_e[ve]));E.nsPsy.last_en_subshort[v][y]=re[y+3]=ye,ie[1+y/3]+=ye,ye>re[y+3-2]?(Pv(re[y+3-2]>0),ye/=re[y+3-2]):ye=re[y+3-2]>10*ye?re[y+3-2]/(10*ye):0,le[y+3]=ye}if(e.analysis){var xe=le[0];for(y=1;y<12;y++)xe<le[y]&&(xe=le[y]);E.pinfo.ers[a][v]=E.pinfo.ers_save[v],E.pinfo.ers_save[v]=xe}for(ae=3==v?E.nsPsy.attackthre_s:E.nsPsy.attackthre,y=0;y<12;y++)0==me[y/3]&&le[y]>ae&&(me[y/3]=y%3+1);for(y=1;y<4;y++){var we;ie[y-1]>ie[y]?(Pv(ie[y]>0),we=ie[y-1]/ie[y]):(Pv(ie[y-1]>0),we=ie[y]/ie[y-1]),we<1.7&&(me[y]=0,1==y&&(me[0]=0))}for(0!=me[0]&&0!=E.nsPsy.lastAttacks[v]&&(me[0]=0),3!=E.nsPsy.lastAttacks[v]&&me[0]+me[1]+me[2]+me[3]==0||(ce=0,0!=me[1]&&0!=me[0]&&(me[1]=0),0!=me[2]&&0!=me[1]&&(me[2]=0),0!=me[3]&&0!=me[2]&&(me[3]=0)),v<2?K[v]=ce:0==ce&&(K[0]=K[1]=0),h[v]=E.tot_ener[v],oe=I,se=B,_(e,pe,he,se,1&v,oe,1&v,a,v,t,o),q(E,pe,N,ue,de),U(E,ue,de,W),M=0;M<3;M++){var ke,Se;for(P(e,he,z,Y,v,M),F(E,z,Y,v,M),k=0;k<Mv.SBMAX_s;k++){if(Se=E.thm[v].s[k][M],Se*=c,me[M]>=2||1==me[M+1]){var Me=0!=M?M-1:2;ye=H(E.thm[v].s[k][Me],Se,u*A);Se=Math.min(Se,ye)}if(1==me[M]){Me=0!=M?M-1:2,ye=H(E.thm[v].s[k][Me],Se,d*A);Se=Math.min(Se,ye)}else if(0!=M&&3==me[M-1]||0==M&&3==E.nsPsy.lastAttacks[v]){Me=2!=M?M+1:0,ye=H(E.thm[v].s[k][Me],Se,d*A);Se=Math.min(Se,ye)}ke=re[3*M+3]+re[3*M+4]+re[3*M+5],6*re[3*M+5]<ke&&(Se*=.5,6*re[3*M+4]<ke&&(Se*=.5)),E.thm[v].s[k][M]=Se}}for(E.nsPsy.lastAttacks[v]=me[2],w=0,b=0;b<E.npart_l;b++){var Ae=E.s3ind[b][0],Re=N[Ae]*S[W[Ae]],Ee=E.s3_ll[w++]*Re;while(++Ae<=E.s3ind[b][1])Re=N[Ae]*S[W[Ae]],Ee=T(Ee,E.s3_ll[w++]*Re,Ae,Ae-b,E,0);Ee*=.158489319246111,E.blocktype_old[1&v]==Mv.SHORT_TYPE?Y[b]=Ee:Y[b]=H(Math.min(Ee,Math.min(n*E.nb_1[v][b],s*E.nb_2[v][b])),Ee,A),E.nb_2[v][b]=E.nb_1[v][b],E.nb_1[v][b]=Ee}for(;b<=Mv.CBANDS;++b)N[b]=0,Y[b]=0;L(E,N,Y,v)}(e.mode!=_v.STEREO&&e.mode!=_v.JOINT_STEREO||e.interChRatio>0&&C(e,e.interChRatio),e.mode==_v.JOINT_STEREO)&&(j(E),R=e.msfix,Math.abs(R)>0&&O(E,R,e.ATHlower*E.ATH.adjust));for(D(e,K,f,G),v=0;v<g;v++){var Te,Be,Ie,Ce=0;v>1?(Te=m,Ce=-2,Be=Mv.NORM_TYPE,f[0]!=Mv.SHORT_TYPE&&f[1]!=Mv.SHORT_TYPE||(Be=Mv.SHORT_TYPE),Ie=i[a][v-2]):(Te=l,Ce=0,Be=f[v],Ie=r[a][v]),Be==Mv.SHORT_TYPE?Te[Ce+v]=$(Ie,E.masking_lower):Te[Ce+v]=V(Ie,E.masking_lower),e.analysis&&(E.pinfo.pe[a][v]=Te[Ce+v])}return 0};var Z=[-1730326e-23,-.01703172,-1349528e-23,.0418072,-673278e-22,-.0876324,-30835e-21,.1863476,-1104424e-22,-.627638];function W(e,t,n,s,o,a,r,i,l,c){for(var u=Fv([2,576]),d=e.internal_flags,m=d.channels_out,h=e.mode==_v.JOINT_STEREO?4:m,f=0;f<m;f++){firbuf=t[f];for(var g=n+576-350-p+192,_=0;_<576;_++){var v,b;v=firbuf[g+_+10],b=0;for(var y=0;y<(p-1)/2-1;y+=2)v+=Z[y]*(firbuf[g+_+y]+firbuf[g+_+p-y]),b+=Z[y+1]*(firbuf[g+_+y+1]+firbuf[g+_+p-y-1]);u[f][_]=v+b}o[s][f].en.assign(d.en[f]),o[s][f].thm.assign(d.thm[f]),h>2&&(a[s][f].en.assign(d.en[f+2]),a[s][f].thm.assign(d.thm[f+2]))}for(f=0;f<h;f++){var x=Ov(12),w=Ov(12),k=[0,0,0,0],S=u[1&f],M=0,A=3==f?d.nsPsy.attackthre_s:d.nsPsy.attackthre,R=1;if(2==f)for(_=0,y=576;y>0;++_,--y){var E=u[0][_],T=u[1][_];u[0][_]=E+T,u[1][_]=E-T}for(_=0;_<3;_++)w[_]=d.nsPsy.last_en_subshort[f][_+6],Pv(d.nsPsy.last_en_subshort[f][_+4]>0),x[_]=w[_]/d.nsPsy.last_en_subshort[f][_+4],k[0]+=w[_];for(_=0;_<9;_++){for(var B=M+64,I=1;M<B;M++)I<Math.abs(S[M])&&(I=Math.abs(S[M]));d.nsPsy.last_en_subshort[f][_]=w[_+3]=I,k[1+_/3]+=I,I>w[_+3-2]?(Pv(w[_+3-2]>0),I/=w[_+3-2]):I=w[_+3-2]>10*I?w[_+3-2]/(10*I):0,x[_+3]=I}for(_=0;_<3;++_){var C=w[3*_+3]+w[3*_+4]+w[3*_+5],j=1;6*w[3*_+5]<C&&(j*=.5,6*w[3*_+4]<C&&(j*=.5)),i[f][_]=j}if(e.analysis){var O=x[0];for(_=1;_<12;_++)O<x[_]&&(O=x[_]);d.pinfo.ers[s][f]=d.pinfo.ers_save[f],d.pinfo.ers_save[f]=O}for(_=0;_<12;_++)0==l[f][_/3]&&x[_]>A&&(l[f][_/3]=_%3+1);for(_=1;_<4;_++){var F=k[_-1],L=k[_],P=Math.max(F,L);P<4e4&&F<1.7*L&&L<1.7*F&&(1==_&&l[f][0]<=l[f][_]&&(l[f][0]=0),l[f][_]=0)}l[f][0]<=d.nsPsy.lastAttacks[f]&&(l[f][0]=0),3!=d.nsPsy.lastAttacks[f]&&l[f][0]+l[f][1]+l[f][2]+l[f][3]==0||(R=0,0!=l[f][1]&&0!=l[f][0]&&(l[f][1]=0),0!=l[f][2]&&0!=l[f][1]&&(l[f][2]=0),0!=l[f][3]&&0!=l[f][2]&&(l[f][3]=0)),f<2?c[f]=R:0==R&&(c[0]=c[1]=0),r[f]=d.tot_ener[f]}}function Q(e,t,n){if(0==n)for(var s=0;s<e.npart_s;s++)e.nb_s2[t][s]=e.nb_s1[t][s],e.nb_s1[t][s]=0}function J(e,t){for(var n=0;n<e.npart_l;n++)e.nb_2[t][n]=e.nb_1[t][n],e.nb_1[t][n]=0}function ee(e,t,n,s){var o=S.length-1,a=0,r=n[a]+n[a+1];if(r>0){var i=t[a];i<t[a+1]&&(i=t[a+1]),Pv(e.numlines_s[a]+e.numlines_s[a+1]-1>0),r=20*(2*i-r)/(r*(e.numlines_s[a]+e.numlines_s[a+1]-1));var l=0|r;l>o&&(l=o),s[a]=l}else s[a]=0;for(a=1;a<e.npart_s-1;a++)if(r=n[a-1]+n[a]+n[a+1],Pv(a+1<e.npart_s),r>0){i=t[a-1];i<t[a]&&(i=t[a]),i<t[a+1]&&(i=t[a+1]),Pv(e.numlines_s[a-1]+e.numlines_s[a]+e.numlines_s[a+1]-1>0),r=20*(3*i-r)/(r*(e.numlines_s[a-1]+e.numlines_s[a]+e.numlines_s[a+1]-1));l=0|r;l>o&&(l=o),s[a]=l}else s[a]=0;if(Pv(a==e.npart_s-1),r=n[a-1]+n[a],r>0){i=t[a-1];i<t[a]&&(i=t[a]),Pv(e.numlines_s[a-1]+e.numlines_s[a]-1>0),r=20*(2*i-r)/(r*(e.numlines_s[a-1]+e.numlines_s[a]-1));l=0|r;l>o&&(l=o),s[a]=l}else s[a]=0;Pv(a==e.npart_s-1)}function te(e,t,n,s,o,a){var r,i,l,c=e.internal_flags,u=new float[Mv.CBANDS],d=Ov(Mv.CBANDS),m=new int[Mv.CBANDS];for(l=i=0;l<c.npart_s;++l){var p=0,h=0,f=c.numlines_s[l];for(r=0;r<f;++r,++i){var g=t[a][i];p+=g,h<g&&(h=g)}n[l]=p,u[l]=h,d[l]=p/f,Pv(d[l]>=0)}for(Pv(l==c.npart_s);l<Mv.CBANDS;++l)u[l]=0,d[l]=0;for(ee(c,u,d,m),i=l=0;l<c.npart_s;l++){var _,v,b,y,x,w=c.s3ind_s[l][0],k=c.s3ind_s[l][1];_=m[w],v=1,y=c.s3_ss[i]*n[w]*S[m[w]],++i,++w;while(w<=k)_+=m[w],v+=1,b=c.s3_ss[i]*n[w]*S[m[w]],y=I(y,b,w-l),++i,++w;_=(1+2*_)/(2*v),x=.5*S[_],y*=x,s[l]=y,c.nb_s2[o][l]=c.nb_s1[o][l],c.nb_s1[o][l]=y,b=u[l],b*=c.minval_s[l],b*=x,s[l]>b&&(s[l]=b),c.masking_lower>1&&(s[l]*=c.masking_lower),s[l]>n[l]&&(s[l]=n[l]),c.masking_lower<1&&(s[l]*=c.masking_lower),Pv(s[l]>=0)}for(;l<Mv.CBANDS;++l)n[l]=0,s[l]=0}function ne(e,t,o,a,r){var i,l=Ov(Mv.CBANDS),c=Ov(Mv.CBANDS),u=Lv(Mv.CBANDS+2);q(e,t,o,l,c),U(e,l,c,u);var m=0;for(i=0;i<e.npart_l;i++){var p,h,f,g,_=e.s3ind[i][0],v=e.s3ind[i][1],b=0,y=0;b=u[_],y+=1,h=e.s3_ll[m]*o[_]*S[u[_]],++m,++_;while(_<=v)b+=u[_],y+=1,p=e.s3_ll[m]*o[_]*S[u[_]],g=I(h,p,_-i),h=g,++m,++_;if(b=(1+2*b)/(2*y),f=.5*S[b],h*=f,e.blocktype_old[1&r]==Mv.SHORT_TYPE){var x=n*e.nb_1[r][i];a[i]=x>0?Math.min(h,x):Math.min(h,o[i]*d)}else{var w=s*e.nb_2[r][i],k=n*e.nb_1[r][i];w<=0&&(w=h),k<=0&&(k=h),x=e.blocktype_old[1&r]==Mv.NORM_TYPE?Math.min(k,w):k,a[i]=Math.min(h,x)}e.nb_2[r][i]=e.nb_1[r][i],e.nb_1[r][i]=h,p=l[i],p*=e.minval_l[i],p*=f,a[i]>p&&(a[i]=p),e.masking_lower>1&&(a[i]*=e.masking_lower),a[i]>o[i]&&(a[i]=o[i]),e.masking_lower<1&&(a[i]*=e.masking_lower),Pv(a[i]>=0)}for(;i<Mv.CBANDS;++i)o[i]=0,a[i]=0}function se(e,t){var n=e.internal_flags;e.short_blocks!=Iv.short_block_coupled||0!=t[0]&&0!=t[1]||(t[0]=t[1]=0);for(var s=0;s<n.channels_out;s++)e.short_blocks==Iv.short_block_dispensed&&(t[s]=1),e.short_blocks==Iv.short_block_forced&&(t[s]=0)}function oe(e,t,n){for(var s=e.internal_flags,o=0;o<s.channels_out;o++){var a=Mv.NORM_TYPE;0!=t[o]?(Pv(s.blocktype_old[o]!=Mv.START_TYPE),s.blocktype_old[o]==Mv.SHORT_TYPE&&(a=Mv.STOP_TYPE)):(a=Mv.SHORT_TYPE,s.blocktype_old[o]==Mv.NORM_TYPE&&(s.blocktype_old[o]=Mv.START_TYPE),s.blocktype_old[o]==Mv.STOP_TYPE&&(s.blocktype_old[o]=Mv.SHORT_TYPE)),n[o]=s.blocktype_old[o],s.blocktype_old[o]=a}}function ae(e,t,n,s,o,a,r){for(var i,l,c=2*a,u=a>0?Math.pow(10,o):1,d=0;d<r;++d){var m=e[2][d],p=e[3][d],h=t[0][d],f=t[1][d],g=t[2][d],_=t[3][d];if(h<=1.58*f&&f<=1.58*h){var v=n[d]*p,b=n[d]*m;l=Math.max(g,Math.min(_,v)),i=Math.max(_,Math.min(g,b))}else l=g,i=_;if(a>0){var y,x,w=s[d]*u;if(y=Math.min(Math.max(h,w),Math.max(f,w)),g=Math.max(l,w),_=Math.max(i,w),x=g+_,x>0&&y*c<x){var k=y*c/x;g*=k,_*=k}l=Math.min(g,l),i=Math.min(_,i)}l>m&&(l=m),i>p&&(i=p),t[2][d]=l,t[3][d]=i}}function re(e,t){var n,s=e;return n=s>=0?27*-s:s*t,n<=-72?0:Math.exp(n*h)}function ie(e){var t=0,n=0,s=0;for(s=0;re(s,e)>1e-20;s-=1);o=s,a=0;while(Math.abs(a-o)>1e-12)s=(a+o)/2,re(s,e)>0?a=s:o=s;t=o;var o,a;s=0;for(s=0;re(s,e)>1e-20;s+=1);o=0,a=s;while(Math.abs(a-o)>1e-12)s=(a+o)/2,re(s,e)>0?o=s:a=s;n=a;var r,i=0,l=1e3;for(r=0;r<=l;++r){s=t+r*(n-t)/l;var c=re(s,e);i+=c}var u=(l+1)/(i*(n-t));return u}function le(e){var t,n,s,o;return t=e,t*=t>=0?3:1.5,t>=.5&&t<=2.5?(o=t-.5,n=8*(o*o-2*o)):n=0,t+=.474,s=15.811389+7.5*t-17.5*Math.sqrt(1+t*t),s<=-60?0:(t=Math.exp((n+s)*h),t/=.6609193,t)}function ce(e){return e<0&&(e=0),e*=.001,13*Math.atan(.76*e)+3.5*Math.atan(e*e/56.25)}function ue(e,t,n,s,o,a,i,l,c,u,d,m){var p,h=Ov(Mv.CBANDS+1),f=l/(m>15?1152:384),g=Lv(Mv.HBLKSIZE);l/=c;var _=0,v=0;for(p=0;p<Mv.CBANDS;p++){var b;for(E=ce(l*_),h[p]=l*_,b=_;ce(l*b)-E<r&&b<=c/2;b++);e[p]=b-_,v=p+1;while(_<b)g[_++]=p;if(_>c/2){_=c/2,++p;break}}h[p]=l*_;for(var y=0;y<m;y++){var x,w,k,S,M;k=u[y],S=u[y+1],x=0|Math.floor(.5+d*(k-.5)),x<0&&(x=0),w=0|Math.floor(.5+d*(S-.5)),w>c/2&&(w=c/2),n[y]=(g[x]+g[w])/2,t[y]=g[w];var A=f*S;i[y]=(A-h[t[y]])/(h[t[y]+1]-h[t[y]]),i[y]<0?i[y]=0:i[y]>1&&(i[y]=1),M=ce(l*u[y]*d),M=Math.min(M,15.5)/15.5,a[y]=Math.pow(10,1.25*(1-Math.cos(Math.PI*M))-2.5)}_=0;for(var R=0;R<v;R++){var E,T,B=e[R];E=ce(l*_),T=ce(l*(_+B-1)),s[R]=.5*(E+T),E=ce(l*(_-.5)),T=ce(l*(_+B-.5)),o[R]=T-E,_+=B}return v}function de(e,t,n,s,o,a){var r,i=Fv([Mv.CBANDS,Mv.CBANDS]),l=0;if(a)for(var c=0;c<t;c++)for(r=0;r<t;r++){var u=le(n[c]-n[r])*s[r];i[c][r]=u*o[c]}else for(r=0;r<t;r++){var d=15+Math.min(21/n[r],12),m=ie(d);for(c=0;c<t;c++){u=m*re(n[c]-n[r],d)*s[r];i[c][r]=u*o[c]}}for(c=0;c<t;c++){for(r=0;r<t;r++)if(i[c][r]>0)break;for(e[c][0]=r,r=t-1;r>0;r--)if(i[c][r]>0)break;e[c][1]=r,l+=e[c][1]-e[c][0]+1}var p=Ov(l),h=0;for(c=0;c<t;c++)for(r=e[c][0];r<=e[c][1];r++)p[h++]=i[c][r];return p}function me(e){var t=ce(e);return t=Math.min(t,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*t))-2.5)}function pe(e,t){e<-.3&&(e=3410),e/=1e3,e=Math.max(.1,e);var n=3.64*Math.pow(e,-.8)-6.8*Math.exp(-.6*Math.pow(e-3.4,2))+6*Math.exp(-.15*Math.pow(e-8.7,2))+.001*(.6+.04*t)*Math.pow(e,4);return n}this.L3psycho_anal_vbr=function(e,t,n,s,o,a,r,i,l,m){var p,h,f=e.internal_flags,g=Ov(Mv.HBLKSIZE),_=Fv([3,Mv.HBLKSIZE_s]),v=Fv([2,Mv.BLKSIZE]),b=Fv([2,3,Mv.BLKSIZE_s]),y=Fv([4,Mv.CBANDS]),x=Fv([4,Mv.CBANDS]),w=Fv([4,3]),k=.6,S=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],M=Lv(2),A=e.mode==_v.JOINT_STEREO?4:f.channels_out;W(e,t,n,s,o,a,l,w,S,M),se(e,M);for(var R=0;R<A;R++){var E=1&R;p=v,Y(e,t,n,R,s,g,p,E),K(e,s,R,g),0!=M[E]?ne(f,g,y[R],x[R],R):J(f,R)}M[0]+M[1]==2&&e.mode==_v.JOINT_STEREO&&ae(y,x,f.mld_cb_l,f.ATH.cb_l,e.ATHlower*f.ATH.adjust,e.msfix,f.npart_l);for(R=0;R<A;R++){E=1&R;0!=M[E]&&L(f,y[R],x[R],R)}for(var T=0;T<3;T++){for(R=0;R<A;++R){E=1&R;0!=M[E]?Q(f,R,T):(h=b,G(e,t,n,R,T,_,h,E),te(e,_,y[R],x[R],R,T))}M[0]+M[1]==0&&e.mode==_v.JOINT_STEREO&&ae(y,x,f.mld_cb_s,f.ATH.cb_s,e.ATHlower*f.ATH.adjust,e.msfix,f.npart_s);for(R=0;R<A;++R){E=1&R;0==M[E]&&F(f,y[R],x[R],R,T)}}for(R=0;R<A;R++){E=1&R;if(0==M[E])for(var B=0;B<Mv.SBMAX_s;B++){var I=Ov(3);for(T=0;T<3;T++){var C=f.thm[R].s[B][T];if(C*=c,S[R][T]>=2||1==S[R][T+1]){var j=0!=T?T-1:2,O=H(f.thm[R].s[B][j],C,u*k);C=Math.min(C,O)}else if(1==S[R][T]){j=0!=T?T-1:2,O=H(f.thm[R].s[B][j],C,d*k);C=Math.min(C,O)}else if(0!=T&&3==S[R][T-1]||0==T&&3==f.nsPsy.lastAttacks[R]){j=2!=T?T+1:0,O=H(f.thm[R].s[B][j],C,d*k);C=Math.min(C,O)}C*=w[R][T],I[T]=C}for(T=0;T<3;T++)f.thm[R].s[B][T]=I[T]}}for(R=0;R<A;R++)f.nsPsy.lastAttacks[R]=S[R][2];oe(e,M,m);for(R=0;R<A;R++){var P,D,N,z;R>1?(P=i,D=-2,N=Mv.NORM_TYPE,m[0]!=Mv.SHORT_TYPE&&m[1]!=Mv.SHORT_TYPE||(N=Mv.SHORT_TYPE),z=a[s][R-2]):(P=r,D=0,N=m[R],z=o[s][R]),N==Mv.SHORT_TYPE?P[D+R]=$(z,f.masking_lower):P[D+R]=V(z,f.masking_lower),e.analysis&&(f.pinfo.pe[s][R]=P[D+R])}return 0},this.psymodel_init=function(n){var s,o=n.internal_flags,a=!0,r=13,i=24,c=0,u=0,d=-8.25,p=-4.5,h=Ov(Mv.CBANDS),f=Ov(Mv.CBANDS),g=Ov(Mv.CBANDS),_=n.out_samplerate;switch(n.experimentalZ){default:case 0:a=!0;break;case 1:a=!(n.VBR==Tv.vbr_mtrh||n.VBR==Tv.vbr_mt);break;case 2:a=!1;break;case 3:r=8,c=-1.75,u=-.0125,d=-8.25,p=-2.25;break}for(o.ms_ener_ratio_old=.25,o.blocktype_old[0]=o.blocktype_old[1]=Mv.NORM_TYPE,s=0;s<4;++s){for(var v=0;v<Mv.CBANDS;++v)o.nb_1[s][v]=1e20,o.nb_2[s][v]=1e20,o.nb_s1[s][v]=o.nb_s2[s][v]=1;for(var b=0;b<Mv.SBMAX_l;b++)o.en[s].l[b]=1e20,o.thm[s].l[b]=1e20;for(v=0;v<3;++v){for(b=0;b<Mv.SBMAX_s;b++)o.en[s].s[b][v]=1e20,o.thm[s].s[b][v]=1e20;o.nsPsy.lastAttacks[s]=0}for(v=0;v<9;v++)o.nsPsy.last_en_subshort[s][v]=10}for(o.loudness_sq_save[0]=o.loudness_sq_save[1]=0,o.npart_l=ue(o.numlines_l,o.bo_l,o.bm_l,h,f,o.mld_l,o.PSY.bo_l_weight,_,Mv.BLKSIZE,o.scalefac_band.l,Mv.BLKSIZE/1152,Mv.SBMAX_l),Pv(o.npart_l<Mv.CBANDS),s=0;s<o.npart_l;s++){var y=c;h[s]>=r&&(y=u*(h[s]-r)/(i-r)+c*(i-h[s])/(i-r)),g[s]=Math.pow(10,y/10),o.numlines_l[s]>0?o.rnumlines_l[s]=1/o.numlines_l[s]:o.rnumlines_l[s]=0}o.s3_ll=de(o.s3ind,o.npart_l,h,f,g,a);var x;v=0;for(s=0;s<o.npart_l;s++){S=Bv.MAX_VALUE;for(var w=0;w<o.numlines_l[s];w++,v++){var k=_*v/(1e3*Mv.BLKSIZE);A=this.ATHformula(1e3*k,n)-20,A=Math.pow(10,.1*A),A*=o.numlines_l[s],S>A&&(S=A)}o.ATH.cb_l[s]=S,S=20*h[s]/10-20,S>6&&(S=100),S<-15&&(S=-15),S-=8,o.minval_l[s]=Math.pow(10,S/10)*o.numlines_l[s]}for(o.npart_s=ue(o.numlines_s,o.bo_s,o.bm_s,h,f,o.mld_s,o.PSY.bo_s_weight,_,Mv.BLKSIZE_s,o.scalefac_band.s,Mv.BLKSIZE_s/384,Mv.SBMAX_s),Pv(o.npart_s<Mv.CBANDS),v=0,s=0;s<o.npart_s;s++){var S;y=d;h[s]>=r&&(y=p*(h[s]-r)/(i-r)+d*(i-h[s])/(i-r)),g[s]=Math.pow(10,y/10),S=Bv.MAX_VALUE;for(w=0;w<o.numlines_s[s];w++,v++){var A;k=_*v/(1e3*Mv.BLKSIZE_s);A=this.ATHformula(1e3*k,n)-20,A=Math.pow(10,.1*A),A*=o.numlines_s[s],S>A&&(S=A)}o.ATH.cb_s[s]=S,S=7*h[s]/12-7,h[s]>12&&(S*=1+3.1*Math.log(1+S)),h[s]<12&&(S*=1+2.3*Math.log(1-S)),S<-15&&(S=-15),S-=8,o.minval_s[s]=Math.pow(10,S/10)*o.numlines_s[s]}o.s3_ss=de(o.s3ind_s,o.npart_s,h,f,g,a),M(),e.init_fft(o),o.decay=Math.exp(-1*t/(l*_/192)),x=m,0!=(2&n.exp_nspsytune)&&(x=1),Math.abs(n.msfix)>0&&(x=n.msfix),n.msfix=x;for(var R=0;R<o.npart_l;R++)o.s3ind[R][1]>o.npart_l-1&&(o.s3ind[R][1]=o.npart_l-1);var E=576*o.mode_gr/_;if(o.ATH.decay=Math.pow(10,-1.2*E),o.ATH.adjust=.01,o.ATH.adjustLimit=1,Pv(o.bo_l[Mv.SBMAX_l-1]<=o.npart_l),Pv(o.bo_s[Mv.SBMAX_s-1]<=o.npart_s),-1!=n.ATHtype){var T=n.out_samplerate/Mv.BLKSIZE,B=0;for(k=0,s=0;s<Mv.BLKSIZE/2;++s)k+=T,o.ATH.eql_w[s]=1/Math.pow(10,this.ATHformula(k,n)/10),B+=o.ATH.eql_w[s];for(B=1/B,s=Mv.BLKSIZE/2;--s>=0;)o.ATH.eql_w[s]*=B}for(R=v=0;R<o.npart_s;++R)for(s=0;s<o.numlines_s[R];++s)++v;for(R=v=0;R<o.npart_l;++R)for(s=0;s<o.numlines_l[R];++s)++v;for(v=0,s=0;s<o.npart_l;s++){k=_*(v+o.numlines_l[s]/2)/(1*Mv.BLKSIZE);o.mld_cb_l[s]=me(k),v+=o.numlines_l[s]}for(;s<Mv.CBANDS;++s)o.mld_cb_l[s]=1;for(v=0,s=0;s<o.npart_s;s++){k=_*(v+o.numlines_s[s]/2)/(1*Mv.BLKSIZE_s);o.mld_cb_s[s]=me(k),v+=o.numlines_s[s]}for(;s<Mv.CBANDS;++s)o.mld_cb_s[s]=1;return 0},this.ATHformula=function(e,t){var n;switch(t.ATHtype){case 0:n=pe(e,9);break;case 1:n=pe(e,-1);break;case 2:n=pe(e,0);break;case 3:n=pe(e,1)+6;break;case 4:n=pe(e,t.ATHcurve);break;default:n=pe(e,0);break}return n}}function Hv(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=_v.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}var Nv={};Nv.SFBMAX=3*Mv.SBMAX_s;var $v=rv.new_float,zv=rv.new_int;function Vv(){this.xr=$v(576),this.l3_enc=zv(576),this.scalefac=zv(Nv.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=zv(3),this.subblock_gain=zv(4),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=zv(Nv.SFBMAX),this.window=zv(Nv.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=zv(4),this.max_nonzero_coeff=0;var e=this;function t(e){return new Int32Array(e)}function n(e){return new Float32Array(e)}this.assign=function(s){e.xr=n(s.xr),e.l3_enc=t(s.l3_enc),e.scalefac=t(s.scalefac),e.xrpow_max=s.xrpow_max,e.part2_3_length=s.part2_3_length,e.big_values=s.big_values,e.count1=s.count1,e.global_gain=s.global_gain,e.scalefac_compress=s.scalefac_compress,e.block_type=s.block_type,e.mixed_block_flag=s.mixed_block_flag,e.table_select=t(s.table_select),e.subblock_gain=t(s.subblock_gain),e.region0_count=s.region0_count,e.region1_count=s.region1_count,e.preflag=s.preflag,e.scalefac_scale=s.scalefac_scale,e.count1table_select=s.count1table_select,e.part2_length=s.part2_length,e.sfb_lmax=s.sfb_lmax,e.sfb_smin=s.sfb_smin,e.psy_lmax=s.psy_lmax,e.sfbmax=s.sfbmax,e.psymax=s.psymax,e.sfbdivide=s.sfbdivide,e.width=t(s.width),e.window=t(s.window),e.count1bits=s.count1bits,e.sfb_partition_table=s.sfb_partition_table.slice(0),e.slen=t(s.slen),e.max_nonzero_coeff=s.max_nonzero_coeff}}var qv=rv.new_int;function Uv(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[qv(4),qv(4)];for(var e=0;e<2;e++)for(var t=0;t<2;t++)this.tt[e][t]=new Vv}var Xv=rv.System,Yv=rv.new_int;function Gv(e,t,n,s){this.l=Yv(1+Mv.SBMAX_l),this.s=Yv(1+Mv.SBMAX_s),this.psfb21=Yv(1+Mv.PSFB21),this.psfb12=Yv(1+Mv.PSFB12);var o=this.l,a=this.s;4==arguments.length&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],Xv.arraycopy(this.arrL,0,o,0,Math.min(this.arrL.length,this.l.length)),Xv.arraycopy(this.arrS,0,a,0,Math.min(this.arrS.length,this.s.length)),Xv.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),Xv.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}var Kv=rv.new_float,Zv=rv.new_float_n,Wv=rv.new_int;function Qv(){this.last_en_subshort=Zv([4,9]),this.lastAttacks=Wv(4),this.pefirbuf=Kv(19),this.longfact=Kv(Mv.SBMAX_l),this.shortfact=Kv(Mv.SBMAX_s),this.attackthre=0,this.attackthre_s=0}function Jv(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}var eb=rv.new_byte,tb=rv.new_double,nb=rv.new_float,sb=rv.new_float_n,ob=rv.new_int,ab=rv.new_int_n;function rb(){var e=40;function t(){this.write_timing=0,this.ptr=0,this.buf=eb(e)}this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=sb([2,rb.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new Uv,this.ms_ratio=nb(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=ob(2),this.CurrentStep=ob(2),this.masking_lower=0,this.bv_scf=ob(576),this.pseudohalf=ob(Nv.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*rb.BPC+1),this.itime=tb(2),this.sideinfo_len=0,this.sb_sample=sb([2,2,18,Mv.SBLIMIT]),this.amp_filter=nb(32),this.header=new Array(rb.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new Gv,this.minval_l=nb(Mv.CBANDS),this.minval_s=nb(Mv.CBANDS),this.nb_1=sb([4,Mv.CBANDS]),this.nb_2=sb([4,Mv.CBANDS]),this.nb_s1=sb([4,Mv.CBANDS]),this.nb_s2=sb([4,Mv.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=nb(4),this.loudness_sq=sb([2,2]),this.loudness_sq_save=nb(2),this.mld_l=nb(Mv.SBMAX_l),this.mld_s=nb(Mv.SBMAX_s),this.bm_l=ob(Mv.SBMAX_l),this.bo_l=ob(Mv.SBMAX_l),this.bm_s=ob(Mv.SBMAX_s),this.bo_s=ob(Mv.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=ab([Mv.CBANDS,2]),this.s3ind_s=ab([Mv.CBANDS,2]),this.numlines_s=ob(Mv.CBANDS),this.numlines_l=ob(Mv.CBANDS),this.rnumlines_l=nb(Mv.CBANDS),this.mld_cb_l=nb(Mv.CBANDS),this.mld_cb_s=nb(Mv.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=nb(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=ob(2),this.nsPsy=new Qv,this.VBR_seek_table=new Jv,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=ab([16,5]),this.bitrate_blockType_Hist=ab([16,6]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var n=0;n<this.en.length;n++)this.en[n]=new fv;for(n=0;n<this.thm.length;n++)this.thm[n]=new fv;for(n=0;n<this.header.length;n++)this.header[n]=new t}rb.MFSIZE=3456+Mv.ENCDELAY-Mv.MDCTDELAY,rb.MAX_HEADER_BUF=256,rb.MAX_BITS_PER_CHANNEL=4095,rb.MAX_BITS_PER_GRANULE=7680,rb.BPC=320;var ib=rv.new_float;function lb(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=ib(Mv.SBMAX_l),this.s=ib(Mv.SBMAX_s),this.psfb21=ib(Mv.PSFB21),this.psfb12=ib(Mv.PSFB12),this.cb_l=ib(Mv.CBANDS),this.cb_s=ib(Mv.CBANDS),this.eql_w=ib(Mv.BLKSIZE/2)}var cb=rv.System,ub=rv.Arrays;function db(){var e=64.82,t=.95,n=db.RMS_WINDOW_TIME_NUMERATOR,s=db.RMS_WINDOW_TIME_DENOMINATOR,o=[[.038575994352,-3.84664617118067,-.02160367184185,7.81501653005538,-.00123395316851,-11.34170355132042,-9291677959e-14,13.05504219327545,-.01655260341619,-12.28759895145294,.02161526843274,9.4829380631979,-.02074045215285,-5.87257861775999,.00594298065125,2.75465861874613,.00306428023191,-.86984376593551,.00012025322027,.13919314567432,.00288463683916],[.0541865640643,-3.47845948550071,-.02911007808948,6.36317777566148,-.00848709379851,-8.54751527471874,-.00851165645469,9.4769360780128,-.00834990904936,-8.81498681370155,.02245293253339,6.85401540936998,-.02596338512915,-4.39470996079559,.01624864962975,2.19611684890774,-.00240879051584,-.75104302451432,.00674613682247,.13149317958808,-.00187763777362],[.15457299681924,-2.37898834973084,-.09331049056315,2.84868151156327,-.06247880153653,-2.64577170229825,.02163541888798,2.23697657451713,-.05588393329856,-1.67148153367602,.04781476674921,1.00595954808547,.00222312597743,-.45953458054983,.03174092540049,.16378164858596,-.01390589421898,-.05032077717131,.00651420667831,.0234789740702,-.00881362733839],[.30296907319327,-1.61273165137247,-.22613988682123,1.0797749225997,-.08587323730772,-.2565625775407,.03282930172664,-.1627671912044,-.00915702933434,-.22638893773906,-.02364141202522,.39120800788284,-.00584456039913,-.22138138954925,.06276101321749,.04500235387352,-828086748e-14,.02005851806501,.00205861885564,.00302439095741,-.02950134983287],[.33642304856132,-1.49858979367799,-.2557224142557,.87350271418188,-.11828570177555,.12205022308084,.11921148675203,-.80774944671438,-.07834489609479,.47854794562326,-.0046997791438,-.12453458140019,-.0058950022444,-.04067510197014,.05724228140351,.08333755284107,.00832043980773,-.04237348025746,-.0163538138454,.02977207319925,-.0176017656815],[.4491525660845,-.62820619233671,-.14351757464547,.29661783706366,-.22784394429749,-.372563729424,-.01419140100551,.00213767857124,.04078262797139,-.42029820170918,-.12398163381748,.22199650564824,.04097565135648,.00613424350682,.10478503600251,.06747620744683,-.01863887810927,.05784820375801,-.03193428438915,.03222754072173,.00541907748707],[.56619470757641,-1.04800335126349,-.75464456939302,.29156311971249,.1624213774223,-.26806001042947,.16744243493672,.00819999645858,-.18901604199609,.45054734505008,.3093178284183,-.33032403314006,-.27562961986224,.0673936833311,.00647310677246,-.04784254229033,.08647503780351,.01639907836189,-.0378898455484,.01807364323573,-.00588215443421],[.58100494960553,-.51035327095184,-.53174909058578,-.31863563325245,-.14289799034253,-.20256413484477,.17520704835522,.1472815413433,.02377945217615,.38952639978999,.15558449135573,-.23313271880868,-.25344790059353,-.05246019024463,.01628462406333,-.02505961724053,.06920467763959,.02442357316099,-.03721611395801,.01818801111503,-.00749618797172],[.53648789255105,-.2504987195602,-.42163034350696,-.43193942311114,-.00275953611929,-.03424681017675,.04267842219415,-.04678328784242,-.10214864179676,.26408300200955,.14590772289388,.15113130533216,-.02459864859345,-.17556493366449,-.11202315195388,-.18823009262115,-.04060034127,.05477720428674,.0478866554818,.0470440968812,-.02217936801134]],a=[[.98621192462708,-1.97223372919527,-1.97242384925416,.97261396931306,.98621192462708],[.98500175787242,-1.96977855582618,-1.97000351574484,.9702284756635,.98500175787242],[.97938932735214,-1.95835380975398,-1.95877865470428,.95920349965459,.97938932735214],[.97531843204928,-1.95002759149878,-1.95063686409857,.95124613669835,.97531843204928],[.97316523498161,-1.94561023566527,-1.94633046996323,.94705070426118,.97316523498161],[.96454515552826,-1.92783286977036,-1.92909031105652,.93034775234268,.96454515552826],[.96009142950541,-1.91858953033784,-1.92018285901082,.92177618768381,.96009142950541],[.95856916599601,-1.9154210807478,-1.91713833199203,.91885558323625,.95856916599601],[.94597685600279,-1.88903307939452,-1.89195371200558,.89487434461664,.94597685600279]];function r(e,t,n,s,o,a){while(0!=o--)n[s]=1e-10+e[t+0]*a[0]-n[s-1]*a[1]+e[t-1]*a[2]-n[s-2]*a[3]+e[t-2]*a[4]-n[s-3]*a[5]+e[t-3]*a[6]-n[s-4]*a[7]+e[t-4]*a[8]-n[s-5]*a[9]+e[t-5]*a[10]-n[s-6]*a[11]+e[t-6]*a[12]-n[s-7]*a[13]+e[t-7]*a[14]-n[s-8]*a[15]+e[t-8]*a[16]-n[s-9]*a[17]+e[t-9]*a[18]-n[s-10]*a[19]+e[t-10]*a[20],++s,++t}function i(e,t,n,s,o,a){while(0!=o--)n[s]=e[t+0]*a[0]-n[s-1]*a[1]+e[t-1]*a[2]-n[s-2]*a[3]+e[t-2]*a[4],++s,++t}function l(e,t){for(var o=0;o<MAX_ORDER;o++)e.linprebuf[o]=e.lstepbuf[o]=e.loutbuf[o]=e.rinprebuf[o]=e.rstepbuf[o]=e.routbuf[o]=0;switch(0|t){case 48e3:e.reqindex=0;break;case 44100:e.reqindex=1;break;case 32e3:e.reqindex=2;break;case 24e3:e.reqindex=3;break;case 22050:e.reqindex=4;break;case 16e3:e.reqindex=5;break;case 12e3:e.reqindex=6;break;case 11025:e.reqindex=7;break;case 8e3:e.reqindex=8;break;default:return INIT_GAIN_ANALYSIS_ERROR}return e.sampleWindow=0|(t*n+s-1)/s,e.lsum=0,e.rsum=0,e.totsamp=0,ub.ill(e.A,0),INIT_GAIN_ANALYSIS_OK}function c(e){return e*e}function u(n,s){var o,a=0;for(o=0;o<s;o++)a+=n[o];if(0==a)return GAIN_NOT_ENOUGH_SAMPLES;var r=0|Math.ceil(a*(1-t));for(o=s;o-- >0;)if((r-=n[o])<=0)break;return e-o/db.STEPS_per_dB}this.InitGainAnalysis=function(e,t){return l(e,t)!=INIT_GAIN_ANALYSIS_OK?INIT_GAIN_ANALYSIS_ERROR:(e.linpre=MAX_ORDER,e.rinpre=MAX_ORDER,e.lstep=MAX_ORDER,e.rstep=MAX_ORDER,e.lout=MAX_ORDER,e.rout=MAX_ORDER,ub.fill(e.B,0),INIT_GAIN_ANALYSIS_OK)},this.AnalyzeSamples=function(e,t,n,s,l,u,d){var m,p,h,f,g,_,v;if(0==u)return GAIN_ANALYSIS_OK;switch(v=0,g=u,d){case 1:s=t,l=n;break;case 2:break;default:return GAIN_ANALYSIS_ERROR}u<MAX_ORDER?(cb.arraycopy(t,n,e.linprebuf,MAX_ORDER,u),cb.arraycopy(s,l,e.rinprebuf,MAX_ORDER,u)):(cb.arraycopy(t,n,e.linprebuf,MAX_ORDER,MAX_ORDER),cb.arraycopy(s,l,e.rinprebuf,MAX_ORDER,MAX_ORDER));while(g>0){_=g>e.sampleWindow-e.totsamp?e.sampleWindow-e.totsamp:g,v<MAX_ORDER?(m=e.linpre+v,p=e.linprebuf,h=e.rinpre+v,f=e.rinprebuf,_>MAX_ORDER-v&&(_=MAX_ORDER-v)):(m=n+v,p=t,h=l+v,f=s),r(p,m,e.lstepbuf,e.lstep+e.totsamp,_,o[e.reqindex]),r(f,h,e.rstepbuf,e.rstep+e.totsamp,_,o[e.reqindex]),i(e.lstepbuf,e.lstep+e.totsamp,e.loutbuf,e.lout+e.totsamp,_,a[e.reqindex]),i(e.rstepbuf,e.rstep+e.totsamp,e.routbuf,e.rout+e.totsamp,_,a[e.reqindex]),m=e.lout+e.totsamp,p=e.loutbuf,h=e.rout+e.totsamp,f=e.routbuf;var b=_%8;while(0!=b--)e.lsum+=c(p[m++]),e.rsum+=c(f[h++]);b=_/8;while(0!=b--)e.lsum+=c(p[m+0])+c(p[m+1])+c(p[m+2])+c(p[m+3])+c(p[m+4])+c(p[m+5])+c(p[m+6])+c(p[m+7]),m+=8,e.rsum+=c(f[h+0])+c(f[h+1])+c(f[h+2])+c(f[h+3])+c(f[h+4])+c(f[h+5])+c(f[h+6])+c(f[h+7]),h+=8;if(g-=_,v+=_,e.totsamp+=_,e.totsamp==e.sampleWindow){var y=10*db.STEPS_per_dB*Math.log10((e.lsum+e.rsum)/e.totsamp*.5+1e-37),x=y<=0?0:0|y;x>=e.A.length&&(x=e.A.length-1),e.A[x]++,e.lsum=e.rsum=0,cb.arraycopy(e.loutbuf,e.totsamp,e.loutbuf,0,MAX_ORDER),cb.arraycopy(e.routbuf,e.totsamp,e.routbuf,0,MAX_ORDER),cb.arraycopy(e.lstepbuf,e.totsamp,e.lstepbuf,0,MAX_ORDER),cb.arraycopy(e.rstepbuf,e.totsamp,e.rstepbuf,0,MAX_ORDER),e.totsamp=0}if(e.totsamp>e.sampleWindow)return GAIN_ANALYSIS_ERROR}return u<MAX_ORDER?(cb.arraycopy(e.linprebuf,u,e.linprebuf,0,MAX_ORDER-u),cb.arraycopy(e.rinprebuf,u,e.rinprebuf,0,MAX_ORDER-u),cb.arraycopy(t,n,e.linprebuf,MAX_ORDER-u,u),cb.arraycopy(s,l,e.rinprebuf,MAX_ORDER-u,u)):(cb.arraycopy(t,n+u-MAX_ORDER,e.linprebuf,0,MAX_ORDER),cb.arraycopy(s,l+u-MAX_ORDER,e.rinprebuf,0,MAX_ORDER)),GAIN_ANALYSIS_OK},this.GetTitleGain=function(e){for(var t=u(e.A,e.A.length),n=0;n<e.A.length;n++)e.B[n]+=e.A[n],e.A[n]=0;for(n=0;n<MAX_ORDER;n++)e.linprebuf[n]=e.lstepbuf[n]=e.loutbuf[n]=e.rinprebuf[n]=e.rstepbuf[n]=e.routbuf[n]=0;return e.totsamp=0,e.lsum=e.rsum=0,t}}db.STEPS_per_dB=100,db.MAX_dB=120,db.GAIN_NOT_ENOUGH_SAMPLES=-24601,db.GAIN_ANALYSIS_ERROR=0,db.GAIN_ANALYSIS_OK=1,db.INIT_GAIN_ANALYSIS_ERROR=0,db.INIT_GAIN_ANALYSIS_OK=1,db.YULE_ORDER=10,db.MAX_ORDER=db.YULE_ORDER,db.MAX_SAMP_FREQ=48e3,db.RMS_WINDOW_TIME_NUMERATOR=1,db.RMS_WINDOW_TIME_DENOMINATOR=20,db.MAX_SAMPLES_PER_WINDOW=db.MAX_SAMP_FREQ*db.RMS_WINDOW_TIME_NUMERATOR/db.RMS_WINDOW_TIME_DENOMINATOR+1;var mb=rv.new_float,pb=rv.new_int;function hb(){this.linprebuf=mb(NaN),this.linpre=0,this.lstepbuf=mb(NaN),this.lstep=0,this.loutbuf=mb(NaN),this.lout=0,this.rinprebuf=mb(NaN),this.rinpre=0,this.rstepbuf=mb(NaN),this.rstep=0,this.routbuf=mb(NaN),this.rout=0,this.sampleWindow=0,this.totsamp=0,this.lsum=0,this.rsum=0,this.freqindex=0,this.first=0,this.A=pb(0),this.B=pb(0)}function fb(e){this.bits=e}var gb=rv.new_float,_b=rv.new_int,vb=rv.assert;function bb(e){var t=e;this.quantize=t,this.iteration_loop=function(e,t,n,s){var o,a=e.internal_flags,r=gb(Nv.SFBMAX),i=gb(576),l=_b(2),c=0,u=a.l3_side,d=new fb(c);this.quantize.rv.ResvFrameBegin(e,d),c=d.bits;for(var m=0;m<a.mode_gr;m++){o=this.quantize.qupvt.on_pe(e,t,l,c,m,m),a.mode_ext==Mv.MPG_MD_MS_LR&&(this.quantize.ms_convert(a.l3_side,m),this.quantize.qupvt.reduce_side(l,n[m],c,o));for(var p=0;p<a.channels_out;p++){var h,f,g=u.tt[m][p];g.block_type!=Mv.SHORT_TYPE?(h=0,f=a.PSY.mask_adjust-h):(h=0,f=a.PSY.mask_adjust_short-h),a.masking_lower=Math.pow(10,.1*f),this.quantize.init_outer_loop(a,g),this.quantize.init_xrpow(a,g,i)&&(this.quantize.qupvt.calc_xmin(e,s[m][p],g,r),this.quantize.outer_loop(e,g,r,i,p,l[p])),this.quantize.iteration_finish_one(a,m,p),vb(g.part2_3_length<=rb.MAX_BITS_PER_CHANNEL),vb(g.part2_3_length<=l[p])}}this.quantize.rv.ResvFrameEnd(a,c)}}function yb(e,t,n,s){this.xlen=e,this.linmax=t,this.table=n,this.hlen=s}var xb={t1HB:[1,1,1,0],t2HB:[1,2,1,3,1,1,3,2,0],t3HB:[3,2,1,1,1,1,3,2,0],t5HB:[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0],t6HB:[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0],t7HB:[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0],t8HB:[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0],t9HB:[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0],t10HB:[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0],t11HB:[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0],t12HB:[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0],t13HB:[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1],t15HB:[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0],t16HB:[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3],t24HB:[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3],t32HB:[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16],t33HB:[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0],t1l:[1,4,3,5],t2l:[1,4,7,4,5,7,6,7,8],t3l:[2,3,7,4,4,7,6,7,8],t5l:[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10],t6l:[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9],t7l:[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12],t8l:[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13],t9l:[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11],t10l:[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13],t11l:[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12],t12l:[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12],t13l:[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18],t15l:[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15],t16_5l:[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12],t16l:[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10],t24l:[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6],t32l:[1,5,5,7,5,8,7,9,5,7,7,9,7,9,9,10],t33l:[4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8]};xb.ht=[new yb(0,0,null,null),new yb(2,0,xb.t1HB,xb.t1l),new yb(3,0,xb.t2HB,xb.t2l),new yb(3,0,xb.t3HB,xb.t3l),new yb(0,0,null,null),new yb(4,0,xb.t5HB,xb.t5l),new yb(4,0,xb.t6HB,xb.t6l),new yb(6,0,xb.t7HB,xb.t7l),new yb(6,0,xb.t8HB,xb.t8l),new yb(6,0,xb.t9HB,xb.t9l),new yb(8,0,xb.t10HB,xb.t10l),new yb(8,0,xb.t11HB,xb.t11l),new yb(8,0,xb.t12HB,xb.t12l),new yb(16,0,xb.t13HB,xb.t13l),new yb(0,0,null,xb.t16_5l),new yb(16,0,xb.t15HB,xb.t15l),new yb(1,1,xb.t16HB,xb.t16l),new yb(2,3,xb.t16HB,xb.t16l),new yb(3,7,xb.t16HB,xb.t16l),new yb(4,15,xb.t16HB,xb.t16l),new yb(6,63,xb.t16HB,xb.t16l),new yb(8,255,xb.t16HB,xb.t16l),new yb(10,1023,xb.t16HB,xb.t16l),new yb(13,8191,xb.t16HB,xb.t16l),new yb(4,15,xb.t24HB,xb.t24l),new yb(5,31,xb.t24HB,xb.t24l),new yb(6,63,xb.t24HB,xb.t24l),new yb(7,127,xb.t24HB,xb.t24l),new yb(8,255,xb.t24HB,xb.t24l),new yb(9,511,xb.t24HB,xb.t24l),new yb(11,2047,xb.t24HB,xb.t24l),new yb(13,8191,xb.t24HB,xb.t24l),new yb(0,0,xb.t32HB,xb.t32l),new yb(0,0,xb.t33HB,xb.t33l)],xb.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366],xb.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296],xb.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369],xb.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]],xb.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]],xb.scfsi_band=[0,6,11,16,21];var wb=rv.VbrMode,kb=rv.Float,Sb=rv.Util,Mb=rv.new_float,Ab=rv.new_int,Rb=rv.assert;function Eb(){var e=null,t=null,n=null;function s(e){return d[e+Eb.Q_MAX2]}this.setModules=function(s,o,a){e=s,t=o,n=a},this.IPOW20=function(e){return m[e]};var o=2220446049250313e-31,a=Eb.IXMAX_VAL,r=a+2,i=Eb.Q_MAX,l=Eb.Q_MAX2,c=100;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var u=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=u,this.sfBandIndex=[new Gv([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Gv([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Gv([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Gv([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Gv([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Gv([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Gv([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Gv([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Gv([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0,8,16,24,36,52,72,96,124,160,162,164,166,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var d=Mb(i+l+1),m=Mb(i),p=Mb(r),h=Mb(r);function f(e,t){var s=n.ATHformula(t,e);return s-=c,s=Math.pow(10,s/10+e.ATHlower),s}function g(e){for(var t=e.internal_flags.ATH.l,n=e.internal_flags.ATH.psfb21,s=e.internal_flags.ATH.s,o=e.internal_flags.ATH.psfb12,a=e.internal_flags,r=e.out_samplerate,i=0;i<Mv.SBMAX_l;i++){var l=a.scalefac_band.l[i],c=a.scalefac_band.l[i+1];t[i]=kb.MAX_VALUE;for(var u=l;u<c;u++){var d=u*r/1152,m=f(e,d);t[i]=Math.min(t[i],m)}}for(i=0;i<Mv.PSFB21;i++){l=a.scalefac_band.psfb21[i],c=a.scalefac_band.psfb21[i+1];n[i]=kb.MAX_VALUE;for(u=l;u<c;u++){d=u*r/1152,m=f(e,d);n[i]=Math.min(n[i],m)}}for(i=0;i<Mv.SBMAX_s;i++){l=a.scalefac_band.s[i],c=a.scalefac_band.s[i+1];s[i]=kb.MAX_VALUE;for(u=l;u<c;u++){d=u*r/384,m=f(e,d);s[i]=Math.min(s[i],m)}s[i]*=a.scalefac_band.s[i+1]-a.scalefac_band.s[i]}for(i=0;i<Mv.PSFB12;i++){l=a.scalefac_band.psfb12[i],c=a.scalefac_band.psfb12[i+1];o[i]=kb.MAX_VALUE;for(u=l;u<c;u++){d=u*r/384,m=f(e,d);o[i]=Math.min(o[i],m)}o[i]*=a.scalefac_band.s[13]-a.scalefac_band.s[12]}if(e.noATH){for(i=0;i<Mv.SBMAX_l;i++)t[i]=1e-20;for(i=0;i<Mv.PSFB21;i++)n[i]=1e-20;for(i=0;i<Mv.SBMAX_s;i++)s[i]=1e-20;for(i=0;i<Mv.PSFB12;i++)o[i]=1e-20}a.ATH.floor=10*Math.log10(f(e,-1))}function _(e){this.s=e}this.adj43=h,this.iteration_init=function(t){var n,s=t.internal_flags,o=s.l3_side;if(0==s.iteration_init_init){for(s.iteration_init_init=1,o.main_data_begin=0,g(t),p[0]=0,n=1;n<r;n++)p[n]=Math.pow(n,4/3);for(n=0;n<r-1;n++)h[n]=n+1-Math.pow(.5*(p[n]+p[n+1]),.75);for(h[n]=.5,n=0;n<i;n++)m[n]=Math.pow(2,-.1875*(n-210));for(n=0;n<=i+l;n++)d[n]=Math.pow(2,.25*(n-210-l));var a,c,u,f;for(e.huffman_init(s),n=t.exp_nspsytune>>2&63,n>=32&&(n-=64),a=Math.pow(10,n/4/10),n=t.exp_nspsytune>>8&63,n>=32&&(n-=64),c=Math.pow(10,n/4/10),n=t.exp_nspsytune>>14&63,n>=32&&(n-=64),u=Math.pow(10,n/4/10),n=t.exp_nspsytune>>20&63,n>=32&&(n-=64),f=u*Math.pow(10,n/4/10),n=0;n<Mv.SBMAX_l;n++){_=n<=6?a:n<=13?c:n<=20?u:f,s.nsPsy.longfact[n]=_}for(n=0;n<Mv.SBMAX_s;n++){var _;_=n<=5?a:n<=10?c:n<=11?u:f,s.nsPsy.shortfact[n]=_}}},this.on_pe=function(e,n,s,o,a,r){var i,l,c=e.internal_flags,u=0,d=Ab(2),m=new fb(u),p=t.ResvMaxBits(e,o,m,r);u=m.bits;var h=u+p;for(h>rb.MAX_BITS_PER_GRANULE&&(h=rb.MAX_BITS_PER_GRANULE),i=0,l=0;l<c.channels_out;++l)s[l]=Math.min(rb.MAX_BITS_PER_CHANNEL,u/c.channels_out),d[l]=0|s[l]*n[a][l]/700-s[l],d[l]>3*o/4&&(d[l]=3*o/4),d[l]<0&&(d[l]=0),d[l]+s[l]>rb.MAX_BITS_PER_CHANNEL&&(d[l]=Math.max(0,rb.MAX_BITS_PER_CHANNEL-s[l])),i+=d[l];if(i>p)for(l=0;l<c.channels_out;++l)d[l]=p*d[l]/i;for(l=0;l<c.channels_out;++l)s[l]+=d[l],p-=d[l];for(i=0,l=0;l<c.channels_out;++l)i+=s[l];if(i>rb.MAX_BITS_PER_GRANULE){for(l=0;l<c.channels_out;++l)s[l]*=rb.MAX_BITS_PER_GRANULE,s[l]/=i,s[l]}return h},this.reduce_side=function(e,t,n,s){Rb(e[0]+e[1]<=rb.MAX_BITS_PER_GRANULE);var o=.33*(.5-t)/.5;o<0&&(o=0),o>.5&&(o=.5);var a=0|.5*o*(e[0]+e[1]);a>rb.MAX_BITS_PER_CHANNEL-e[0]&&(a=rb.MAX_BITS_PER_CHANNEL-e[0]),a<0&&(a=0),e[1]>=125&&(e[1]-a>125?(e[0]<n&&(e[0]+=a),e[1]-=a):(e[0]+=e[1]-125,e[1]=125)),a=e[0]+e[1],a>s&&(e[0]=s*e[0]/a,e[1]=s*e[1]/a),Rb(e[0]<=rb.MAX_BITS_PER_CHANNEL),Rb(e[1]<=rb.MAX_BITS_PER_CHANNEL),Rb(e[0]+e[1]<=rb.MAX_BITS_PER_GRANULE)},this.athAdjust=function(e,t,n){var s=90.30873362,o=94.82444863,a=Sb.FAST_LOG10_X(t,10),r=e*e,i=0;return a-=n,r>1e-20&&(i=1+Sb.FAST_LOG10_X(r,10/s)),i<0&&(i=0),a*=i,a+=n+s-o,Math.pow(10,.1*a)},this.calc_xmin=function(e,t,n,s){var a,r=0,i=e.internal_flags,l=0,c=0,u=i.ATH,d=n.xr,m=e.VBR==wb.vbr_mtrh?1:0,p=i.masking_lower;for(e.VBR!=wb.vbr_mtrh&&e.VBR!=wb.vbr_mt||(p=1),a=0;a<n.psy_lmax;a++){w=e.VBR==wb.vbr_rh||e.VBR==wb.vbr_mtrh?athAdjust(u.adjust,u.l[a],u.floor):u.adjust*u.l[a],b=n.width[a],k=w/b,S=o,A=b>>1,M=0;do{R=d[l]*d[l],M+=R,S+=R<k?R:k,l++,E=d[l]*d[l],M+=E,S+=E<k?E:k,l++}while(--A>0);if(M>w&&c++,a==Mv.SBPSY_l){var h=w*i.nsPsy.longfact[a];S<h&&(S=h)}if(0!=m&&(w=S),!e.ATHonly){var f=t.en.l[a];if(f>0)h=M*t.thm.l[a]*p/f,0!=m&&(h*=i.nsPsy.longfact[a]),w<h&&(w=h)}s[r++]=0!=m?w:w*i.nsPsy.longfact[a]}var g=575;if(n.block_type!=Mv.SHORT_TYPE){var _=576;while(0!=_--&&Nb.EQ(d[_],0))g=_}n.max_nonzero_coeff=g;for(var v=n.sfb_smin;a<n.psymax;v++,a+=3){var b,y,x;for(x=e.VBR==wb.vbr_rh||e.VBR==wb.vbr_mtrh?athAdjust(u.adjust,u.s[v],u.floor):u.adjust*u.s[v],b=n.width[a],y=0;y<3;y++){var w,k,S,M=0,A=b>>1;k=x/b,S=o;do{var R,E;R=d[l]*d[l],M+=R,S+=R<k?R:k,l++,E=d[l]*d[l],M+=E,S+=E<k?E:k,l++}while(--A>0);if(M>x&&c++,v==Mv.SBPSY_s){h=x*i.nsPsy.shortfact[v];S<h&&(S=h)}if(w=0!=m?S:x,!e.ATHonly&&!e.ATHshort){f=t.en.s[v][y];if(f>0)h=M*t.thm.s[v][y]*p/f,0!=m&&(h*=i.nsPsy.shortfact[v]),w<h&&(w=h)}s[r++]=0!=m?w:w*i.nsPsy.shortfact[v]}e.useTemporal&&(s[r-3]>s[r-3+1]&&(s[r-3+1]+=(s[r-3]-s[r-3+1])*i.decay),s[r-3+1]>s[r-3+2]&&(s[r-3+2]+=(s[r-3+1]-s[r-3+2])*i.decay))}return c},this.calc_noise_core=function(e,t,n,s){var o=0,a=t.s,r=e.l3_enc;if(a>e.count1)while(0!=n--){l=e.xr[a],a++,o+=l*l,l=e.xr[a],a++,o+=l*l}else if(a>e.big_values){var i=Mb(2);i[0]=0,i[1]=s;while(0!=n--){l=Math.abs(e.xr[a])-i[r[a]],a++,o+=l*l,l=Math.abs(e.xr[a])-i[r[a]],a++,o+=l*l}}else while(0!=n--){var l;l=Math.abs(e.xr[a])-p[r[a]]*s,a++,o+=l*l,l=Math.abs(e.xr[a])-p[r[a]]*s,a++,o+=l*l}return t.s=a,o},this.calc_noise=function(e,t,n,o,a){var r,i,l=0,c=0,d=0,m=0,p=0,h=-20,f=0,g=e.scalefac,v=0;for(o.over_SSD=0,r=0;r<e.psymax;r++){var b,y=e.global_gain-(g[v++]+(0!=e.preflag?u[r]:0)<<e.scalefac_scale+1)-8*e.subblock_gain[e.window[r]],x=0;if(null!=a&&a.step[r]==y)x=a.noise[r],f+=e.width[r],n[l++]=x/t[c++],x=a.noise_log[r];else{var w,k=s(y);if(i=e.width[r]>>1,f+e.width[r]>e.max_nonzero_coeff)w=e.max_nonzero_coeff-f+1,i=w>0?w>>1:0;var S=new _(f);x=this.calc_noise_core(e,S,i,k),f=S.s,null!=a&&(a.step[r]=y,a.noise[r]=x),x=n[l++]=x/t[c++],x=Sb.FAST_LOG10(Math.max(x,1e-20)),null!=a&&(a.noise_log[r]=x)}if(null!=a&&(a.global_gain=e.global_gain),p+=x,x>0)b=Math.max(0|10*x+.5,1),o.over_SSD+=b*b,d++,m+=x;h=Math.max(h,x)}return o.over_count=d,o.tot_noise=p,o.over_noise=m,o.max_noise=h,d},this.set_pinfo=function(e,t,n,s,o){var a,r,i,l,c,d=e.internal_flags,m=0==t.scalefac_scale?.5:1,p=t.scalefac,h=Mb(L3Side.SFBMAX),f=Mb(L3Side.SFBMAX),g=new CalcNoiseResult;calc_xmin(e,n,t,h),calc_noise(t,h,f,g,null);var _=0;for(r=t.sfb_lmax,t.block_type!=Mv.SHORT_TYPE&&0==t.mixed_block_flag&&(r=22),a=0;a<r;a++){var v=d.scalefac_band.l[a],b=d.scalefac_band.l[a+1],y=b-v;for(l=0;_<b;_++)l+=t.xr[_]*t.xr[_];l/=y,c=1e15,d.pinfo.en[s][o][a]=c*l,d.pinfo.xfsf[s][o][a]=c*h[a]*f[a]/y,n.en.l[a]>0&&!e.ATHonly?l/=n.en.l[a]:l=0,d.pinfo.thr[s][o][a]=c*Math.max(l*n.thm.l[a],d.ATH.l[a]),d.pinfo.LAMEsfb[s][o][a]=0,0!=t.preflag&&a>=11&&(d.pinfo.LAMEsfb[s][o][a]=-m*u[a]),a<Mv.SBPSY_l&&(Rb(p[a]>=0),d.pinfo.LAMEsfb[s][o][a]-=m*p[a])}if(t.block_type==Mv.SHORT_TYPE)for(r=a,a=t.sfb_smin;a<Mv.SBMAX_s;a++){v=d.scalefac_band.s[a],b=d.scalefac_band.s[a+1],y=b-v;for(var x=0;x<3;x++){for(l=0,i=v;i<b;i++)l+=t.xr[_]*t.xr[_],_++;l=Math.max(l/y,1e-20),c=1e15,d.pinfo.en_s[s][o][3*a+x]=c*l,d.pinfo.xfsf_s[s][o][3*a+x]=c*h[r]*f[r]/y,n.en.s[a][x]>0?l/=n.en.s[a][x]:l=0,(e.ATHonly||e.ATHshort)&&(l=0),d.pinfo.thr_s[s][o][3*a+x]=c*Math.max(l*n.thm.s[a][x],d.ATH.s[a]),d.pinfo.LAMEsfb_s[s][o][3*a+x]=-2*t.subblock_gain[x],a<Mv.SBPSY_s&&(d.pinfo.LAMEsfb_s[s][o][3*a+x]-=m*p[r]),r++}}d.pinfo.LAMEqss[s][o]=t.global_gain,d.pinfo.LAMEmainbits[s][o]=t.part2_3_length+t.part2_length,d.pinfo.LAMEsfbits[s][o]=t.part2_length,d.pinfo.over[s][o]=g.over_count,d.pinfo.max_noise[s][o]=10*g.max_noise,d.pinfo.over_noise[s][o]=10*g.over_noise,d.pinfo.tot_noise[s][o]=10*g.tot_noise,d.pinfo.over_SSD[s][o]=g.over_SSD}}Eb.Q_MAX=257,Eb.Q_MAX2=116,Eb.LARGE_BITS=1e5,Eb.IXMAX_VAL=8206;var Tb=rv.System,Bb=rv.Arrays,Ib=rv.new_int,Cb=rv.assert;function jb(){var e=null;function t(e){this.bits=0|e}this.qupvt=null,this.setModules=function(t){this.qupvt=t,e=t};var n=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function s(e,t,n,s,o,a){var r=.5946/t;e>>=1;while(0!=e--)o[a++]=r>n[s++]?0:1,o[a++]=r>n[s++]?0:1}function o(t,n,s,o,a,r){t>>=1;var i=t%2;t>>=1;while(0!=t--){var l,c,u,d,m,p,h,f;l=s[o++]*n,c=s[o++]*n,m=0|l,u=s[o++]*n,p=0|c,d=s[o++]*n,h=0|u,l+=e.adj43[m],f=0|d,c+=e.adj43[p],a[r++]=0|l,u+=e.adj43[h],a[r++]=0|c,d+=e.adj43[f],a[r++]=0|u,a[r++]=0|d}0!=i&&(l=s[o++]*n,c=s[o++]*n,m=0|l,p=0|c,l+=e.adj43[m],c+=e.adj43[p],a[r++]=0|l,a[r++]=0|c)}function a(t,n,a,r,i){var l,c,u,d=0,m=0,p=0,h=0,f=n,g=0,_=f,v=0,b=t,y=0;for(u=null!=i&&r.global_gain==i.global_gain,c=r.block_type==Mv.SHORT_TYPE?38:21,l=0;l<=c;l++){var x=-1;if((u||r.block_type==Mv.NORM_TYPE)&&(x=r.global_gain-(r.scalefac[l]+(0!=r.preflag?e.pretab[l]:0)<<r.scalefac_scale+1)-8*r.subblock_gain[r.window[l]]),Cb(r.width[l]>=0),u&&i.step[l]==x)0!=m&&(o(m,a,b,y,_,v),m=0),0!=p&&(s(p,a,b,y,_,v),p=0);else{var w,k=r.width[l];if(d+r.width[l]>r.max_nonzero_coeff)w=r.max_nonzero_coeff-d+1,Bb.fill(n,r.max_nonzero_coeff,576,0),k=w,k<0&&(k=0),l=c+1;if(0==m&&0==p&&(_=f,v=g,b=t,y=h),null!=i&&i.sfb_count1>0&&l>=i.sfb_count1&&i.step[l]>0&&x>=i.step[l]?(0!=m&&(o(m,a,b,y,_,v),m=0,_=f,v=g,b=t,y=h),p+=k):(0!=p&&(s(p,a,b,y,_,v),p=0,_=f,v=g,b=t,y=h),m+=k),k<=0){0!=p&&(s(p,a,b,y,_,v),p=0),0!=m&&(o(m,a,b,y,_,v),m=0);break}}l<=c&&(g+=r.width[l],h+=r.width[l],d+=r.width[l])}0!=m&&(o(m,a,b,y,_,v),m=0),0!=p&&(s(p,a,b,y,_,v),p=0)}function r(e,t,n){var s=0,o=0;do{var a=e[t++],r=e[t++];s<a&&(s=a),o<r&&(o=r)}while(t<n);return s<o&&(s=o),s}function i(e,t,n,s,o,a){var r,i=65536*xb.ht[s].xlen+xb.ht[o].xlen,l=0;do{var c=e[t++],u=e[t++];0!=c&&(c>14&&(c=15,l+=i),c*=16),0!=u&&(u>14&&(u=15,l+=i),c+=u),l+=xb.largetbl[c]}while(t<n);return r=65535&l,l>>=16,l>r&&(l=r,s=o),a.bits+=l,s}function l(e,t,n,s){var o=0,a=xb.ht[1].hlen;do{var r=2*e[t+0]+e[t+1];t+=2,o+=a[r]}while(t<n);return s.bits+=o,1}function c(e,t,n,s,o){var a,r,i=0,l=xb.ht[s].xlen;r=2==s?xb.table23:xb.table56;do{var c=e[t+0]*l+e[t+1];t+=2,i+=r[c]}while(t<n);return a=65535&i,i>>=16,i>a&&(i=a,s++),o.bits+=i,s}function u(e,t,n,s,o){var a=0,r=0,i=0,l=xb.ht[s].xlen,c=xb.ht[s].hlen,u=xb.ht[s+1].hlen,d=xb.ht[s+2].hlen;do{var m=e[t+0]*l+e[t+1];t+=2,a+=c[m],r+=u[m],i+=d[m]}while(t<n);var p=s;return a>r&&(a=r,p++),a>i&&(a=i,p=s+2),o.bits+=a,p}var d=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function m(e,t,n,s){var o=r(e,t,n);switch(o){case 0:return o;case 1:return l(e,t,n,s);case 2:case 3:return c(e,t,n,d[o-1],s);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return u(e,t,n,d[o-1],s);default:if(o>Eb.IXMAX_VAL)return s.bits=Eb.LARGE_BITS,-1;var a,m;for(o-=15,a=24;a<32;a++)if(xb.ht[a].linmax>=o)break;for(m=a-8;m<24;m++)if(xb.ht[m].linmax>=o)break;return i(e,t,n,m,a,s)}}function p(e,n,s,o,a,r,i){for(var l=n.big_values,c=0;c<=22;c++)o[c]=Eb.LARGE_BITS;for(c=0;c<16;c++){var u=e.scalefac_band.l[c+1];if(u>=l)break;var d=0,p=new t(d),h=m(s,0,u,p);d=p.bits;for(var f=0;f<8;f++){var g=e.scalefac_band.l[c+f+2];if(g>=l)break;var _=d;p=new t(_);var v=m(s,u,g,p);_=p.bits,o[c+f]>_&&(o[c+f]=_,a[c+f]=c,r[c+f]=h,i[c+f]=v)}}}function h(e,n,s,o,a,r,i,l){for(var c=n.big_values,u=2;u<Mv.SBMAX_l+1;u++){var d=e.scalefac_band.l[u];if(d>=c)break;var p=a[u-2]+n.count1bits;if(s.part2_3_length<=p)break;var h=new t(p),f=m(o,d,c,h);p=h.bits,s.part2_3_length<=p||(s.assign(n),s.part2_3_length=p,s.region0_count=r[u-2],s.region1_count=u-2-r[u-2],s.table_select[0]=i[u-2],s.table_select[1]=l[u-2],s.table_select[2]=f)}}this.noquant_count_bits=function(e,n,s){var o=n.l3_enc,a=Math.min(576,n.max_nonzero_coeff+2>>1<<1);for(null!=s&&(s.sfb_count1=0);a>1;a-=2)if(0!=(o[a-1]|o[a-2]))break;n.count1=a;for(var r=0,i=0;a>3;a-=4){var l;if((2147483647&(o[a-1]|o[a-2]|o[a-3]|o[a-4]))>1)break;l=2*(2*(2*o[a-4]+o[a-3])+o[a-2])+o[a-1],r+=xb.t32l[l],i+=xb.t33l[l]}var c=r;if(n.count1table_select=0,r>i&&(c=i,n.count1table_select=1),n.count1bits=c,n.big_values=a,0==a)return c;if(n.block_type==Mv.SHORT_TYPE)r=3*e.scalefac_band.s[3],r>n.big_values&&(r=n.big_values),i=n.big_values;else if(n.block_type==Mv.NORM_TYPE){if(r=n.region0_count=e.bv_scf[a-2],i=n.region1_count=e.bv_scf[a-1],i=e.scalefac_band.l[r+i+2],r=e.scalefac_band.l[r+1],i<a){var u=new t(c);n.table_select[2]=m(o,i,a,u),c=u.bits}}else n.region0_count=7,n.region1_count=Mv.SBMAX_l-1-7-1,r=e.scalefac_band.l[8],i=a,r>i&&(r=i);if(r=Math.min(r,a),i=Math.min(i,a),r>0){u=new t(c);n.table_select[0]=m(o,0,r,u),c=u.bits}if(r<i){u=new t(c);n.table_select[1]=m(o,r,i,u),c=u.bits}if(2==e.use_best_huffman&&(n.part2_3_length=c,best_huffman_divide(e,n),c=n.part2_3_length),null!=s&&n.block_type==Mv.NORM_TYPE){var d=0;while(e.scalefac_band.l[d]<n.big_values)d++;s.sfb_count1=d}return c},this.count_bits=function(t,n,s,o){var r=s.l3_enc,i=Eb.IXMAX_VAL/e.IPOW20(s.global_gain);if(s.xrpow_max>i)return Eb.LARGE_BITS;if(a(n,r,e.IPOW20(s.global_gain),s,o),0!=(2&t.substep_shaping))for(var l=0,c=s.global_gain+s.scalefac_scale,u=.634521682242439/e.IPOW20(c),d=0;d<s.sfbmax;d++){var m,p=s.width[d];if(0==t.pseudohalf[d])l+=p;else for(m=l,l+=p;m<l;++m)r[m]=n[m]>=u?r[m]:0}return this.noquant_count_bits(t,s,o)},this.best_huffman_divide=function(e,n){var s=new Vv,o=n.l3_enc,a=Ib(23),r=Ib(23),i=Ib(23),l=Ib(23);if(n.block_type!=Mv.SHORT_TYPE||1!=e.mode_gr){s.assign(n),n.block_type==Mv.NORM_TYPE&&(p(e,n,o,a,r,i,l),h(e,s,n,o,a,r,i,l));var c=s.big_values;if(!(0==c||(o[c-2]|o[c-1])>1)&&(c=n.count1+2,!(c>576))){s.assign(n),s.count1=c;for(var u=0,d=0;c>s.big_values;c-=4){var f=2*(2*(2*o[c-4]+o[c-3])+o[c-2])+o[c-1];u+=xb.t32l[f],d+=xb.t33l[f]}if(s.big_values=c,s.count1table_select=0,u>d&&(u=d,s.count1table_select=1),s.count1bits=u,s.block_type==Mv.NORM_TYPE)h(e,s,n,o,a,r,i,l);else{if(s.part2_3_length=u,u=e.scalefac_band.l[8],u>c&&(u=c),u>0){var g=new t(s.part2_3_length);s.table_select[0]=m(o,0,u,g),s.part2_3_length=g.bits}if(c>u){g=new t(s.part2_3_length);s.table_select[1]=m(o,u,c,g),s.part2_3_length=g.bits}n.part2_3_length>s.part2_3_length&&n.assign(s)}}}};var f=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],g=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],_=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],v=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];function b(e,t){for(var n,s=t.tt[1][e],o=t.tt[0][e],a=0;a<xb.scfsi_band.length-1;a++){for(n=xb.scfsi_band[a];n<xb.scfsi_band[a+1];n++)if(o.scalefac[n]!=s.scalefac[n]&&s.scalefac[n]>=0)break;if(n==xb.scfsi_band[a+1]){for(n=xb.scfsi_band[a];n<xb.scfsi_band[a+1];n++)s.scalefac[n]=-1;t.scfsi[e][a]=1}}var r=0,i=0;for(n=0;n<11;n++)-1!=s.scalefac[n]&&(i++,r<s.scalefac[n]&&(r=s.scalefac[n]));for(var l=0,c=0;n<Mv.SBPSY_l;n++)-1!=s.scalefac[n]&&(c++,l<s.scalefac[n]&&(l=s.scalefac[n]));for(a=0;a<16;a++)if(r<f[a]&&l<g[a]){var u=_[a]*i+v[a]*c;s.part2_length>u&&(s.part2_length=u,s.scalefac_compress=a)}}function y(e,t){for(var n=0;n<t;++n)if(e[n]<0)return!1;return!0}jb.slen1_tab=_,jb.slen2_tab=v,this.best_scalefac_store=function(t,n,s,o){var a,r,i,l,c=o.tt[n][s],u=0;for(i=0,a=0;a<c.sfbmax;a++){var d=c.width[a];for(i+=d,l=-d;l<0;l++)if(0!=c.l3_enc[l+i])break;0==l&&(c.scalefac[a]=u=-2)}if(0==c.scalefac_scale&&0==c.preflag){var m=0;for(a=0;a<c.sfbmax;a++)c.scalefac[a]>0&&(m|=c.scalefac[a]);if(0==(1&m)&&0!=m){for(a=0;a<c.sfbmax;a++)c.scalefac[a]>0&&(c.scalefac[a]>>=1);c.scalefac_scale=u=1}}if(0==c.preflag&&c.block_type!=Mv.SHORT_TYPE&&2==t.mode_gr){for(a=11;a<Mv.SBPSY_l;a++)if(c.scalefac[a]<e.pretab[a]&&-2!=c.scalefac[a])break;if(a==Mv.SBPSY_l){for(a=11;a<Mv.SBPSY_l;a++)c.scalefac[a]>0&&(c.scalefac[a]-=e.pretab[a]);c.preflag=u=1}}for(r=0;r<4;r++)o.scfsi[s][r]=0;for(2==t.mode_gr&&1==n&&o.tt[0][s].block_type!=Mv.SHORT_TYPE&&o.tt[1][s].block_type!=Mv.SHORT_TYPE&&(b(s,o),u=0),a=0;a<c.sfbmax;a++)-2==c.scalefac[a]&&(c.scalefac[a]=0);0!=u&&(2==t.mode_gr?this.scale_bitcount(c):this.scale_bitcount_lsf(t,c))};var x=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],w=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],k=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(t){var n,s,o,a=0,r=0,i=t.scalefac;if(Cb(y(i,t.sfbmax)),t.block_type==Mv.SHORT_TYPE)o=x,0!=t.mixed_block_flag&&(o=w);else if(o=k,0==t.preflag){for(s=11;s<Mv.SBPSY_l;s++)if(i[s]<e.pretab[s])break;if(s==Mv.SBPSY_l)for(t.preflag=1,s=11;s<Mv.SBPSY_l;s++)i[s]-=e.pretab[s]}for(s=0;s<t.sfbdivide;s++)a<i[s]&&(a=i[s]);for(;s<t.sfbmax;s++)r<i[s]&&(r=i[s]);for(t.part2_length=Eb.LARGE_BITS,n=0;n<16;n++)a<f[n]&&r<g[n]&&t.part2_length>o[n]&&(t.part2_length=o[n],t.scalefac_compress=n);return t.part2_length==Eb.LARGE_BITS};var S=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(t,n){var s,o,a,r,i,l,c,u,d=Ib(4),m=n.scalefac;for(s=0!=n.preflag?2:0,c=0;c<4;c++)d[c]=0;if(n.block_type==Mv.SHORT_TYPE){o=1;var p=e.nr_of_sfb_block[s][o];for(u=0,a=0;a<4;a++)for(r=p[a]/3,c=0;c<r;c++,u++)for(i=0;i<3;i++)m[3*u+i]>d[a]&&(d[a]=m[3*u+i])}else{o=0;p=e.nr_of_sfb_block[s][o];for(u=0,a=0;a<4;a++)for(r=p[a],c=0;c<r;c++,u++)m[u]>d[a]&&(d[a]=m[u])}for(l=!1,a=0;a<4;a++)d[a]>S[s][a]&&(l=!0);if(!l){var h,f,g,_;for(n.sfb_partition_table=e.nr_of_sfb_block[s][o],a=0;a<4;a++)n.slen[a]=M[d[a]];switch(h=n.slen[0],f=n.slen[1],g=n.slen[2],_=n.slen[3],s){case 0:n.scalefac_compress=(5*h+f<<4)+(g<<2)+_;break;case 1:n.scalefac_compress=400+(5*h+f<<2)+g;break;case 2:n.scalefac_compress=500+3*h+f;break;default:Tb.err.printf("intensity stereo not implemented yet\n");break}}if(!l)for(Cb(null!=n.sfb_partition_table),n.part2_length=0,a=0;a<4;a++)n.part2_length+=n.slen[a]*n.sfb_partition_table[a];return l};var M=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(e){for(var t=2;t<=576;t+=2){var s,o=0;while(e.scalefac_band.l[++o]<t);s=n[o][0];while(e.scalefac_band.l[s+1]>t)s--;s<0&&(s=n[o][0]),e.bv_scf[t-2]=s,s=n[o][1];while(e.scalefac_band.l[s+e.bv_scf[t-2]+2]>t)s--;s<0&&(s=n[o][1]),e.bv_scf[t-1]=s}}}var Ob=rv.System,Fb=rv.Arrays,Lb=rv.new_byte,Pb=rv.new_float_n,Db=rv.new_int,Hb=rv.assert;function Nb(){var e=this,t=32773,n=null,s=null,o=null,a=null;this.setModules=function(e,t,r,i){n=e,s=t,o=r,a=i};var r=null,i=0,l=0,c=0;function u(e){Ob.arraycopy(e.header[e.w_ptr].buf,0,r,l,e.sideinfo_len),l+=e.sideinfo_len,i+=8*e.sideinfo_len,e.w_ptr=e.w_ptr+1&rb.MAX_HEADER_BUF-1}function d(e,t,n){while(n>0){var s;0==c&&(c=8,l++,Hb(e.header[e.w_ptr].write_timing>=i),e.header[e.w_ptr].write_timing==i&&u(e),r[l]=0),s=Math.min(n,c),n-=s,c-=s,r[l]|=t>>n<<c,i+=s}}function m(e,t,n){while(n>0){var s;0==c&&(c=8,l++,r[l]=0),s=Math.min(n,c),n-=s,c-=s,r[l]|=t>>n<<c,i+=s}}function p(e,t){var n,s=e.internal_flags;if(t>=8&&(d(s,76,8),t-=8),t>=8&&(d(s,65,8),t-=8),t>=8&&(d(s,77,8),t-=8),t>=8&&(d(s,69,8),t-=8),t>=32){var a=o.getLameShortVersion();if(t>=32)for(n=0;n<a.length&&t>=8;++n)t-=8,d(s,a.charAt(n),8)}for(;t>=1;t-=1)d(s,s.ancillary_flag,1),s.ancillary_flag^=e.disable_reservoir?0:1}function h(e,t,n){var s=e.header[e.h_ptr].ptr;while(n>0){var o=Math.min(n,8-(7&s));n-=o,e.header[e.h_ptr].buf[s>>3]|=t>>n<<8-(7&s)-o,s+=o}e.header[e.h_ptr].ptr=s}function f(e,n){e<<=8;for(var s=0;s<8;s++)e<<=1,n<<=1,0!=(65536&(n^e))&&(n^=t);return n}function g(e,t){var n,s,o,a=e.internal_flags;if(n=a.l3_side,a.header[a.h_ptr].ptr=0,Fb.fill(a.header[a.h_ptr].buf,0,a.sideinfo_len,0),e.out_samplerate<16e3?h(a,4094,12):h(a,4095,12),h(a,e.version,1),h(a,1,2),h(a,e.error_protection?0:1,1),h(a,a.bitrate_index,4),h(a,a.samplerate_index,2),h(a,a.padding,1),h(a,e.extension,1),h(a,e.mode.ordinal(),2),h(a,a.mode_ext,2),h(a,e.copyright,1),h(a,e.original,1),h(a,e.emphasis,2),e.error_protection&&h(a,0,16),1==e.version){for(Hb(n.main_data_begin>=0),h(a,n.main_data_begin,9),2==a.channels_out?h(a,n.private_bits,3):h(a,n.private_bits,5),o=0;o<a.channels_out;o++){var r;for(r=0;r<4;r++)h(a,n.scfsi[o][r],1)}for(s=0;s<2;s++)for(o=0;o<a.channels_out;o++){var i=n.tt[s][o];h(a,i.part2_3_length+i.part2_length,12),h(a,i.big_values/2,9),h(a,i.global_gain,8),h(a,i.scalefac_compress,4),i.block_type!=Mv.NORM_TYPE?(h(a,1,1),h(a,i.block_type,2),h(a,i.mixed_block_flag,1),14==i.table_select[0]&&(i.table_select[0]=16),h(a,i.table_select[0],5),14==i.table_select[1]&&(i.table_select[1]=16),h(a,i.table_select[1],5),h(a,i.subblock_gain[0],3),h(a,i.subblock_gain[1],3),h(a,i.subblock_gain[2],3)):(h(a,0,1),14==i.table_select[0]&&(i.table_select[0]=16),h(a,i.table_select[0],5),14==i.table_select[1]&&(i.table_select[1]=16),h(a,i.table_select[1],5),14==i.table_select[2]&&(i.table_select[2]=16),h(a,i.table_select[2],5),Hb(i.region0_count>=0&&i.region0_count<16),Hb(i.region1_count>=0&&i.region1_count<8),h(a,i.region0_count,4),h(a,i.region1_count,3)),h(a,i.preflag,1),h(a,i.scalefac_scale,1),h(a,i.count1table_select,1)}}else for(Hb(n.main_data_begin>=0),h(a,n.main_data_begin,8),h(a,n.private_bits,a.channels_out),s=0,o=0;o<a.channels_out;o++){i=n.tt[s][o];h(a,i.part2_3_length+i.part2_length,12),h(a,i.big_values/2,9),h(a,i.global_gain,8),h(a,i.scalefac_compress,9),i.block_type!=Mv.NORM_TYPE?(h(a,1,1),h(a,i.block_type,2),h(a,i.mixed_block_flag,1),14==i.table_select[0]&&(i.table_select[0]=16),h(a,i.table_select[0],5),14==i.table_select[1]&&(i.table_select[1]=16),h(a,i.table_select[1],5),h(a,i.subblock_gain[0],3),h(a,i.subblock_gain[1],3),h(a,i.subblock_gain[2],3)):(h(a,0,1),14==i.table_select[0]&&(i.table_select[0]=16),h(a,i.table_select[0],5),14==i.table_select[1]&&(i.table_select[1]=16),h(a,i.table_select[1],5),14==i.table_select[2]&&(i.table_select[2]=16),h(a,i.table_select[2],5),Hb(i.region0_count>=0&&i.region0_count<16),Hb(i.region1_count>=0&&i.region1_count<8),h(a,i.region0_count,4),h(a,i.region1_count,3)),h(a,i.scalefac_scale,1),h(a,i.count1table_select,1)}e.error_protection&&CRC_writeheader(a,a.header[a.h_ptr].buf);var l=a.h_ptr;Hb(a.header[l].ptr==8*a.sideinfo_len),a.h_ptr=l+1&rb.MAX_HEADER_BUF-1,a.header[a.h_ptr].write_timing=a.header[l].write_timing+t,a.h_ptr==a.w_ptr&&Ob.err.println("Error: MAX_HEADER_BUF too small in bitstream.c \n")}function _(e,t){var n,s=xb.ht[t.count1table_select+32],o=0,a=t.big_values,r=t.big_values;for(Hb(t.count1table_select<2),n=(t.count1-t.big_values)/4;n>0;--n){var i,l=0,c=0;i=t.l3_enc[a+0],0!=i&&(c+=8,t.xr[r+0]<0&&l++),i=t.l3_enc[a+1],0!=i&&(c+=4,l*=2,t.xr[r+1]<0&&l++),i=t.l3_enc[a+2],0!=i&&(c+=2,l*=2,t.xr[r+2]<0&&l++),i=t.l3_enc[a+3],0!=i&&(c++,l*=2,t.xr[r+3]<0&&l++),a+=4,r+=4,d(e,l+s.table[c],s.hlen[c]),o+=s.hlen[c]}return o}function v(e,t,n,s,o){var a=xb.ht[t],r=0;if(0==t)return r;for(var i=n;i<s;i+=2){var l=0,c=0,u=a.xlen,m=a.xlen,p=0,h=o.l3_enc[i],f=o.l3_enc[i+1];if(0!=h&&(o.xr[i]<0&&p++,l--),t>15){if(h>14){var g=h-15;Hb(g<=a.linmax),p|=g<<1,c=u,h=15}if(f>14){var _=f-15;Hb(_<=a.linmax),p<<=u,p|=_,c+=u,f=15}m=16}0!=f&&(p<<=1,o.xr[i+1]<0&&p++,l--),h=h*m+f,c-=l,l+=a.hlen[h],d(e,a.table[h],l),d(e,p,c),r+=l+c}return r}function b(e,t){var n=3*e.scalefac_band.s[3];n>t.big_values&&(n=t.big_values);var s=v(e,t.table_select[0],0,n,t);return s+=v(e,t.table_select[1],n,t.big_values,t),s}function y(e,t){var n,s,o,a;n=t.big_values;var r=t.region0_count+1;return Hb(r<e.scalefac_band.l.length),o=e.scalefac_band.l[r],r+=t.region1_count+1,Hb(r<e.scalefac_band.l.length),a=e.scalefac_band.l[r],o>n&&(o=n),a>n&&(a=n),s=v(e,t.table_select[0],0,o,t),s+=v(e,t.table_select[1],o,a,t),s+=v(e,t.table_select[2],a,n,t),s}function x(e){var t,n,s,o,a=0,r=e.internal_flags,i=r.l3_side;if(1==e.version)for(t=0;t<2;t++)for(n=0;n<r.channels_out;n++){var l=i.tt[t][n],c=jb.slen1_tab[l.scalefac_compress],u=jb.slen2_tab[l.scalefac_compress];for(o=0,s=0;s<l.sfbdivide;s++)-1!=l.scalefac[s]&&(d(r,l.scalefac[s],c),o+=c);for(;s<l.sfbmax;s++)-1!=l.scalefac[s]&&(d(r,l.scalefac[s],u),o+=u);Hb(o==l.part2_length),l.block_type==Mv.SHORT_TYPE?o+=b(r,l):o+=y(r,l),o+=_(r,l),Hb(o==l.part2_3_length+l.part2_length),a+=o}else for(t=0,n=0;n<r.channels_out;n++){l=i.tt[t][n];var m,p,h=0;if(Hb(null!=l.sfb_partition_table),o=0,s=0,p=0,l.block_type==Mv.SHORT_TYPE){for(;p<4;p++){var f=l.sfb_partition_table[p]/3,g=l.slen[p];for(m=0;m<f;m++,s++)d(r,Math.max(l.scalefac[3*s+0],0),g),d(r,Math.max(l.scalefac[3*s+1],0),g),d(r,Math.max(l.scalefac[3*s+2],0),g),h+=3*g}o+=b(r,l)}else{for(;p<4;p++){f=l.sfb_partition_table[p],g=l.slen[p];for(m=0;m<f;m++,s++)d(r,Math.max(l.scalefac[s],0),g),h+=g}o+=y(r,l)}o+=_(r,l),Hb(o==l.part2_3_length),Hb(h==l.part2_length),a+=h+o}return a}function w(){this.total=0}function k(t,n){var s,o,a,r,c,u=t.internal_flags;return c=u.w_ptr,r=u.h_ptr-1,-1==r&&(r=rb.MAX_HEADER_BUF-1),s=u.header[r].write_timing-i,n.total=s,s>=0&&(o=1+r-c,r<c&&(o=1+r-c+rb.MAX_HEADER_BUF),s-=8*o*u.sideinfo_len),a=e.getframebits(t),s+=a,n.total+=a,n.total%8!=0?n.total=1+n.total/8:n.total=n.total/8,n.total+=l+1,s<0&&Ob.err.println("strange error flushing buffer ... \n"),s}this.getframebits=function(e){var t,n=e.internal_flags;t=0!=n.bitrate_index?xb.bitrate_table[e.version][n.bitrate_index]:e.brate;var s=0|72e3*(e.version+1)*t/e.out_samplerate+n.padding;return 8*s},this.CRC_writeheader=function(e,t){var n=65535;n=f(255&t[2],n),n=f(255&t[3],n);for(var s=6;s<e.sideinfo_len;s++)n=f(255&t[s],n);t[4]=byte(n>>8),t[5]=byte(255&n)},this.flush_bitstream=function(e){var t,s,o=e.internal_flags,a=o.h_ptr-1;if(-1==a&&(a=rb.MAX_HEADER_BUF-1),t=o.l3_side,!((s=k(e,new w))<0)){if(p(e,s),Hb(o.header[a].write_timing+this.getframebits(e)==i),o.ResvSize=0,t.main_data_begin=0,o.findReplayGain){var r=n.GetTitleGain(o.rgdata);Hb(NEQ(r,GainAnalysis.GAIN_NOT_ENOUGH_SAMPLES)),o.RadioGain=0|Math.floor(10*r+.5)}o.findPeakSample&&(o.noclipGainChange=0|Math.ceil(20*Math.log10(o.PeakSample/32767)*10),o.noclipGainChange>0&&(EQ(e.scale,1)||EQ(e.scale,0))?o.noclipScale=Math.floor(32767/o.PeakSample*100)/100:o.noclipScale=-1)}},this.add_dummy_byte=function(e,t,n){var s,o=e.internal_flags;while(n-- >0)for(m(o,t,8),s=0;s<rb.MAX_HEADER_BUF;++s)o.header[s].write_timing+=8},this.format_bitstream=function(e){var t,n=e.internal_flags;t=n.l3_side;var s=this.getframebits(e);p(e,t.resvDrain_pre),g(e,s);var o=8*n.sideinfo_len;if(o+=x(e),p(e,t.resvDrain_post),o+=t.resvDrain_post,t.main_data_begin+=(s-o)/8,k(e,new w)!=n.ResvSize&&Ob.err.println("Internal buffer inconsistency. flushbits <> ResvSize"),8*t.main_data_begin!=n.ResvSize&&(Ob.err.printf("bit reservoir error: \nl3_side.main_data_begin: %d \nResvoir size:             %d \nresv drain (post)         %d \nresv drain (pre)          %d \nheader and sideinfo:      %d \ndata bits:                %d \ntotal bits:               %d (remainder: %d) \nbitsperframe:             %d \n",8*t.main_data_begin,n.ResvSize,t.resvDrain_post,t.resvDrain_pre,8*n.sideinfo_len,o-t.resvDrain_post-8*n.sideinfo_len,o,o%8,s),Ob.err.println("This is a fatal error.  It has several possible causes:"),Ob.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),Ob.err.println(" 9%%  Your system is overclocked"),Ob.err.println(" 1%%  bug in LAME encoding library"),n.ResvSize=8*t.main_data_begin),i>1e9){var a;for(a=0;a<rb.MAX_HEADER_BUF;++a)n.header[a].write_timing-=i;i=0}return 0},this.copy_buffer=function(e,t,o,i,u){var d=l+1;if(d<=0)return 0;if(0!=i&&d>i)return-1;if(Ob.arraycopy(r,0,t,o,d),l=-1,c=0,0!=u){var m=Db(1);if(m[0]=e.nMusicCRC,a.updateMusicCRC(m,t,o,d),e.nMusicCRC=m[0],d>0&&(e.VBR_seek_table.nBytesWritten+=d),e.decode_on_the_fly){var p,h=Pb([2,1152]),f=d,g=-1;while(0!=g)if(g=s.hip_decode1_unclipped(e.hip,t,o,f,h[0],h[1]),f=0,-1==g&&(g=0),g>0){if(e.findPeakSample){for(p=0;p<g;p++)h[0][p]>e.PeakSample?e.PeakSample=h[0][p]:-h[0][p]>e.PeakSample&&(e.PeakSample=-h[0][p]);if(e.channels_out>1)for(p=0;p<g;p++)h[1][p]>e.PeakSample?e.PeakSample=h[1][p]:-h[1][p]>e.PeakSample&&(e.PeakSample=-h[1][p])}if(e.findReplayGain&&n.AnalyzeSamples(e.rgdata,h[0],0,h[1],0,g,e.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6}}}return d},this.init_bit_stream_w=function(e){r=Lb(Gb.LAME_MAXMP3BUFFER),e.h_ptr=e.w_ptr=0,e.header[e.h_ptr].write_timing=0,l=-1,c=0,i=0}}Nb.EQ=function(e,t){return Math.abs(e)>Math.abs(t)?Math.abs(e-t)<=1e-6*Math.abs(e):Math.abs(e-t)<=1e-6*Math.abs(t)},Nb.NEQ=function(e,t){return!Nb.EQ(e,t)};var $b=rv.System,zb=rv.VbrMode,Vb=rv.ShortBlock,qb=rv.new_float,Ub=rv.new_int_n,Xb=rv.new_short_n,Yb=rv.assert;function Gb(){var e=this,t=131072;Gb.V9=410,Gb.V8=420,Gb.V7=430,Gb.V6=440,Gb.V5=450,Gb.V4=460,Gb.V3=470,Gb.V2=480,Gb.V1=490,Gb.V0=500,Gb.R3MIX=1e3,Gb.STANDARD=1001,Gb.EXTREME=1002,Gb.INSANE=1003,Gb.STANDARD_FAST=1004,Gb.EXTREME_FAST=1005,Gb.MEDIUM=1006,Gb.MEDIUM_FAST=1007;var n,s,o,a,r,i=16384+t;Gb.LAME_MAXMP3BUFFER=i;var l,c,u,d=new Dv;function m(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=qb(Mv.SBMAX_l),this.bo_s_weight=qb(Mv.SBMAX_s)}function p(){this.lowerlimit=0}function h(e,t){this.lowpass=t}this.enc=new Mv,this.setModules=function(e,t,i,m,p,h,f,g,_){n=e,s=t,o=i,a=m,r=p,l=h,c=g,u=_,this.enc.setModules(s,d,a,l)};var f=4294479419;function g(e){var t;return e.class_id=f,t=e.internal_flags=new rb,e.mode=_v.NOT_SET,e.original=1,e.in_samplerate=44100,e.num_channels=2,e.num_samples=-1,e.bWriteVbrTag=!0,e.quality=-1,e.short_blocks=null,t.subblock_gain=-1,e.lowpassfreq=0,e.highpassfreq=0,e.lowpasswidth=-1,e.highpasswidth=-1,e.VBR=zb.vbr_off,e.VBR_q=4,e.ATHcurve=-1,e.VBR_mean_bitrate_kbps=128,e.VBR_min_bitrate_kbps=0,e.VBR_max_bitrate_kbps=0,e.VBR_hard_min=0,t.VBR_min_bitrate=1,t.VBR_max_bitrate=13,e.quant_comp=-1,e.quant_comp_short=-1,e.msfix=-1,t.resample_ratio=1,t.OldValue[0]=180,t.OldValue[1]=180,t.CurrentStep[0]=4,t.CurrentStep[1]=4,t.masking_lower=1,t.nsPsy.attackthre=-1,t.nsPsy.attackthre_s=-1,e.scale=-1,e.athaa_type=-1,e.ATHtype=-1,e.athaa_loudapprox=-1,e.athaa_sensitivity=0,e.useTemporal=null,e.interChRatio=-1,t.mf_samples_to_encode=Mv.ENCDELAY+Mv.POSTDELAY,e.encoder_padding=0,t.mf_size=Mv.ENCDELAY-Mv.MDCTDELAY,e.findReplayGain=!1,e.decode_on_the_fly=!1,t.decode_on_the_fly=!1,t.findReplayGain=!1,t.findPeakSample=!1,t.RadioGain=0,t.AudiophileGain=0,t.noclipGainChange=0,t.noclipScale=-1,e.preset=0,e.write_id3tag_automatic=!0,0}function _(e){return e>1?0:e<=0?1:Math.cos(Math.PI/2*e)}function v(e,t){var n=44100;return t>=48e3?n=48e3:t>=44100?n=44100:t>=32e3?n=32e3:t>=24e3?n=24e3:t>=22050?n=22050:t>=16e3?n=16e3:t>=12e3?n=12e3:t>=11025?n=11025:t>=8e3&&(n=8e3),-1==e?n:(e<=15960&&(n=44100),e<=15250&&(n=32e3),e<=11220&&(n=24e3),e<=9970&&(n=22050),e<=7230&&(n=16e3),e<=5420&&(n=12e3),e<=4510&&(n=11025),e<=3970&&(n=8e3),t<n?t>44100?48e3:t>32e3?44100:t>24e3?32e3:t>22050?24e3:t>16e3?22050:t>12e3?16e3:t>11025?12e3:t>8e3?11025:8e3:n)}function b(e,t){switch(e){case 44100:return t.version=1,0;case 48e3:return t.version=1,1;case 32e3:return t.version=1,2;case 22050:return t.version=0,0;case 24e3:return t.version=0,1;case 16e3:return t.version=0,2;case 11025:return t.version=0,0;case 12e3:return t.version=0,1;case 8e3:return t.version=0,2;default:return t.version=0,-1}}function y(e,t,n){n<16e3&&(t=2);for(var s=xb.bitrate_table[t][1],o=2;o<=14;o++)xb.bitrate_table[t][o]>0&&Math.abs(xb.bitrate_table[t][o]-e)<Math.abs(s-e)&&(s=xb.bitrate_table[t][o]);return s}function x(e,t,n){n<16e3&&(t=2);for(var s=0;s<=14;s++)if(xb.bitrate_table[t][s]>0&&xb.bitrate_table[t][s]==e)return s;return-1}function w(t,n){var s=[new h(8,2e3),new h(16,3700),new h(24,3900),new h(32,5500),new h(40,7e3),new h(48,7500),new h(56,1e4),new h(64,11e3),new h(80,13500),new h(96,15100),new h(112,15600),new h(128,17e3),new h(160,17500),new h(192,18600),new h(224,19400),new h(256,19700),new h(320,20500)],o=e.nearestBitrateFullIndex(n);t.lowerlimit=s[o].lowpass}function k(e){var t=e.internal_flags,n=32,s=-1;if(t.lowpass1>0){for(var o=999,a=0;a<=31;a++){var r=a/31;r>=t.lowpass2&&(n=Math.min(n,a)),t.lowpass1<r&&r<t.lowpass2&&(o=Math.min(o,a))}t.lowpass1=999==o?(n-.75)/31:(o-.75)/31,t.lowpass2=n/31}if(t.highpass2>0&&t.highpass2<.75/31*.9&&(t.highpass1=0,t.highpass2=0,$b.err.println("Warning: highpass filter disabled.  highpass frequency too small\n")),t.highpass2>0){var i=-1;for(a=0;a<=31;a++){r=a/31;r<=t.highpass1&&(s=Math.max(s,a)),t.highpass1<r&&r<t.highpass2&&(i=Math.max(i,a))}t.highpass1=s/31,t.highpass2=-1==i?(s+.75)/31:(i+.75)/31}for(a=0;a<32;a++){var l,c;r=a/31;l=t.highpass2>t.highpass1?_((t.highpass2-r)/(t.highpass2-t.highpass1+1e-20)):1,c=t.lowpass2>t.lowpass1?_((r-t.lowpass1)/(t.lowpass2-t.lowpass1+1e-20)):1,t.amp_filter[a]=l*c}}function S(e){var t=e.internal_flags;switch(e.quality){default:case 9:t.psymodel=0,t.noise_shaping=0,t.noise_shaping_amp=0,t.noise_shaping_stop=0,t.use_best_huffman=0,t.full_outer_loop=0;break;case 8:e.quality=7;case 7:t.psymodel=1,t.noise_shaping=0,t.noise_shaping_amp=0,t.noise_shaping_stop=0,t.use_best_huffman=0,t.full_outer_loop=0;break;case 6:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=0,t.noise_shaping_stop=0,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=0,t.full_outer_loop=0;break;case 5:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=0,t.noise_shaping_stop=0,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=0,t.full_outer_loop=0;break;case 4:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=0,t.noise_shaping_stop=0,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 3:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=1,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 2:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),0==t.substep_shaping&&(t.substep_shaping=2),t.noise_shaping_amp=1,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 1:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),0==t.substep_shaping&&(t.substep_shaping=2),t.noise_shaping_amp=2,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 0:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),0==t.substep_shaping&&(t.substep_shaping=2),t.noise_shaping_amp=2,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break}}function M(e){var t=e.internal_flags;e.frameNum=0,e.write_id3tag_automatic&&c.id3tag_write_v2(e),t.bitrate_stereoMode_Hist=Ub([16,5]),t.bitrate_blockType_Hist=Ub([16,6]),t.PeakSample=0,e.bWriteVbrTag&&l.InitVbrTag(e)}function A(e,t){(null==e.in_buffer_0||e.in_buffer_nsamples<t)&&(e.in_buffer_0=qb(t),e.in_buffer_1=qb(t),e.in_buffer_nsamples=t)}function R(e){var t=Mv.BLKSIZE+e.framesize-Mv.FFTOFFSET;return t=Math.max(t,512+e.framesize-32),t}function E(e,t,o,a,r,i,l){var c,u,d,m,p,h=e.internal_flags,g=0,_=[null,null],v=[null,null];if(h.Class_ID!=f)return-3;if(0==a)return 0;if(p=s.copy_buffer(h,r,i,l,0),p<0)return p;if(i+=p,g+=p,v[0]=t,v[1]=o,Nb.NEQ(e.scale,0)&&Nb.NEQ(e.scale,1))for(u=0;u<a;++u)v[0][u]*=e.scale,2==h.channels_out&&(v[1][u]*=e.scale);if(Nb.NEQ(e.scale_left,0)&&Nb.NEQ(e.scale_left,1))for(u=0;u<a;++u)v[0][u]*=e.scale_left;if(Nb.NEQ(e.scale_right,0)&&Nb.NEQ(e.scale_right,1))for(u=0;u<a;++u)v[1][u]*=e.scale_right;if(2==e.num_channels&&1==h.channels_out)for(u=0;u<a;++u)v[0][u]=.5*(v[0][u]+v[1][u]),v[1][u]=0;m=R(e),_[0]=h.mfbuf[0],_[1]=h.mfbuf[1];var b=0;while(a>0){var y=[null,null],x=0,w=0;y[0]=v[0],y[1]=v[1];var k=new B;if(F(e,_,y,b,a,k),x=k.n_in,w=k.n_out,h.findReplayGain&&!h.decode_on_the_fly&&n.AnalyzeSamples(h.rgdata,_[0],h.mf_size,_[1],h.mf_size,w,h.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6;if(a-=x,b+=x,h.channels_out,h.mf_size+=w,Yb(h.mf_size<=rb.MFSIZE),h.mf_samples_to_encode<1&&(h.mf_samples_to_encode=Mv.ENCDELAY+Mv.POSTDELAY),h.mf_samples_to_encode+=w,h.mf_size>=m){var S=l-g;if(0==l&&(S=0),c=T(e,_[0],_[1],r,i,S),c<0)return c;for(i+=c,g+=c,h.mf_size-=e.framesize,h.mf_samples_to_encode-=e.framesize,d=0;d<h.channels_out;d++)for(u=0;u<h.mf_size;u++)_[d][u]=_[d][u+e.framesize]}}return g}function T(t,n,s,o,a,r){var i=e.enc.lame_encode_mp3_frame(t,n,s,o,a,r);return t.frameNum++,i}function B(){this.n_in=0,this.n_out=0}function I(){this.num_used=0}function C(e,t){return 0!=t?C(t,e%t):e}function j(e,t,n){var s=Math.PI*t;e/=n,e<0&&(e=0),e>1&&(e=1);var o=e-.5,a=.42-.5*Math.cos(2*e*Math.PI)+.08*Math.cos(4*e*Math.PI);return Math.abs(o)<1e-9?s/Math.PI:a*Math.sin(n*s*o)/(Math.PI*n*o)}function O(e,t,n,s,o,a,r,i,l){var c,u,d=e.internal_flags,m=0,p=e.out_samplerate/C(e.out_samplerate,e.in_samplerate);p>rb.BPC&&(p=rb.BPC);var h=Math.abs(d.resample_ratio-Math.floor(.5+d.resample_ratio))<1e-4?1:0,f=1/d.resample_ratio;f>1&&(f=1);var g=31;g%2==0&&--g,g+=h;var _=g+1;if(0==d.fill_buffer_resample_init){for(d.inbuf_old[0]=qb(_),d.inbuf_old[1]=qb(_),c=0;c<=2*p;++c)d.blackfilt[c]=qb(_);for(d.itime[0]=0,d.itime[1]=0,m=0;m<=2*p;m++){var v=0,b=(m-p)/(2*p);for(c=0;c<=g;c++)v+=d.blackfilt[m][c]=j(c-b,f,g);for(c=0;c<=g;c++)d.blackfilt[m][c]/=v}d.fill_buffer_resample_init=1}var y=d.inbuf_old[l];for(u=0;u<s;u++){var x,w;if(x=u*d.resample_ratio,m=0|Math.floor(x-d.itime[l]),g+m-g/2>=r)break;b=x-d.itime[l]-(m+g%2*.5);w=0|Math.floor(2*b*p+p+.5);var k=0;for(c=0;c<=g;++c){var S,M=0|c+m-g/2;S=M<0?y[_+M]:o[a+M],k+=S*d.blackfilt[w][c]}t[n+u]=k}if(i.num_used=Math.min(r,g+m-g/2),d.itime[l]+=i.num_used-u*d.resample_ratio,i.num_used>=_)for(c=0;c<_;c++)y[c]=o[a+i.num_used+c-_];else{var A=_-i.num_used;for(c=0;c<A;++c)y[c]=y[c+i.num_used];for(m=0;c<_;++c,++m)y[c]=o[a+m];Yb(m==i.num_used)}return u}function F(e,t,n,s,o,a){var r=e.internal_flags;if(r.resample_ratio<.9999||r.resample_ratio>1.0001)for(var i=0;i<r.channels_out;i++){var l=new I;a.n_out=O(e,t[i],r.mf_size,e.framesize,n[i],s,o,l,i),a.n_in=l.num_used}else{a.n_out=Math.min(e.framesize,o),a.n_in=a.n_out;for(var c=0;c<a.n_out;++c)t[0][r.mf_size+c]=n[0][s+c],2==r.channels_out&&(t[1][r.mf_size+c]=n[1][s+c])}}this.lame_init=function(){var e=new Hv;return g(e),e.lame_allocated_gfp=1,e},this.nearestBitrateFullIndex=function(e){var t=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],n=0,s=0,o=0,a=0;a=t[16],o=16,s=t[16],n=16;for(var r=0;r<16;r++)if(Math.max(e,t[r+1])!=e){a=t[r+1],o=r+1,s=t[r],n=r;break}return a-e>e-s?n:o},this.lame_init_params=function(e){var t=e.internal_flags;if(t.Class_ID=0,null==t.ATH&&(t.ATH=new lb),null==t.PSY&&(t.PSY=new m),null==t.rgdata&&(t.rgdata=new hb),t.channels_in=e.num_channels,1==t.channels_in&&(e.mode=_v.MONO),t.channels_out=e.mode==_v.MONO?1:2,t.mode_ext=Mv.MPG_MD_MS_LR,e.mode==_v.MONO&&(e.force_ms=!1),e.VBR==zb.vbr_off&&128!=e.VBR_mean_bitrate_kbps&&0==e.brate&&(e.brate=e.VBR_mean_bitrate_kbps),e.VBR==zb.vbr_off||e.VBR==zb.vbr_mtrh||e.VBR==zb.vbr_mt||(e.free_format=!1),e.VBR==zb.vbr_off&&0==e.brate&&Nb.EQ(e.compression_ratio,0)&&(e.compression_ratio=11.025),e.VBR==zb.vbr_off&&e.compression_ratio>0&&(0==e.out_samplerate&&(e.out_samplerate=map2MP3Frequency(int(.97*e.in_samplerate))),e.brate=0|16*e.out_samplerate*t.channels_out/(1e3*e.compression_ratio),t.samplerate_index=b(e.out_samplerate,e),e.free_format||(e.brate=y(e.brate,e.version,e.out_samplerate))),0!=e.out_samplerate&&(e.out_samplerate<16e3?(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,64)):e.out_samplerate<32e3?(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,160)):(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,32),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,320))),0==e.lowpassfreq){var i=16e3;switch(e.VBR){case zb.vbr_off:var l=new p;w(l,e.brate),i=l.lowerlimit;break;case zb.vbr_abr:l=new p;w(l,e.VBR_mean_bitrate_kbps),i=l.lowerlimit;break;case zb.vbr_rh:var c=[19500,19e3,18600,18e3,17500,16e3,15600,14900,12500,1e4,3950];if(e.VBR_q>=0&&e.VBR_q<=9){var h=c[e.VBR_q],g=c[e.VBR_q+1],_=e.VBR_q_frac;i=linear_int(h,g,_)}else i=19500;break;default:c=[19500,19e3,18500,18e3,17500,16500,15500,14500,12500,9500,3950];if(e.VBR_q>=0&&e.VBR_q<=9){h=c[e.VBR_q],g=c[e.VBR_q+1],_=e.VBR_q_frac;i=linear_int(h,g,_)}else i=19500}e.mode!=_v.MONO||e.VBR!=zb.vbr_off&&e.VBR!=zb.vbr_abr||(i*=1.5),e.lowpassfreq=0|i}if(0==e.out_samplerate&&(2*e.lowpassfreq>e.in_samplerate&&(e.lowpassfreq=e.in_samplerate/2),e.out_samplerate=v(0|e.lowpassfreq,e.in_samplerate)),e.lowpassfreq=Math.min(20500,e.lowpassfreq),e.lowpassfreq=Math.min(e.out_samplerate/2,e.lowpassfreq),e.VBR==zb.vbr_off&&(e.compression_ratio=16*e.out_samplerate*t.channels_out/(1e3*e.brate)),e.VBR==zb.vbr_abr&&(e.compression_ratio=16*e.out_samplerate*t.channels_out/(1e3*e.VBR_mean_bitrate_kbps)),e.bWriteVbrTag||(e.findReplayGain=!1,e.decode_on_the_fly=!1,t.findPeakSample=!1),t.findReplayGain=e.findReplayGain,t.decode_on_the_fly=e.decode_on_the_fly,t.decode_on_the_fly&&(t.findPeakSample=!0),t.findReplayGain&&n.InitGainAnalysis(t.rgdata,e.out_samplerate)==GainAnalysis.INIT_GAIN_ANALYSIS_ERROR)return e.internal_flags=null,-6;switch(t.decode_on_the_fly&&!e.decode_only&&(null!=t.hip&&u.hip_decode_exit(t.hip),t.hip=u.hip_decode_init()),t.mode_gr=e.out_samplerate<=24e3?1:2,e.framesize=576*t.mode_gr,e.encoder_delay=Mv.ENCDELAY,t.resample_ratio=e.in_samplerate/e.out_samplerate,e.VBR){case zb.vbr_mt:case zb.vbr_rh:case zb.vbr_mtrh:var A=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5];e.compression_ratio=A[e.VBR_q];break;case zb.vbr_abr:e.compression_ratio=16*e.out_samplerate*t.channels_out/(1e3*e.VBR_mean_bitrate_kbps);break;default:e.compression_ratio=16*e.out_samplerate*t.channels_out/(1e3*e.brate);break}if(e.mode==_v.NOT_SET&&(e.mode=_v.JOINT_STEREO),e.highpassfreq>0?(t.highpass1=2*e.highpassfreq,e.highpasswidth>=0?t.highpass2=2*(e.highpassfreq+e.highpasswidth):t.highpass2=2*e.highpassfreq,t.highpass1/=e.out_samplerate,t.highpass2/=e.out_samplerate):(t.highpass1=0,t.highpass2=0),e.lowpassfreq>0?(t.lowpass2=2*e.lowpassfreq,e.lowpasswidth>=0?(t.lowpass1=2*(e.lowpassfreq-e.lowpasswidth),t.lowpass1<0&&(t.lowpass1=0)):t.lowpass1=2*e.lowpassfreq,t.lowpass1/=e.out_samplerate,t.lowpass2/=e.out_samplerate):(t.lowpass1=0,t.lowpass2=0),k(e),t.samplerate_index=b(e.out_samplerate,e),t.samplerate_index<0)return e.internal_flags=null,-1;if(e.VBR==zb.vbr_off){if(e.free_format)t.bitrate_index=0;else if(e.brate=y(e.brate,e.version,e.out_samplerate),t.bitrate_index=x(e.brate,e.version,e.out_samplerate),t.bitrate_index<=0)return e.internal_flags=null,-1}else t.bitrate_index=1;e.analysis&&(e.bWriteVbrTag=!1),null!=t.pinfo&&(e.bWriteVbrTag=!1),s.init_bit_stream_w(t);for(var R,E=t.samplerate_index+3*e.version+6*(e.out_samplerate<16e3?1:0),T=0;T<Mv.SBMAX_l+1;T++)t.scalefac_band.l[T]=a.sfBandIndex[E].l[T];for(T=0;T<Mv.PSFB21+1;T++){var B=(t.scalefac_band.l[22]-t.scalefac_band.l[21])/Mv.PSFB21,I=t.scalefac_band.l[21]+T*B;t.scalefac_band.psfb21[T]=I}t.scalefac_band.psfb21[Mv.PSFB21]=576;for(T=0;T<Mv.SBMAX_s+1;T++)t.scalefac_band.s[T]=a.sfBandIndex[E].s[T];for(T=0;T<Mv.PSFB12+1;T++){B=(t.scalefac_band.s[13]-t.scalefac_band.s[12])/Mv.PSFB12,I=t.scalefac_band.s[12]+T*B;t.scalefac_band.psfb12[T]=I}for(t.scalefac_band.psfb12[Mv.PSFB12]=192,1==e.version?t.sideinfo_len=1==t.channels_out?21:36:t.sideinfo_len=1==t.channels_out?13:21,e.error_protection&&(t.sideinfo_len+=2),M(e),t.Class_ID=f,R=0;R<19;R++)t.nsPsy.pefirbuf[R]=700*t.mode_gr*t.channels_out;switch(-1==e.ATHtype&&(e.ATHtype=4),Yb(e.VBR_q<=9),Yb(e.VBR_q>=0),e.VBR){case zb.vbr_mt:e.VBR=zb.vbr_mtrh;case zb.vbr_mtrh:null==e.useTemporal&&(e.useTemporal=!1),o.apply_preset(e,500-10*e.VBR_q,0),e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),e.quality<5&&(e.quality=0),e.quality>5&&(e.quality=5),t.PSY.mask_adjust=e.maskingadjust,t.PSY.mask_adjust_short=e.maskingadjust_short,e.experimentalY?t.sfb21_extra=!1:t.sfb21_extra=e.out_samplerate>44e3,t.iteration_loop=new VBRNewIterationLoop(r);break;case zb.vbr_rh:o.apply_preset(e,500-10*e.VBR_q,0),t.PSY.mask_adjust=e.maskingadjust,t.PSY.mask_adjust_short=e.maskingadjust_short,e.experimentalY?t.sfb21_extra=!1:t.sfb21_extra=e.out_samplerate>44e3,e.quality>6&&(e.quality=6),e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),t.iteration_loop=new VBROldIterationLoop(r);break;default:var C;t.sfb21_extra=!1,e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),C=e.VBR,C==zb.vbr_off&&(e.VBR_mean_bitrate_kbps=e.brate),o.apply_preset(e,e.VBR_mean_bitrate_kbps,0),e.VBR=C,t.PSY.mask_adjust=e.maskingadjust,t.PSY.mask_adjust_short=e.maskingadjust_short,C==zb.vbr_off?t.iteration_loop=new bb(r):t.iteration_loop=new ABRIterationLoop(r);break}if(Yb(e.scale>=0),e.VBR!=zb.vbr_off){if(t.VBR_min_bitrate=1,t.VBR_max_bitrate=14,e.out_samplerate<16e3&&(t.VBR_max_bitrate=8),0!=e.VBR_min_bitrate_kbps&&(e.VBR_min_bitrate_kbps=y(e.VBR_min_bitrate_kbps,e.version,e.out_samplerate),t.VBR_min_bitrate=x(e.VBR_min_bitrate_kbps,e.version,e.out_samplerate),t.VBR_min_bitrate<0))return-1;if(0!=e.VBR_max_bitrate_kbps&&(e.VBR_max_bitrate_kbps=y(e.VBR_max_bitrate_kbps,e.version,e.out_samplerate),t.VBR_max_bitrate=x(e.VBR_max_bitrate_kbps,e.version,e.out_samplerate),t.VBR_max_bitrate<0))return-1;e.VBR_min_bitrate_kbps=xb.bitrate_table[e.version][t.VBR_min_bitrate],e.VBR_max_bitrate_kbps=xb.bitrate_table[e.version][t.VBR_max_bitrate],e.VBR_mean_bitrate_kbps=Math.min(xb.bitrate_table[e.version][t.VBR_max_bitrate],e.VBR_mean_bitrate_kbps),e.VBR_mean_bitrate_kbps=Math.max(xb.bitrate_table[e.version][t.VBR_min_bitrate],e.VBR_mean_bitrate_kbps)}return e.tune&&(t.PSY.mask_adjust+=e.tune_value_a,t.PSY.mask_adjust_short+=e.tune_value_a),S(e),Yb(e.scale>=0),e.athaa_type<0?t.ATH.useAdjust=3:t.ATH.useAdjust=e.athaa_type,t.ATH.aaSensitivityP=Math.pow(10,e.athaa_sensitivity/-10),null==e.short_blocks&&(e.short_blocks=Vb.short_block_allowed),e.short_blocks!=Vb.short_block_allowed||e.mode!=_v.JOINT_STEREO&&e.mode!=_v.STEREO||(e.short_blocks=Vb.short_block_coupled),e.quant_comp<0&&(e.quant_comp=1),e.quant_comp_short<0&&(e.quant_comp_short=0),e.msfix<0&&(e.msfix=0),e.exp_nspsytune=1|e.exp_nspsytune,e.internal_flags.nsPsy.attackthre<0&&(e.internal_flags.nsPsy.attackthre=Dv.NSATTACKTHRE),e.internal_flags.nsPsy.attackthre_s<0&&(e.internal_flags.nsPsy.attackthre_s=Dv.NSATTACKTHRE_S),Yb(e.scale>=0),e.scale<0&&(e.scale=1),e.ATHtype<0&&(e.ATHtype=4),e.ATHcurve<0&&(e.ATHcurve=4),e.athaa_loudapprox<0&&(e.athaa_loudapprox=2),e.interChRatio<0&&(e.interChRatio=0),null==e.useTemporal&&(e.useTemporal=!0),t.slot_lag=t.frac_SpF=0,e.VBR==zb.vbr_off&&(t.slot_lag=t.frac_SpF=72e3*(e.version+1)*e.brate%e.out_samplerate|0),a.iteration_init(e),d.psymodel_init(e),Yb(e.scale>=0),0},this.lame_encode_flush=function(e,t,n,o){var a,r,i,l,u=e.internal_flags,d=Xb([2,1152]),m=0,p=u.mf_samples_to_encode-Mv.POSTDELAY,h=R(e);if(u.mf_samples_to_encode<1)return 0;a=0,e.in_samplerate!=e.out_samplerate&&(p+=16*e.out_samplerate/e.in_samplerate),i=e.framesize-p%e.framesize,i<576&&(i+=e.framesize),e.encoder_padding=i,l=(p+i)/e.framesize;while(l>0&&m>=0){var f=h-u.mf_size,g=e.frameNum;f*=e.in_samplerate,f/=e.out_samplerate,f>1152&&(f=1152),f<1&&(f=1),r=o-a,0==o&&(r=0),m=this.lame_encode_buffer(e,d[0],d[1],f,t,n,r),n+=m,a+=m,l-=g!=e.frameNum?1:0}if(u.mf_samples_to_encode=0,m<0)return m;if(r=o-a,0==o&&(r=0),s.flush_bitstream(e),m=s.copy_buffer(u,t,n,r,1),m<0)return m;if(n+=m,a+=m,r=o-a,0==o&&(r=0),e.write_id3tag_automatic){if(c.id3tag_write_v1(e),m=s.copy_buffer(u,t,n,r,0),m<0)return m;a+=m}return a},this.lame_encode_buffer=function(e,t,n,s,o,a,r){var i=e.internal_flags,l=[null,null];if(i.Class_ID!=f)return-3;if(0==s)return 0;A(i,s),l[0]=i.in_buffer_0,l[1]=i.in_buffer_1;for(var c=0;c<s;c++)l[0][c]=t[c],i.channels_in>1&&(l[1][c]=n[c]);return E(e,l[0],l[1],s,o,a,r)}}var Kb=rv.VbrMode;function Zb(){function e(e,t,n,s,o,a,r,i,l,c,u,d,m,p,h){this.vbr_q=e,this.quant_comp=t,this.quant_comp_s=n,this.expY=s,this.st_lrm=o,this.st_s=a,this.masking_adj=r,this.masking_adj_short=i,this.ath_lower=l,this.ath_curve=c,this.ath_sensitivity=u,this.interch=d,this.safejoint=m,this.sfb21mod=p,this.msfix=h}function t(e,t,n,s,o,a,r,i,l,c,u,d,m,p){this.quant_comp=t,this.quant_comp_s=n,this.safejoint=s,this.nsmsfix=o,this.st_lrm=a,this.st_s=r,this.nsbass=i,this.scale=l,this.masking_adj=c,this.ath_lower=u,this.ath_curve=d,this.interch=m,this.sfscale=p}var n;this.setModules=function(e){n=e};var s=[new e(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new e(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new e(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new e(4,9,9,1,6,135,-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new e(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,6.6,145,.67,.65,-14.7,6.5,-19,4e-4,0,0,2.3),new e(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6e-4,0,0,2.7),new e(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7e-4,0,0,0),new e(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8e-4,0,0,0),new e(10,9,9,1,6.6,145,2,2,-36,12,-25,8e-4,0,0,0)],o=[new e(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new e(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,2,18,1.49),new e(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new e(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new e(5,9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4e-4,0,0,2),new e(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6e-4,0,0,2),new e(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7e-4,0,0,2),new e(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8e-4,0,0,2),new e(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8e-4,0,0,2)];function a(e,t,n){var a=e.VBR==Kb.vbr_rh?s:o,r=e.VBR_q_frac,i=a[t],c=a[t+1],u=i;i.st_lrm=i.st_lrm+r*(c.st_lrm-i.st_lrm),i.st_s=i.st_s+r*(c.st_s-i.st_s),i.masking_adj=i.masking_adj+r*(c.masking_adj-i.masking_adj),i.masking_adj_short=i.masking_adj_short+r*(c.masking_adj_short-i.masking_adj_short),i.ath_lower=i.ath_lower+r*(c.ath_lower-i.ath_lower),i.ath_curve=i.ath_curve+r*(c.ath_curve-i.ath_curve),i.ath_sensitivity=i.ath_sensitivity+r*(c.ath_sensitivity-i.ath_sensitivity),i.interch=i.interch+r*(c.interch-i.interch),i.msfix=i.msfix+r*(c.msfix-i.msfix),l(e,u.vbr_q),0!=n?e.quant_comp=u.quant_comp:Math.abs(e.quant_comp- -1)>0||(e.quant_comp=u.quant_comp),0!=n?e.quant_comp_short=u.quant_comp_s:Math.abs(e.quant_comp_short- -1)>0||(e.quant_comp_short=u.quant_comp_s),0!=u.expY&&(e.experimentalY=0!=u.expY),0!=n?e.internal_flags.nsPsy.attackthre=u.st_lrm:Math.abs(e.internal_flags.nsPsy.attackthre- -1)>0||(e.internal_flags.nsPsy.attackthre=u.st_lrm),0!=n?e.internal_flags.nsPsy.attackthre_s=u.st_s:Math.abs(e.internal_flags.nsPsy.attackthre_s- -1)>0||(e.internal_flags.nsPsy.attackthre_s=u.st_s),0!=n?e.maskingadjust=u.masking_adj:Math.abs(e.maskingadjust-0)>0||(e.maskingadjust=u.masking_adj),0!=n?e.maskingadjust_short=u.masking_adj_short:Math.abs(e.maskingadjust_short-0)>0||(e.maskingadjust_short=u.masking_adj_short),0!=n?e.ATHlower=-u.ath_lower/10:Math.abs(10*-e.ATHlower-0)>0||(e.ATHlower=-u.ath_lower/10),0!=n?e.ATHcurve=u.ath_curve:Math.abs(e.ATHcurve- -1)>0||(e.ATHcurve=u.ath_curve),0!=n?e.athaa_sensitivity=u.ath_sensitivity:Math.abs(e.athaa_sensitivity- -1)>0||(e.athaa_sensitivity=u.ath_sensitivity),u.interch>0&&(0!=n?e.interChRatio=u.interch:Math.abs(e.interChRatio- -1)>0||(e.interChRatio=u.interch)),u.safejoint>0&&(e.exp_nspsytune=e.exp_nspsytune|u.safejoint),u.sfb21mod>0&&(e.exp_nspsytune=e.exp_nspsytune|u.sfb21mod<<20),0!=n?e.msfix=u.msfix:Math.abs(e.msfix- -1)>0||(e.msfix=u.msfix),0==n&&(e.VBR_q=t,e.VBR_q_frac=r)}var r=[new t(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new t(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new t(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new t(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new t(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new t(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new t(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new t(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new t(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new t(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new t(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new t(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new t(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new t(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new t(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function i(e,t,s){var o=t,a=n.nearestBitrateFullIndex(t);if(e.VBR=Kb.vbr_abr,e.VBR_mean_bitrate_kbps=o,e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,320),e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.brate=e.VBR_mean_bitrate_kbps,e.VBR_mean_bitrate_kbps>320&&(e.disable_reservoir=!0),r[a].safejoint>0&&(e.exp_nspsytune=2|e.exp_nspsytune),r[a].sfscale>0&&(e.internal_flags.noise_shaping=2),Math.abs(r[a].nsbass)>0){var i=int(4*r[a].nsbass);i<0&&(i+=64),e.exp_nspsytune=e.exp_nspsytune|i<<2}return 0!=s?e.quant_comp=r[a].quant_comp:Math.abs(e.quant_comp- -1)>0||(e.quant_comp=r[a].quant_comp),0!=s?e.quant_comp_short=r[a].quant_comp_s:Math.abs(e.quant_comp_short- -1)>0||(e.quant_comp_short=r[a].quant_comp_s),0!=s?e.msfix=r[a].nsmsfix:Math.abs(e.msfix- -1)>0||(e.msfix=r[a].nsmsfix),0!=s?e.internal_flags.nsPsy.attackthre=r[a].st_lrm:Math.abs(e.internal_flags.nsPsy.attackthre- -1)>0||(e.internal_flags.nsPsy.attackthre=r[a].st_lrm),0!=s?e.internal_flags.nsPsy.attackthre_s=r[a].st_s:Math.abs(e.internal_flags.nsPsy.attackthre_s- -1)>0||(e.internal_flags.nsPsy.attackthre_s=r[a].st_s),0!=s?e.scale=r[a].scale:Math.abs(e.scale- -1)>0||(e.scale=r[a].scale),0!=s?e.maskingadjust=r[a].masking_adj:Math.abs(e.maskingadjust-0)>0||(e.maskingadjust=r[a].masking_adj),r[a].masking_adj>0?0!=s?e.maskingadjust_short=.9*r[a].masking_adj:Math.abs(e.maskingadjust_short-0)>0||(e.maskingadjust_short=.9*r[a].masking_adj):0!=s?e.maskingadjust_short=1.1*r[a].masking_adj:Math.abs(e.maskingadjust_short-0)>0||(e.maskingadjust_short=1.1*r[a].masking_adj),0!=s?e.ATHlower=-r[a].ath_lower/10:Math.abs(10*-e.ATHlower-0)>0||(e.ATHlower=-r[a].ath_lower/10),0!=s?e.ATHcurve=r[a].ath_curve:Math.abs(e.ATHcurve- -1)>0||(e.ATHcurve=r[a].ath_curve),0!=s?e.interChRatio=r[a].interch:Math.abs(e.interChRatio- -1)>0||(e.interChRatio=r[a].interch),t}function l(e,t){var n=0;return t<0&&(n=-1,t=0),t>9&&(n=-1,t=9),e.VBR_q=t,e.VBR_q_frac=0,n}this.apply_preset=function(e,t,n){switch(t){case Gb.R3MIX:t=Gb.V3,e.VBR=Kb.vbr_mtrh;break;case Gb.MEDIUM:t=Gb.V4,e.VBR=Kb.vbr_rh;break;case Gb.MEDIUM_FAST:t=Gb.V4,e.VBR=Kb.vbr_mtrh;break;case Gb.STANDARD:t=Gb.V2,e.VBR=Kb.vbr_rh;break;case Gb.STANDARD_FAST:t=Gb.V2,e.VBR=Kb.vbr_mtrh;break;case Gb.EXTREME:t=Gb.V0,e.VBR=Kb.vbr_rh;break;case Gb.EXTREME_FAST:t=Gb.V0,e.VBR=Kb.vbr_mtrh;break;case Gb.INSANE:return t=320,e.preset=t,i(e,t,n),e.VBR=Kb.vbr_off,t}switch(e.preset=t,t){case Gb.V9:return a(e,9,n),t;case Gb.V8:return a(e,8,n),t;case Gb.V7:return a(e,7,n),t;case Gb.V6:return a(e,6,n),t;case Gb.V5:return a(e,5,n),t;case Gb.V4:return a(e,4,n),t;case Gb.V3:return a(e,3,n),t;case Gb.V2:return a(e,2,n),t;case Gb.V1:return a(e,1,n),t;case Gb.V0:return a(e,0,n),t}return t>=8&&t<=320?i(e,t,n):(e.preset=0,t)}}function Wb(){this.setModules=function(e,t){}}function Qb(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}var Jb=rv.new_float,ey=rv.new_int;function ty(){this.global_gain=0,this.sfb_count1=0,this.step=ey(39),this.noise=Jb(39),this.noise_log=Jb(39)}var ny=rv.System,sy=rv.VbrMode,oy=rv.Util,ay=rv.Arrays,ry=rv.new_float,iy=rv.assert;function ly(){var e,t,n;this.rv=null,this.qupvt=null;var s,o=new Wb;function a(e,t,n,s){s=0;for(var o=0;o<=n;++o){var a=Math.abs(e.xr[o]);s+=a,t[o]=Math.sqrt(a*Math.sqrt(a)),t[o]>e.xrpow_max&&(e.xrpow_max=t[o])}return s}function r(e,t){var s=e.ATH,o=t.xr;if(t.block_type!=Mv.SHORT_TYPE)for(var a=!1,r=Mv.PSFB21-1;r>=0&&!a;r--){var i=e.scalefac_band.psfb21[r],l=e.scalefac_band.psfb21[r+1],c=n.athAdjust(s.adjust,s.psfb21[r],s.floor);e.nsPsy.longfact[21]>1e-12&&(c*=e.nsPsy.longfact[21]);for(var u=l-1;u>=i;u--){if(!(Math.abs(o[u])<c)){a=!0;break}o[u]=0}}else for(var d=0;d<3;d++)for(a=!1,r=Mv.PSFB12-1;r>=0&&!a;r--){i=3*e.scalefac_band.s[12]+(e.scalefac_band.s[13]-e.scalefac_band.s[12])*d+(e.scalefac_band.psfb12[r]-e.scalefac_band.psfb12[0]),l=i+(e.scalefac_band.psfb12[r+1]-e.scalefac_band.psfb12[r]);var m=n.athAdjust(s.adjust,s.psfb12[r],s.floor);e.nsPsy.shortfact[12]>1e-12&&(m*=e.nsPsy.shortfact[12]);for(u=l-1;u>=i;u--){if(!(Math.abs(o[u])<m)){a=!0;break}o[u]=0}}}function i(e){this.ordinal=e}function l(e,t,n,o,a){var r,l=e.CurrentStep[o],c=!1,u=e.OldValue[o],d=i.BINSEARCH_NONE;for(t.global_gain=u,n-=t.part2_length;;){var m;if(r=s.count_bits(e,a,t,null),1==l||r==n)break;r>n?(d==i.BINSEARCH_DOWN&&(c=!0),c&&(l/=2),d=i.BINSEARCH_UP,m=l):(d==i.BINSEARCH_UP&&(c=!0),c&&(l/=2),d=i.BINSEARCH_DOWN,m=-l),t.global_gain+=m,t.global_gain<0&&(t.global_gain=0,c=!0),t.global_gain>255&&(t.global_gain=255,c=!0)}iy(t.global_gain>=0),iy(t.global_gain<256);while(r>n&&t.global_gain<255)t.global_gain++,r=s.count_bits(e,a,t,null);return e.CurrentStep[o]=u-t.global_gain>=4?4:2,e.OldValue[o]=t.global_gain,t.part2_3_length=r,r}function c(e){for(var t=0;t<e.sfbmax;t++)if(e.scalefac[t]+e.subblock_gain[e.window[t]]==0)return!1;return!0}function u(e){return oy.FAST_LOG10(.368+.632*e*e*e)}function d(e,t){for(var n=1e-37,s=0;s<t.psymax;s++)n+=u(e[s]);return Math.max(1e-20,n)}function m(e,t,n,s,o){var a;switch(e){default:case 9:t.over_count>0?(a=n.over_SSD<=t.over_SSD,n.over_SSD==t.over_SSD&&(a=n.bits<t.bits)):a=n.max_noise<0&&10*n.max_noise+n.bits<=10*t.max_noise+t.bits;break;case 0:a=n.over_count<t.over_count||n.over_count==t.over_count&&n.over_noise<t.over_noise||n.over_count==t.over_count&&BitStream.EQ(n.over_noise,t.over_noise)&&n.tot_noise<t.tot_noise;break;case 8:n.max_noise=d(o,s);case 1:a=n.max_noise<t.max_noise;break;case 2:a=n.tot_noise<t.tot_noise;break;case 3:a=n.tot_noise<t.tot_noise&&n.max_noise<t.max_noise;break;case 4:a=n.max_noise<=0&&t.max_noise>.2||n.max_noise<=0&&t.max_noise<0&&t.max_noise>n.max_noise-.2&&n.tot_noise<t.tot_noise||n.max_noise<=0&&t.max_noise>0&&t.max_noise>n.max_noise-.2&&n.tot_noise<t.tot_noise+t.over_noise||n.max_noise>0&&t.max_noise>-.05&&t.max_noise>n.max_noise-.1&&n.tot_noise+n.over_noise<t.tot_noise+t.over_noise||n.max_noise>0&&t.max_noise>-.1&&t.max_noise>n.max_noise-.15&&n.tot_noise+n.over_noise+n.over_noise<t.tot_noise+t.over_noise+t.over_noise;break;case 5:a=n.over_noise<t.over_noise||BitStream.EQ(n.over_noise,t.over_noise)&&n.tot_noise<t.tot_noise;break;case 6:a=n.over_noise<t.over_noise||BitStream.EQ(n.over_noise,t.over_noise)&&(n.max_noise<t.max_noise||BitStream.EQ(n.max_noise,t.max_noise)&&n.tot_noise<=t.tot_noise);break;case 7:a=n.over_count<t.over_count||n.over_noise<t.over_noise;break}return 0==t.over_count&&(a=a&&n.bits<t.bits),a}function p(e,t,n,s,o){var a,r=e.internal_flags;a=0==t.scalefac_scale?1.2968395546510096:1.6817928305074292;for(var i=0,l=0;l<t.sfbmax;l++)i<n[l]&&(i=n[l]);var c=r.noise_shaping_amp;switch(3==c&&(c=o?2:1),c){case 2:break;case 1:i>1?i=Math.pow(i,.5):i*=.95;break;case 0:default:i>1?i=1:i*=.95;break}var u=0;for(l=0;l<t.sfbmax;l++){var d,m=t.width[l];if(u+=m,!(n[l]<i)){if(0!=(2&r.substep_shaping)&&(r.pseudohalf[l]=0==r.pseudohalf[l]?1:0,0==r.pseudohalf[l]&&2==r.noise_shaping_amp))return;for(t.scalefac[l]++,d=-m;d<0;d++)s[u+d]*=a,s[u+d]>t.xrpow_max&&(t.xrpow_max=s[u+d]);if(2==r.noise_shaping_amp)return}}}function h(e,t){for(var s=1.2968395546510096,o=0,a=0;a<e.sfbmax;a++){var r=e.width[a],i=e.scalefac[a];if(0!=e.preflag&&(i+=n.pretab[a]),o+=r,0!=(1&i)){i++;for(var l=-r;l<0;l++)t[o+l]*=s,t[o+l]>e.xrpow_max&&(e.xrpow_max=t[o+l])}e.scalefac[a]=i>>1}e.preflag=0,e.scalefac_scale=1}function f(e,t,s){var o,a=t.scalefac;for(o=0;o<t.sfb_lmax;o++)if(a[o]>=16)return!0;for(var r=0;r<3;r++){var i=0,l=0;for(o=t.sfb_lmax+r;o<t.sfbdivide;o+=3)i<a[o]&&(i=a[o]);for(;o<t.sfbmax;o+=3)l<a[o]&&(l=a[o]);if(!(i<16&&l<8)){if(t.subblock_gain[r]>=7)return!0;t.subblock_gain[r]++;var c=e.scalefac_band.l[t.sfb_lmax];for(o=t.sfb_lmax+r;o<t.sfbmax;o+=3){var u=t.width[o],d=a[o];if(d-=4>>t.scalefac_scale,d>=0)a[o]=d,c+=3*u;else{a[o]=0;var m=210+(d<<t.scalefac_scale+1);h=n.IPOW20(m),c+=u*(r+1);for(var p=-u;p<0;p++)s[c+p]*=h,s[c+p]>t.xrpow_max&&(t.xrpow_max=s[c+p]);c+=u*(3-r-1)}}var h=n.IPOW20(202);c+=t.width[o]*(r+1);for(p=-t.width[o];p<0;p++)s[c+p]*=h,s[c+p]>t.xrpow_max&&(t.xrpow_max=s[c+p])}}return!1}function g(e,t,n,o,a){var r=e.internal_flags;p(e,t,n,o,a);var i=c(t);return!i&&(i=2==r.mode_gr?s.scale_bitcount(t):s.scale_bitcount_lsf(r,t),!i||(r.noise_shaping>1&&(ay.fill(r.pseudohalf,0),0==t.scalefac_scale?(h(t,o),i=!1):t.block_type==Mv.SHORT_TYPE&&r.subblock_gain>0&&(i=f(r,t,o)||c(t))),i||(i=2==r.mode_gr?s.scale_bitcount(t):s.scale_bitcount_lsf(r,t)),!i))}this.setModules=function(a,r,i,l){e=a,t=r,this.rv=r,n=i,this.qupvt=i,s=l,o.setModules(n,s)},this.ms_convert=function(e,t){for(var n=0;n<576;++n){var s=e.tt[t][0].xr[n],o=e.tt[t][1].xr[n];e.tt[t][0].xr[n]=(s+o)*(.5*oy.SQRT2),e.tt[t][1].xr[n]=(s-o)*(.5*oy.SQRT2)}},this.init_xrpow=function(e,t,n){var s=0,o=0|t.max_nonzero_coeff;if(t.xrpow_max=0,ay.fill(n,o,576,0),s=a(t,n,o,s),s>1e-20){var r=0;0!=(2&e.substep_shaping)&&(r=1);for(var i=0;i<t.psymax;i++)e.pseudohalf[i]=r;return!0}return ay.fill(t.l3_enc,0,576,0),!1},this.init_outer_loop=function(e,t){t.part2_3_length=0,t.big_values=0,t.count1=0,t.global_gain=210,t.scalefac_compress=0,t.table_select[0]=0,t.table_select[1]=0,t.table_select[2]=0,t.subblock_gain[0]=0,t.subblock_gain[1]=0,t.subblock_gain[2]=0,t.subblock_gain[3]=0,t.region0_count=0,t.region1_count=0,t.preflag=0,t.scalefac_scale=0,t.count1table_select=0,t.part2_length=0,t.sfb_lmax=Mv.SBPSY_l,t.sfb_smin=Mv.SBPSY_s,t.psy_lmax=e.sfb21_extra?Mv.SBMAX_l:Mv.SBPSY_l,t.psymax=t.psy_lmax,t.sfbmax=t.sfb_lmax,t.sfbdivide=11;for(var s=0;s<Mv.SBMAX_l;s++)t.width[s]=e.scalefac_band.l[s+1]-e.scalefac_band.l[s],t.window[s]=3;if(t.block_type==Mv.SHORT_TYPE){var o=ry(576);t.sfb_smin=0,t.sfb_lmax=0,0!=t.mixed_block_flag&&(t.sfb_smin=3,t.sfb_lmax=2*e.mode_gr+4),t.psymax=t.sfb_lmax+3*((e.sfb21_extra?Mv.SBMAX_s:Mv.SBPSY_s)-t.sfb_smin),t.sfbmax=t.sfb_lmax+3*(Mv.SBPSY_s-t.sfb_smin),t.sfbdivide=t.sfbmax-18,t.psy_lmax=t.sfb_lmax;var a=e.scalefac_band.l[t.sfb_lmax];ny.arraycopy(t.xr,0,o,0,576);for(s=t.sfb_smin;s<Mv.SBMAX_s;s++)for(var i=e.scalefac_band.s[s],l=e.scalefac_band.s[s+1],c=0;c<3;c++)for(var u=i;u<l;u++)t.xr[a++]=o[3*u+c];var d=t.sfb_lmax;for(s=t.sfb_smin;s<Mv.SBMAX_s;s++)t.width[d]=t.width[d+1]=t.width[d+2]=e.scalefac_band.s[s+1]-e.scalefac_band.s[s],t.window[d]=0,t.window[d+1]=1,t.window[d+2]=2,d+=3}t.count1bits=0,t.sfb_partition_table=n.nr_of_sfb_block[0][0],t.slen[0]=0,t.slen[1]=0,t.slen[2]=0,t.slen[3]=0,t.max_nonzero_coeff=575,ay.fill(t.scalefac,0),r(e,t)},i.BINSEARCH_NONE=new i(0),i.BINSEARCH_UP=new i(1),i.BINSEARCH_DOWN=new i(2),this.trancate_smallspectrums=function(e,t,o,a){var r=ry(Nv.SFBMAX);if((0!=(4&e.substep_shaping)||t.block_type!=Mv.SHORT_TYPE)&&0==(128&e.substep_shaping)){n.calc_noise(t,o,r,new Qb,null);for(var i=0;i<576;i++){var l=0;0!=t.l3_enc[i]&&(l=Math.abs(t.xr[i])),a[i]=l}i=0;var c=8;t.block_type==Mv.SHORT_TYPE&&(c=6);do{var u,d,m,p,h=t.width[c];if(i+=h,!(r[c]>=1)&&(ay.sort(a,i-h,h),!BitStream.EQ(a[i-1],0))){u=(1-r[c])*o[c],d=0,p=0;do{var f;for(m=1;p+m<h;m++)if(BitStream.NEQ(a[p+i-h],a[p+i+m-h]))break;if(f=a[p+i-h]*a[p+i-h]*m,u<f){0!=p&&(d=a[p+i-h-1]);break}u-=f,p+=m}while(p<h);if(!BitStream.EQ(d,0))do{Math.abs(t.xr[i-h])<=d&&(t.l3_enc[i-h]=0)}while(--h>0)}}while(++c<t.psymax);t.part2_3_length=s.noquant_count_bits(e,t,null)}},this.outer_loop=function(e,t,o,a,r,i){var c,u=e.internal_flags,d=new Vv,p=ry(576),h=ry(Nv.SFBMAX),f=new Qb,_=new ty,v=9999999,b=!1,y=!1,x=0;if(l(u,t,i,r,a),0==u.noise_shaping)return 100;n.calc_noise(t,o,h,f,_),f.bits=t.part2_3_length,d.assign(t);var w=0;ny.arraycopy(a,0,p,0,576);while(!b){do{var k,S=new Qb,M=255;if(k=0!=(2&u.substep_shaping)?20:3,u.sfb21_extra){if(h[d.sfbmax]>1)break;if(d.block_type==Mv.SHORT_TYPE&&(h[d.sfbmax+1]>1||h[d.sfbmax+2]>1))break}if(!g(e,d,h,a,y))break;0!=d.scalefac_scale&&(M=254);var A=i-d.part2_length;if(A<=0)break;while((d.part2_3_length=s.count_bits(u,a,d,_))>A&&d.global_gain<=M)d.global_gain++;if(d.global_gain>M)break;if(0==f.over_count){while((d.part2_3_length=s.count_bits(u,a,d,_))>v&&d.global_gain<=M)d.global_gain++;if(d.global_gain>M)break}if(n.calc_noise(d,o,h,S,_),S.bits=d.part2_3_length,c=t.block_type!=Mv.SHORT_TYPE?e.quant_comp:e.quant_comp_short,c=m(c,f,S,d,h)?1:0,0!=c)v=t.part2_3_length,f=S,t.assign(d),w=0,ny.arraycopy(a,0,p,0,576);else if(0==u.full_outer_loop){if(++w>k&&0==f.over_count)break;if(3==u.noise_shaping_amp&&y&&w>30)break;if(3==u.noise_shaping_amp&&y&&d.global_gain-x>15)break}}while(d.global_gain+d.scalefac_scale<255);3==u.noise_shaping_amp?y?b=!0:(d.assign(t),ny.arraycopy(p,0,a,0,576),w=0,x=d.global_gain,y=!0):b=!0}return iy(t.global_gain+t.scalefac_scale<=255),e.VBR==sy.vbr_rh||e.VBR==sy.vbr_mtrh?ny.arraycopy(p,0,a,0,576):0!=(1&u.substep_shaping)&&trancate_smallspectrums(u,t,o,a),f.over_count},this.iteration_finish_one=function(e,n,o){var a=e.l3_side,r=a.tt[n][o];s.best_scalefac_store(e,n,o,a),1==e.use_best_huffman&&s.best_huffman_divide(e,r),t.ResvAdjust(e,r)},this.VBR_encode_granule=function(e,t,n,s,o,a,r){var i,l,c=e.internal_flags,u=new Vv,d=ry(576),m=r,p=r+1,h=(r+a)/2,f=0,g=c.sfb21_extra;iy(m<=LameInternalFlags.MAX_BITS_PER_CHANNEL),ay.fill(u.l3_enc,0);do{c.sfb21_extra=!(h>m-42)&&g,l=outer_loop(e,t,n,s,o,h),l<=0?(f=1,p=t.part2_3_length,u.assign(t),ny.arraycopy(s,0,d,0,576),r=p-32,i=r-a,h=(r+a)/2):(a=h+32,i=r-a,h=(r+a)/2,0!=f&&(f=2,t.assign(u),ny.arraycopy(d,0,s,0,576)))}while(i>12);c.sfb21_extra=g,2==f&&ny.arraycopy(u.l3_enc,0,t.l3_enc,0,576),iy(t.part2_3_length<=m)},this.get_framebits=function(n,s){var o=n.internal_flags;o.bitrate_index=o.VBR_min_bitrate;var a=e.getframebits(n);o.bitrate_index=1,a=e.getframebits(n);for(var r=1;r<=o.VBR_max_bitrate;r++){o.bitrate_index=r;var i=new MeanBits(a);s[r]=t.ResvFrameBegin(n,i),a=i.bits}},this.VBR_old_prepare=function(e,s,o,a,r,i,l,c,u){var d,m=e.internal_flags,p=0,h=1,f=0;m.bitrate_index=m.VBR_max_bitrate;var g=t.ResvFrameBegin(e,new MeanBits(0))/m.mode_gr;get_framebits(e,i);for(var _=0;_<m.mode_gr;_++){var v=n.on_pe(e,s,c[_],g,_,0);m.mode_ext==Mv.MPG_MD_MS_LR&&(ms_convert(m.l3_side,_),n.reduce_side(c[_],o[_],g,v));for(var b=0;b<m.channels_out;++b){var y=m.l3_side.tt[_][b];y.block_type!=Mv.SHORT_TYPE?(p=1.28/(1+Math.exp(3.5-s[_][b]/300))-.05,d=m.PSY.mask_adjust-p):(p=2.56/(1+Math.exp(3.5-s[_][b]/300))-.14,d=m.PSY.mask_adjust_short-p),m.masking_lower=Math.pow(10,.1*d),init_outer_loop(m,y),u[_][b]=n.calc_xmin(e,a[_][b],y,r[_][b]),0!=u[_][b]&&(h=0),l[_][b]=126,f+=c[_][b]}}for(_=0;_<m.mode_gr;_++)for(b=0;b<m.channels_out;b++)f>i[m.VBR_max_bitrate]&&(c[_][b]*=i[m.VBR_max_bitrate],c[_][b]/=f),l[_][b]>c[_][b]&&(l[_][b]=c[_][b]);return h},this.bitpressure_strategy=function(e,t,n,s){for(var o=0;o<e.mode_gr;o++)for(var a=0;a<e.channels_out;a++){for(var r=e.l3_side.tt[o][a],i=t[o][a],l=0,c=0;c<r.psy_lmax;c++)i[l++]*=1+.029*c*c/Mv.SBMAX_l/Mv.SBMAX_l;if(r.block_type==Mv.SHORT_TYPE)for(c=r.sfb_smin;c<Mv.SBMAX_s;c++)i[l++]*=1+.029*c*c/Mv.SBMAX_s/Mv.SBMAX_s,i[l++]*=1+.029*c*c/Mv.SBMAX_s/Mv.SBMAX_s,i[l++]*=1+.029*c*c/Mv.SBMAX_s/Mv.SBMAX_s;s[o][a]=0|Math.max(n[o][a],.9*s[o][a])}},this.VBR_new_prepare=function(e,s,o,a,r,i){var l,c=e.internal_flags,u=1,d=0,m=0;if(e.free_format){c.bitrate_index=0;p=new MeanBits(d);l=t.ResvFrameBegin(e,p),d=p.bits,r[0]=l}else{c.bitrate_index=c.VBR_max_bitrate;var p=new MeanBits(d);t.ResvFrameBegin(e,p),d=p.bits,get_framebits(e,r),l=r[c.VBR_max_bitrate]}for(var h=0;h<c.mode_gr;h++){n.on_pe(e,s,i[h],d,h,0),c.mode_ext==Mv.MPG_MD_MS_LR&&ms_convert(c.l3_side,h);for(var f=0;f<c.channels_out;++f){var g=c.l3_side.tt[h][f];c.masking_lower=Math.pow(10,.1*c.PSY.mask_adjust),init_outer_loop(c,g),0!=n.calc_xmin(e,o[h][f],g,a[h][f])&&(u=0),m+=i[h][f]}}for(h=0;h<c.mode_gr;h++)for(f=0;f<c.channels_out;f++)m>l&&(i[h][f]*=l,i[h][f]/=m);return u},this.calc_target_bits=function(s,o,a,r,i,l){var c,u,d,m,p=s.internal_flags,h=p.l3_side,f=0;p.bitrate_index=p.VBR_max_bitrate;var g=new MeanBits(f);for(l[0]=t.ResvFrameBegin(s,g),f=g.bits,p.bitrate_index=1,f=e.getframebits(s)-8*p.sideinfo_len,i[0]=f/(p.mode_gr*p.channels_out),f=s.VBR_mean_bitrate_kbps*s.framesize*1e3,0!=(1&p.substep_shaping)&&(f*=1.09),f/=s.out_samplerate,f-=8*p.sideinfo_len,f/=p.mode_gr*p.channels_out,c=.93+.07*(11-s.compression_ratio)/5.5,c<.9&&(c=.9),c>1&&(c=1),u=0;u<p.mode_gr;u++){var _=0;for(d=0;d<p.channels_out;d++){if(r[u][d]=int(c*f),o[u][d]>700){var v=int((o[u][d]-700)/1.4),b=h.tt[u][d];r[u][d]=int(c*f),b.block_type==Mv.SHORT_TYPE&&v<f/2&&(v=f/2),v>3*f/2?v=3*f/2:v<0&&(v=0),r[u][d]+=v}r[u][d]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(r[u][d]=LameInternalFlags.MAX_BITS_PER_CHANNEL),_+=r[u][d]}if(_>LameInternalFlags.MAX_BITS_PER_GRANULE)for(d=0;d<p.channels_out;++d)r[u][d]*=LameInternalFlags.MAX_BITS_PER_GRANULE,r[u][d]/=_}if(p.mode_ext==Mv.MPG_MD_MS_LR)for(u=0;u<p.mode_gr;u++)n.reduce_side(r[u],a[u],f*p.channels_out,LameInternalFlags.MAX_BITS_PER_GRANULE);for(m=0,u=0;u<p.mode_gr;u++)for(d=0;d<p.channels_out;d++)r[u][d]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(r[u][d]=LameInternalFlags.MAX_BITS_PER_CHANNEL),m+=r[u][d];if(m>l[0])for(u=0;u<p.mode_gr;u++)for(d=0;d<p.channels_out;d++)r[u][d]*=l[0],r[u][d]/=m}}var cy=rv.assert;function uy(){var e;this.setModules=function(t){e=t},this.ResvFrameBegin=function(t,n){var s,o=t.internal_flags,a=o.l3_side,r=e.getframebits(t);n.bits=(r-8*o.sideinfo_len)/o.mode_gr;var i=2048*o.mode_gr-8;t.brate>320?s=8*int(1e3*t.brate/(t.out_samplerate/1152)/8+.5):(s=11520,t.strict_ISO&&(s=8*int(32e4/(t.out_samplerate/1152)/8+.5))),o.ResvMax=s-r,o.ResvMax>i&&(o.ResvMax=i),(o.ResvMax<0||t.disable_reservoir)&&(o.ResvMax=0);var l=n.bits*o.mode_gr+Math.min(o.ResvSize,o.ResvMax);return l>s&&(l=s),cy(o.ResvMax%8==0),cy(o.ResvMax>=0),a.resvDrain_pre=0,null!=o.pinfo&&(o.pinfo.mean_bits=n.bits/2,o.pinfo.resvsize=o.ResvSize),l},this.ResvMaxBits=function(e,t,n,s){var o,a=e.internal_flags,r=a.ResvSize,i=a.ResvMax;0!=s&&(r+=t),0!=(1&a.substep_shaping)&&(i*=.9),n.bits=t,10*r>9*i?(o=r-9*i/10,n.bits+=o,a.substep_shaping|=128):(o=0,a.substep_shaping&=127,e.disable_reservoir||0!=(1&a.substep_shaping)||(n.bits-=.1*t));var l=r<6*a.ResvMax/10?r:6*a.ResvMax/10;return l-=o,l<0&&(l=0),l},this.ResvAdjust=function(e,t){e.ResvSize-=t.part2_3_length+t.part2_length},this.ResvFrameEnd=function(e,t){var n,s=e.l3_side;e.ResvSize+=t*e.mode_gr;var o=0;s.resvDrain_post=0,s.resvDrain_pre=0,0!=(n=e.ResvSize%8)&&(o+=n),n=e.ResvSize-o-e.ResvMax,n>0&&(o+=n);var a=Math.min(8*s.main_data_begin,o)/8;s.resvDrain_pre+=8*a,o-=8*a,e.ResvSize-=8*a,s.main_data_begin-=a,s.resvDrain_post+=o,e.ResvSize-=o}}function dy(){var e="http://www.mp3dev.org/",t=3,n=98,s=4,o=0,a=93;this.getLameVersion=function(){return t+"."+n+"."+s},this.getLameShortVersion=function(){return t+"."+n+"."+s},this.getLameVeryShortVersion=function(){return"LAME"+t+"."+n+"r"},this.getPsyVersion=function(){return o+"."+a},this.getLameUrl=function(){return e},this.getLameOsBitness=function(){return"32bits"}}var my=rv.System,py=rv.VbrMode,hy=rv.ShortBlock,fy=rv.Arrays,gy=rv.new_byte,_y=rv.assert;function vy(){var e,t,n;this.setModules=function(s,o,a){e=s,t=o,n=a};var s=1,o=2,a=4,r=8,i=vy.NUMTOCENTRIES,l=vy.MAXFRAMESIZE,c=i+4+4+4+4+4,u=c+9+1+1+8+1+1+3+1+1+2+4+2+2,d=128,m=64,p=32,h=null,f="Xing",g="Info",_=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];function v(e,t){if(e.nVbrNumFrames++,e.sum+=t,e.seen++,!(e.seen<e.want)&&(e.pos<e.size&&(e.bag[e.pos]=e.sum,e.pos++,e.seen=0),e.pos==e.size)){for(var n=1;n<e.size;n+=2)e.bag[n/2]=e.bag[n];e.want*=2,e.pos/=2}}function b(e,t){if(!(e.pos<=0))for(var n=1;n<i;++n){var s,o,a=n/i,r=0|Math.floor(a*e.pos);r>e.pos-1&&(r=e.pos-1),s=e.bag[r],o=e.sum;var l=0|256*s/o;l>255&&(l=255),t[n]=255&l}}function y(e,t){var n=255&e[t+0];return n<<=8,n|=255&e[t+1],n<<=8,n|=255&e[t+2],n<<=8,n|=255&e[t+3],n}function x(e,t,n){e[t+0]=255&n>>24,e[t+1]=255&n>>16,e[t+2]=255&n>>8,e[t+3]=255&n}function w(e,t,n){e[t+0]=255&n>>8,e[t+1]=255&n}function k(e,t){return new String(e,t,f.length(),h).equals(f)||new String(e,t,g.length(),h).equals(g)}function S(e,t,n){return 255&(e<<t|n&~(-1<<t))}function M(t,n){var s=t.internal_flags;n[0]=S(n[0],8,255),n[1]=S(n[1],3,7),n[1]=S(n[1],1,t.out_samplerate<16e3?0:1),n[1]=S(n[1],1,t.version),n[1]=S(n[1],2,1),n[1]=S(n[1],1,t.error_protection?0:1),n[2]=S(n[2],4,s.bitrate_index),n[2]=S(n[2],2,s.samplerate_index),n[2]=S(n[2],1,0),n[2]=S(n[2],1,t.extension),n[3]=S(n[3],2,t.mode.ordinal()),n[3]=S(n[3],2,s.mode_ext),n[3]=S(n[3],1,t.copyright),n[3]=S(n[3],1,t.original),n[3]=S(n[3],2,t.emphasis),n[0]=255;var o,a,r=241&n[1];o=1==t.version?d:t.out_samplerate<16e3?p:m,t.VBR==py.vbr_off&&(o=t.brate),a=t.free_format?0:255&16*e.BitrateIndex(o,t.version,t.out_samplerate),1==t.version?(n[1]=255&r|10,r=13&n[2],n[2]=255&(a|r)):(n[1]=255&r|2,r=13&n[2],n[2]=255&(a|r))}function A(e,t){var n=t^e;return t=t>>8^_[255&n],t}function R(e,t,s,o,a){var r,i,l,c=e.internal_flags,u=0,d=e.encoder_delay,m=e.encoder_padding,p=100-10*e.VBR_q-e.quality,h=n.getLameVeryShortVersion(),f=0,g=[1,5,3,2,4,0,3],_=0|(e.lowpassfreq/100+.5>255?255:e.lowpassfreq/100+.5),v=0,b=0,y=0,k=e.internal_flags.noise_shaping,S=0,M=0,R=0,E=0,T=0,B=0!=(1&e.exp_nspsytune),I=0!=(2&e.exp_nspsytune),C=!1,j=!1,O=e.internal_flags.nogap_total,F=e.internal_flags.nogap_current,L=e.ATHtype,P=0;switch(e.VBR){case vbr_abr:l=e.VBR_mean_bitrate_kbps;break;case vbr_off:l=e.brate;break;default:l=e.VBR_min_bitrate_kbps}switch(r=e.VBR.ordinal()<g.length?g[e.VBR.ordinal()]:0,i=16*f+r,c.findReplayGain&&(c.RadioGain>510&&(c.RadioGain=510),c.RadioGain<-510&&(c.RadioGain=-510),b=8192,b|=3072,c.RadioGain>=0?b|=c.RadioGain:(b|=512,b|=-c.RadioGain)),c.findPeakSample&&(v=Math.abs(0|c.PeakSample/32767*Math.pow(2,23)+.5)),-1!=O&&(F>0&&(j=!0),F<O-1&&(C=!0)),P=L+((B?1:0)<<4)+((I?1:0)<<5)+((C?1:0)<<6)+((j?1:0)<<7),p<0&&(p=0),e.mode){case MONO:S=0;break;case STEREO:S=1;break;case DUAL_CHANNEL:S=2;break;case JOINT_STEREO:S=e.force_ms?4:3;break;case NOT_SET:default:S=7;break}R=e.in_samplerate<=32e3?0:48e3==e.in_samplerate?2:e.in_samplerate>48e3?3:1,(e.short_blocks==hy.short_block_forced||e.short_blocks==hy.short_block_dispensed||-1==e.lowpassfreq&&-1==e.highpassfreq||e.scale_left<e.scale_right||e.scale_left>e.scale_right||e.disable_reservoir&&e.brate<320||e.noATH||e.ATHonly||0==L||e.in_samplerate<=32e3)&&(M=1),E=k+(S<<2)+(M<<5)+(R<<6),T=c.nMusicCRC,x(s,o+u,p),u+=4;for(var D=0;D<9;D++)s[o+u+D]=255&h.charAt(D);u+=9,s[o+u]=255&i,u++,s[o+u]=255&_,u++,x(s,o+u,v),u+=4,w(s,o+u,b),u+=2,w(s,o+u,y),u+=2,s[o+u]=255&P,u++,s[o+u]=l>=255?255:255&l,u++,s[o+u]=255&d>>4,s[o+u+1]=255&(d<<4)+(m>>8),s[o+u+2]=255&m,u+=3,s[o+u]=255&E,u++,s[o+u++]=0,w(s,o+u,e.preset),u+=2,x(s,o+u,t),u+=4,w(s,o+u,T),u+=2;for(var H=0;H<u;H++)a=A(s[o+H],a);return w(s,o+u,a),u+=2,u}function E(e){e.seek(0);var t,n=gy(10);return e.readFully(n),t=new String(n,"ISO-8859-1").startsWith("ID3")?0:((127&n[6])<<21|(127&n[7])<<14|(127&n[8])<<7|127&n[9])+n.length,t}this.addVbrFrame=function(e){var t=e.internal_flags,n=Tables.bitrate_table[e.version][t.bitrate_index];_y(null!=t.VBR_seek_table.bag),v(t.VBR_seek_table,n)},this.getVbrTag=function(e){var t=new VBRTagData,n=0;t.flags=0;var l=e[n+1]>>3&1,c=e[n+2]>>2&3,u=e[n+3]>>6&3,d=e[n+2]>>4&15;if(d=Tables.bitrate_table[l][d],e[n+1]>>4==14?t.samprate=Tables.samplerate_table[2][c]:t.samprate=Tables.samplerate_table[l][c],n+=0!=l?3!=u?36:21:3!=u?21:13,!k(e,n))return null;n+=4,t.hId=l;var m=t.flags=y(e,n);if(n+=4,0!=(m&s)&&(t.frames=y(e,n),n+=4),0!=(m&o)&&(t.bytes=y(e,n),n+=4),0!=(m&a)){if(null!=t.toc)for(var p=0;p<i;p++)t.toc[p]=e[n+p];n+=i}t.vbrScale=-1,0!=(m&r)&&(t.vbrScale=y(e,n),n+=4),t.headersize=72e3*(l+1)*d/t.samprate,n+=21;var h=e[n+0]<<4;h+=e[n+1]>>4;var f=(15&e[n+1])<<8;return f+=255&e[n+2],(h<0||h>3e3)&&(h=-1),(f<0||f>3e3)&&(f=-1),t.encDelay=h,t.encPadding=f,t},this.InitVbrTag=function(e){var n,s=e.internal_flags;n=1==e.version?d:e.out_samplerate<16e3?p:m,e.VBR==py.vbr_off&&(n=e.brate);var o=72e3*(e.version+1)*n/e.out_samplerate,a=s.sideinfo_len+u;if(s.VBR_seek_table.TotalFrameSize=o,o<a||o>l)e.bWriteVbrTag=!1;else{s.VBR_seek_table.nVbrNumFrames=0,s.VBR_seek_table.nBytesWritten=0,s.VBR_seek_table.sum=0,s.VBR_seek_table.seen=0,s.VBR_seek_table.want=1,s.VBR_seek_table.pos=0,null==s.VBR_seek_table.bag&&(s.VBR_seek_table.bag=new int[400],s.VBR_seek_table.size=400);var r=gy(l);M(e,r);for(var i=s.VBR_seek_table.TotalFrameSize,c=0;c<i;++c)t.add_dummy_byte(e,255&r[c],1)}},this.updateMusicCRC=function(e,t,n,s){for(var o=0;o<s;++o)e[0]=A(t[n+o],e[0])},this.getLameTagFrame=function(e,n){var l=e.internal_flags;if(!e.bWriteVbrTag)return 0;if(l.Class_ID!=Lame.LAME_ID)return 0;if(l.VBR_seek_table.pos<=0)return 0;if(n.length<l.VBR_seek_table.TotalFrameSize)return l.VBR_seek_table.TotalFrameSize;fy.fill(n,0,l.VBR_seek_table.TotalFrameSize,0),M(e,n);var c=gy(i);if(e.free_format)for(var u=1;u<i;++u)c[u]=255&255*u/100;else b(l.VBR_seek_table,c);var d=l.sideinfo_len;e.error_protection&&(d-=2),e.VBR==py.vbr_off?(n[d++]=255&g.charAt(0),n[d++]=255&g.charAt(1),n[d++]=255&g.charAt(2),n[d++]=255&g.charAt(3)):(n[d++]=255&f.charAt(0),n[d++]=255&f.charAt(1),n[d++]=255&f.charAt(2),n[d++]=255&f.charAt(3)),x(n,d,s+o+a+r),d+=4,x(n,d,l.VBR_seek_table.nVbrNumFrames),d+=4;var m=l.VBR_seek_table.nBytesWritten+l.VBR_seek_table.TotalFrameSize;x(n,d,0|m),d+=4,my.arraycopy(c,0,n,d,c.length),d+=c.length,e.error_protection&&t.CRC_writeheader(l,n);var p=0;for(u=0;u<d;u++)p=A(n[u],p);return d+=R(e,m,n,d,p),l.VBR_seek_table.TotalFrameSize},this.putVbrTag=function(e,t){var n=e.internal_flags;if(n.VBR_seek_table.pos<=0)return-1;if(t.seek(t.length()),0==t.length())return-1;var s=E(t);t.seek(s);var o=gy(l),a=getLameTagFrame(e,o);return a>o.length?-1:(a<1||t.write(o,0,a),0)}}vy.NUMTOCENTRIES=100,vy.MAXFRAMESIZE=2880;var by=rv.new_byte,yy=rv.assert;function xy(){this.setModules=function(e,t){}}function wy(){this.setModules=function(e,t,n){}}function ky(){}function Sy(){this.setModules=function(e,t){}}function My(e,t,n){3!=arguments.length&&(console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified"),e=1,t=44100,n=128);var s=new Gb,o=new xy,a=new db,r=new Nb,i=new Zb,l=new Eb,c=new ly,u=new vy,d=new dy,m=new Sy,p=new uy,h=new jb,f=new wy,g=new ky;s.setModules(a,r,i,l,c,u,d,m,g),r.setModules(a,g,d,u),m.setModules(r,d),i.setModules(s),c.setModules(r,p,l,h),l.setModules(h,p,s.enc.psy),p.setModules(r),h.setModules(l),u.setModules(s,r,d),o.setModules(f,g),f.setModules(d,m,i);var _=s.lame_init();_.num_channels=e,_.in_samplerate=t,_.brate=n,_.mode=_v.STEREO,_.quality=3,_.bWriteVbrTag=!1,_.disable_reservoir=!0,_.write_id3tag_automatic=!1,s.lame_init_params(_);var v=1152,b=0|1.25*v+7200,y=by(b);this.encodeBuffer=function(t,n){1==e&&(n=t),yy(t.length==n.length),t.length>v&&(v=t.length,b=0|1.25*v+7200,y=by(b));var o=s.lame_encode_buffer(_,t,n,t.length,y,0,b);return new Int8Array(y.subarray(0,o))},this.flush=function(){var e=s.lame_encode_flush(_,y,0,b);return new Int8Array(y.subarray(0,e))}}function Ay(e){return e.charCodeAt(0)<<24|e.charCodeAt(1)<<16|e.charCodeAt(2)<<8|e.charCodeAt(3)}Ay("RIFF"),Ay("WAVE"),Ay("fmt "),Ay("data");class Ry{constructor(e){this.bitRate=e.bitRate,this.sampleRate=e.sampleRate,this.dataBuffer=[],this.encoder=new My(1,this.sampleRate,this.bitRate)}encode(e){const t=1152,n=this._convertBuffer(e);let s=n.length;for(let o=0;s>=0;o+=t){const e=n.subarray(o,o+t),a=this.encoder.encodeBuffer(e);this.dataBuffer.push(new Int8Array(a)),s-=t}}finish(){this.dataBuffer.push(this.encoder.flush());const e=new Blob(this.dataBuffer,{type:"audio/mp3"});return this.dataBuffer=[],{id:Date.now(),blob:e,url:URL.createObjectURL(e)}}_floatTo16BitPCM(e,t){for(let n=0;n<e.length;n++){const s=Math.max(-1,Math.min(1,e[n]));t[n]=s<0?32768*s:32767*s}}_convertBuffer(e){const t=new Float32Array(e),n=new Int16Array(e.length);return this._floatTo16BitPCM(t,n),n}}class Ey{constructor(e={}){this.beforeRecording=e.beforeRecording,this.pauseRecording=e.pauseRecording,this.afterRecording=e.afterRecording,this.micFailed=e.micFailed,this.onProcess=e.onProcess,this.encoderOptions={bitRate:e.bitRate,sampleRate:e.sampleRate},this.bufferSize=4096,this.records=[],this.isPause=!1,this.isRecording=!1,this.duration=0,this.volume=0,this._duration=0}start(){const e={video:!1,audio:{channelCount:1,echoCancellation:!1}};this.beforeRecording&&this.beforeRecording("start recording"),navigator.mediaDevices.getUserMedia(e).then(this._micCaptured.bind(this)).catch(this._micError.bind(this)),this.isPause=!1,this.isRecording=!0,this.lameEncoder||(this.lameEncoder=new Ry(this.encoderOptions))}stop(){this.stream.getTracks().forEach((e=>e.stop())),this.input.disconnect(),this.processor.disconnect(),this.context.close();let e=null;e=this.lameEncoder.finish(),e.duration=this.duration,this.records.push(e),this._duration=0,this.duration=0,this.isPause=!1,this.isRecording=!1,this.afterRecording&&this.afterRecording(e)}pause(){this.stream.getTracks().forEach((e=>e.stop())),this.input.disconnect(),this.processor.disconnect(),this._duration=this.duration,this.isPause=!0,this.pauseRecording&&this.pauseRecording("pause recording")}_micCaptured(e){this.context=new(window.AudioContext||window.webkitAudioContext),this.duration=this._duration,this.input=this.context.createMediaStreamSource(e),this.processor=this.context.createScriptProcessor(this.bufferSize,1,1),this.stream=e,this.processor.onaudioprocess=e=>{const t=e.inputBuffer.getChannelData(0);let n=0;this.onProcess(t),this.lameEncoder&&this.lameEncoder.encode(t);for(let s=0;s<t.length;++s)n+=t[s]*t[s];this.duration=parseFloat(this._duration)+parseFloat(this.context.currentTime.toFixed(2)),this.volume=Math.sqrt(n/t.length).toFixed(2)},this.input.connect(this.processor),this.processor.connect(this.context.destination)}_micError(e){this.micFailed&&this.micFailed(e)}}var Ty=window.chrome,By=window.navigator,Iy=By.vendor,Cy="undefined"!==typeof window.opr,jy=By.userAgent.indexOf("Edg")>-1,Oy=By.userAgent.match("CriOS");function Fy(){return!!Oy||null!==Ty&&"undefined"!==typeof Ty&&"Google Inc."===Iy&&!1===Cy&&!1===jy}function Ly(){var e=Py(),t=e.substr(0,4);return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw(n|u)|c55\/|capi|ccwa|cdm|cell|chtm|cldc|cmd|co(mp|nd)|craw|da(it|ll|ng)|dbte|dcs|devi|dica|dmob|do(c|p)o|ds(12|d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(|_)|g1 u|g560|gene|gf5|gmo|go(\.w|od)|gr(ad|un)|haie|hcit|hd(m|p|t)|hei|hi(pt|ta)|hp( i|ip)|hsc|ht(c(| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i(20|go|ma)|i230|iac( ||\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|[a-w])|libw|lynx|m1w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|mcr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|([1-8]|c))|phil|pire|pl(ay|uc)|pn2|po(ck|rt|se)|prox|psio|ptg|qaa|qc(07|12|21|32|60|[2-7]|i)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h|oo|p)|sdk\/|se(c(|0|1)|47|mc|nd|ri)|sgh|shar|sie(|m)|sk0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h|v|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl|tdg|tel(i|m)|tim|tmo|to(pl|sh)|ts(70|m|m3|m5)|tx9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas|your|zeto|zte/i.test(t)}function Py(){var e=navigator.userAgent||navigator.vendor||window.opera||null;if(!e)throw new Error("Failed to look for user agent information.");return e}const Dy={name:"RoomFooter",components:{SvgIcon:Ri,EmojiPickerContainer:Hg,RoomFiles:Qg,RoomMessageReply:k_,RoomUsersTag:B_,RoomEmojis:F_,RoomTemplatesText:V_},directives:{clickOutside:bm},props:{room:{type:Object,required:!0},roomId:{type:[String,Number],required:!0},roomMessage:{type:String,default:null},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},textMessages:{type:Object,required:!0},showSendIcon:{type:Boolean,required:!0},showFiles:{type:Boolean,required:!0},showAudio:{type:Boolean,required:!0},showEmojis:{type:Boolean,required:!0},showFooter:{type:Boolean,required:!0},acceptedFiles:{type:String,required:!0},multipleFiles:{type:Boolean,default:!0},captureFiles:{type:String,required:!0},textareaActionEnabled:{type:Boolean,required:!0},textareaAutoFocus:{type:Boolean,required:!0},userTagsEnabled:{type:Boolean,required:!0},emojisSuggestionEnabled:{type:Boolean,required:!0},templatesText:{type:Array,default:null},audioBitRate:{type:Number,required:!0},audioSampleRate:{type:Number,required:!0},initReplyMessage:{type:Object,default:null},initEditMessage:{type:Object,default:null},droppedFiles:{type:Array,default:null},emojiDataSource:{type:String,default:void 0}},emits:["edit-message","send-message","record-voice","record-stauts","update-edited-message-id","textarea-action-handler","typing-message"],data(){return{message:"",editedMessage:{},messageReply:null,cursorRangePosition:null,files:[],fileDialog:!1,selectUsersTagItem:null,selectEmojiItem:null,selectTemplatesTextItem:null,activeUpOrDownEmojis:null,activeUpOrDownUsersTag:null,activeUpOrDownTemplatesText:null,emojisDB:new Fh({dataSource:this.emojiDataSource}),emojiOpened:!1,keepKeyboardOpen:!1,filteredEmojis:[],filteredUsersTag:[],selectedUsersTag:[],filteredTemplatesText:[],recorder:this.initRecorder(),isRecording:!1}},computed:{isMessageEmpty(){return!this.files.length&&!this.message.trim()},isFileLoading(){return this.files.some((e=>e.loading))},recordedTime(){return new Date(1e3*this.recorder.duration).toISOString().substr(14,5)},shadowFooter(){return!!this.filteredEmojis.length||!!this.filteredUsersTag.length||!!this.filteredTemplatesText.length||!!this.files.length||!!this.messageReply}},watch:{roomId(){this.resetMessage(!0,!0),this.roomMessage&&(this.message=this.roomMessage,setTimeout((()=>this.onChangeInput())))},message(e){this.getTextareaRef().value=e},roomMessage:{immediate:!0,handler(e){e&&(this.message=this.roomMessage)}},editedMessage(e){this.$emit("update-edited-message-id",e._id)},initReplyMessage(e){e&&this.replyMessage(e)},initEditMessage(e){e&&this.editMessage(e)},droppedFiles(e){e&&this.onFileChange(e)}},mounted(){const e=Ly();let t=!0;this.getTextareaRef().addEventListener("keyup",(n=>{"Enter"!==n.key||n.shiftKey||this.fileDialog||(e?(this.message=this.message+"\n",setTimeout((()=>this.onChangeInput()))):!t||this.filteredEmojis.length||this.filteredUsersTag.length||this.filteredTemplatesText.length||this.sendMessage()),t=!n.isComposing,setTimeout((()=>{this.updateFooterLists()}),60)})),this.getTextareaRef().addEventListener("click",(()=>{e&&(this.keepKeyboardOpen=!0),this.updateFooterLists()})),this.getTextareaRef().addEventListener("blur",(()=>{setTimeout((()=>{this.resetFooterList()}),100),e&&setTimeout((()=>this.keepKeyboardOpen=!1))}))},beforeUnmount(){this.stopRecorder()},methods:{setInput(e){return console.log(e),this.$refs.roomTextarea.val(e)},getTextareaRef(){return this.$refs.roomTextarea},focusTextarea(e){Ly()&&e||this.getTextareaRef()&&(this.getTextareaRef().focus(),this.cursorRangePosition&&setTimeout((()=>{const e=Fy()?0:1;this.getTextareaRef().setSelectionRange(this.cursorRangePosition+e,this.cursorRangePosition+e),this.cursorRangePosition=null})))},onChangeInput(){var e,t,n;((null==(e=this.getTextareaRef())?void 0:e.value)||""===(null==(t=this.getTextareaRef())?void 0:t.value))&&(this.message=null==(n=this.getTextareaRef())?void 0:n.value),this.keepKeyboardOpen=!0,this.resizeTextarea(),this.$emit("typing-message",this.message)},resizeTextarea(){const e=this.getTextareaRef();if(!e)return;const t=window.getComputedStyle(e,null).getPropertyValue("padding-top").replace("px","");e.style.height=0,e.style.height=e.scrollHeight-2*t+"px"},escapeTextarea(){this.filteredEmojis.length?this.filteredEmojis=[]:this.filteredUsersTag.length?this.filteredUsersTag=[]:this.filteredTemplatesText.length?this.filteredTemplatesText=[]:this.resetMessage()},onPasteImage(e){var t;const n=null==(t=e.clipboardData)?void 0:t.items;n&&Array.from(n).forEach((e=>{if(e.type.includes("image")){const t=e.getAsFile();this.onFileChange([t])}}))},updateActiveUpOrDown(e,t){this.filteredEmojis.length?(this.activeUpOrDownEmojis=t,e.preventDefault()):this.filteredUsersTag.length?(this.activeUpOrDownUsersTag=t,e.preventDefault()):this.filteredTemplatesText.length&&(this.activeUpOrDownTemplatesText=t,e.preventDefault())},selectItem(){this.filteredEmojis.length?this.selectEmojiItem=!0:this.filteredUsersTag.length?this.selectUsersTagItem=!0:this.filteredTemplatesText.length&&(this.selectTemplatesTextItem=!0)},selectEmoji(e){if(this.selectEmojiItem=!1,!e)return;const{position:t,endPosition:n}=this.getCharPosition(":");this.message=this.message.substr(0,t-1)+e+this.message.substr(n,this.message.length-1),this.cursorRangePosition=t,this.focusTextarea()},selectTemplateText(e){if(this.selectTemplatesTextItem=!1,!e)return;const{position:t,endPosition:n}=this.getCharPosition("/"),s=this.message.substr(n,n).length?"":" ";this.message=this.message.substr(0,t-1)+e.text+s+this.message.substr(n,this.message.length-1),this.cursorRangePosition=t+e.text.length+s.length+1,this.focusTextarea()},addEmoji(e){this.message+=e.unicode,this.focusTextarea(!0)},launchFilePicker(){this.$refs.file.value="",this.$refs.file.click()},async onFileChange(e){this.fileDialog=!0,this.focusTextarea(),Array.from(e).forEach((async e=>{const t=URL.createObjectURL(e),n=e.name.lastIndexOf(".");this.files.push({loading:!0,name:e.name.substring(0,n),size:e.size,type:e.type,extension:e.name.substring(n+1),localUrl:t});const s=await fetch(t).then((e=>e.blob()));let o=this.files.find((e=>e.localUrl===t));o&&(o.blob=s,o.loading=!1,delete o.loading)})),setTimeout((()=>this.fileDialog=!1),500)},removeFile(e){this.files.splice(e,1),this.focusTextarea()},toggleRecorder(e){if(this.isRecording=e,this.recorder.isRecording)try{this.recorder.stop(),this.$emit("record-status",0),this.recorder=this.initRecorder()}catch{setTimeout((()=>this.stopRecorder()),100)}else setTimeout((()=>{this.$emit("record-status",1),this.recorder.start()}),200)},stopRecorder(){if(this.recorder.isRecording)try{this.recorder.stop(),this.recorder=this.initRecorder()}catch{setTimeout((()=>this.stopRecorder()),100)}},textareaActionHandler(){this.$emit("textarea-action-handler",this.message)},sendMessage(){var e;let t=this.message.trim();if(!this.files.length&&!t)return;if(this.isFileLoading)return;this.selectedUsersTag.forEach((e=>{t=t.replace(`@${e.username}`,`<usertag>${e._id}</usertag>`)}));const n=this.files.length?this.files:null;this.editedMessage._id?(this.editedMessage.content!==t||(null==(e=this.editedMessage.files)?void 0:e.length)||this.files.length)&&this.$emit("edit-message",{messageId:this.editedMessage._id,newContent:t,files:n,replyMessage:this.messageReply,usersTag:this.selectedUsersTag}):this.$emit("send-message",{content:t,files:n,replyMessage:this.messageReply,usersTag:this.selectedUsersTag}),this.resetMessage(!0)},editMessage(e){this.resetMessage(),this.editedMessage={...e};let t=e.content;const n=t,s="<usertag>",o="</usertag>",a=[...t.matchAll(new RegExp(s,"gi"))].map((e=>e.index));a.forEach((e=>{const a=n.substring(e+s.length,n.indexOf(o,e)),r=this.room.users.find((e=>e._id===a));t=t.replace(`${s}${a}${o}`,`@${(null==r?void 0:r.username)||"unknown"}`),this.selectUserTag(r,!0)})),this.message=t,e.files&&(this.files=[...e.files]),setTimeout((()=>this.resizeTextarea()))},replyMessage(e){this.editedMessage={},this.messageReply=e,this.focusTextarea()},updateFooterLists(){this.updateFooterList("@"),this.updateFooterList(":"),this.updateFooterList("/")},updateFooterList(e){if(!this.getTextareaRef())return;if(":"===e&&!this.emojisSuggestionEnabled)return;if("@"===e&&(!this.userTagsEnabled||!this.room.users))return;if("/"===e&&!this.templatesText)return;const t=this.getTextareaRef().selectionStart;let n=t;while(n>0&&this.message.charAt(n-1)!==e&&(" "!==this.message.charAt(n-1)||":"!==e))n--;const s=this.message.charAt(n-2),o=!s.match(/^[0-9a-zA-Z]+$/);if(this.message.charAt(n-1)!==e||s&&" "!==s&&!o)this.resetFooterList(e);else{const s=this.message.substring(n,t);":"===e?this.updateEmojis(s):"@"===e?this.updateShowUsersTag(s):"/"===e&&this.updateShowTemplatesText(s)}},updateShowUsersTag(e){this.filteredUsersTag=zm(this.room.users,"username",e,!0).filter((e=>e._id!==this.currentUserId))},selectUserTag(e,t=!1){if(this.selectUsersTagItem=!1,!e)return;const{position:n,endPosition:s}=this.getCharPosition("@"),o=this.message.substr(s,s).length?"":" ";this.message=this.message.substr(0,n)+e.username+o+this.message.substr(s,this.message.length-1),this.selectedUsersTag=[...this.selectedUsersTag,{...e}],t||(this.cursorRangePosition=n+e.username.length+o.length+1),this.focusTextarea()},updateShowTemplatesText(e){this.filteredTemplatesText=zm(this.templatesText,"tag",e,!0)},getCharPosition(e){const t=this.getTextareaRef().selectionStart;let n=t;while(n>0&&this.message.charAt(n-1)!==e)n--;const s=this.getTextareaRef().selectionEnd;return{position:n,endPosition:s}},async updateEmojis(e){if(!e)return;const t=await this.emojisDB.getEmojiBySearchQuery(e);this.filteredEmojis=t.map((e=>e.unicode))},resetFooterList(e=null){":"===e?this.filteredEmojis=[]:"@"===e?this.filteredUsersTag=[]:("/"===e||(this.filteredEmojis=[],this.filteredUsersTag=[]),this.filteredTemplatesText=[])},resetMessage(e=!1,t=!1){t||this.$emit("typing-message",null),this.selectedUsersTag=[],this.resetFooterList(),this.resetTextareaSize(),this.message="",this.editedMessage={},this.messageReply=null,this.files=[],this.emojiOpened=!1,this.preventKeyboardFromClosing(),!this.textareaAutoFocus&&t||setTimeout((()=>this.focusTextarea(e)))},resetTextareaSize(){this.getTextareaRef()&&(this.getTextareaRef().style.height="20px")},preventKeyboardFromClosing(){this.keepKeyboardOpen&&this.getTextareaRef().focus()},initRecorder(){this.isRecording=!1;var e=new Ey({bitRate:Number(this.audioBitRate),sampleRate:Number(this.audioSampleRate),beforeRecording:null,afterRecording:null,pauseRecording:null,micFailed:this.micFailed,onProcess:this.onRecord});return e},onRecord(e){this.$emit("record-voice",e)},micFailed(){this.isRecording=!1,this.recorder=this.initRecorder()}}},Hy={key:0,class:"vac-icon-textarea-left"},Ny=Zo("div",{class:"vac-dot-audio-record"},null,-1),$y={class:"vac-dot-audio-record-time"},zy=["placeholder"],Vy={class:"vac-icon-textarea"},qy={key:1},Uy=["multiple","accept","capture"];function Xy(e,t,n,s,o,a){const r=Is("room-emojis"),i=Is("room-users-tag"),l=Is("room-templates-text"),c=Is("room-message-reply"),u=Is("room-files"),d=Is("svg-icon"),m=Is("emoji-picker-container"),p=Os("click-outside");return Rs((Do(),Vo("div",{id:"room-footer",class:ht(["vac-room-footer",{"vac-app-box-shadow":a.shadowFooter}])},[Wo(r,{"filtered-emojis":o.filteredEmojis,"select-item":o.selectEmojiItem,"active-up-or-down":o.activeUpOrDownEmojis,onSelectEmoji:t[0]||(t[0]=e=>a.selectEmoji(e)),onActivateItem:t[1]||(t[1]=e=>o.activeUpOrDownEmojis=0)},null,8,["filtered-emojis","select-item","active-up-or-down"]),Wo(i,{"filtered-users-tag":o.filteredUsersTag,"select-item":o.selectUsersTagItem,"active-up-or-down":o.activeUpOrDownUsersTag,onSelectUserTag:t[2]||(t[2]=e=>a.selectUserTag(e)),onActivateItem:t[3]||(t[3]=e=>o.activeUpOrDownUsersTag=0)},null,8,["filtered-users-tag","select-item","active-up-or-down"]),Wo(l,{"filtered-templates-text":o.filteredTemplatesText,"select-item":o.selectTemplatesTextItem,"active-up-or-down":o.activeUpOrDownTemplatesText,onSelectTemplateText:t[4]||(t[4]=e=>a.selectTemplateText(e)),onActivateItem:t[5]||(t[5]=e=>o.activeUpOrDownTemplatesText=0)},null,8,["filtered-templates-text","select-item","active-up-or-down"]),Wo(c,{room:n.room,"message-reply":o.messageReply,"text-formatting":n.textFormatting,"link-options":n.linkOptions,onResetMessage:a.resetMessage},Ds({_:2},[Ps(e.$slots,((t,n)=>({name:n,fn:Fn((t=>[Hs(e.$slots,n,ft(Jo(t)))]))})))]),1032,["room","message-reply","text-formatting","link-options","onResetMessage"]),Wo(u,{files:o.files,onRemoveFile:a.removeFile,onResetMessage:a.resetMessage},Ds({_:2},[Ps(e.$slots,((t,n)=>({name:n,fn:Fn((t=>[Hs(e.$slots,n,ft(Jo(t)))]))})))]),1032,["files","onRemoveFile","onResetMessage"]),Zo("div",{class:ht(["vac-box-footer",{"vac-box-footer-border":!o.files.length}])},[n.showAudio&&!o.files.length?(Do(),Vo("div",Hy,[o.isRecording?(Do(),Vo(Co,{key:0},[Zo("div",{class:"vac-svg-button vac-icon-audio-stop",onClick:t[6]||(t[6]=(...e)=>a.stopRecorder&&a.stopRecorder(...e))},[Hs(e.$slots,"audio-stop-icon",{},(()=>[Wo(d,{name:"close-outline"})]))]),Ny,Zo("div",$y,gt(a.recordedTime),1),Zo("div",{class:"vac-svg-button vac-icon-audio-confirm",onClick:t[7]||(t[7]=e=>a.toggleRecorder(!1))},[Hs(e.$slots,"audio-check-icon",{},(()=>[Wo(d,{name:"checkmark"})]))])],64)):(Do(),Vo("div",{key:1,class:"vac-svg-button",onClick:t[8]||(t[8]=e=>a.toggleRecorder(!0))},[Hs(e.$slots,"microphone-icon",{},(()=>[Wo(d,{name:"microphone",class:"vac-icon-microphone"})]))]))])):na("",!0),Zo("textarea",{id:"roomTextarea",ref:"roomTextarea",placeholder:n.textMessages.TYPE_MESSAGE,class:ht(["vac-textarea",{"vac-textarea-outline":o.editedMessage._id}]),style:{"min-height":"20px","padding-left":"12px"},onInput:t[9]||(t[9]=(...e)=>a.onChangeInput&&a.onChangeInput(...e)),onKeydown:[t[10]||(t[10]=ai(((...e)=>a.escapeTextarea&&a.escapeTextarea(...e)),["esc"])),t[11]||(t[11]=ai(si(((...e)=>a.selectItem&&a.selectItem(...e)),["exact","prevent"]),["enter"])),t[13]||(t[13]=ai(si((()=>{}),["exact","prevent"]),["tab"])),t[14]||(t[14]=ai(((...e)=>a.selectItem&&a.selectItem(...e)),["tab"])),t[15]||(t[15]=ai((e=>a.updateActiveUpOrDown(e,-1)),["up"])),t[16]||(t[16]=ai((e=>a.updateActiveUpOrDown(e,1)),["down"]))],onPaste:t[12]||(t[12]=(...e)=>a.onPasteImage&&a.onPasteImage(...e))},null,42,zy),Zo("div",Vy,[o.editedMessage._id?(Do(),Vo("div",{key:0,class:"vac-svg-button",onClick:t[17]||(t[17]=(...e)=>a.resetMessage&&a.resetMessage(...e))},[Hs(e.$slots,"edit-close-icon",{},(()=>[Wo(d,{name:"close-outline"})]))])):na("",!0),n.showEmojis?Rs((Do(),Vo("div",qy,[Hs(e.$slots,"emoji-picker",ra({emojiOpened:o.emojiOpened},{addEmoji:a.addEmoji}),(()=>[Wo(m,{"emoji-opened":o.emojiOpened,"position-top":!0,"emoji-data-source":n.emojiDataSource,onAddEmoji:a.addEmoji,onOpenEmoji:t[18]||(t[18]=e=>o.emojiOpened=e)},{"emoji-picker-icon":Fn((()=>[Hs(e.$slots,"emoji-picker-icon")])),_:3},8,["emoji-opened","emoji-data-source","onAddEmoji"])]))])),[[p,()=>o.emojiOpened=!1]]):na("",!0),n.showFiles?(Do(),Vo("div",{key:2,class:"vac-svg-button",onClick:t[19]||(t[19]=(...e)=>a.launchFilePicker&&a.launchFilePicker(...e))},[Hs(e.$slots,"paperclip-icon",{},(()=>[Wo(d,{name:"paperclip"})]))])):na("",!0),n.textareaActionEnabled?(Do(),Vo("div",{key:3,class:"vac-svg-button",onClick:t[20]||(t[20]=(...e)=>a.textareaActionHandler&&a.textareaActionHandler(...e))},[Hs(e.$slots,"custom-action-icon",{},(()=>[Wo(d,{name:"deleted"})]))])):na("",!0),n.showFiles?(Do(),Vo("input",{key:4,ref:"file",type:"file",multiple:!!n.multipleFiles||null,accept:n.acceptedFiles,capture:n.captureFiles,style:{display:"none"},onChange:t[21]||(t[21]=e=>a.onFileChange(e.target.files))},null,40,Uy)):na("",!0),n.showSendIcon?(Do(),Vo("div",{key:5,class:ht(["vac-svg-button",{"vac-send-disabled":a.isMessageEmpty}]),onClick:t[22]||(t[22]=(...e)=>a.sendMessage&&a.sendMessage(...e))},[Hs(e.$slots,"send-icon",{},(()=>[Wo(d,{name:"send",param:a.isMessageEmpty||a.isFileLoading?"disabled":""},null,8,["param"])]))],2)):na("",!0)])],2)],2)),[[ri,Object.keys(n.room).length&&n.showFooter]])}var Yy=mi(Dy,[["render",Xy]]);const Gy={name:"MessageReply",components:{AudioPlayer:l_,SvgIcon:Ri,FormatMessage:am},props:{message:{type:Object,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},roomUsers:{type:Array,required:!0}},computed:{replyUsername(){const{senderId:e}=this.message.replyMessage,t=this.roomUsers.find((t=>t._id===e));return t?t.username:""},firstFile(){var e,t;return(null==(t=null==(e=this.message.replyMessage)?void 0:e.files)?void 0:t.length)?this.message.replyMessage.files[0]:{}},isAudio(){return Mm(this.firstFile)},isImage(){return wm(this.firstFile)},isVideo(){return km(this.firstFile)},isOtherFile(){var e;return(null==(e=this.message.replyMessage.files)?void 0:e.length)&&!this.isAudio&&!this.isVideo&&!this.isImage}}},Ky={class:"vac-reply-message"},Zy={class:"vac-reply-username"},Wy={key:0,class:"vac-image-reply-container"},Qy={key:1,class:"vac-video-reply-container"},Jy={controls:""},ex=["src"],tx={key:3,class:"vac-file-container"},nx={class:"vac-text-ellipsis"},sx={key:0,class:"vac-text-ellipsis vac-text-extension"},ox={class:"vac-reply-content"};function ax(e,t,n,s,o,a){const r=Is("audio-player"),i=Is("svg-icon"),l=Is("format-message");return Do(),Vo("div",Ky,[Zo("div",Zy,gt(a.replyUsername),1),a.isImage?(Do(),Vo("div",Wy,[Zo("div",{class:"vac-message-image vac-message-image-reply",style:ut({"background-image":`url('${a.firstFile.url}')`})},null,4)])):a.isVideo?(Do(),Vo("div",Qy,[Zo("video",Jy,[Zo("source",{src:a.firstFile.url},null,8,ex)])])):a.isAudio?(Do(),qo(r,{key:2,src:a.firstFile.url,"message-selection-enabled":!1,onUpdateProgressTime:t[0]||(t[0]=t=>e.progressTime=t),onHoverAudioProgress:t[1]||(t[1]=t=>e.hoverAudioProgress=t)},Ds({_:2},[Ps(e.$slots,((t,n)=>({name:n,fn:Fn((t=>[Hs(e.$slots,n,ft(Jo(t)))]))})))]),1032,["src"])):a.isOtherFile?(Do(),Vo("div",tx,[Zo("div",null,[Hs(e.$slots,"file-icon",{},(()=>[Wo(i,{name:"file"})]))]),Zo("div",nx,gt(a.firstFile.name),1),a.firstFile.extension?(Do(),Vo("div",sx,gt(a.firstFile.extension),1)):na("",!0)])):na("",!0),Zo("div",ox,[Wo(l,{"message-id":n.message.replyMessage._id,content:n.message.replyMessage.content,users:n.roomUsers,"text-formatting":n.textFormatting,"link-options":n.linkOptions,reply:!0},null,8,["message-id","content","users","text-formatting","link-options"])])])}var rx=mi(Gy,[["render",ax]]);const ix={name:"ProgressBar",props:{progress:{type:Number,default:0}},data(){const e=35,t=4,n=e-2*t,s=2*n*Math.PI;return{radius:e,stroke:t,normalizedRadius:n,circumference:s}},computed:{strokeDashoffset(){return this.circumference-this.progress/100*this.circumference}}},lx={ref:"progress",class:"vac-progress-wrapper"},cx=["height","width"],ux=["stroke-dasharray","stroke-width","r","cx","cy"],dx={class:"vac-progress-text"},mx=Zo("span",{class:"vac-progress-pourcent"},"%",-1);function px(e,t,n,s,o,a){return Do(),qo(Br,{name:"vac-fade-spinner",appear:""},{default:Fn((()=>[Zo("div",lx,[(Do(),Vo("svg",{height:2*o.radius,width:2*o.radius},[Zo("circle",{stroke:"rgba(255, 255, 255, 0.7)","stroke-dasharray":o.circumference+" "+o.circumference,style:ut({strokeDashoffset:a.strokeDashoffset,strokeLinecap:"round"}),"stroke-width":o.stroke,fill:"transparent",r:o.normalizedRadius,cx:o.radius,cy:o.radius},null,12,ux)],8,cx)),Zo("div",{class:"vac-progress-content",style:ut({height:2*o.radius-19+"px",width:2*o.radius-19+"px"})},[Zo("div",dx,[ta(gt(n.progress),1),mx])],4)],512)])),_:1})}var hx=mi(ix,[["render",px]]);const fx={name:"MessageFile",components:{SvgIcon:Ri,Loader:xi,ProgressBar:hx},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},file:{type:Object,required:!0},index:{type:Number,required:!0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["open-file"],data(){return{imageResponsive:"",imageLoading:!1,imageHover:!1}},computed:{isImageLoading(){return-1!==this.file.url.indexOf("blob:http")||this.imageLoading},isImage(){return wm(this.file)},isVideo(){return km(this.file)}},watch:{file:{immediate:!0,handler(){this.checkImgLoad()}}},mounted(){const e=this.$refs["imageRef"+this.index];e&&(this.imageResponsive={maxHeight:e.clientWidth-18,loaderTop:e.clientHeight/2-9})},methods:{checkImgLoad(){if(!wm(this.file))return;this.imageLoading=!0;const e=new Image;e.src=this.file.url,e.addEventListener("load",(()=>this.imageLoading=!1))},openFile(e,t){this.messageSelectionEnabled||(e.stopPropagation(),this.$emit("open-file",{file:this.file,action:t}))}}},gx={class:"vac-message-file-container"},_x={key:0,class:"vac-image-buttons"},vx={controls:""},bx=["src"];function yx(e,t,n,s,o,a){const r=Is("progress-bar"),i=Is("loader"),l=Is("svg-icon");return Do(),Vo("div",gx,[a.isImage?(Do(),Vo("div",{key:0,ref:"imageRef"+n.index,class:"vac-message-image-container",onMouseover:t[2]||(t[2]=e=>o.imageHover=!0),onMouseleave:t[3]||(t[3]=e=>o.imageHover=!1),onClick:t[4]||(t[4]=e=>a.openFile(e,"preview"))},[n.file.progress>=0?(Do(),qo(r,{key:0,progress:n.file.progress,style:ut({top:`${o.imageResponsive.loaderTop}px`})},null,8,["progress","style"])):(Do(),qo(i,{key:1,show:a.isImageLoading,type:"message-file","message-id":n.message._id,style:ut({top:`${o.imageResponsive.loaderTop}px`})},Ds({_:2},[Ps(e.$slots,((t,n)=>({name:n,fn:Fn((t=>[Hs(e.$slots,n,ft(Jo(t)))]))})))]),1032,["show","message-id","style"])),Zo("div",{class:ht(["vac-message-image",{"vac-blur-loading":a.isImageLoading&&n.message.senderId===n.currentUserId}]),style:ut({"background-image":`url('${a.isImageLoading&&n.file.preview||n.file.url}')`,"max-height":`${o.imageResponsive.maxHeight}px`})},[Wo(Br,{name:"vac-fade-image"},{default:Fn((()=>[n.messageSelectionEnabled||!o.imageHover||a.isImageLoading?na("",!0):(Do(),Vo("div",_x,[Zo("div",{class:"vac-svg-button vac-button-view",onClick:t[0]||(t[0]=e=>a.openFile(e,"preview"))},[Hs(e.$slots,"eye-icon_"+n.message._id,{},(()=>[Wo(l,{name:"eye"})]))]),Zo("div",{class:"vac-svg-button vac-button-download",onClick:t[1]||(t[1]=e=>a.openFile(e,"download"))},[Hs(e.$slots,"document-icon_"+n.message._id,{},(()=>[Wo(l,{name:"document"})]))])]))])),_:3})],6)],544)):a.isVideo?(Do(),Vo("div",{key:1,class:"vac-video-container",onClick:t[5]||(t[5]=si((e=>a.openFile(e,"preview")),["prevent"]))},[n.file.progress>=0?(Do(),qo(r,{key:0,progress:n.file.progress},null,8,["progress"])):na("",!0),Zo("video",vx,[Zo("source",{src:n.file.url},null,8,bx)])])):na("",!0)])}var xx=mi(fx,[["render",yx]]);const wx={name:"MessageFiles",components:{SvgIcon:Ri,FormatMessage:am,ProgressBar:hx,MessageFile:xx},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},roomUsers:{type:Array,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["open-file","open-user-tag"],computed:{imageVideoFiles(){return this.message.files.filter((e=>Sm(e)))},otherFiles(){return this.message.files.filter((e=>!Sm(e)))}},methods:{openFile(e,t,n){this.messageSelectionEnabled||(e.stopPropagation(),this.$emit("open-file",{file:t,action:n}))}}},kx={class:"vac-message-files-container"},Sx=["onClick"],Mx={class:"vac-svg-button"},Ax={class:"vac-text-ellipsis"},Rx={key:0,class:"vac-text-ellipsis vac-text-extension"};function Ex(e,t,n,s,o,a){const r=Is("message-file"),i=Is("progress-bar"),l=Is("svg-icon"),c=Is("format-message");return Do(),Vo("div",kx,[(Do(!0),Vo(Co,null,Ps(a.imageVideoFiles,((s,o)=>(Do(),Vo("div",{key:o+"iv"},[Wo(r,{file:s,"current-user-id":n.currentUserId,message:n.message,index:o,"message-selection-enabled":n.messageSelectionEnabled,onOpenFile:t[0]||(t[0]=t=>e.$emit("open-file",t))},Ds({_:2},[Ps(e.$slots,((t,n)=>({name:n,fn:Fn((t=>[Hs(e.$slots,n,ft(Jo(t)))]))})))]),1032,["file","current-user-id","message","index","message-selection-enabled"])])))),128)),(Do(!0),Vo(Co,null,Ps(a.otherFiles,((t,n)=>(Do(),Vo("div",{key:n+"a",class:"vac-file-wrapper"},[t.progress>=0?(Do(),qo(i,{key:0,progress:t.progress,style:{top:"44px"}},null,8,["progress"])):na("",!0),Zo("div",{class:ht(["vac-file-container",{"vac-file-container-progress":t.progress>=0}]),onClick:e=>a.openFile(e,t,"download")},[Zo("div",Mx,[Hs(e.$slots,"document-icon",{},(()=>[Wo(l,{name:"document"})]))]),Zo("div",Ax,gt(t.name),1),t.extension?(Do(),Vo("div",Rx,gt(t.extension),1)):na("",!0)],10,Sx)])))),128)),Wo(c,{"message-id":n.message._id,content:n.message.content,users:n.roomUsers,"text-formatting":n.textFormatting,"link-options":n.linkOptions,onOpenUserTag:t[1]||(t[1]=t=>e.$emit("open-user-tag",t))},null,8,["message-id","content","users","text-formatting","link-options"])])}var Tx=mi(wx,[["render",Ex]]);const Bx={name:"MessageActions",components:{SvgIcon:Ri,EmojiPickerContainer:Hg},directives:{clickOutside:bm},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},messageActions:{type:Array,required:!0},showReactionEmojis:{type:Boolean,required:!0},messageHover:{type:Boolean,required:!0},hoverMessageId:{type:[String,Number],default:null},hoverAudioProgress:{type:Boolean,required:!0},emojiDataSource:{type:String,default:void 0}},emits:["update-emoji-opened","update-options-opened","update-message-hover","message-action-handler","send-message-reaction"],data(){return{menuOptionsTop:0,optionsOpened:!1,optionsClosing:!1,emojiOpened:!1}},computed:{isMessageActions(){return this.filteredMessageActions.length&&this.messageHover&&!this.message.deleted&&!this.message.disableActions&&!this.hoverAudioProgress},isMessageReactions(){return this.showReactionEmojis&&this.messageHover&&!this.message.deleted&&!this.message.disableReactions&&!this.hoverAudioProgress},filteredMessageActions(){return this.message.senderId===this.currentUserId?this.messageActions:this.messageActions.filter((e=>!e.onlyMe))}},watch:{emojiOpened(e){this.$emit("update-emoji-opened",e),e&&(this.optionsOpened=!1)},optionsOpened(e){this.$emit("update-options-opened",e)}},methods:{openOptions(){this.optionsClosing||(this.optionsOpened=!this.optionsOpened,this.optionsOpened&&setTimeout((()=>{const e=Fg(this.$el,"#room-footer");if(!e||!this.$refs.menuOptions||!this.$refs.actionIcon)return;const t=this.$refs.menuOptions.getBoundingClientRect().height,n=this.$refs.actionIcon.getBoundingClientRect().top,s=e.getBoundingClientRect().top,o=s-n>t+50;this.menuOptionsTop=o?30:-t})))},closeOptions(){this.optionsOpened=!1,this.optionsClosing=!0,this.updateMessageHover(),setTimeout((()=>this.optionsClosing=!1),100)},openEmoji(){this.emojiOpened=!this.emojiOpened},closeEmoji(){this.emojiOpened=!1,this.updateMessageHover()},updateMessageHover(){this.hoverMessageId!==this.message._id&&this.$emit("update-message-hover",!1)},messageActionHandler(e){this.closeOptions(),this.$emit("message-action-handler",e)},sendMessageReaction(e,t){this.$emit("send-message-reaction",{emoji:e,reaction:t}),this.closeEmoji()}}},Ix={class:"vac-message-actions-wrapper"},Cx={key:"3"},jx={class:"vac-menu-list"},Ox=["onClick"];function Fx(e,t,n,s,o,a){const r=Is("svg-icon"),i=Is("emoji-picker-container"),l=Os("click-outside");return Do(),Vo("div",Ix,[Zo("div",{class:"vac-options-container",style:ut({display:n.hoverAudioProgress?"none":"initial",width:a.filteredMessageActions.length&&n.showReactionEmojis?"70px":"45px"})},[Wo(Zr,{name:"vac-slide-left",tag:"span"},{default:Fn((()=>[a.isMessageActions||a.isMessageReactions?(Do(),Vo("div",{key:"1",class:ht(["vac-blur-container",{"vac-options-me":n.message.senderId===n.currentUserId}])},null,2)):na("",!0),a.isMessageActions?(Do(),Vo("div",{ref:"actionIcon",key:"2",class:"vac-svg-button vac-message-options",onClick:t[0]||(t[0]=(...e)=>a.openOptions&&a.openOptions(...e))},[Hs(e.$slots,"dropdown-icon_"+n.message._id,{},(()=>[Wo(r,{name:"dropdown",param:"message"})]))],512)):na("",!0),a.isMessageReactions?Rs((Do(),Vo("div",Cx,[Hs(e.$slots,"emoji-picker",ra({emojiOpened:o.emojiOpened},{addEmoji:a.sendMessageReaction}),(()=>[Wo(i,{class:"vac-message-emojis",style:ut({right:a.isMessageActions?"30px":"5px"}),"emoji-opened":o.emojiOpened,"emoji-reaction":!0,"position-right":n.message.senderId===n.currentUserId,"message-id":n.message._id,"emoji-data-source":n.emojiDataSource,onAddEmoji:a.sendMessageReaction,onOpenEmoji:a.openEmoji},Ds({_:2},[Ps(e.$slots,((t,n)=>({name:n,fn:Fn((t=>[Hs(e.$slots,n,ft(Jo(t)))]))})))]),1032,["style","emoji-opened","position-right","message-id","emoji-data-source","onAddEmoji","onOpenEmoji"])]))])),[[l,a.closeEmoji]]):na("",!0)])),_:3})],4),a.filteredMessageActions.length?(Do(),qo(Br,{key:0,name:n.message.senderId===n.currentUserId?"vac-slide-left":"vac-slide-right"},{default:Fn((()=>[o.optionsOpened?Rs((Do(),Vo("div",{key:0,ref:"menuOptions",class:ht(["vac-menu-options",{"vac-menu-left":n.message.senderId!==n.currentUserId}]),style:ut({top:`${o.menuOptionsTop}px`})},[Zo("div",jx,[(Do(!0),Vo(Co,null,Ps(a.filteredMessageActions,(e=>(Do(),Vo("div",{key:e.name},[Zo("div",{class:"vac-menu-item",onClick:t=>a.messageActionHandler(e)},gt(e.title),9,Ox)])))),128))])],6)),[[l,a.closeOptions]]):na("",!0)])),_:1},8,["name"])):na("",!0)])}var Lx=mi(Bx,[["render",Fx]]);const Px={name:"MessageReactions",props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0}},emits:["send-message-reaction"],methods:{sendMessageReaction(e,t){this.$emit("send-message-reaction",{emoji:e,reaction:t})}}},Dx=["onClick"];function Hx(e,t,n,s,o,a){return n.message.deleted?na("",!0):(Do(),qo(Zr,{key:0,name:"vac-slide-left",tag:"span"},{default:Fn((()=>[(Do(!0),Vo(Co,null,Ps(n.message.reactions,((e,t)=>Rs((Do(),Vo("button",{key:t+0,class:ht(["vac-button-reaction",{"vac-reaction-me":-1!==e.indexOf(n.currentUserId)}]),style:ut({float:n.message.senderId===n.currentUserId?"right":"left"}),onClick:n=>a.sendMessageReaction({unicode:t},e)},[ta(gt(t),1),Zo("span",null,gt(e.length),1)],14,Dx)),[[ri,e.length]]))),128))])),_:1}))}var Nx=mi(Px,[["render",Hx]]);function $x(e){const t=[{key:"roomId",type:["string","number"]},{key:"roomName",type:["string"]},{key:"users",type:["array"]}],n=(e,t)=>t.every((t=>{let n=!1;return("array"===t.type[0]&&Array.isArray(e[t.key])||t.type.find((n=>n===typeof e[t.key])))&&(n=!0),n&&qx(e,t.key)}));if(!n(e,t))throw new Error("Rooms object is not valid! Must contain at least roomId[String, Number], roomName[String] and users[Array]")}function zx(e){const t=[{key:"_id",type:["string","number"]},{key:"username",type:["string"]}],n=(e,t)=>t.every((t=>{const n=t.type.find((n=>n===typeof e[t.key]));return n&&qx(e,t.key)}));if(!n(e,t))throw new Error("Participants object is not valid! Must contain at least _id[String, Number] and username[String]")}function Vx(e){const t=[{key:"_id",type:["string","number"]},{key:"senderId",type:["string","number"]}],n=(e,t)=>t.every((t=>{const n=t.type.find((n=>n===typeof e[t.key]));return n&&qx(e,t.key)}));if(!n(e,t))throw new Error("Messages object is not valid! Must contain at least _id[String, Number] and senderId[String, Number]")}function qx(e,t){return Object.prototype.hasOwnProperty.call(e,t)&&null!==e[t]&&void 0!==e[t]}const Ux={name:"RoomMessage",components:{SvgIcon:Ri,FormatMessage:am,AudioPlayer:l_,MessageReply:rx,MessageFiles:Tx,MessageActions:Lx,MessageReactions:Nx},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},index:{type:Number,required:!0},message:{type:Object,required:!0},messages:{type:Array,required:!0},editedMessageId:{type:[String,Number],default:null},roomUsers:{type:Array,default:()=>[]},messageActions:{type:Array,required:!0},newMessages:{type:Array,default:()=>[]},showReactionEmojis:{type:Boolean,required:!0},showNewMessagesDivider:{type:Boolean,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},usernameOptions:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0},selectedMessages:{type:Array,default:()=>[]},emojiDataSource:{type:String,default:void 0}},emits:["message-added","open-file","open-user-tag","open-failed-message","message-action-handler","send-message-reaction","select-message","unselect-message"],data(){return{hoverMessageId:null,messageHover:!1,optionsOpened:!1,emojiOpened:!1,newMessage:{},progressTime:"- : -",hoverAudioProgress:!1}},computed:{showUsername(){return!(!this.usernameOptions.currentUser&&this.message.senderId===this.currentUserId)&&this.roomUsers.length>=this.usernameOptions.minUsers},showDate(){return this.index>0&&this.message.date!==this.messages[this.index-1].date},messageOffset(){return this.index>0&&this.message.senderId!==this.messages[this.index-1].senderId},isMessageHover(){return this.editedMessageId===this.message._id||this.hoverMessageId===this.message._id},isAudio(){var e;return null==(e=this.message.files)?void 0:e.some((e=>Mm(e)))},isCheckmarkVisible(){return this.message.senderId===this.currentUserId&&!this.message.deleted&&(this.message.saved||this.message.distributed||this.message.seen)},hasCurrentUserAvatar(){return this.messages.some((e=>e.senderId===this.currentUserId&&e.avatar))},hasSenderUserAvatar(){return this.messages.some((e=>e.senderId!==this.currentUserId&&e.avatar))},isMessageSelected(){return this.messageSelectionEnabled&&!!this.selectedMessages.find((e=>e._id===this.message._id))}},watch:{newMessages:{immediate:!0,deep:!0,handler(e){e.length&&this.showNewMessagesDivider?this.newMessage=e.reduce(((e,t)=>t.index<e.index?t:e)):this.newMessage={}}},messageSelectionEnabled(){this.resetMessageHover()}},mounted(){Vx(this.message),this.$emit("message-added",{message:this.message,index:this.index,ref:this.$refs.message})},methods:{onHoverMessage(){this.messageSelectionEnabled||(this.messageHover=!0,this.canEditMessage()&&(this.hoverMessageId=this.message._id))},canEditMessage(){return!this.message.deleted},onLeaveMessage(){this.messageSelectionEnabled||(this.optionsOpened||this.emojiOpened||(this.messageHover=!1),this.hoverMessageId=null)},resetMessageHover(){this.messageHover=!1,this.hoverMessageId=null},openFile(e){this.$emit("open-file",{message:this.message,file:e})},openUserTag(e){this.$emit("open-user-tag",{user:e})},messageActionHandler(e){this.resetMessageHover(),setTimeout((()=>{this.$emit("message-action-handler",{action:e,message:this.message})}),300)},sendMessageReaction({emoji:e,reaction:t}){this.$emit("send-message-reaction",{messageId:this.message._id,reaction:e,remove:t&&-1!==t.indexOf(this.currentUserId)}),this.messageHover=!1},selectMessage(){this.messageSelectionEnabled&&(this.isMessageSelected?this.$emit("unselect-message",this.message._id):this.$emit("select-message",this.message))}}},Xx=["id"],Yx={key:0,class:"vac-card-info vac-card-date"},Gx={key:1,class:"vac-line-new"},Kx={key:2,class:"vac-card-info vac-card-system"},Zx={key:1,class:"vac-avatar-offset"},Wx={key:0,class:"vac-progress-time"},Qx={class:"vac-text-timestamp"},Jx={key:0,class:"vac-icon-edited"},ew={key:1},tw=Zo("div",{class:"vac-failure-text"},"!",-1),nw=[tw],sw={key:3,class:"vac-avatar-current-offset"};function ow(e,t,n,s,o,a){const r=Is("format-message"),i=Is("message-reply"),l=Is("message-files"),c=Is("audio-player"),u=Is("svg-icon"),d=Is("message-actions"),m=Is("message-reactions");return Do(),Vo("div",{id:n.message._id,ref:"message",class:"vac-message-wrapper"},[a.showDate?(Do(),Vo("div",Yx,gt(n.message.date),1)):na("",!0),o.newMessage._id===n.message._id?(Do(),Vo("div",Gx,gt(n.textMessages.NEW_MESSAGES),1)):na("",!0),n.message.system?(Do(),Vo("div",Kx,[Hs(e.$slots,"message_"+n.message._id,{},(()=>[Wo(r,{"message-id":n.message._id,content:n.message.content,deleted:!!n.message.deleted,users:n.roomUsers,"text-messages":n.textMessages,"text-formatting":n.textFormatting,"link-options":n.linkOptions,onOpenUserTag:a.openUserTag},Ds({_:2},[Ps(e.$slots,((t,n)=>({name:n,fn:Fn((t=>[Hs(e.$slots,n,ft(Jo(t)))]))})))]),1032,["message-id","content","deleted","users","text-messages","text-formatting","link-options","onOpenUserTag"])]))])):(Do(),Vo("div",{key:3,class:ht(["vac-message-box",{"vac-offset-current":n.message.senderId===n.currentUserId}]),onClick:t[8]||(t[8]=(...e)=>a.selectMessage&&a.selectMessage(...e))},[Hs(e.$slots,"message_"+n.message._id,{},(()=>[n.message.senderId!==n.currentUserId?Hs(e.$slots,"message-avatar_"+n.message._id,{key:0},(()=>[n.message.avatar?(Do(),Vo("div",{key:0,class:"vac-avatar",style:ut({"background-image":`url('${n.message.avatar}')`})},null,4)):na("",!0)])):na("",!0),a.hasSenderUserAvatar&&!n.message.avatar?(Do(),Vo("div",Zx)):na("",!0),Zo("div",{class:ht(["vac-message-container",{"vac-message-container-offset":a.messageOffset}])},[Zo("div",{class:ht(["vac-message-card",{"vac-message-highlight":a.isMessageHover,"vac-message-current":n.message.senderId===n.currentUserId,"vac-message-deleted":n.message.deleted,"vac-item-clickable":n.messageSelectionEnabled,"vac-message-selected":a.isMessageSelected}]),onMouseover:t[5]||(t[5]=(...e)=>a.onHoverMessage&&a.onHoverMessage(...e)),onMouseleave:t[6]||(t[6]=(...e)=>a.onLeaveMessage&&a.onLeaveMessage(...e))},[a.showUsername?(Do(),Vo("div",{key:0,class:ht(["vac-text-username",{"vac-username-reply":!n.message.deleted&&n.message.replyMessage}])},[Zo("span",null,gt(n.message.username),1)],2)):na("",!0),!n.message.deleted&&n.message.replyMessage?(Do(),qo(i,{key:1,message:n.message,"room-users":n.roomUsers,"text-formatting":n.textFormatting,"link-options":n.linkOptions},Ds({_:2},[Ps(e.$slots,((t,n)=>({name:n,fn:Fn((t=>[Hs(e.$slots,n,ft(Jo(t)))]))})))]),1032,["message","room-users","text-formatting","link-options"])):na("",!0),!n.message.deleted&&n.message.files&&n.message.files.length?!a.isAudio||n.message.files.length>1?(Do(),qo(l,{key:3,"current-user-id":n.currentUserId,message:n.message,"room-users":n.roomUsers,"text-formatting":n.textFormatting,"link-options":n.linkOptions,"message-selection-enabled":n.messageSelectionEnabled,onOpenFile:a.openFile,onOpenUserTag:a.openUserTag},Ds({_:2},[Ps(e.$slots,((t,n)=>({name:n,fn:Fn((t=>[Hs(e.$slots,n,ft(Jo(t)))]))})))]),1032,["current-user-id","message","room-users","text-formatting","link-options","message-selection-enabled","onOpenFile","onOpenUserTag"])):(Do(),Vo(Co,{key:4},[Wo(c,{"message-id":n.message._id,src:n.message.files[0].url,"message-selection-enabled":n.messageSelectionEnabled,onUpdateProgressTime:t[0]||(t[0]=e=>o.progressTime=e),onHoverAudioProgress:t[1]||(t[1]=e=>o.hoverAudioProgress=e)},Ds({_:2},[Ps(e.$slots,((t,n)=>({name:n,fn:Fn((t=>[Hs(e.$slots,n,ft(Jo(t)))]))})))]),1032,["message-id","src","message-selection-enabled"]),n.message.deleted?na("",!0):(Do(),Vo("div",Wx,gt(o.progressTime),1))],64)):(Do(),qo(r,{key:2,"message-id":n.message._id,content:n.message.content,deleted:!!n.message.deleted,users:n.roomUsers,"text-formatting":n.textFormatting,"text-messages":n.textMessages,"link-options":n.linkOptions,onOpenUserTag:a.openUserTag},Ds({_:2},[Ps(e.$slots,((t,n)=>({name:n,fn:Fn((t=>[Hs(e.$slots,n,ft(Jo(t)))]))})))]),1032,["message-id","content","deleted","users","text-formatting","text-messages","link-options","onOpenUserTag"])),Zo("div",Qx,[n.message.edited&&!n.message.deleted?(Do(),Vo("div",Jx,[Hs(e.$slots,"pencil-icon_"+n.message._id,{},(()=>[Wo(u,{name:"pencil"})]))])):na("",!0),Zo("span",null,gt(n.message.timestamp),1),a.isCheckmarkVisible?(Do(),Vo("span",ew,[Hs(e.$slots,"checkmark-icon_"+n.message._id,{},(()=>[Wo(u,{name:n.message.distributed?"double-checkmark":"checkmark",param:n.message.seen?"seen":"",class:"vac-icon-check"},null,8,["name","param"])]))])):na("",!0)]),Wo(d,{"current-user-id":n.currentUserId,message:n.message,"message-actions":n.messageActions,"show-reaction-emojis":n.showReactionEmojis,"message-hover":o.messageHover,"hover-message-id":o.hoverMessageId,"hover-audio-progress":o.hoverAudioProgress,"emoji-data-source":n.emojiDataSource,onUpdateMessageHover:t[2]||(t[2]=e=>o.messageHover=e),onUpdateOptionsOpened:t[3]||(t[3]=e=>o.optionsOpened=e),onUpdateEmojiOpened:t[4]||(t[4]=e=>o.emojiOpened=e),onMessageActionHandler:a.messageActionHandler,onSendMessageReaction:a.sendMessageReaction},Ds({_:2},[Ps(e.$slots,((t,n)=>({name:n,fn:Fn((t=>[Hs(e.$slots,n,ft(Jo(t)))]))})))]),1032,["current-user-id","message","message-actions","show-reaction-emojis","message-hover","hover-message-id","hover-audio-progress","emoji-data-source","onMessageActionHandler","onSendMessageReaction"])],34),Wo(m,{"current-user-id":n.currentUserId,message:n.message,onSendMessageReaction:a.sendMessageReaction},null,8,["current-user-id","message","onSendMessageReaction"])],2),Hs(e.$slots,"message-failure_"+n.message._id,{},(()=>[n.message.failure&&n.message.senderId===n.currentUserId?(Do(),Vo("div",{key:0,class:ht(["vac-failure-container vac-svg-button",{"vac-failure-container-avatar":n.message.avatar&&n.message.senderId===n.currentUserId}]),onClick:t[7]||(t[7]=t=>e.$emit("open-failed-message",{message:n.message}))},nw,2)):na("",!0)])),n.message.senderId===n.currentUserId?Hs(e.$slots,"message-avatar_"+n.message._id,{key:2},(()=>[n.message.avatar?(Do(),Vo("div",{key:0,class:"vac-avatar vac-avatar-current",style:ut({"background-image":`url('${n.message.avatar}')`})},null,4)):na("",!0)])):na("",!0),a.hasCurrentUserAvatar&&!n.message.avatar?(Do(),Vo("div",sw)):na("",!0)]))],2))],8,Xx)}var aw=mi(Ux,[["render",ow]]);const rw={name:"ChatRoom",components:{Loader:xi,SvgIcon:Ri,RoomHeader:mp,RoomFooter:Yy,RoomMessage:aw},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},singleRoom:{type:Boolean,required:!0},showRoomsList:{type:Boolean,required:!0},isMobile:{type:Boolean,required:!0},rooms:{type:Array,required:!0},roomId:{type:[String,Number],required:!0},loadFirstRoom:{type:Boolean,required:!0},messages:{type:Array,required:!0},roomMessage:{type:String,default:null},messagesLoaded:{type:Boolean,required:!0},menuActions:{type:Array,required:!0},messageActions:{type:Array,required:!0},messageSelectionActions:{type:Array,required:!0},autoScroll:{type:Object,required:!0},showSendIcon:{type:Boolean,required:!0},showFiles:{type:Boolean,required:!0},showAudio:{type:Boolean,required:!0},audioBitRate:{type:Number,required:!0},audioSampleRate:{type:Number,required:!0},showEmojis:{type:Boolean,required:!0},showReactionEmojis:{type:Boolean,required:!0},showNewMessagesDivider:{type:Boolean,required:!0},showFooter:{type:Boolean,required:!0},acceptedFiles:{type:String,required:!0},captureFiles:{type:String,required:!0},multipleFiles:{type:Boolean,default:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},loadingRooms:{type:Boolean,required:!0},roomInfoEnabled:{type:Boolean,required:!0},textareaActionEnabled:{type:Boolean,required:!0},textareaAutoFocus:{type:Boolean,required:!0},userTagsEnabled:{type:Boolean,required:!0},emojisSuggestionEnabled:{type:Boolean,required:!0},scrollDistance:{type:Number,required:!0},templatesText:{type:Array,default:null},usernameOptions:{type:Object,required:!0},emojiDataSource:{type:String,default:void 0}},emits:["toggle-rooms-list","room-info","menu-action-handler","message-selection-action-handler","edit-message","send-message","record-voice","record-status","delete-message","message-action-handler","fetch-messages","send-message-reaction","typing-message","open-file","open-user-tag","open-failed-message","textarea-action-handler"],data(){return{editedMessageId:null,initReplyMessage:null,initEditMessage:null,loadingMessages:!1,observer:null,showLoader:!0,loadingMoreMessages:!1,scrollIcon:!1,scrollMessagesCount:0,newMessages:[],messageSelectionEnabled:!1,selectedMessages:[],droppedFiles:[]}},computed:{room(){return this.rooms.find((e=>e.roomId===this.roomId))||{}},showNoMessages(){return this.roomId&&!this.messages.length&&!this.loadingMessages&&!this.loadingRooms},showNoRoom(){const e=!this.rooms.length&&!this.loadingRooms||!this.roomId&&!this.loadFirstRoom;return e&&this.updateLoadingMessages(!1),e},showMessagesStarted(){return this.messages.length&&this.messagesLoaded}},watch:{roomId:{immediate:!0,handler(){this.onRoomChanged()}},messages:{deep:!0,handler(e,t){e.forEach(((e,t)=>{this.showNewMessagesDivider&&!e.seen&&e.senderId!==this.currentUserId&&this.newMessages.push({_id:e._id,index:t})})),(null==t?void 0:t.length)===(null==e?void 0:e.length)-1&&(this.newMessages=[]),setTimeout((()=>this.loadingMoreMessages=!1))}},messagesLoaded(e){e&&this.updateLoadingMessages(!1)}},mounted(){this.newMessages=[]},methods:{setInput(e){$refs.footer.setInput(e)},updateLoadingMessages(e){this.loadingMessages=e,e||setTimeout((()=>this.initIntersectionObserver()))},initIntersectionObserver(){this.observer&&(this.showLoader=!0,this.observer.disconnect());const e=this.$el.querySelector("#infinite-loader-messages");if(e){const t={root:this.$el.querySelector("#messages-list"),rootMargin:`${this.scrollDistance}px`,threshold:0};this.observer=new IntersectionObserver((e=>{e[0].isIntersecting&&this.loadMoreMessages()}),t),this.observer.observe(e)}},preventTopScroll(){const e=this.$refs.scrollContainer,t=e.scrollHeight,n=new ResizeObserver((s=>{e.scrollHeight!==t&&this.$refs.scrollContainer&&(this.$refs.scrollContainer.scrollTo({top:e.scrollHeight-t}),n.disconnect())}));for(var s=0;s<e.children.length;s++)n.observe(e.children[s])},touchStart(e){if(!this.singleRoom&&1===e.changedTouches.length){const t=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY;addEventListener("touchend",(e=>this.touchEnd(e,t,n)),{once:!0})}},touchEnd(e,t,n){if(1===e.changedTouches.length){const s=e.changedTouches[0].clientX,o=e.changedTouches[0].clientY,a=s-t>100,r=Math.abs(o-n)>50;a&&!r&&this.$emit("toggle-rooms-list")}},onRoomChanged(){this.updateLoadingMessages(!0),this.scrollIcon=!1,this.scrollMessagesCount=0,this.resetMessageSelection();const e=this.$watch((()=>this.messages),(t=>{if(!t||!t.length)return;const n=this.$refs.scrollContainer;n&&(e(),setTimeout((()=>{n.scrollTo({top:n.scrollHeight}),this.updateLoadingMessages(!1)})))}))},resetMessageSelection(){this.messageSelectionEnabled=!1,this.selectedMessages=[]},selectMessage(e){this.selectedMessages.push(e)},unselectMessage(e){this.selectedMessages=this.selectedMessages.filter((t=>t._id!==e))},onMessageAdded({message:e,index:t,ref:n}){if(t!==this.messages.length-1)return;const s=n.offsetHeight+60;setTimeout((()=>{const t=this.$refs.scrollContainer;let n=!1;t&&(n=this.getBottomScroll(t)>s),e.senderId===this.currentUserId?n?this.autoScroll.send.newAfterScrollUp&&this.scrollToBottom():this.autoScroll.send.new&&this.scrollToBottom():n?this.autoScroll.receive.newAfterScrollUp?this.scrollToBottom():(this.scrollIcon=!0,this.scrollMessagesCount++):this.autoScroll.receive.new?this.scrollToBottom():(this.scrollIcon=!0,this.scrollMessagesCount++)}))},onContainerScroll(e){if(!e.target)return;const t=this.getBottomScroll(e.target);t<60&&(this.scrollMessagesCount=0),this.scrollIcon=t>500||this.scrollMessagesCount},loadMoreMessages(){this.loadingMessages||setTimeout((()=>{if(!this.loadingMoreMessages){if(this.messagesLoaded||!this.roomId)return this.loadingMoreMessages=!1,void(this.showLoader=!1);this.preventTopScroll(),this.$emit("fetch-messages"),this.loadingMoreMessages=!0}}),500)},messageActionHandler({action:e,message:t}){switch(e.name){case"replyMessage":return this.initReplyMessage=t,void setTimeout((()=>{this.initReplyMessage=null}));case"editMessage":return this.initEditMessage=t,void setTimeout((()=>{this.initEditMessage=null}));case"deleteMessage":return this.$emit("delete-message",t);case"selectMessages":return this.selectedMessages=[t],void(this.messageSelectionEnabled=!0);default:return this.$emit("message-action-handler",{action:e,message:t})}},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",{action:e,messages:this.selectedMessages}),this.resetMessageSelection()},sendMessageReaction(e){this.$emit("send-message-reaction",e)},getBottomScroll(e){const{scrollHeight:t,clientHeight:n,scrollTop:s}=e;return t-n-s},scrollToBottom(){setTimeout((()=>{const e=this.$refs.scrollContainer;e&&(e.classList.add("vac-scroll-smooth"),e.scrollTo({top:e.scrollHeight,behavior:"smooth"}),setTimeout((()=>e.classList.remove("vac-scroll-smooth"))))}),50)},openFile({message:e,file:t}){this.$emit("open-file",{message:e,file:t})},openUserTag(e){this.$emit("open-user-tag",e)},onDropFiles(e){this.showFiles&&(this.droppedFiles=e.dataTransfer.files)}}},iw={class:"vac-container-center vac-room-empty"},lw={class:"vac-messages-container"},cw={key:0,class:"vac-text-started"},uw={key:1,class:"vac-text-started"},dw={key:0,id:"infinite-loader-messages"},mw={key:2},pw={key:0,class:"vac-badge-counter vac-messages-count"};function hw(e,t,n,s,o,a){const r=Is("room-header"),i=Is("loader"),l=Is("room-message"),c=Is("svg-icon"),u=Is("room-footer");return Rs((Do(),Vo("div",{class:"vac-col-messages",onDrop:t[14]||(t[14]=si(((...e)=>a.onDropFiles&&a.onDropFiles(...e)),["prevent"])),onDragenter:t[15]||(t[15]=si((()=>{}),["prevent"])),onDragover:t[16]||(t[16]=si((()=>{}),["prevent"])),onDragleave:t[17]||(t[17]=si((()=>{}),["prevent"])),onTouchstart:t[18]||(t[18]=(...e)=>a.touchStart&&a.touchStart(...e))},[a.showNoRoom?Hs(e.$slots,"no-room-selected",{key:0},(()=>[Zo("div",iw,[Zo("div",null,gt(n.textMessages.ROOM_EMPTY),1)])])):(Do(),qo(r,{key:1,"current-user-id":n.currentUserId,"text-messages":n.textMessages,"single-room":n.singleRoom,"show-rooms-list":n.showRoomsList,"is-mobile":n.isMobile,"room-info-enabled":n.roomInfoEnabled,"menu-actions":n.menuActions,room:a.room,"message-selection-enabled":o.messageSelectionEnabled,"message-selection-actions":n.messageSelectionActions,"selected-messages-total":o.selectedMessages.length,onToggleRoomsList:t[0]||(t[0]=t=>e.$emit("toggle-rooms-list")),onRoomInfo:t[1]||(t[1]=t=>e.$emit("room-info")),onMenuActionHandler:t[2]||(t[2]=t=>e.$emit("menu-action-handler",t)),onMessageSelectionActionHandler:a.messageSelectionActionHandler,onCancelMessageSelection:t[3]||(t[3]=e=>o.messageSelectionEnabled=!1)},Ds({_:2},[Ps(e.$slots,((t,n)=>({name:n,fn:Fn((t=>[Hs(e.$slots,n,ft(Jo(t)))]))})))]),1032,["current-user-id","text-messages","single-room","show-rooms-list","is-mobile","room-info-enabled","menu-actions","room","message-selection-enabled","message-selection-actions","selected-messages-total","onMessageSelectionActionHandler"])),Zo("div",{id:"messages-list",ref:"scrollContainer",class:"vac-container-scroll",onScroll:t[5]||(t[5]=(...e)=>a.onContainerScroll&&a.onContainerScroll(...e))},[Wo(i,{show:o.loadingMessages,type:"messages"},Ds({_:2},[Ps(e.$slots,((t,n)=>({name:n,fn:Fn((t=>[Hs(e.$slots,n,ft(Jo(t)))]))})))]),1032,["show"]),Zo("div",lw,[Zo("div",{class:ht({"vac-messages-hidden":o.loadingMessages})},[Wo(Br,{name:"vac-fade-message"},{default:Fn((()=>[Zo("div",null,[a.showNoMessages?(Do(),Vo("div",cw,[Hs(e.$slots,"messages-empty",{},(()=>[ta(gt(n.textMessages.MESSAGES_EMPTY),1)]))])):na("",!0),a.showMessagesStarted?(Do(),Vo("div",uw,gt(n.textMessages.CONVERSATION_STARTED)+" "+gt(n.messages[0].date),1)):na("",!0)])])),_:3}),n.messages.length&&!n.messagesLoaded?(Do(),Vo("div",dw,[Wo(i,{show:!0,infinite:!0,type:"infinite-messages"},Ds({_:2},[Ps(e.$slots,((t,n)=>({name:n,fn:Fn((t=>[Hs(e.$slots,n,ft(Jo(t)))]))})))]),1024)])):na("",!0),(Do(),qo(Zr,{key:n.roomId,name:"vac-fade-message",tag:"span"},{default:Fn((()=>[(Do(!0),Vo(Co,null,Ps(n.messages,((s,r)=>(Do(),Vo("div",{key:s.indexId||s._id},[Wo(l,{"current-user-id":n.currentUserId,message:s,index:r,messages:n.messages,"edited-message-id":o.editedMessageId,"message-actions":n.messageActions,"room-users":a.room.users,"text-messages":n.textMessages,"new-messages":o.newMessages,"show-reaction-emojis":n.showReactionEmojis,"show-new-messages-divider":n.showNewMessagesDivider,"text-formatting":n.textFormatting,"link-options":n.linkOptions,"username-options":n.usernameOptions,"message-selection-enabled":o.messageSelectionEnabled,"selected-messages":o.selectedMessages,"emoji-data-source":n.emojiDataSource,onMessageAdded:a.onMessageAdded,onMessageActionHandler:a.messageActionHandler,onOpenFile:a.openFile,onOpenUserTag:a.openUserTag,onOpenFailedMessage:t[4]||(t[4]=t=>e.$emit("open-failed-message",t)),onSendMessageReaction:a.sendMessageReaction,onSelectMessage:a.selectMessage,onUnselectMessage:a.unselectMessage},Ds({_:2},[Ps(e.$slots,((t,n)=>({name:n,fn:Fn((t=>[Hs(e.$slots,n,ft(Jo(t)))]))})))]),1032,["current-user-id","message","index","messages","edited-message-id","message-actions","room-users","text-messages","new-messages","show-reaction-emojis","show-new-messages-divider","text-formatting","link-options","username-options","message-selection-enabled","selected-messages","emoji-data-source","onMessageAdded","onMessageActionHandler","onOpenFile","onOpenUserTag","onSendMessageReaction","onSelectMessage","onUnselectMessage"])])))),128))])),_:3}))],2)])],544),o.loadingMessages?na("",!0):(Do(),Vo("div",mw,[Wo(Br,{name:"vac-bounce"},{default:Fn((()=>[o.scrollIcon?(Do(),Vo("div",{key:0,class:"vac-icon-scroll",onClick:t[6]||(t[6]=(...e)=>a.scrollToBottom&&a.scrollToBottom(...e))},[Wo(Br,{name:"vac-bounce"},{default:Fn((()=>[o.scrollMessagesCount?(Do(),Vo("div",pw,gt(o.scrollMessagesCount),1)):na("",!0)])),_:1}),Hs(e.$slots,"scroll-icon",{},(()=>[Wo(c,{name:"dropdown",param:"scroll"})]))])):na("",!0)])),_:3})])),Wo(u,{id:"footer",ref:"footer",room:a.room,"room-id":n.roomId,"room-message":n.roomMessage,"text-messages":n.textMessages,"show-send-icon":n.showSendIcon,"show-files":n.showFiles,"show-audio":n.showAudio,"show-emojis":n.showEmojis,"show-footer":n.showFooter,"accepted-files":n.acceptedFiles,"capture-files":n.captureFiles,"multiple-files":n.multipleFiles,"textarea-action-enabled":n.textareaActionEnabled,"textarea-auto-focus":n.textareaAutoFocus,"user-tags-enabled":n.userTagsEnabled,"emojis-suggestion-enabled":n.emojisSuggestionEnabled,"templates-text":n.templatesText,"text-formatting":n.textFormatting,"link-options":n.linkOptions,"audio-bit-rate":n.audioBitRate,"audio-sample-rate":n.audioSampleRate,"init-reply-message":o.initReplyMessage,"init-edit-message":o.initEditMessage,"dropped-files":o.droppedFiles,"emoji-data-source":n.emojiDataSource,onUpdateEditedMessageId:t[7]||(t[7]=e=>o.editedMessageId=e),onEditMessage:t[8]||(t[8]=t=>e.$emit("edit-message",t)),onSendMessage:t[9]||(t[9]=t=>e.$emit("send-message",t)),onRecordVoice:t[10]||(t[10]=t=>e.$emit("record-voice",t)),onRecordStatus:t[11]||(t[11]=t=>e.$emit("record-status",t)),onTypingMessage:t[12]||(t[12]=t=>e.$emit("typing-message",t)),onTextareaActionHandler:t[13]||(t[13]=t=>e.$emit("textarea-action-handler",t))},Ds({_:2},[Ps(e.$slots,((t,n)=>({name:n,fn:Fn((t=>[Hs(e.$slots,n,ft(Jo(t)))]))})))]),1032,["room","room-id","room-message","text-messages","show-send-icon","show-files","show-audio","show-emojis","show-footer","accepted-files","capture-files","multiple-files","textarea-action-enabled","textarea-auto-focus","user-tags-enabled","emojis-suggestion-enabled","templates-text","text-formatting","link-options","audio-bit-rate","audio-sample-rate","init-reply-message","init-edit-message","dropped-files","emoji-data-source"])],544)),[[ri,n.isMobile&&!n.showRoomsList||!n.isMobile||n.singleRoom]])}var fw=mi(rw,[["render",hw]]);const gw={name:"MediaPreview",components:{SvgIcon:Ri},props:{file:{type:Object,required:!0}},emits:["close-media-preview"],computed:{isImage(){return wm(this.file)},isVideo(){return km(this.file)}},mounted(){this.$refs.modal.focus()},methods:{closeModal(){this.$emit("close-media-preview")}}},_w={key:0,class:"vac-media-preview-container"},vw={key:1,class:"vac-media-preview-container"},bw={controls:"",autoplay:""},yw=["src"],xw={class:"vac-svg-button"};function ww(e,t,n,s,o,a){const r=Is("svg-icon");return Do(),Vo("div",{ref:"modal",tabindex:"0",class:"vac-media-preview",onClick:t[0]||(t[0]=si(((...e)=>a.closeModal&&a.closeModal(...e)),["stop"])),onKeydown:t[1]||(t[1]=ai(((...e)=>a.closeModal&&a.closeModal(...e)),["esc"]))},[Wo(Br,{name:"vac-bounce-preview",appear:""},{default:Fn((()=>[a.isImage?(Do(),Vo("div",_w,[Zo("div",{class:"vac-image-preview",style:ut({"background-image":`url('${n.file.url}')`})},null,4)])):a.isVideo?(Do(),Vo("div",vw,[Zo("video",bw,[Zo("source",{src:n.file.url},null,8,yw)])])):na("",!0)])),_:1}),Zo("div",xw,[Hs(e.$slots,"preview-close-icon",{},(()=>[Wo(r,{name:"close-outline",param:"preview"})]))])],544)}var kw=mi(gw,[["render",ww]]),Sw={ROOMS_EMPTY:"No rooms",ROOM_EMPTY:"No room selected",NEW_MESSAGES:"New Messages",MESSAGE_DELETED:"This message was deleted",MESSAGES_EMPTY:"No messages",CONVERSATION_STARTED:"Conversation started on:",TYPE_MESSAGE:"Type message",SEARCH:"Search",IS_ONLINE:"is online",LAST_SEEN:"last seen ",IS_TYPING:"is writing...",CANCEL_SELECT_MESSAGE:"Cancel"};const Mw={light:{general:{color:"#0a0a0a",colorButtonClear:"#1976d2",colorButton:"#fff",backgroundColorButton:"#1976d2",backgroundInput:"#fff",colorPlaceholder:"#9ca6af",colorCaret:"#1976d2",colorSpinner:"#333",borderStyle:"1px solid #e1e4e8",backgroundScrollIcon:"#fff"},container:{border:"none",borderRadius:"4px",boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)"},header:{background:"#fff",colorRoomName:"#0a0a0a",colorRoomInfo:"#9ca6af",position:"absolute",width:"100%"},footer:{background:"#f8f9fa",borderStyleInput:"1px solid #e1e4e8",borderInputSelected:"#1976d2",backgroundReply:"#e5e5e6",backgroundTagActive:"#e5e5e6",backgroundTag:"#f8f9fa"},content:{background:"#f8f9fa"},sidemenu:{background:"#fff",backgroundHover:"#f6f6f6",backgroundActive:"#e5effa",colorActive:"#1976d2",borderColorSearch:"#e1e5e8"},dropdown:{background:"#fff",backgroundHover:"#f6f6f6"},message:{background:"#fff",backgroundMe:"#ccf2cf",color:"#0a0a0a",colorStarted:"#9ca6af",backgroundDeleted:"#dadfe2",backgroundSelected:"#c2dcf2",colorDeleted:"#757e85",colorUsername:"#9ca6af",colorTimestamp:"#828c94",backgroundDate:"#e5effa",colorDate:"#505a62",backgroundSystem:"#e5effa",colorSystem:"#505a62",backgroundMedia:"rgba(0, 0, 0, 0.15)",backgroundReply:"rgba(0, 0, 0, 0.08)",colorReplyUsername:"#0a0a0a",colorReply:"#6e6e6e",colorTag:"#0d579c",backgroundImage:"#ddd",colorNewMessages:"#1976d2",backgroundScrollCounter:"#0696c7",colorScrollCounter:"#fff",backgroundReaction:"#eee",borderStyleReaction:"1px solid #eee",backgroundReactionHover:"#fff",borderStyleReactionHover:"1px solid #ddd",colorReactionCounter:"#0a0a0a",backgroundReactionMe:"#cfecf5",borderStyleReactionMe:"1px solid #3b98b8",backgroundReactionHoverMe:"#cfecf5",borderStyleReactionHoverMe:"1px solid #3b98b8",colorReactionCounterMe:"#0b59b3",backgroundAudioRecord:"#eb4034",backgroundAudioLine:"rgba(0, 0, 0, 0.15)",backgroundAudioProgress:"#455247",backgroundAudioProgressSelector:"#455247",colorFileExtension:"#757e85"},markdown:{background:"rgba(239, 239, 239, 0.7)",border:"rgba(212, 212, 212, 0.9)",color:"#e01e5a",colorMulti:"#0a0a0a"},room:{colorUsername:"#0a0a0a",colorMessage:"#67717a",colorTimestamp:"#a2aeb8",colorStateOnline:"#4caf50",colorStateOffline:"#9ca6af",backgroundCounterBadge:"#0696c7",colorCounterBadge:"#fff"},emoji:{background:"#fff"},icons:{search:"#9ca6af",add:"#1976d2",toggle:"#0a0a0a",menu:"#0a0a0a",close:"#9ca6af",closeImage:"#fff",file:"#1976d2",paperclip:"#1976d2",closeOutline:"#000",closePreview:"#fff",send:"#1976d2",sendDisabled:"#9ca6af",emoji:"#1976d2",emojiReaction:"rgba(0, 0, 0, 0.3)",document:"#1976d2",pencil:"#9e9e9e",checkmark:"#9e9e9e",checkmarkSeen:"#0696c7",eye:"#fff",dropdownMessage:"#fff",dropdownMessageBackground:"rgba(0, 0, 0, 0.25)",dropdownRoom:"#9e9e9e",dropdownScroll:"#0a0a0a",microphone:"#1976d2",audioPlay:"#455247",audioPause:"#455247",audioCancel:"#eb4034",audioConfirm:"#1ba65b"}},dark:{general:{color:"#fff",colorButtonClear:"#fff",colorButton:"#fff",backgroundColorButton:"#1976d2",backgroundInput:"#202223",colorPlaceholder:"#596269",colorCaret:"#fff",colorSpinner:"#fff",borderStyle:"none",backgroundScrollIcon:"#fff"},container:{border:"none",borderRadius:"4px",boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)"},header:{background:"#181a1b",colorRoomName:"#fff",colorRoomInfo:"#9ca6af",position:"absolute",width:"100%"},footer:{background:"#131415",borderStyleInput:"none",borderInputSelected:"#1976d2",backgroundReply:"#1b1c1c",backgroundTagActive:"#1b1c1c",backgroundTag:"#131415"},content:{background:"#131415"},sidemenu:{background:"#181a1b",backgroundHover:"#202224",backgroundActive:"#151617",colorActive:"#fff",borderColorSearch:"#181a1b"},dropdown:{background:"#2a2c33",backgroundHover:"#26282e"},message:{background:"#22242a",backgroundMe:"#1f7e80",color:"#fff",colorStarted:"#9ca6af",backgroundDeleted:"#1b1c21",backgroundSelected:"#c2dcf2",colorDeleted:"#a2a5a8",colorUsername:"#b3bac9",colorTimestamp:"#ebedf2",backgroundDate:"rgba(0, 0, 0, 0.3)",colorDate:"#bec5cc",backgroundSystem:"rgba(0, 0, 0, 0.3)",colorSystem:"#bec5cc",backgroundMedia:"rgba(0, 0, 0, 0.18)",backgroundReply:"rgba(0, 0, 0, 0.18)",colorReplyUsername:"#fff",colorReply:"#d6d6d6",colorTag:"#f0c60a",backgroundImage:"#ddd",colorNewMessages:"#fff",backgroundScrollCounter:"#1976d2",colorScrollCounter:"#fff",backgroundReaction:"none",borderStyleReaction:"none",backgroundReactionHover:"#202223",borderStyleReactionHover:"none",colorReactionCounter:"#fff",backgroundReactionMe:"#4e9ad1",borderStyleReactionMe:"none",backgroundReactionHoverMe:"#4e9ad1",borderStyleReactionHoverMe:"none",colorReactionCounterMe:"#fff",backgroundAudioRecord:"#eb4034",backgroundAudioLine:"rgba(255, 255, 255, 0.15)",backgroundAudioProgress:"#b7d4d3",backgroundAudioProgressSelector:"#b7d4d3",colorFileExtension:"#a2a5a8"},markdown:{background:"rgba(239, 239, 239, 0.7)",border:"rgba(212, 212, 212, 0.9)",color:"#e01e5a",colorMulti:"#0a0a0a"},room:{colorUsername:"#fff",colorMessage:"#6c7278",colorTimestamp:"#6c7278",colorStateOnline:"#4caf50",colorStateOffline:"#596269",backgroundCounterBadge:"#1976d2",colorCounterBadge:"#fff"},emoji:{background:"#343740"},icons:{search:"#596269",add:"#fff",toggle:"#fff",menu:"#fff",close:"#9ca6af",closeImage:"#fff",file:"#1976d2",paperclip:"#fff",closeOutline:"#fff",closePreview:"#fff",send:"#fff",sendDisabled:"#646a70",emoji:"#fff",emojiReaction:"#fff",document:"#1976d2",pencil:"#ebedf2",checkmark:"#ebedf2",checkmarkSeen:"#f0d90a",eye:"#fff",dropdownMessage:"#fff",dropdownMessageBackground:"rgba(0, 0, 0, 0.25)",dropdownRoom:"#fff",dropdownScroll:"#0a0a0a",microphone:"#fff",audioPlay:"#b7d4d3",audioPause:"#b7d4d3",audioCancel:"#eb4034",audioConfirm:"#1ba65b"}}},Aw=({general:e,container:t,header:n,footer:s,sidemenu:o,content:a,dropdown:r,message:i,markdown:l,room:c,emoji:u,icons:d})=>({"--chat-color":e.color,"--chat-color-button-clear":e.colorButtonClear,"--chat-color-button":e.colorButton,"--chat-bg-color-button":e.backgroundColorButton,"--chat-bg-color-input":e.backgroundInput,"--chat-color-spinner":e.colorSpinner,"--chat-color-placeholder":e.colorPlaceholder,"--chat-color-caret":e.colorCaret,"--chat-border-style":e.borderStyle,"--chat-bg-scroll-icon":e.backgroundScrollIcon,"--chat-container-border":t.border,"--chat-container-border-radius":t.borderRadius,"--chat-container-box-shadow":t.boxShadow,"--chat-header-bg-color":n.background,"--chat-header-color-name":n.colorRoomName,"--chat-header-color-info":n.colorRoomInfo,"--chat-header-position":n.position,"--chat-header-width":n.width,"--chat-footer-bg-color":s.background,"--chat-border-style-input":s.borderStyleInput,"--chat-border-color-input-selected":s.borderInputSelected,"--chat-footer-bg-color-reply":s.backgroundReply,"--chat-footer-bg-color-tag-active":s.backgroundTagActive,"--chat-footer-bg-color-tag":s.backgroundTag,"--chat-content-bg-color":a.background,"--chat-sidemenu-bg-color":o.background,"--chat-sidemenu-bg-color-hover":o.backgroundHover,"--chat-sidemenu-bg-color-active":o.backgroundActive,"--chat-sidemenu-color-active":o.colorActive,"--chat-sidemenu-border-color-search":o.borderColorSearch,"--chat-dropdown-bg-color":r.background,"--chat-dropdown-bg-color-hover":r.backgroundHover,"--chat-message-bg-color":i.background,"--chat-message-bg-color-me":i.backgroundMe,"--chat-message-color-started":i.colorStarted,"--chat-message-bg-color-deleted":i.backgroundDeleted,"--chat-message-bg-color-selected":i.backgroundSelected,"--chat-message-color-deleted":i.colorDeleted,"--chat-message-color-username":i.colorUsername,"--chat-message-color-timestamp":i.colorTimestamp,"--chat-message-bg-color-date":i.backgroundDate,"--chat-message-color-date":i.colorDate,"--chat-message-bg-color-system":i.backgroundSystem,"--chat-message-color-system":i.colorSystem,"--chat-message-color":i.color,"--chat-message-bg-color-media":i.backgroundMedia,"--chat-message-bg-color-reply":i.backgroundReply,"--chat-message-color-reply-username":i.colorReplyUsername,"--chat-message-color-reply-content":i.colorReply,"--chat-message-color-tag":i.colorTag,"--chat-message-bg-color-image":i.backgroundImage,"--chat-message-color-new-messages":i.colorNewMessages,"--chat-message-bg-color-scroll-counter":i.backgroundScrollCounter,"--chat-message-color-scroll-counter":i.colorScrollCounter,"--chat-message-bg-color-reaction":i.backgroundReaction,"--chat-message-border-style-reaction":i.borderStyleReaction,"--chat-message-bg-color-reaction-hover":i.backgroundReactionHover,"--chat-message-border-style-reaction-hover":i.borderStyleReactionHover,"--chat-message-color-reaction-counter":i.colorReactionCounter,"--chat-message-bg-color-reaction-me":i.backgroundReactionMe,"--chat-message-border-style-reaction-me":i.borderStyleReactionMe,"--chat-message-bg-color-reaction-hover-me":i.backgroundReactionHoverMe,"--chat-message-border-style-reaction-hover-me":i.borderStyleReactionHoverMe,"--chat-message-color-reaction-counter-me":i.colorReactionCounterMe,"--chat-message-bg-color-audio-record":i.backgroundAudioRecord,"--chat-message-bg-color-audio-line":i.backgroundAudioLine,"--chat-message-bg-color-audio-progress":i.backgroundAudioProgress,"--chat-message-bg-color-audio-progress-selector":i.backgroundAudioProgressSelector,"--chat-message-color-file-extension":i.colorFileExtension,"--chat-markdown-bg":l.background,"--chat-markdown-border":l.border,"--chat-markdown-color":l.color,"--chat-markdown-color-multi":l.colorMulti,"--chat-room-color-username":c.colorUsername,"--chat-room-color-message":c.colorMessage,"--chat-room-color-timestamp":c.colorTimestamp,"--chat-room-color-online":c.colorStateOnline,"--chat-room-color-offline":c.colorStateOffline,"--chat-room-bg-color-badge":c.backgroundCounterBadge,"--chat-room-color-badge":c.colorCounterBadge,"--chat-emoji-bg-color":u.background,"--chat-icon-color-search":d.search,"--chat-icon-color-add":d.add,"--chat-icon-color-toggle":d.toggle,"--chat-icon-color-menu":d.menu,"--chat-icon-color-close":d.close,"--chat-icon-color-close-image":d.closeImage,"--chat-icon-color-file":d.file,"--chat-icon-color-paperclip":d.paperclip,"--chat-icon-color-close-outline":d.closeOutline,"--chat-icon-color-close-preview":d.closePreview,"--chat-icon-color-send":d.send,"--chat-icon-color-send-disabled":d.sendDisabled,"--chat-icon-color-emoji":d.emoji,"--chat-icon-color-emoji-reaction":d.emojiReaction,"--chat-icon-color-document":d.document,"--chat-icon-color-pencil":d.pencil,"--chat-icon-color-checkmark":d.checkmark,"--chat-icon-color-checkmark-seen":d.checkmarkSeen,"--chat-icon-color-eye":d.eye,"--chat-icon-color-dropdown-message":d.dropdownMessage,"--chat-icon-bg-dropdown-message":d.dropdownMessageBackground,"--chat-icon-color-dropdown-room":d.dropdownRoom,"--chat-icon-color-dropdown-scroll":d.dropdownScroll,"--chat-icon-color-microphone":d.microphone,"--chat-icon-color-audio-play":d.audioPlay,"--chat-icon-color-audio-pause":d.audioPause,"--chat-icon-color-audio-cancel":d.audioCancel,"--chat-icon-color-audio-confirm":d.audioConfirm});var Rw='.vac-fade-spinner-enter-from{opacity:0}.vac-fade-spinner-enter-active{transition:opacity .8s}.vac-fade-spinner-leave-active{transition:opacity .2s;opacity:0}.vac-fade-image-enter-from{opacity:0}.vac-fade-image-enter-active{transition:opacity 1s}.vac-fade-image-leave-active{transition:opacity .5s;opacity:0}.vac-fade-message-enter-from{opacity:0}.vac-fade-message-enter-active{transition:opacity .5s}.vac-fade-message-leave-active{transition:opacity .2s;opacity:0}.vac-slide-left-enter-active,.vac-slide-right-enter-active{transition:all .3s ease;transition-property:transform,opacity}.vac-slide-left-leave-active,.vac-slide-right-leave-active{transition:all .2s cubic-bezier(1,.5,.8,1)!important;transition-property:transform,opacity}.vac-slide-left-enter-from,.vac-slide-left-leave-to{transform:translate(10px);opacity:0}.vac-slide-right-enter-from,.vac-slide-right-leave-to{transform:translate(-10px);opacity:0}.vac-slide-up-enter-active{transition:all .3s ease}.vac-slide-up-leave-active{transition:all .2s cubic-bezier(1,.5,.8,1)}.vac-slide-up-enter-from,.vac-slide-up-leave-to{transform:translateY(10px);opacity:0}.vac-bounce-enter-active{animation:vac-bounce-in .5s}.vac-bounce-leave-active{animation:vac-bounce-in .3s reverse}@keyframes vac-bounce-in{0%{transform:scale(0)}50%{transform:scale(1.05)}to{transform:scale(1)}}.vac-fade-preview-enter{opacity:0}.vac-fade-preview-enter-active{transition:opacity .1s}.vac-fade-preview-leave-active{transition:opacity .2s;opacity:0}.vac-bounce-preview-enter-active{animation:vac-bounce-image-in .4s}.vac-bounce-preview-leave-active{animation:vac-bounce-image-in .3s reverse}@keyframes vac-bounce-image-in{0%{transform:scale(.6)}to{transform:scale(1)}}.vac-menu-list{border-radius:4px;display:block;cursor:pointer;background:var(--chat-dropdown-bg-color);padding:6px 0}.vac-menu-list :hover{background:var(--chat-dropdown-bg-color-hover);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-menu-list :not(:hover){transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-menu-item{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1 1 100%;flex:1 1 100%;min-height:30px;padding:5px 16px;position:relative;white-space:nowrap;line-height:30px}.vac-menu-options{position:absolute;right:10px;top:20px;z-index:9999;min-width:150px;display:inline-block;border-radius:4px;font-size:14px;color:var(--chat-color);overflow-y:auto;overflow-x:hidden;contain:content;box-shadow:0 2px 2px -4px #0000001a,0 2px 2px 1px #0000001f,0 1px 8px 1px #0000001f}.vac-app-border{border:var(--chat-border-style)}.vac-app-border-t{border-top:var(--chat-border-style)}.vac-app-border-r{border-right:var(--chat-border-style)}.vac-app-border-b{border-bottom:var(--chat-border-style)}.vac-app-box-shadow{transition:all .5s;box-shadow:0 2px 2px -4px #0000001a,0 2px 2px 1px #0000001f,0 1px 8px 1px #0000001f}.vac-item-clickable{cursor:pointer}.vac-vertical-center{display:flex;align-items:center;height:100%}.vac-vertical-center .vac-vertical-container{width:100%;text-align:center}.vac-svg-button{max-height:30px;display:flex;cursor:pointer;transition:all .2s}.vac-svg-button:hover{transform:scale(1.1);opacity:.7}.vac-avatar{background-size:cover;background-position:center center;background-repeat:no-repeat;background-color:#ddd;height:42px;width:42px;min-height:42px;min-width:42px;margin-right:15px;border-radius:50%}.vac-blur-loading{filter:blur(3px)}.vac-badge-counter{height:13px;width:auto;min-width:13px;border-radius:50%;display:flex;align-items:center;justify-content:center;padding:3px;font-size:11px;font-weight:500}.vac-text-ellipsis{width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.vac-text-tag{color:var(--chat-message-color-tag);cursor:pointer}.vac-file-container{display:flex;align-content:center;justify-content:center;flex-wrap:wrap;text-align:center;background:var(--chat-bg-color-input);border:var(--chat-border-style-input);border-radius:4px;padding:10px}.vac-file-container svg{height:28px;width:28px}.vac-file-container .vac-text-extension{font-size:12px;color:var(--chat-message-color-file-extension);margin-top:-2px}.markdown p{margin:0}.markdown ol{display:flex;flex-direction:column;list-style-position:inside}.markdown ul{display:flex;flex-direction:column}.markdown code{display:block;font-size:12px;color:var(--chat-markdown-color-multi);background:var(--chat-markdown-bg);border:1px solid var(--chat-markdown-border);border-radius:3px;margin:4px 0;padding:7px}.markdown p code{display:inline-block;font-size:12px;color:var(--chat-markdown-color);background:var(--chat-markdown-bg);border:1px solid var(--chat-markdown-border);border-radius:3px;margin:2px 0;padding:2px 3px}.vac-card-window{width:100%;display:block;max-width:100%;background:var(--chat-content-bg-color);color:var(--chat-color);overflow-wrap:break-word;white-space:normal;border:var(--chat-container-border);border-radius:var(--chat-container-border-radius);box-shadow:var(--chat-container-box-shadow);-webkit-tap-highlight-color:transparent}.vac-card-window *{font-family:inherit}.vac-card-window a{color:#0d579c;font-weight:500}.vac-card-window .vac-chat-container{height:100%;display:flex}.vac-card-window .vac-chat-container input{min-width:10px}.vac-card-window .vac-chat-container textarea,.vac-card-window .vac-chat-container input[type=text],.vac-card-window .vac-chat-container input[type=search]{-webkit-appearance:none}.vac-media-preview{position:fixed;top:0;left:0;z-index:99;width:100vw;height:100vh;display:flex;align-items:center;background-color:#000c;outline:none}.vac-media-preview .vac-media-preview-container{height:calc(100% - 140px);width:calc(100% - 80px);padding:70px 40px;margin:0 auto}.vac-media-preview .vac-image-preview{width:100%;height:100%;background-size:contain;background-repeat:no-repeat;background-position:center}.vac-media-preview video{width:100%;height:100%}.vac-media-preview .vac-svg-button{position:absolute;top:30px;right:30px;transform:scale(1.4)}@media only screen and (max-width: 768px){.vac-media-preview .vac-svg-button{top:20px;right:20px;transform:scale(1.2)}.vac-media-preview .vac-media-preview-container{width:calc(100% - 40px);padding:70px 20px}}.vac-col-messages{position:relative;height:100%;flex:1;overflow:hidden;display:flex;flex-flow:column}.vac-col-messages .vac-container-center{height:100%;width:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center}.vac-col-messages .vac-room-empty{font-size:14px;color:#9ca6af;font-style:italic;line-height:20px;white-space:pre-line}.vac-col-messages .vac-room-empty div{padding:0 10%}.vac-col-messages .vac-container-scroll{background:var(--chat-content-bg-color);flex:1;overflow-y:auto;margin-right:1px;margin-top:65px;-webkit-overflow-scrolling:touch}.vac-col-messages .vac-container-scroll.vac-scroll-smooth{scroll-behavior:smooth}.vac-col-messages .vac-messages-container{padding:0 5px 5px}.vac-col-messages .vac-text-started{font-size:14px;color:var(--chat-message-color-started);font-style:italic;text-align:center;margin-top:25px;margin-bottom:20px}.vac-col-messages .vac-icon-scroll{position:absolute;bottom:80px;right:20px;padding:8px;background:var(--chat-bg-scroll-icon);border-radius:50%;box-shadow:0 1px 1px -1px #0003,0 1px 1px #00000024,0 1px 2px #0000001f;display:flex;cursor:pointer;z-index:10}.vac-col-messages .vac-icon-scroll svg{height:25px;width:25px}.vac-col-messages .vac-messages-count{position:absolute;top:-8px;left:11px;background-color:var(--chat-message-bg-color-scroll-counter);color:var(--chat-message-color-scroll-counter)}.vac-col-messages .vac-messages-hidden{opacity:0}@media only screen and (max-width: 768px){.vac-col-messages .vac-container-scroll{margin-top:50px}.vac-col-messages .vac-text-started{margin-top:20px}.vac-col-messages .vac-icon-scroll{bottom:70px}}.vac-room-header{position:var(--chat-header-position);display:flex;align-items:center;height:64px;width:var(--chat-header-width);z-index:10;margin-right:1px;background:var(--chat-header-bg-color);border-top-right-radius:var(--chat-container-border-radius)}.vac-room-header .vac-room-wrapper{display:flex;align-items:center;min-width:0;height:100%;width:100%;padding:0 16px}.vac-room-header .vac-toggle-button{margin-right:15px}.vac-room-header .vac-toggle-button svg{height:26px;width:26px}.vac-room-header .vac-rotate-icon{transform:rotate(180deg)!important}.vac-room-header .vac-rotate-icon-init{transform:rotate(360deg)}.vac-room-header .vac-info-wrapper,.vac-room-header .vac-room-selection{display:flex;align-items:center;min-width:0;width:100%;height:100%}.vac-room-header .vac-room-selection .vac-selection-button{padding:8px 16px;color:var(--chat-color-button);background-color:var(--chat-bg-color-button);border-radius:4px;margin-right:10px;cursor:pointer;transition:all .2s}.vac-room-header .vac-room-selection .vac-selection-button:hover{opacity:.7}.vac-room-header .vac-room-selection .vac-selection-button:active{opacity:.9}.vac-room-header .vac-room-selection .vac-selection-button .vac-selection-button-count{margin-left:6px;opacity:.9}.vac-room-header .vac-room-selection .vac-selection-cancel{display:flex;align-items:center;margin-left:auto;white-space:nowrap;color:var(--chat-color-button-clear);transition:all .2s}.vac-room-header .vac-room-selection .vac-selection-cancel:hover{opacity:.7}.vac-room-header .vac-room-name{font-size:17px;font-weight:500;line-height:22px;color:var(--chat-header-color-name)}.vac-room-header .vac-room-info{font-size:13px;line-height:18px;color:var(--chat-header-color-info)}.vac-room-header .vac-room-options{margin-left:auto}@media only screen and (max-width: 768px){.vac-room-header{height:50px}.vac-room-header .vac-room-wrapper{padding:0 10px}.vac-room-header .vac-room-name{font-size:16px;line-height:22px}.vac-room-header .vac-room-info{font-size:12px;line-height:16px}.vac-room-header .vac-avatar{height:37px;width:37px;min-height:37px;min-width:37px}}.vac-room-footer{width:100%;border-bottom-right-radius:4px;z-index:10}.vac-box-footer{display:flex;position:relative;background:var(--chat-footer-bg-color);padding:10px 8px}.vac-textarea{max-height:300px;overflow-y:auto;height:20px;width:100%;line-height:20px;outline:0;resize:none;border-radius:20px;padding:12px 16px;box-sizing:content-box;font-size:16px;background:var(--chat-bg-color-input);color:var(--chat-color);caret-color:var(--chat-color-caret);border:var(--chat-border-style-input)}.vac-textarea::placeholder{color:var(--chat-color-placeholder);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.vac-textarea-outline{border:1px solid var(--chat-border-color-input-selected);box-shadow:inset 0 0 0 1px var(--chat-border-color-input-selected)}.vac-icon-textarea,.vac-icon-textarea-left{display:flex;align-items:center}.vac-icon-textarea svg,.vac-icon-textarea .vac-wrapper,.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 7px}.vac-icon-textarea{margin-left:5px}.vac-icon-textarea-left{display:flex;align-items:center;margin-right:5px}.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 7px}.vac-icon-textarea-left .vac-icon-microphone{fill:var(--chat-icon-color-microphone);margin:0 7px}.vac-icon-textarea-left .vac-dot-audio-record{height:15px;width:15px;border-radius:50%;background-color:var(--chat-message-bg-color-audio-record);animation:vac-scaling .8s ease-in-out infinite alternate}@keyframes vac-scaling{0%{transform:scale(1);opacity:.4}to{transform:scale(1.1);opacity:1}}.vac-icon-textarea-left .vac-dot-audio-record-time{font-size:16px;color:var(--chat-color);margin-left:8px;width:45px}.vac-icon-textarea-left .vac-icon-audio-stop,.vac-icon-textarea-left .vac-icon-audio-confirm{min-height:28px;min-width:28px}.vac-icon-textarea-left .vac-icon-audio-stop svg,.vac-icon-textarea-left .vac-icon-audio-confirm svg{min-height:28px;min-width:28px}.vac-icon-textarea-left .vac-icon-audio-stop{margin-right:20px}.vac-icon-textarea-left .vac-icon-audio-stop #vac-icon-close-outline{fill:var(--chat-icon-color-audio-cancel)}.vac-icon-textarea-left .vac-icon-audio-confirm{margin-right:3px;margin-left:12px}.vac-icon-textarea-left .vac-icon-audio-confirm #vac-icon-checkmark{fill:var(--chat-icon-color-audio-confirm)}.vac-send-disabled,.vac-send-disabled svg{cursor:none!important;pointer-events:none!important;transform:none!important}@media only screen and (max-width: 768px){.vac-room-footer{width:100%}.vac-box-footer{padding:7px 2px 7px 7px}.vac-box-footer.vac-box-footer-border{border-top:var(--chat-border-style-input)}.vac-textarea{padding:7px;line-height:18px}.vac-textarea::placeholder{color:transparent}.vac-icon-textarea svg,.vac-icon-textarea .vac-wrapper,.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 5px!important}}@media only screen and (max-height: 768px){.vac-textarea{max-height:120px}}.vac-emojis-container{width:calc(100% - 16px);padding:10px 8px;background:var(--chat-footer-bg-color);display:flex;align-items:center;overflow:auto}.vac-emojis-container .vac-emoji-element{padding:0 8px;font-size:30px;border-radius:4px;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-emojis-container .vac-emoji-element-active{background:var(--chat-footer-bg-color-tag-active)}@media only screen and (max-width: 768px){.vac-emojis-container{width:calc(100% - 10px);padding:7px 5px}.vac-emojis-container .vac-emoji-element{padding:0 7px;font-size:26px}}.vac-reply-container{display:flex;padding:10px 10px 0;background:var(--chat-footer-bg-color);align-items:center;width:calc(100% - 20px)}.vac-reply-container .vac-reply-box{width:100%;overflow:hidden;background:var(--chat-footer-bg-color-reply);border-radius:4px;padding:8px 10px}.vac-reply-container .vac-reply-info{overflow:hidden}.vac-reply-container .vac-reply-username{color:var(--chat-message-color-reply-username);font-size:12px;line-height:15px;margin-bottom:2px}.vac-reply-container .vac-reply-content{font-size:12px;color:var(--chat-message-color-reply-content);white-space:pre-line}.vac-reply-container .vac-icon-reply{margin-left:10px}.vac-reply-container .vac-icon-reply svg{height:20px;width:20px}.vac-reply-container .vac-image-reply{max-height:100px;max-width:200px;margin:4px 10px 0 0;border-radius:4px}.vac-reply-container .vac-audio-reply{margin-right:10px}.vac-reply-container .vac-file-container{max-width:80px}@media only screen and (max-width: 768px){.vac-reply-container{padding:5px 8px;width:calc(100% - 16px)}}.vac-room-files-container{display:flex;align-items:center;padding:10px 6px 0;background:var(--chat-footer-bg-color)}.vac-room-files-container .vac-files-box{display:flex;overflow:auto;width:calc(100% - 30px)}.vac-room-files-container video{height:100px;border:var(--chat-border-style-input);border-radius:4px}.vac-room-files-container .vac-icon-close{margin-left:auto}.vac-room-files-container .vac-icon-close svg{height:20px;width:20px}@media only screen and (max-width: 768px){.vac-files-container{padding:6px 4px 4px 2px}}.vac-room-file-container{display:flex;position:relative;margin:0 4px}.vac-room-file-container .vac-message-image{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:cover!important;background-position:center center!important;background-repeat:no-repeat!important;height:100px;width:100px;border:var(--chat-border-style-input);border-radius:4px}.vac-room-file-container .vac-file-container{height:80px;width:80px}.vac-room-file-container .vac-icon-remove{position:absolute;top:6px;left:6px;z-index:10}.vac-room-file-container .vac-icon-remove svg{height:20px;width:20px;border-radius:50%}.vac-room-file-container .vac-icon-remove:before{content:" ";position:absolute;width:100%;height:100%;background:rgba(0,0,0,.5);border-radius:50%;z-index:-1}.vac-tags-container{display:flex;flex-direction:column;align-items:center;width:100%}.vac-tags-container .vac-tags-box{display:flex;width:100%;height:54px;overflow:hidden;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-tags-container .vac-tags-box-active{background:var(--chat-footer-bg-color-tag-active)}.vac-tags-container .vac-tags-info{display:flex;overflow:hidden;padding:0 20px;align-items:center}.vac-tags-container .vac-tags-avatar{height:34px;width:34px;min-height:34px;min-width:34px}.vac-tags-container .vac-tags-username{font-size:14px}@media only screen and (max-width: 768px){.vac-tags-container .vac-tags-box{height:50px}.vac-tags-container .vac-tags-info{padding:0 12px}}.vac-template-container{display:flex;flex-direction:column;align-items:center;width:100%}.vac-template-container .vac-template-box{display:flex;width:100%;height:54px;overflow:hidden;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-template-container .vac-template-active{background:var(--chat-footer-bg-color-tag-active)}.vac-template-container .vac-template-info{display:flex;overflow:hidden;padding:0 20px;align-items:center}.vac-template-container .vac-template-tag{font-size:14px;font-weight:700;margin-right:10px}.vac-template-container .vac-template-text{font-size:14px}@media only screen and (max-width: 768px){.vac-template-container .vac-template-box{height:50px}.vac-template-container .vac-template-info{padding:0 12px}}.vac-rooms-container{display:flex;flex-flow:column;flex:0 0 25%;min-width:260px;max-width:500px;position:relative;background:var(--chat-sidemenu-bg-color);height:100%;border-top-left-radius:var(--chat-container-border-radius);border-bottom-left-radius:var(--chat-container-border-radius)}.vac-rooms-container.vac-rooms-container-full{flex:0 0 100%;max-width:100%}.vac-rooms-container .vac-rooms-empty{font-size:14px;color:#9ca6af;font-style:italic;text-align:center;margin:40px 0;line-height:20px;white-space:pre-line}.vac-rooms-container .vac-room-list{flex:1;position:relative;max-width:100%;padding:0 10px 5px;overflow-y:auto}.vac-rooms-container .vac-room-item{border-radius:8px;align-items:center;display:flex;flex:1 1 100%;margin-bottom:5px;padding:0 14px;position:relative;min-height:71px;transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-rooms-container .vac-room-item:hover{background:var(--chat-sidemenu-bg-color-hover)}.vac-rooms-container .vac-room-item:not(.vac-room-selected){cursor:pointer}.vac-rooms-container .vac-room-selected{color:var(--chat-sidemenu-color-active)!important;background:var(--chat-sidemenu-bg-color-active)!important}.vac-rooms-container .vac-room-selected:hover{background:var(--chat-sidemenu-bg-color-active)!important}@media only screen and (max-width: 768px){.vac-rooms-container .vac-room-list{padding:0 7px 5px}.vac-rooms-container .vac-room-item{min-height:60px;padding:0 8px}}.vac-room-container{display:flex;flex:1;align-items:center;width:100%}.vac-room-container .vac-name-container{flex:1}.vac-room-container .vac-title-container{display:flex;align-items:center;line-height:25px}.vac-room-container .vac-state-circle{width:9px;height:9px;border-radius:50%;background-color:var(--chat-room-color-offline);margin-right:6px;transition:.3s}.vac-room-container .vac-state-online{background-color:var(--chat-room-color-online)}.vac-room-container .vac-room-name{flex:1;color:var(--chat-room-color-username);font-weight:500}.vac-room-container .vac-text-date{margin-left:5px;font-size:11px;color:var(--chat-room-color-timestamp)}.vac-room-container .vac-text-last{display:flex;align-items:center;font-size:12px;line-height:19px;color:var(--chat-room-color-message)}.vac-room-container .vac-message-new{color:var(--chat-room-color-username);font-weight:500}.vac-room-container .vac-icon-check{display:flex;vertical-align:middle;height:14px;width:14px;margin-top:-2px;margin-right:2px}.vac-room-container .vac-icon-microphone{height:15px;width:15px;vertical-align:middle;margin:-3px 1px 0 -2px;fill:var(--chat-room-color-message)}.vac-room-container .vac-room-options-container{display:flex;margin-left:auto}.vac-room-container .vac-room-badge{background-color:var(--chat-room-bg-color-badge);color:var(--chat-room-color-badge);margin-left:5px}.vac-room-container .vac-list-room-options{height:19px;width:19px;align-items:center;margin-left:5px}.vac-box-empty{margin-top:10px}@media only screen and (max-width: 768px){.vac-box-empty{margin-top:7px}}.vac-box-search{position:sticky;display:flex;align-items:center;height:64px;padding:0 15px}.vac-box-search .vac-icon-search{display:flex;position:absolute;left:30px}.vac-box-search .vac-icon-search svg{width:18px;height:18px}.vac-box-search .vac-input{height:38px;width:100%;background:var(--chat-bg-color-input);color:var(--chat-color);font-size:15px;outline:0;caret-color:var(--chat-color-caret);padding:10px 10px 10px 40px;border:1px solid var(--chat-sidemenu-border-color-search);border-radius:20px}.vac-box-search .vac-input::placeholder{color:var(--chat-color-placeholder)}.vac-box-search .vac-add-icon{margin-left:auto;padding-left:10px}@media only screen and (max-width: 768px){.vac-box-search{height:58px}}.vac-message-wrapper .vac-card-info{border-radius:4px;text-align:center;margin:10px auto;font-size:12px;padding:4px;display:block;overflow-wrap:break-word;position:relative;white-space:normal;box-shadow:0 1px 1px -1px #0000001a,0 1px 1px -1px #0000001c,0 1px 2px -1px #0000001c}.vac-message-wrapper .vac-card-date{max-width:150px;font-weight:500;text-transform:uppercase;color:var(--chat-message-color-date);background-color:var(--chat-message-bg-color-date)}.vac-message-wrapper .vac-card-system{max-width:250px;padding:8px 4px;color:var(--chat-message-color-system);background-color:var(--chat-message-bg-color-system)}.vac-message-wrapper .vac-line-new{color:var(--chat-message-color-new-messages);position:relative;text-align:center;font-size:13px;padding:10px 0}.vac-message-wrapper .vac-line-new:after,.vac-message-wrapper .vac-line-new:before{border-top:1px solid var(--chat-message-color-new-messages);content:"";left:0;position:absolute;top:50%;width:calc(50% - 60px)}.vac-message-wrapper .vac-line-new:before{left:auto;right:0}.vac-message-wrapper .vac-message-box{display:flex;flex:0 0 50%;max-width:50%;justify-content:flex-start;line-height:1.4}.vac-message-wrapper .vac-avatar{height:28px;width:28px;min-height:28px;min-width:28px;margin:0 0 2px;align-self:flex-end}.vac-message-wrapper .vac-avatar-current-offset{margin-right:28px}.vac-message-wrapper .vac-avatar-offset{margin-left:28px}.vac-message-wrapper .vac-failure-container{position:relative;align-self:flex-end;height:20px;width:20px;margin:0 0 2px -4px;border-radius:50%;background-color:#f44336}.vac-message-wrapper .vac-failure-container.vac-failure-container-avatar{margin-right:6px}.vac-message-wrapper .vac-failure-container .vac-failure-text{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;font-size:15px;font-weight:700}.vac-message-wrapper .vac-message-container{position:relative;padding:2px 10px;align-items:end;min-width:100px;box-sizing:content-box}.vac-message-wrapper .vac-message-container-offset{margin-top:10px}.vac-message-wrapper .vac-offset-current{margin-left:50%;justify-content:flex-end}.vac-message-wrapper .vac-message-card{background-color:var(--chat-message-bg-color);color:var(--chat-message-color);border-radius:8px;font-size:14px;padding:6px 9px 3px;white-space:pre-line;max-width:100%;-webkit-transition-property:box-shadow,opacity;transition-property:box-shadow,opacity;transition:box-shadow .28s cubic-bezier(.4,0,.2,1);will-change:box-shadow;box-shadow:0 1px 1px -1px #0000001a,0 1px 1px -1px #0000001c,0 1px 2px -1px #0000001c}.vac-message-wrapper .vac-message-highlight{box-shadow:0 1px 2px -1px #0000001a,0 1px 2px -1px #0000001c,0 1px 5px -1px #0000001c}.vac-message-wrapper .vac-message-current{background-color:var(--chat-message-bg-color-me)!important}.vac-message-wrapper .vac-message-deleted{color:var(--chat-message-color-deleted)!important;font-size:13px!important;font-style:italic!important;background-color:var(--chat-message-bg-color-deleted)!important}.vac-message-wrapper .vac-message-selected{background-color:var(--chat-message-bg-color-selected)!important;transition:background-color .2s}.vac-message-wrapper .vac-message-image{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:cover!important;background-position:center center!important;background-repeat:no-repeat!important;height:250px;width:250px;max-width:100%;border-radius:4px;margin:4px auto 5px;transition:.4s filter linear}.vac-message-wrapper .vac-text-username{font-size:13px;color:var(--chat-message-color-username);margin-bottom:2px}.vac-message-wrapper .vac-username-reply{margin-bottom:5px}.vac-message-wrapper .vac-text-timestamp{font-size:10px;color:var(--chat-message-color-timestamp);text-align:right}.vac-message-wrapper .vac-progress-time{float:left;margin:-2px 0 0 40px;color:var(--chat-color);font-size:12px}.vac-message-wrapper .vac-icon-edited{-webkit-box-align:center;align-items:center;display:-webkit-inline-box;display:inline-flex;justify-content:center;letter-spacing:normal;line-height:1;text-indent:0;vertical-align:middle;margin:0 4px 2px}.vac-message-wrapper .vac-icon-edited svg{height:12px;width:12px}.vac-message-wrapper .vac-icon-check{height:14px;width:14px;vertical-align:middle;margin:-3px -3px 0 3px}@media only screen and (max-width: 768px){.vac-message-wrapper .vac-message-container{padding:2px 3px 1px}.vac-message-wrapper .vac-message-container-offset{margin-top:10px}.vac-message-wrapper .vac-message-box{flex:0 0 80%;max-width:80%}.vac-message-wrapper .vac-avatar{height:25px;width:25px;min-height:25px;min-width:25px;margin:0 6px 1px 0}.vac-message-wrapper .vac-avatar.vac-avatar-current{margin:0 0 1px 6px}.vac-message-wrapper .vac-avatar-current-offset{margin-right:31px}.vac-message-wrapper .vac-avatar-offset{margin-left:31px}.vac-message-wrapper .vac-failure-container{margin-left:2px}.vac-message-wrapper .vac-failure-container.vac-failure-container-avatar{margin-right:0}.vac-message-wrapper .vac-offset-current{margin-left:20%}.vac-message-wrapper .vac-progress-time{margin-left:37px}}.vac-audio-player{display:flex;margin:8px 0 5px}.vac-audio-player .vac-svg-button{max-width:18px;margin-left:7px}@media only screen and (max-width: 768px){.vac-audio-player{margin:4px 0 0}.vac-audio-player .vac-svg-button{max-width:16px;margin-left:5px}}.vac-player-bar{display:flex;align-items:center;max-width:calc(100% - 18px);margin-right:7px;margin-left:20px}.vac-player-bar .vac-player-progress{width:190px}.vac-player-bar .vac-player-progress .vac-line-container{position:relative;height:4px;border-radius:5px;background-color:var(--chat-message-bg-color-audio-line)}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-progress{position:absolute;height:inherit;background-color:var(--chat-message-bg-color-audio-progress);border-radius:inherit}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot{position:absolute;top:-5px;margin-left:-7px;height:14px;width:14px;border-radius:50%;background-color:var(--chat-message-bg-color-audio-progress-selector);transition:transform .25s}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot__active{transform:scale(1.2)}@media only screen and (max-width: 768px){.vac-player-bar{margin-right:5px}.vac-player-bar .vac-player-progress .vac-line-container{height:3px}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot{height:12px;width:12px;top:-5px;margin-left:-5px}}.vac-message-actions-wrapper .vac-options-container{position:absolute;top:2px;right:10px;height:40px;width:70px;overflow:hidden;border-top-right-radius:8px}.vac-message-actions-wrapper .vac-blur-container{position:absolute;height:100%;width:100%;left:8px;bottom:10px;background:var(--chat-message-bg-color);filter:blur(3px);border-bottom-left-radius:8px}.vac-message-actions-wrapper .vac-options-me{background:var(--chat-message-bg-color-me)}.vac-message-actions-wrapper .vac-message-options{background:var(--chat-icon-bg-dropdown-message);border-radius:50%;position:absolute;top:7px;right:7px}.vac-message-actions-wrapper .vac-message-options svg{height:17px;width:17px;padding:5px;margin:-5px}.vac-message-actions-wrapper .vac-message-emojis{position:absolute;top:6px;right:30px}.vac-message-actions-wrapper .vac-menu-options{right:15px}.vac-message-actions-wrapper .vac-menu-left{right:-118px}@media only screen and (max-width: 768px){.vac-message-actions-wrapper .vac-options-container{right:3px}.vac-message-actions-wrapper .vac-menu-left{right:-50px}}.vac-message-files-container .vac-file-wrapper{position:relative;width:fit-content}.vac-message-files-container .vac-file-wrapper .vac-file-container{height:60px;width:60px;margin:3px 0 5px;cursor:pointer;transition:all .6s}.vac-message-files-container .vac-file-wrapper .vac-file-container:hover{opacity:.85}.vac-message-files-container .vac-file-wrapper .vac-file-container svg{height:30px;width:30px}.vac-message-files-container .vac-file-wrapper .vac-file-container.vac-file-container-progress{background-color:#0000004d}.vac-message-file-container{position:relative;z-index:0}.vac-message-file-container .vac-message-image-container{cursor:pointer}.vac-message-file-container .vac-image-buttons{position:absolute;width:100%;height:100%;border-radius:4px;background:linear-gradient(to bottom,rgba(0,0,0,0) 55%,rgba(0,0,0,.02) 60%,rgba(0,0,0,.05) 65%,rgba(0,0,0,.1) 70%,rgba(0,0,0,.2) 75%,rgba(0,0,0,.3) 80%,rgba(0,0,0,.5) 85%,rgba(0,0,0,.6) 90%,rgba(0,0,0,.7) 95%,rgba(0,0,0,.8) 100%)}.vac-message-file-container .vac-image-buttons svg{height:26px;width:26px}.vac-message-file-container .vac-image-buttons .vac-button-view,.vac-message-file-container .vac-image-buttons .vac-button-download{position:absolute;bottom:6px;left:7px}.vac-message-file-container .vac-image-buttons :first-child{left:40px}.vac-message-file-container .vac-image-buttons .vac-button-view{max-width:18px;bottom:8px}.vac-message-file-container .vac-video-container{width:350px;max-width:100%;margin:4px auto 5px;cursor:pointer}.vac-message-file-container .vac-video-container video{width:100%;height:100%;border-radius:4px}.vac-button-reaction{display:inline-flex;align-items:center;border:var(--chat-message-border-style-reaction);outline:none;background:var(--chat-message-bg-color-reaction);border-radius:4px;margin:4px 2px 0;transition:.3s;padding:0 5px;font-size:18px;line-height:23px}.vac-button-reaction span{font-size:11px;font-weight:500;min-width:7px;color:var(--chat-message-color-reaction-counter)}.vac-button-reaction:hover{border:var(--chat-message-border-style-reaction-hover);background:var(--chat-message-bg-color-reaction-hover);cursor:pointer}.vac-button-reaction.vac-reaction-me{border:var(--chat-message-border-style-reaction-me);background:var(--chat-message-bg-color-reaction-me)}.vac-button-reaction.vac-reaction-me span{color:var(--chat-message-color-reaction-counter-me)}.vac-button-reaction.vac-reaction-me:hover{border:var(--chat-message-border-style-reaction-hover-me);background:var(--chat-message-bg-color-reaction-hover-me)}.vac-reply-message{background:var(--chat-message-bg-color-reply);border-radius:4px;margin:-1px -5px 8px;padding:8px 10px}.vac-reply-message .vac-reply-username{color:var(--chat-message-color-reply-username);font-size:12px;line-height:15px;margin-bottom:2px}.vac-reply-message .vac-image-reply-container{width:70px}.vac-reply-message .vac-image-reply-container .vac-message-image-reply{height:70px;width:70px;margin:4px auto 3px}.vac-reply-message .vac-video-reply-container{width:200px;max-width:100%}.vac-reply-message .vac-video-reply-container video{width:100%;height:100%;border-radius:4px}.vac-reply-message .vac-reply-content{font-size:12px;color:var(--chat-message-color-reply-content)}.vac-reply-message .vac-file-container{height:60px;width:60px}.vac-emoji-wrapper{position:relative;display:flex}.vac-emoji-wrapper .vac-emoji-reaction svg{height:19px;width:19px}.vac-emoji-wrapper .vac-emoji-picker{position:absolute;z-index:9999;bottom:32px;right:10px;width:300px;padding-top:4px;overflow:scroll;box-sizing:border-box;border-radius:.5rem;background:var(--chat-emoji-bg-color);box-shadow:0 1px 2px -2px #0000001a,0 1px 2px -1px #0000001a,0 1px 2px 1px #0000001a;scrollbar-width:none}.vac-emoji-wrapper .vac-emoji-picker::-webkit-scrollbar{display:none}.vac-emoji-wrapper .vac-emoji-picker.vac-picker-reaction{position:fixed;top:initial;right:initial}.vac-emoji-wrapper .vac-emoji-picker emoji-picker{height:100%;width:100%;--emoji-size: 1.2rem;--background: var(--chat-emoji-bg-color);--emoji-padding: .4rem;--border-color: var(--chat-sidemenu-border-color-search);--button-hover-background: var(--chat-sidemenu-bg-color-hover);--button-active-background: var(--chat-sidemenu-bg-color-hover)}.vac-format-message-wrapper .vac-format-container{display:inline}.vac-format-message-wrapper .vac-icon-deleted{height:14px;width:14px;vertical-align:middle;margin:-2px 2px 0 0;fill:var(--chat-message-color-deleted)}.vac-format-message-wrapper .vac-icon-deleted.vac-icon-deleted-room{margin:-3px 1px 0 0;fill:var(--chat-room-color-message)}.vac-format-message-wrapper .vac-image-link-container{background-color:var(--chat-message-bg-color-media);padding:8px;margin:2px auto;border-radius:4px}.vac-format-message-wrapper .vac-image-link{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:contain;background-position:center center!important;background-repeat:no-repeat!important;height:150px;width:150px;max-width:100%;border-radius:4px;margin:0 auto}.vac-format-message-wrapper .vac-image-link-message{max-width:166px;font-size:12px}.vac-loader-wrapper.vac-container-center{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:9}.vac-loader-wrapper.vac-container-top{padding:21px}.vac-loader-wrapper.vac-container-top #vac-circle{height:20px;width:20px}.vac-loader-wrapper #vac-circle{margin:auto;height:28px;width:28px;border:3px rgba(0,0,0,.25) solid;border-top:3px var(--chat-color-spinner) solid;border-right:3px var(--chat-color-spinner) solid;border-bottom:3px var(--chat-color-spinner) solid;border-radius:50%;-webkit-animation:vac-spin 1s infinite linear;animation:vac-spin 1s infinite linear}@media only screen and (max-width: 768px){.vac-loader-wrapper #vac-circle{height:24px;width:24px}.vac-loader-wrapper.vac-container-top{padding:18px}.vac-loader-wrapper.vac-container-top #vac-circle{height:16px;width:16px}}@-webkit-keyframes vac-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@keyframes vac-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}#vac-icon-search{fill:var(--chat-icon-color-search)}#vac-icon-add{fill:var(--chat-icon-color-add)}#vac-icon-toggle{fill:var(--chat-icon-color-toggle)}#vac-icon-menu{fill:var(--chat-icon-color-menu)}#vac-icon-close{fill:var(--chat-icon-color-close)}#vac-icon-close-image{fill:var(--chat-icon-color-close-image)}#vac-icon-file{fill:var(--chat-icon-color-file)}#vac-icon-paperclip{fill:var(--chat-icon-color-paperclip)}#vac-icon-close-outline{fill:var(--chat-icon-color-close-outline)}#vac-icon-close-outline-preview{fill:var(--chat-icon-color-close-preview)}#vac-icon-send{fill:var(--chat-icon-color-send)}#vac-icon-send-disabled{fill:var(--chat-icon-color-send-disabled)}#vac-icon-emoji{fill:var(--chat-icon-color-emoji)}#vac-icon-emoji-reaction{fill:var(--chat-icon-color-emoji-reaction)}#vac-icon-document{fill:var(--chat-icon-color-document)}#vac-icon-pencil{fill:var(--chat-icon-color-pencil)}#vac-icon-checkmark,#vac-icon-double-checkmark{fill:var(--chat-icon-color-checkmark)}#vac-icon-checkmark-seen,#vac-icon-double-checkmark-seen{fill:var(--chat-icon-color-checkmark-seen)}#vac-icon-eye{fill:var(--chat-icon-color-eye)}#vac-icon-dropdown-message{fill:var(--chat-icon-color-dropdown-message)}#vac-icon-dropdown-room{fill:var(--chat-icon-color-dropdown-room)}#vac-icon-dropdown-scroll{fill:var(--chat-icon-color-dropdown-scroll)}#vac-icon-audio-play{fill:var(--chat-icon-color-audio-play)}#vac-icon-audio-pause{fill:var(--chat-icon-color-audio-pause)}.vac-progress-wrapper{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:9}.vac-progress-wrapper circle{transition:stroke-dashoffset .35s;transform:rotate(-90deg);transform-origin:50% 50%}.vac-progress-wrapper .vac-progress-content{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:-1;margin-top:-2px;background-color:#000000b3;border-radius:50%}.vac-progress-wrapper .vac-progress-content .vac-progress-text{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);font-weight:700;color:#fff}.vac-progress-wrapper .vac-progress-content .vac-progress-text .vac-progress-pourcent{font-size:9px;font-weight:400}\n';const Ew={name:"ChatContainer",components:{RoomsList:Zm,Room:fw,MediaPreview:kw},expose:["setInput"],props:{height:{type:String,default:"600px"},theme:{type:String,default:"light"},styles:{type:[Object,String],default:()=>({})},responsiveBreakpoint:{type:Number,default:900},singleRoom:{type:[Boolean,String],default:!1},roomsListOpened:{type:[Boolean,String],default:!0},textMessages:{type:[Object,String],default:()=>({})},currentUserId:{type:String,default:""},rooms:{type:[Array,String],default:()=>[]},roomsOrder:{type:String,default:"desc"},loadingRooms:{type:[Boolean,String],default:!1},roomsLoaded:{type:[Boolean,String],default:!1},roomId:{type:String,default:null},loadFirstRoom:{type:[Boolean,String],default:!0},messages:{type:[Array,String],default:()=>[]},messagesLoaded:{type:[Boolean,String],default:!1},roomActions:{type:[Array,String],default:()=>[]},menuActions:{type:[Array,String],default:()=>[]},messageActions:{type:[Array,String],default:()=>[{name:"replyMessage",title:"Reply"},{name:"editMessage",title:"Edit Message",onlyMe:!0},{name:"deleteMessage",title:"Delete Message",onlyMe:!0},{name:"selectMessages",title:"Select"}]},messageSelectionActions:{type:[Array,String],default:()=>[]},autoScroll:{type:[Object,String],default:()=>({send:{new:!0,newAfterScrollUp:!0},receive:{new:!0,newAfterScrollUp:!1}})},customSearchRoomEnabled:{type:[Boolean,String],default:!1},showSearch:{type:[Boolean,String],default:!0},showAddRoom:{type:[Boolean,String],default:!0},showSendIcon:{type:[Boolean,String],default:!0},showFiles:{type:[Boolean,String],default:!0},showAudio:{type:[Boolean,String],default:!0},audioBitRate:{type:Number,default:128},audioSampleRate:{type:Number,default:(new(window.AudioContext||window.webkitAudioContext)).sampleRate},showEmojis:{type:[Boolean,String],default:!0},showReactionEmojis:{type:[Boolean,String],default:!0},showNewMessagesDivider:{type:[Boolean,String],default:!0},showFooter:{type:[Boolean,String],default:!0},textFormatting:{type:[Object,String],default:()=>({disabled:!1})},linkOptions:{type:[Object,String],default:()=>({disabled:!1,target:"_blank",rel:null})},roomInfoEnabled:{type:[Boolean,String],default:!1},textareaActionEnabled:{type:[Boolean,String],default:!1},textareaAutoFocus:{type:[Boolean,String],default:!0},userTagsEnabled:{type:[Boolean,String],default:!0},emojisSuggestionEnabled:{type:[Boolean,String],default:!0},roomMessage:{type:String,default:""},scrollDistance:{type:Number,default:60},acceptedFiles:{type:String,default:"*"},captureFiles:{type:String,default:""},multipleFiles:{type:[Boolean,String],default:!0},templatesText:{type:[Array,String],default:()=>[]},mediaPreviewEnabled:{type:[Boolean,String],default:!0},usernameOptions:{type:[Object,String],default:()=>({minUsers:3,currentUser:!1})},emojiDataSource:{type:String,default:void 0}},emits:["toggle-rooms-list","room-info","fetch-messages","send-message","edit-message","delete-message","open-file","open-user-tag","open-failed-message","menu-action-handler","message-action-handler","send-message-reaction","typing-message","textarea-action-handler","fetch-more-rooms","add-room","search-room","room-action-handler","record-voice","record-status","message-selection-action-handler"],setup(){const e=tt(0);return{roomComp:e}},data(){return{slots:[],room:{},loadingMoreRooms:!1,showRoomsList:!0,isMobile:!1,showMediaPreview:!1,previewFile:{}}},computed:{t(){return{...Sw,...this.textMessagesCasted}},cssVars(){const e=Mw[this.theme],t={};return Object.keys(e).map((n=>{t[n]={...e[n],...this.stylesCasted[n]||{}}})),Aw(t)},orderedRooms(){return this.roomsCasted.slice().sort(((e,t)=>{const n=e.index||0,s=t.index||0;return"asc"===this.roomsOrder?n<s?-1:s<n?1:0:n>s?-1:s>n?1:0}))},singleRoomCasted(){return this.castBoolean(this.singleRoom)},roomsListOpenedCasted(){return this.castBoolean(this.roomsListOpened)},loadingRoomsCasted(){return this.castBoolean(this.loadingRooms)},roomsLoadedCasted(){return this.castBoolean(this.roomsLoaded)},loadFirstRoomCasted(){return this.castBoolean(this.loadFirstRoom)},messagesLoadedCasted(){return this.castBoolean(this.messagesLoaded)},multipleFilesCasted(){return this.castBoolean(this.multipleFiles)},showSearchCasted(){return this.castBoolean(this.showSearch)},showAddRoomCasted(){return this.castBoolean(this.showAddRoom)},showSendIconCasted(){return this.castBoolean(this.showSendIcon)},showFilesCasted(){return this.castBoolean(this.showFiles)},showAudioCasted(){return this.castBoolean(this.showAudio)},showEmojisCasted(){return this.castBoolean(this.showEmojis)},showReactionEmojisCasted(){return this.castBoolean(this.showReactionEmojis)},showNewMessagesDividerCasted(){return this.castBoolean(this.showNewMessagesDivider)},showFooterCasted(){return this.castBoolean(this.showFooter)},roomInfoEnabledCasted(){return this.castBoolean(this.roomInfoEnabled)},textareaActionEnabledCasted(){return this.castBoolean(this.textareaActionEnabled)},textareaAutoFocusCasted(){return this.castBoolean(this.textareaAutoFocus)},userTagsEnabledCasted(){return this.castBoolean(this.userTagsEnabled)},emojisSuggestionEnabledCasted(){return this.castBoolean(this.emojisSuggestionEnabled)},mediaPreviewEnabledCasted(){return this.castBoolean(this.mediaPreviewEnabled)},roomsCasted(){return this.castArray(this.rooms)},messagesCasted(){return this.castArray(this.messages)},roomActionsCasted(){return this.castArray(this.roomActions)},menuActionsCasted(){return this.castArray(this.menuActions)},messageActionsCasted(){return this.castArray(this.messageActions)},messageSelectionActionsCasted(){return this.castArray(this.messageSelectionActions)},templatesTextCasted(){return this.castArray(this.templatesText)},stylesCasted(){return this.castObject(this.styles)},textMessagesCasted(){return this.castObject(this.textMessages)},autoScrollCasted(){return this.castObject(this.autoScroll)},textFormattingCasted(){return this.castObject(this.textFormatting)},linkOptionsCasted(){return this.castObject(this.linkOptions)},usernameOptionsCasted(){return this.castObject(this.usernameOptions)}},watch:{roomsCasted:{immediate:!0,deep:!0,handler(e,t){if(e[0]&&e.find((e=>e.roomId===this.room.roomId))||(this.showRoomsList=!0),!this.loadingMoreRooms&&this.loadFirstRoomCasted&&e[0]&&(!t||e.length!==t.length))if(this.roomId){const t=e.find((e=>e.roomId===this.roomId))||{};this.fetchRoom({room:t})}else!this.isMobile||this.singleRoomCasted?this.fetchRoom({room:this.orderedRooms[0]}):this.showRoomsList=!0}},loadingRoomsCasted(e){e&&(this.room={})},roomId:{immediate:!0,handler(e,t){if(e&&!this.loadingRoomsCasted&&this.roomsCasted.length){const t=this.roomsCasted.find((t=>t.roomId===e));this.fetchRoom({room:t})}else t&&!e&&(this.room={})}},room(e){e&&0!==Object.entries(e).length&&($x(e),e.users.forEach((e=>{zx(e)})))},roomsListOpenedCasted:{immediate:!0,handler(e){this.showRoomsList=e}}},created(){this.updateResponsive(),window.addEventListener("resize",(e=>{e.isTrusted&&this.updateResponsive()}))},updated(){const e=document.querySelectorAll("[slot]");this.slots.length!==e.length&&(this.slots=e)},methods:{setInput(e){return console.log(111),this.$refs.roomComp},castBoolean(e){return"true"===e||!0===e},castArray(e){return e?Array.isArray(e)?e:JSON.parse(e):[]},castObject(e){return e?"object"===typeof e?e:JSON.parse(e):{}},updateResponsive(){this.isMobile=window.innerWidth<Number(this.responsiveBreakpoint)},toggleRoomsList(){this.showRoomsList=!this.showRoomsList,this.isMobile&&(this.room={}),this.$emit("toggle-rooms-list",{opened:this.showRoomsList})},fetchRoom({room:e}){this.room=e,this.fetchMessages({reset:!0}),this.isMobile&&(this.showRoomsList=!1)},fetchMoreRooms(){this.$emit("fetch-more-rooms")},roomInfo(){this.$emit("room-info",this.room)},addRoom(){this.$emit("add-room")},searchRoom(e){this.$emit("search-room",{value:e,roomId:this.room.roomId})},fetchMessages(e){this.$emit("fetch-messages",{room:this.room,options:e})},sendMessage(e){this.$emit("send-message",{...e,roomId:this.room.roomId})},editMessage(e){this.$emit("edit-message",{...e,roomId:this.room.roomId})},deleteMessage(e){this.$emit("delete-message",{message:e,roomId:this.room.roomId})},openFile({message:e,file:t}){this.mediaPreviewEnabledCasted&&"preview"===t.action?(this.previewFile=t.file,this.showMediaPreview=!0):this.$emit("open-file",{message:e,file:t})},openUserTag({user:e}){this.$emit("open-user-tag",{user:e})},recordVoice(e){this.$emit("record-voice",e)},recordStatus(e){this.$emit("record-status",e)},openFailedMessage({message:e}){this.$emit("open-failed-message",{message:e,roomId:this.room.roomId})},menuActionHandler(e){this.$emit("menu-action-handler",{action:e,roomId:this.room.roomId})},roomActionHandler({action:e,roomId:t}){this.$emit("room-action-handler",{action:e,roomId:t})},messageActionHandler(e){this.$emit("message-action-handler",{...e,roomId:this.room.roomId})},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",{...e,roomId:this.room.roomId})},sendMessageReaction(e){this.$emit("send-message-reaction",{...e,roomId:this.room.roomId})},typingMessage(e){this.$emit("typing-message",{message:e,roomId:this.room.roomId})},textareaActionHandler(e){this.$emit("textarea-action-handler",{message:e,roomId:this.room.roomId})}}},Tw={class:"vac-chat-container"};function Bw(e,t,n,s,o,a){const r=Is("rooms-list"),i=Is("room"),l=Is("media-preview");return Do(),Vo("div",{class:"vac-card-window",style:ut([{height:n.height},a.cssVars])},[Zo("div",Tw,[a.singleRoomCasted?na("",!0):(Do(),qo(r,{key:0,"current-user-id":n.currentUserId,rooms:a.orderedRooms,"loading-rooms":a.loadingRoomsCasted,"rooms-loaded":a.roomsLoadedCasted,room:o.room,"room-actions":a.roomActionsCasted,"custom-search-room-enabled":n.customSearchRoomEnabled,"text-messages":a.t,"show-search":a.showSearchCasted,"show-add-room":a.showAddRoomCasted,"show-rooms-list":o.showRoomsList&&a.roomsListOpenedCasted,"text-formatting":a.textFormattingCasted,"link-options":a.linkOptionsCasted,"is-mobile":o.isMobile,"scroll-distance":n.scrollDistance,onFetchRoom:a.fetchRoom,onFetchMoreRooms:a.fetchMoreRooms,onLoadingMoreRooms:t[0]||(t[0]=e=>o.loadingMoreRooms=e),onAddRoom:a.addRoom,onSearchRoom:a.searchRoom,onRoomActionHandler:a.roomActionHandler},Ds({_:2},[Ps(o.slots,(t=>({name:t.slot,fn:Fn((n=>[Hs(e.$slots,t.slot,ft(Jo(n)))]))})))]),1032,["current-user-id","rooms","loading-rooms","rooms-loaded","room","room-actions","custom-search-room-enabled","text-messages","show-search","show-add-room","show-rooms-list","text-formatting","link-options","is-mobile","scroll-distance","onFetchRoom","onFetchMoreRooms","onAddRoom","onSearchRoom","onRoomActionHandler"])),Wo(i,{id:"roomComp",ref:"roomComp","current-user-id":n.currentUserId,rooms:a.roomsCasted,"room-id":o.room.roomId||"","load-first-room":a.loadFirstRoomCasted,messages:a.messagesCasted,"room-message":n.roomMessage,"messages-loaded":a.messagesLoadedCasted,"menu-actions":a.menuActionsCasted,"message-actions":a.messageActionsCasted,"message-selection-actions":a.messageSelectionActionsCasted,"auto-scroll":a.autoScrollCasted,"show-send-icon":a.showSendIconCasted,"show-files":a.showFilesCasted,"show-audio":a.showAudioCasted,"audio-bit-rate":n.audioBitRate,"audio-sample-rate":n.audioSampleRate,"show-emojis":a.showEmojisCasted,"show-reaction-emojis":a.showReactionEmojisCasted,"show-new-messages-divider":a.showNewMessagesDividerCasted,"show-footer":a.showFooterCasted,"text-messages":a.t,"single-room":a.singleRoomCasted,"show-rooms-list":o.showRoomsList&&a.roomsListOpenedCasted,"text-formatting":a.textFormattingCasted,"link-options":a.linkOptionsCasted,"is-mobile":o.isMobile,"loading-rooms":a.loadingRoomsCasted,"room-info-enabled":a.roomInfoEnabledCasted,"textarea-action-enabled":a.textareaActionEnabledCasted,"textarea-auto-focus":a.textareaAutoFocusCasted,"user-tags-enabled":a.userTagsEnabledCasted,"emojis-suggestion-enabled":a.emojisSuggestionEnabledCasted,"scroll-distance":n.scrollDistance,"accepted-files":n.acceptedFiles,"capture-files":n.captureFiles,"multiple-files":a.multipleFilesCasted,"templates-text":a.templatesTextCasted,"username-options":a.usernameOptionsCasted,"emoji-data-source":n.emojiDataSource,onToggleRoomsList:a.toggleRoomsList,onRoomInfo:a.roomInfo,onFetchMessages:a.fetchMessages,onSendMessage:a.sendMessage,onEditMessage:a.editMessage,onDeleteMessage:a.deleteMessage,onRecordVoice:a.recordVoice,onRecordStatus:a.recordStatus,onOpenFile:a.openFile,onOpenUserTag:a.openUserTag,onOpenFailedMessage:a.openFailedMessage,onMenuActionHandler:a.menuActionHandler,onMessageActionHandler:a.messageActionHandler,onMessageSelectionActionHandler:a.messageSelectionActionHandler,onSendMessageReaction:a.sendMessageReaction,onTypingMessage:a.typingMessage,onTextareaActionHandler:a.textareaActionHandler},Ds({_:2},[Ps(o.slots,(t=>({name:t.slot,fn:Fn((n=>[Hs(e.$slots,t.slot,ft(Jo(n)))]))})))]),1032,["current-user-id","rooms","room-id","load-first-room","messages","room-message","messages-loaded","menu-actions","message-actions","message-selection-actions","auto-scroll","show-send-icon","show-files","show-audio","audio-bit-rate","audio-sample-rate","show-emojis","show-reaction-emojis","show-new-messages-divider","show-footer","text-messages","single-room","show-rooms-list","text-formatting","link-options","is-mobile","loading-rooms","room-info-enabled","textarea-action-enabled","textarea-auto-focus","user-tags-enabled","emojis-suggestion-enabled","scroll-distance","accepted-files","capture-files","multiple-files","templates-text","username-options","emoji-data-source","onToggleRoomsList","onRoomInfo","onFetchMessages","onSendMessage","onEditMessage","onDeleteMessage","onRecordVoice","onRecordStatus","onOpenFile","onOpenUserTag","onOpenFailedMessage","onMenuActionHandler","onMessageActionHandler","onMessageSelectionActionHandler","onSendMessageReaction","onTypingMessage","onTextareaActionHandler"])]),Wo(Br,{name:"vac-fade-preview",appear:""},{default:Fn((()=>[o.showMediaPreview?(Do(),qo(l,{key:0,file:o.previewFile,onCloseMediaPreview:t[1]||(t[1]=e=>o.showMediaPreview=!1)},Ds({_:2},[Ps(o.slots,(t=>({name:t.slot,fn:Fn((n=>[Hs(e.$slots,t.slot,ft(Jo(n)))]))})))]),1032,["file"])):na("",!0)])),_:3})],4)}var Iw=mi(Ew,[["render",Bw],["styles",[Rw]]]);const Cw=Mr(Iw),jw="vue-advanced-chat";function Ow(){customElements.get(jw)||customElements.define(jw,Cw)}var Fw=n(6408),Lw=n(5984);Ow();(0,Fw.KR)(null);var Pw={components:{VueAdvancedChat:s["default"]},mounted(){this.socket=(0,Lw.Ay)("http://160.16.216.251:8379"),this.autoScroll={send:{new:!0,newAfterScrollUp:!0},receive:{new:!0,newAfterScrollUp:!0}},this.socket.on("v2t",(e=>{console.log(e)})),this.socket.on("message",(e=>{console.log(e),this.messages=[...this.messages,{_id:this.messages.length,content:e.content,senderId:"9999",timestamp:(new Date).toString().substring(16,21),date:(new Date).toDateString()}]})),this.socket.on("newThread",(e=>{this.canUse=!0,this.thread=e}))},data(){return{currentUserId:"1111",rooms:[{roomId:"1",roomName:"FSR",avatar:"https://66.media.tumblr.com/avatar_c6a8eae4303e_512.pnj",users:[{_id:"1111",username:"FSR"}]}],messages:[],messagesLoaded:!0}},methods:{onClick:function(){console.log(this.$refs.chat.roomComp),this.$refs.childComp.play()},addMessages(e){},record(e){this.socket.emit("recording",{threadId:this.thread,data:e.buffer})},recordStatus(e){console.log(e),1==e?this.socket.emit("startRecord",{threadId:this.thread}):this.socket.emit("stopRecord",{threadId:this.thread},(e=>{"fail"==e.a?this.messages=[...this.messages,{_id:this.messages.length,content:"聞こえません",senderId:"9999",timestamp:(new Date).toString().substring(16,21),date:(new Date).toDateString()}]:this.messages=[...this.messages,{_id:this.messages.length,content:e.q,senderId:"1111",timestamp:(new Date).toString().substring(16,21),date:(new Date).toDateString()},{_id:this.messages.length+1,content:e.a,senderId:"9999",timestamp:(new Date).toString().substring(16,21),date:(new Date).toDateString()}]})),console.log(e)},sendMessage(e){this.socket.emit("message",{threadId:this.thread,msg:e}),this.messages=[...this.messages,{_id:this.messages.length,content:e.content,senderId:this.currentUserId,timestamp:(new Date).toString().substring(16,21),date:(new Date).toDateString()}]}}},Dw=n(6552);const Hw=(0,Dw.A)(Pw,[["render",r]]);var Nw=Hw,$w=n(6699),zw=n(7988),Vw=n(7027),qw=n(4026),Uw=n(1406),Xw=n(7764);const Yw=(0,o.Ef)(Nw);Yw.use($w.$n),Yw.use(zw.nz),Yw.use(Vw.cG),Yw.use(qw.Sv),Yw.use(Uw.D0),Yw.use(Xw.Qh),Yw.mount("#app")}},t={};function n(s){var o=t[s];if(void 0!==o)return o.exports;var a=t[s]={exports:{}};return e[s].call(a.exports,a,a.exports,n),a.exports}n.m=e,function(){var e=[];n.O=function(t,s,o,a){if(!s){var r=1/0;for(u=0;u<e.length;u++){s=e[u][0],o=e[u][1],a=e[u][2];for(var i=!0,l=0;l<s.length;l++)(!1&a||r>=a)&&Object.keys(n.O).every((function(e){return n.O[e](s[l])}))?s.splice(l--,1):(i=!1,a<r&&(r=a));if(i){e.splice(u--,1);var c=o();void 0!==c&&(t=c)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[s,o,a]}}(),function(){n.d=function(e,t){for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};n.O.j=function(t){return 0===e[t]};var t=function(t,s){var o,a,r=s[0],i=s[1],l=s[2],c=0;if(r.some((function(t){return 0!==e[t]}))){for(o in i)n.o(i,o)&&(n.m[o]=i[o]);if(l)var u=l(n)}for(t&&t(s);c<r.length;c++)a=r[c],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(u)},s=self["webpackChunkfsr"]=self["webpackChunkfsr"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=n.O(void 0,[504],(function(){return n(6396)}));s=n.O(s)})();
//# sourceMappingURL=app.103b55d4.js.map